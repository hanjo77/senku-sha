<html><head><meta http-equiv="content-type" content="text/html; charset=utf-8"> <style>
	.KEYW {color: #933;}
	.COMM {color: #bbb; font-style: italic;}
	.NUMB {color: #393;}
	.STRN {color: #393;}
	.REGX {color: #339;}
	.line {border-right: 1px dotted #666; color: #666; font-style: normal;}
	</style></head><body><pre><span class='line'>  1</span> <span class="COMM">// three.js - http://github.com/mrdoob/three.js</span><span class="WHIT">
<span class='line'>  2</span> </span><span class="STRN">'use strict'</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">THREE</span><span class="PUNC">=</span><span class="NAME">THREE</span><span class="PUNC">||</span><span class="PUNC">{</span><span class="NAME">REVISION</span><span class="PUNC">:</span><span class="STRN">"59"</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">self.console</span><span class="PUNC">=</span><span class="NAME">self.console</span><span class="PUNC">||</span><span class="PUNC">{</span><span class="NAME">info</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">log</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">debug</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">warn</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">error</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">String.prototype.trim</span><span class="PUNC">=</span><span class="NAME">String.prototype.trim</span><span class="PUNC">||</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.replace</span><span class="PUNC">(</span><span class="REGX">/^\s+|\s+$/g</span><span class="PUNC">,</span><span class="STRN">""</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.extend</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">Object.keys</span><span class="PUNC">)</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">Object.keys</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">c.length</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">&lt;</span><span class="NAME">e</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NAME">d</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">Object.defineProperty</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">Object.getOwnPropertyDescriptor</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">f</span><span class="WHIT"> </span><span class="KEYW">in</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">.</span><span class="NAME">hasOwnProperty</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="NAME">c.call</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NAME">f</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NAME">f</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>  3</span> </span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="STRN">"ms"</span><span class="PUNC">,</span><span class="STRN">"moz"</span><span class="PUNC">,</span><span class="STRN">"webkit"</span><span class="PUNC">,</span><span class="STRN">"o"</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">&lt;</span><span class="NAME">b.length</span><span class="PUNC">&&</span><span class="PUNC">!</span><span class="NAME">self.requestAnimationFrame</span><span class="PUNC">;</span><span class="PUNC">++</span><span class="NAME">c</span><span class="PUNC">)</span><span class="NAME">self.requestAnimationFrame</span><span class="PUNC">=</span><span class="NAME">self</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">]</span><span class="PUNC">+</span><span class="STRN">"RequestAnimationFrame"</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">self.cancelAnimationFrame</span><span class="PUNC">=</span><span class="NAME">self</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">]</span><span class="PUNC">+</span><span class="STRN">"CancelAnimationFrame"</span><span class="PUNC">]</span><span class="PUNC">||</span><span class="NAME">self</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">]</span><span class="PUNC">+</span><span class="STRN">"CancelRequestAnimationFrame"</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">===</span><span class="NAME">self.requestAnimationFrame</span><span class="PUNC">&&</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">self.setTimeout</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">self.requestAnimationFrame</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">Date.now</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">Math.max</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">16</span><span class="PUNC">-</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">-</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">self.setTimeout</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">b</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">+</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">+</span><span class="NAME">f</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">h</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">===</span><span class="NAME">self.cancelAnimationFrame</span><span class="PUNC">&&</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="WHIT">
<span class='line'>  4</span> </span><span class="NAME">self.clearTimeout</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">self.cancelAnimationFrame</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">self.clearTimeout</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">THREE.CullFaceNone</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">THREE.CullFaceBack</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">THREE.CullFaceFront</span><span class="PUNC">=</span><span class="NUMB">2</span><span class="PUNC">;</span><span class="NAME">THREE.CullFaceFrontBack</span><span class="PUNC">=</span><span class="NUMB">3</span><span class="PUNC">;</span><span class="NAME">THREE.FrontFaceDirectionCW</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">THREE.FrontFaceDirectionCCW</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">THREE.BasicShadowMap</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">THREE.PCFShadowMap</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">THREE.PCFSoftShadowMap</span><span class="PUNC">=</span><span class="NUMB">2</span><span class="PUNC">;</span><span class="NAME">THREE.FrontSide</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">THREE.BackSide</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">THREE.DoubleSide</span><span class="PUNC">=</span><span class="NUMB">2</span><span class="PUNC">;</span><span class="NAME">THREE.NoShading</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">THREE.FlatShading</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">THREE.SmoothShading</span><span class="PUNC">=</span><span class="NUMB">2</span><span class="PUNC">;</span><span class="NAME">THREE.NoColors</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">THREE.FaceColors</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">THREE.VertexColors</span><span class="PUNC">=</span><span class="NUMB">2</span><span class="PUNC">;</span><span class="NAME">THREE.NoBlending</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>  5</span> </span><span class="NAME">THREE.NormalBlending</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">THREE.AdditiveBlending</span><span class="PUNC">=</span><span class="NUMB">2</span><span class="PUNC">;</span><span class="NAME">THREE.SubtractiveBlending</span><span class="PUNC">=</span><span class="NUMB">3</span><span class="PUNC">;</span><span class="NAME">THREE.MultiplyBlending</span><span class="PUNC">=</span><span class="NUMB">4</span><span class="PUNC">;</span><span class="NAME">THREE.CustomBlending</span><span class="PUNC">=</span><span class="NUMB">5</span><span class="PUNC">;</span><span class="NAME">THREE.AddEquation</span><span class="PUNC">=</span><span class="NUMB">100</span><span class="PUNC">;</span><span class="NAME">THREE.SubtractEquation</span><span class="PUNC">=</span><span class="NUMB">101</span><span class="PUNC">;</span><span class="NAME">THREE.ReverseSubtractEquation</span><span class="PUNC">=</span><span class="NUMB">102</span><span class="PUNC">;</span><span class="NAME">THREE.ZeroFactor</span><span class="PUNC">=</span><span class="NUMB">200</span><span class="PUNC">;</span><span class="NAME">THREE.OneFactor</span><span class="PUNC">=</span><span class="NUMB">201</span><span class="PUNC">;</span><span class="NAME">THREE.SrcColorFactor</span><span class="PUNC">=</span><span class="NUMB">202</span><span class="PUNC">;</span><span class="NAME">THREE.OneMinusSrcColorFactor</span><span class="PUNC">=</span><span class="NUMB">203</span><span class="PUNC">;</span><span class="NAME">THREE.SrcAlphaFactor</span><span class="PUNC">=</span><span class="NUMB">204</span><span class="PUNC">;</span><span class="NAME">THREE.OneMinusSrcAlphaFactor</span><span class="PUNC">=</span><span class="NUMB">205</span><span class="PUNC">;</span><span class="NAME">THREE.DstAlphaFactor</span><span class="PUNC">=</span><span class="NUMB">206</span><span class="PUNC">;</span><span class="NAME">THREE.OneMinusDstAlphaFactor</span><span class="PUNC">=</span><span class="NUMB">207</span><span class="PUNC">;</span><span class="NAME">THREE.DstColorFactor</span><span class="PUNC">=</span><span class="NUMB">208</span><span class="PUNC">;</span><span class="NAME">THREE.OneMinusDstColorFactor</span><span class="PUNC">=</span><span class="NUMB">209</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>  6</span> </span><span class="NAME">THREE.SrcAlphaSaturateFactor</span><span class="PUNC">=</span><span class="NUMB">210</span><span class="PUNC">;</span><span class="NAME">THREE.MultiplyOperation</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">THREE.MixOperation</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">THREE.AddOperation</span><span class="PUNC">=</span><span class="NUMB">2</span><span class="PUNC">;</span><span class="NAME">THREE.UVMapping</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.CubeReflectionMapping</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.CubeRefractionMapping</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.SphericalReflectionMapping</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.SphericalRefractionMapping</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.RepeatWrapping</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="NAME">E3</span><span class="PUNC">;</span><span class="NAME">THREE.ClampToEdgeWrapping</span><span class="PUNC">=</span><span class="NUMB">1001</span><span class="PUNC">;</span><span class="NAME">THREE.MirroredRepeatWrapping</span><span class="PUNC">=</span><span class="NUMB">1002</span><span class="PUNC">;</span><span class="NAME">THREE.NearestFilter</span><span class="PUNC">=</span><span class="NUMB">1003</span><span class="PUNC">;</span><span class="NAME">THREE.NearestMipMapNearestFilter</span><span class="PUNC">=</span><span class="NUMB">1004</span><span class="PUNC">;</span><span class="NAME">THREE.NearestMipMapLinearFilter</span><span class="PUNC">=</span><span class="NUMB">1005</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>  7</span> </span><span class="NAME">THREE.LinearFilter</span><span class="PUNC">=</span><span class="NUMB">1006</span><span class="PUNC">;</span><span class="NAME">THREE.LinearMipMapNearestFilter</span><span class="PUNC">=</span><span class="NUMB">1007</span><span class="PUNC">;</span><span class="NAME">THREE.LinearMipMapLinearFilter</span><span class="PUNC">=</span><span class="NUMB">1008</span><span class="PUNC">;</span><span class="NAME">THREE.UnsignedByteType</span><span class="PUNC">=</span><span class="NUMB">1009</span><span class="PUNC">;</span><span class="NAME">THREE.ByteType</span><span class="PUNC">=</span><span class="NUMB">1010</span><span class="PUNC">;</span><span class="NAME">THREE.ShortType</span><span class="PUNC">=</span><span class="NUMB">1011</span><span class="PUNC">;</span><span class="NAME">THREE.UnsignedShortType</span><span class="PUNC">=</span><span class="NUMB">1012</span><span class="PUNC">;</span><span class="NAME">THREE.IntType</span><span class="PUNC">=</span><span class="NUMB">1013</span><span class="PUNC">;</span><span class="NAME">THREE.UnsignedIntType</span><span class="PUNC">=</span><span class="NUMB">1014</span><span class="PUNC">;</span><span class="NAME">THREE.FloatType</span><span class="PUNC">=</span><span class="NUMB">1015</span><span class="PUNC">;</span><span class="NAME">THREE.UnsignedShort4444Type</span><span class="PUNC">=</span><span class="NUMB">1016</span><span class="PUNC">;</span><span class="NAME">THREE.UnsignedShort5551Type</span><span class="PUNC">=</span><span class="NUMB">1017</span><span class="PUNC">;</span><span class="NAME">THREE.UnsignedShort565Type</span><span class="PUNC">=</span><span class="NUMB">1018</span><span class="PUNC">;</span><span class="NAME">THREE.AlphaFormat</span><span class="PUNC">=</span><span class="NUMB">1019</span><span class="PUNC">;</span><span class="NAME">THREE.RGBFormat</span><span class="PUNC">=</span><span class="NUMB">1020</span><span class="PUNC">;</span><span class="NAME">THREE.RGBAFormat</span><span class="PUNC">=</span><span class="NUMB">1021</span><span class="PUNC">;</span><span class="NAME">THREE.LuminanceFormat</span><span class="PUNC">=</span><span class="NUMB">1022</span><span class="PUNC">;</span><span class="NAME">THREE.LuminanceAlphaFormat</span><span class="PUNC">=</span><span class="NUMB">1023</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>  8</span> </span><span class="NAME">THREE.RGB_S3TC_DXT1_Format</span><span class="PUNC">=</span><span class="NUMB">2001</span><span class="PUNC">;</span><span class="NAME">THREE.RGBA_S3TC_DXT1_Format</span><span class="PUNC">=</span><span class="NUMB">2002</span><span class="PUNC">;</span><span class="NAME">THREE.RGBA_S3TC_DXT3_Format</span><span class="PUNC">=</span><span class="NUMB">2003</span><span class="PUNC">;</span><span class="NAME">THREE.RGBA_S3TC_DXT5_Format</span><span class="PUNC">=</span><span class="NUMB">2004</span><span class="PUNC">;</span><span class="NAME">THREE.Color</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">a</span><span class="PUNC">&&</span><span class="NAME">this.set</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>  9</span> </span><span class="NAME">THREE.Color.prototype</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="NAME">constructor</span><span class="PUNC">:</span><span class="NAME">THREE.Color</span><span class="PUNC">,</span><span class="NAME">r</span><span class="PUNC">:</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">:</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">:</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">set</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">a</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">THREE.Color</span><span class="PUNC">?</span><span class="NAME">this.copy</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="STRN">"number"</span><span class="PUNC">===</span><span class="KEYW">typeof</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">?</span><span class="NAME">this.setHex</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="STRN">"string"</span><span class="PUNC">===</span><span class="KEYW">typeof</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">&&</span><span class="NAME">this.setStyle</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">setHex</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">Math.floor</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.r</span><span class="PUNC">=</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">>></span><span class="NUMB">16</span><span class="PUNC">&</span><span class="NUMB">255</span><span class="PUNC">)</span><span class="PUNC">/</span><span class="NUMB">255</span><span class="PUNC">;</span><span class="NAME">this.g</span><span class="PUNC">=</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">>></span><span class="NUMB">8</span><span class="PUNC">&</span><span class="NUMB">255</span><span class="PUNC">)</span><span class="PUNC">/</span><span class="NUMB">255</span><span class="PUNC">;</span><span class="NAME">this.b</span><span class="PUNC">=</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">&</span><span class="NUMB">255</span><span class="PUNC">)</span><span class="PUNC">/</span><span class="NUMB">255</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">setRGB</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.r</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">this.g</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">;</span><span class="NAME">this.b</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">setHSL</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">===</span><span class="NAME">b</span><span class="PUNC">)</span><span class="NAME">this.r</span><span class="PUNC">=</span><span class="NAME">this.g</span><span class="PUNC">=</span><span class="NAME">this.b</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">;</span><span class="KEYW">else</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NUMB">0</span><span class="PUNC">></span><span class="NAME">c</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NUMB">1</span><span class="PUNC">&lt;</span><span class="NAME">c</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">-</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">&lt;</span><span class="NUMB">1</span><span class="PUNC">/</span><span class="NUMB">6</span><span class="PUNC">?</span><span class="NAME">a</span><span class="PUNC">+</span><span class="NUMB">6</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">-</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="WHIT">
<span class='line'> 10</span> </span><span class="NAME">c</span><span class="PUNC">:</span><span class="NUMB">0.5</span><span class="PUNC">></span><span class="NAME">c</span><span class="PUNC">?</span><span class="NAME">b</span><span class="PUNC">:</span><span class="NAME">c</span><span class="PUNC">&lt;</span><span class="NUMB">2</span><span class="PUNC">/</span><span class="NUMB">3</span><span class="PUNC">?</span><span class="NAME">a</span><span class="PUNC">+</span><span class="NUMB">6</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">-</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NUMB">2</span><span class="PUNC">/</span><span class="NUMB">3</span><span class="PUNC">-</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">a</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NUMB">0.5</span><span class="PUNC">>=</span><span class="NAME">c</span><span class="PUNC">?</span><span class="NAME">c</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NUMB">1</span><span class="PUNC">+</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">c</span><span class="PUNC">+</span><span class="NAME">b</span><span class="PUNC">-</span><span class="NAME">c</span><span class="PUNC">*</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NUMB">2</span><span class="PUNC">*</span><span class="NAME">c</span><span class="PUNC">-</span><span class="NAME">b</span><span class="PUNC">;</span><span class="NAME">this.r</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">/</span><span class="NUMB">3</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.g</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.b</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">/</span><span class="NUMB">3</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">setStyle</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="REGX">/^rgb\((\d+),(\d+),(\d+)\)$/i</span><span class="PUNC">.</span><span class="NAME">test</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="REGX">/^rgb\((\d+),(\d+),(\d+)\)$/i</span><span class="PUNC">.</span><span class="NAME">exec</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this.r</span><span class="PUNC">=</span><span class="NAME">Math.min</span><span class="PUNC">(</span><span class="NUMB">255</span><span class="PUNC">,</span><span class="NAME">parseInt</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NUMB">10</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">/</span><span class="NUMB">255</span><span class="PUNC">,</span><span class="NAME">this.g</span><span class="PUNC">=</span><span class="NAME">Math.min</span><span class="PUNC">(</span><span class="NUMB">255</span><span class="PUNC">,</span><span class="NAME">parseInt</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NUMB">10</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">/</span><span class="NUMB">255</span><span class="PUNC">,</span><span class="NAME">this.b</span><span class="PUNC">=</span><span class="NAME">Math.min</span><span class="PUNC">(</span><span class="NUMB">255</span><span class="PUNC">,</span><span class="NAME">parseInt</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">3</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NUMB">10</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">/</span><span class="NUMB">255</span><span class="PUNC">,</span><span class="KEYW">this</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="REGX">/^rgb\((\d+)\%,(\d+)\%,(\d+)\%\)$/i</span><span class="PUNC">.</span><span class="NAME">test</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="REGX">/^rgb\((\d+)\%,(\d+)\%,(\d+)\%\)$/i</span><span class="PUNC">.</span><span class="NAME">exec</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this.r</span><span class="PUNC">=</span><span class="NAME">Math.min</span><span class="PUNC">(</span><span class="NUMB">100</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'> 11</span> </span><span class="NAME">parseInt</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NUMB">10</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">/</span><span class="NUMB">100</span><span class="PUNC">,</span><span class="NAME">this.g</span><span class="PUNC">=</span><span class="NAME">Math.min</span><span class="PUNC">(</span><span class="NUMB">100</span><span class="PUNC">,</span><span class="NAME">parseInt</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NUMB">10</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">/</span><span class="NUMB">100</span><span class="PUNC">,</span><span class="NAME">this.b</span><span class="PUNC">=</span><span class="NAME">Math.min</span><span class="PUNC">(</span><span class="NUMB">100</span><span class="PUNC">,</span><span class="NAME">parseInt</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">3</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NUMB">10</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">/</span><span class="NUMB">100</span><span class="PUNC">,</span><span class="KEYW">this</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="REGX">/^\#([0-9a-f]{6})$/i</span><span class="PUNC">.</span><span class="NAME">test</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="REGX">/^\#([0-9a-f]{6})$/i</span><span class="PUNC">.</span><span class="NAME">exec</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this.setHex</span><span class="PUNC">(</span><span class="NAME">parseInt</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NUMB">16</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="KEYW">this</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="REGX">/^\#([0-9a-f])([0-9a-f])([0-9a-f])$/i</span><span class="PUNC">.</span><span class="NAME">test</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="REGX">/^\#([0-9a-f])([0-9a-f])([0-9a-f])$/i</span><span class="PUNC">.</span><span class="NAME">exec</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this.setHex</span><span class="PUNC">(</span><span class="NAME">parseInt</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">+</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">+</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">+</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">+</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">3</span><span class="PUNC">]</span><span class="PUNC">+</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">3</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NUMB">16</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="KEYW">this</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="REGX">/^(\w+)$/i</span><span class="PUNC">.</span><span class="NAME">test</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.setHex</span><span class="PUNC">(</span><span class="NAME">THREE.ColorKeywords</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="KEYW">this</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">copy</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.r</span><span class="PUNC">=</span><span class="NAME">a.r</span><span class="PUNC">;</span><span class="NAME">this.g</span><span class="PUNC">=</span><span class="NAME">a.g</span><span class="PUNC">;</span><span class="NAME">this.b</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'> 12</span> </span><span class="NAME">a.b</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">copyGammaToLinear</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.r</span><span class="PUNC">=</span><span class="NAME">a.r</span><span class="PUNC">*</span><span class="NAME">a.r</span><span class="PUNC">;</span><span class="NAME">this.g</span><span class="PUNC">=</span><span class="NAME">a.g</span><span class="PUNC">*</span><span class="NAME">a.g</span><span class="PUNC">;</span><span class="NAME">this.b</span><span class="PUNC">=</span><span class="NAME">a.b</span><span class="PUNC">*</span><span class="NAME">a.b</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">copyLinearToGamma</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.r</span><span class="PUNC">=</span><span class="NAME">Math.sqrt</span><span class="PUNC">(</span><span class="NAME">a.r</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.g</span><span class="PUNC">=</span><span class="NAME">Math.sqrt</span><span class="PUNC">(</span><span class="NAME">a.g</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.b</span><span class="PUNC">=</span><span class="NAME">Math.sqrt</span><span class="PUNC">(</span><span class="NAME">a.b</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">convertGammaToLinear</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">this.r</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.g</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.b</span><span class="PUNC">;</span><span class="NAME">this.r</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">*</span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">this.g</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">*</span><span class="NAME">b</span><span class="PUNC">;</span><span class="NAME">this.b</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">*</span><span class="NAME">c</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">convertLinearToGamma</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.r</span><span class="PUNC">=</span><span class="NAME">Math.sqrt</span><span class="PUNC">(</span><span class="NAME">this.r</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.g</span><span class="PUNC">=</span><span class="NAME">Math.sqrt</span><span class="PUNC">(</span><span class="NAME">this.g</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.b</span><span class="PUNC">=</span><span class="NAME">Math.sqrt</span><span class="PUNC">(</span><span class="NAME">this.b</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">getHex</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NUMB">255</span><span class="PUNC">*</span><span class="NAME">this.r</span><span class="PUNC">&lt;&lt;</span><span class="NUMB">16</span><span class="PUNC">^</span><span class="NUMB">255</span><span class="PUNC">*</span><span class="NAME">this.g</span><span class="PUNC">&lt;&lt;</span><span class="NUMB">8</span><span class="PUNC">^</span><span class="NUMB">255</span><span class="PUNC">*</span><span class="WHIT">
<span class='line'> 13</span> </span><span class="NAME">this.b</span><span class="PUNC">&lt;&lt;</span><span class="NUMB">0</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">getHexString</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="PUNC">(</span><span class="STRN">"000000"</span><span class="PUNC">+</span><span class="NAME">this.getHex</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">toString</span><span class="PUNC">(</span><span class="NUMB">16</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">slice</span><span class="PUNC">(</span><span class="PUNC">-</span><span class="NUMB">6</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">getHSL</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="NAME">h</span><span class="PUNC">:</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">s</span><span class="PUNC">:</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">l</span><span class="PUNC">:</span><span class="NUMB">0</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.r</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.g</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">this.b</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">Math.max</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">Math.min</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">=</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">+</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">/</span><span class="NUMB">2</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">===</span><span class="NAME">e</span><span class="PUNC">)</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">else</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">=</span><span class="NAME">e</span><span class="PUNC">-</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NUMB">0.5</span><span class="PUNC">>=</span><span class="NAME">g</span><span class="PUNC">?</span><span class="NAME">i</span><span class="PUNC">/</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">+</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">i</span><span class="PUNC">/</span><span class="PUNC">(</span><span class="NUMB">2</span><span class="PUNC">-</span><span class="NAME">e</span><span class="PUNC">-</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">switch</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">:</span><span class="NAME">h</span><span class="PUNC">=</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">-</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">/</span><span class="NAME">i</span><span class="PUNC">+</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">&lt;</span><span class="NAME">d</span><span class="PUNC">?</span><span class="NUMB">6</span><span class="PUNC">:</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">break</span><span class="PUNC">;</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">:</span><span class="NAME">h</span><span class="PUNC">=</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">-</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">/</span><span class="NAME">i</span><span class="PUNC">+</span><span class="NUMB">2</span><span class="PUNC">;</span><span class="KEYW">break</span><span class="PUNC">;</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">:</span><span class="NAME">h</span><span class="PUNC">=</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">-</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">/</span><span class="NAME">i</span><span class="PUNC">+</span><span class="NUMB">4</span><span class="PUNC">}</span><span class="NAME">h</span><span class="PUNC">/</span><span class="PUNC">=</span><span class="NUMB">6</span><span class="PUNC">}</span><span class="NAME">a.h</span><span class="PUNC">=</span><span class="NAME">h</span><span class="PUNC">;</span><span class="NAME">a.s</span><span class="PUNC">=</span><span class="NAME">f</span><span class="PUNC">;</span><span class="NAME">a.l</span><span class="PUNC">=</span><span class="NAME">g</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">getStyle</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="STRN">"rgb("</span><span class="PUNC">+</span><span class="PUNC">(</span><span class="NUMB">255</span><span class="PUNC">*</span><span class="NAME">this.r</span><span class="PUNC">|</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="STRN">","</span><span class="PUNC">+</span><span class="PUNC">(</span><span class="NUMB">255</span><span class="PUNC">*</span><span class="NAME">this.g</span><span class="PUNC">|</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="STRN">","</span><span class="PUNC">+</span><span class="PUNC">(</span><span class="NUMB">255</span><span class="PUNC">*</span><span class="NAME">this.b</span><span class="PUNC">|</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="STRN">")"</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">offsetHSL</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'> 14</span> </span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">this.getHSL</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">d.h</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">d.s</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">;</span><span class="NAME">d.l</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">;</span><span class="NAME">this.setHSL</span><span class="PUNC">(</span><span class="NAME">d.h</span><span class="PUNC">,</span><span class="NAME">d.s</span><span class="PUNC">,</span><span class="NAME">d.l</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">add</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.r</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">a.r</span><span class="PUNC">;</span><span class="NAME">this.g</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">a.g</span><span class="PUNC">;</span><span class="NAME">this.b</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">a.b</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">addColors</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.r</span><span class="PUNC">=</span><span class="NAME">a.r</span><span class="PUNC">+</span><span class="NAME">b.r</span><span class="PUNC">;</span><span class="NAME">this.g</span><span class="PUNC">=</span><span class="NAME">a.g</span><span class="PUNC">+</span><span class="NAME">b.g</span><span class="PUNC">;</span><span class="NAME">this.b</span><span class="PUNC">=</span><span class="NAME">a.b</span><span class="PUNC">+</span><span class="NAME">b.b</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">addScalar</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.r</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">this.g</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">this.b</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">multiply</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.r</span><span class="PUNC">*</span><span class="PUNC">=</span><span class="NAME">a.r</span><span class="PUNC">;</span><span class="NAME">this.g</span><span class="PUNC">*</span><span class="PUNC">=</span><span class="NAME">a.g</span><span class="PUNC">;</span><span class="NAME">this.b</span><span class="PUNC">*</span><span class="PUNC">=</span><span class="NAME">a.b</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">multiplyScalar</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.r</span><span class="PUNC">*</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">this.g</span><span class="PUNC">*</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">this.b</span><span class="PUNC">*</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">lerp</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.r</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="PUNC">(</span><span class="NAME">a.r</span><span class="PUNC">-</span><span class="NAME">this.r</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">b</span><span class="PUNC">;</span><span class="NAME">this.g</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="PUNC">(</span><span class="NAME">a.g</span><span class="PUNC">-</span><span class="NAME">this.g</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">b</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 15</span> </span><span class="NAME">this.b</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="PUNC">(</span><span class="NAME">a.b</span><span class="PUNC">-</span><span class="NAME">this.b</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">b</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">equals</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a.r</span><span class="PUNC">===</span><span class="NAME">this.r</span><span class="PUNC">&&</span><span class="NAME">a.g</span><span class="PUNC">===</span><span class="NAME">this.g</span><span class="PUNC">&&</span><span class="NAME">a.b</span><span class="PUNC">===</span><span class="NAME">this.b</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">clone</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="PUNC">(</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Color</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">setRGB</span><span class="PUNC">(</span><span class="NAME">this.r</span><span class="PUNC">,</span><span class="NAME">this.g</span><span class="PUNC">,</span><span class="NAME">this.b</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 16</span> </span><span class="NAME">THREE.ColorKeywords</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="NAME">aliceblue</span><span class="PUNC">:</span><span class="NUMB">15792383</span><span class="PUNC">,</span><span class="NAME">antiquewhite</span><span class="PUNC">:</span><span class="NUMB">16444375</span><span class="PUNC">,</span><span class="NAME">aqua</span><span class="PUNC">:</span><span class="NUMB">65535</span><span class="PUNC">,</span><span class="NAME">aquamarine</span><span class="PUNC">:</span><span class="NUMB">8388564</span><span class="PUNC">,</span><span class="NAME">azure</span><span class="PUNC">:</span><span class="NUMB">15794175</span><span class="PUNC">,</span><span class="NAME">beige</span><span class="PUNC">:</span><span class="NUMB">16119260</span><span class="PUNC">,</span><span class="NAME">bisque</span><span class="PUNC">:</span><span class="NUMB">16770244</span><span class="PUNC">,</span><span class="NAME">black</span><span class="PUNC">:</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">blanchedalmond</span><span class="PUNC">:</span><span class="NUMB">16772045</span><span class="PUNC">,</span><span class="NAME">blue</span><span class="PUNC">:</span><span class="NUMB">255</span><span class="PUNC">,</span><span class="NAME">blueviolet</span><span class="PUNC">:</span><span class="NUMB">9055202</span><span class="PUNC">,</span><span class="NAME">brown</span><span class="PUNC">:</span><span class="NUMB">10824234</span><span class="PUNC">,</span><span class="NAME">burlywood</span><span class="PUNC">:</span><span class="NUMB">14596231</span><span class="PUNC">,</span><span class="NAME">cadetblue</span><span class="PUNC">:</span><span class="NUMB">6266528</span><span class="PUNC">,</span><span class="NAME">chartreuse</span><span class="PUNC">:</span><span class="NUMB">8388352</span><span class="PUNC">,</span><span class="NAME">chocolate</span><span class="PUNC">:</span><span class="NUMB">13789470</span><span class="PUNC">,</span><span class="NAME">coral</span><span class="PUNC">:</span><span class="NUMB">16744272</span><span class="PUNC">,</span><span class="NAME">cornflowerblue</span><span class="PUNC">:</span><span class="NUMB">6591981</span><span class="PUNC">,</span><span class="NAME">cornsilk</span><span class="PUNC">:</span><span class="NUMB">16775388</span><span class="PUNC">,</span><span class="NAME">crimson</span><span class="PUNC">:</span><span class="NUMB">14423100</span><span class="PUNC">,</span><span class="NAME">cyan</span><span class="PUNC">:</span><span class="NUMB">65535</span><span class="PUNC">,</span><span class="NAME">darkblue</span><span class="PUNC">:</span><span class="NUMB">139</span><span class="PUNC">,</span><span class="NAME">darkcyan</span><span class="PUNC">:</span><span class="NUMB">35723</span><span class="PUNC">,</span><span class="NAME">darkgoldenrod</span><span class="PUNC">:</span><span class="NUMB">12092939</span><span class="PUNC">,</span><span class="NAME">darkgray</span><span class="PUNC">:</span><span class="NUMB">11119017</span><span class="PUNC">,</span><span class="NAME">darkgreen</span><span class="PUNC">:</span><span class="NUMB">25600</span><span class="PUNC">,</span><span class="NAME">darkgrey</span><span class="PUNC">:</span><span class="NUMB">11119017</span><span class="PUNC">,</span><span class="NAME">darkkhaki</span><span class="PUNC">:</span><span class="NUMB">12433259</span><span class="PUNC">,</span><span class="NAME">darkmagenta</span><span class="PUNC">:</span><span class="NUMB">9109643</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'> 17</span> </span><span class="NAME">darkolivegreen</span><span class="PUNC">:</span><span class="NUMB">5597999</span><span class="PUNC">,</span><span class="NAME">darkorange</span><span class="PUNC">:</span><span class="NUMB">16747520</span><span class="PUNC">,</span><span class="NAME">darkorchid</span><span class="PUNC">:</span><span class="NUMB">10040012</span><span class="PUNC">,</span><span class="NAME">darkred</span><span class="PUNC">:</span><span class="NUMB">9109504</span><span class="PUNC">,</span><span class="NAME">darksalmon</span><span class="PUNC">:</span><span class="NUMB">15308410</span><span class="PUNC">,</span><span class="NAME">darkseagreen</span><span class="PUNC">:</span><span class="NUMB">9419919</span><span class="PUNC">,</span><span class="NAME">darkslateblue</span><span class="PUNC">:</span><span class="NUMB">4734347</span><span class="PUNC">,</span><span class="NAME">darkslategray</span><span class="PUNC">:</span><span class="NUMB">3100495</span><span class="PUNC">,</span><span class="NAME">darkslategrey</span><span class="PUNC">:</span><span class="NUMB">3100495</span><span class="PUNC">,</span><span class="NAME">darkturquoise</span><span class="PUNC">:</span><span class="NUMB">52945</span><span class="PUNC">,</span><span class="NAME">darkviolet</span><span class="PUNC">:</span><span class="NUMB">9699539</span><span class="PUNC">,</span><span class="NAME">deeppink</span><span class="PUNC">:</span><span class="NUMB">16716947</span><span class="PUNC">,</span><span class="NAME">deepskyblue</span><span class="PUNC">:</span><span class="NUMB">49151</span><span class="PUNC">,</span><span class="NAME">dimgray</span><span class="PUNC">:</span><span class="NUMB">6908265</span><span class="PUNC">,</span><span class="NAME">dimgrey</span><span class="PUNC">:</span><span class="NUMB">6908265</span><span class="PUNC">,</span><span class="NAME">dodgerblue</span><span class="PUNC">:</span><span class="NUMB">2003199</span><span class="PUNC">,</span><span class="NAME">firebrick</span><span class="PUNC">:</span><span class="NUMB">11674146</span><span class="PUNC">,</span><span class="NAME">floralwhite</span><span class="PUNC">:</span><span class="NUMB">16775920</span><span class="PUNC">,</span><span class="NAME">forestgreen</span><span class="PUNC">:</span><span class="NUMB">2263842</span><span class="PUNC">,</span><span class="NAME">fuchsia</span><span class="PUNC">:</span><span class="NUMB">16711935</span><span class="PUNC">,</span><span class="NAME">gainsboro</span><span class="PUNC">:</span><span class="NUMB">14474460</span><span class="PUNC">,</span><span class="NAME">ghostwhite</span><span class="PUNC">:</span><span class="NUMB">16316671</span><span class="PUNC">,</span><span class="NAME">gold</span><span class="PUNC">:</span><span class="NUMB">16766720</span><span class="PUNC">,</span><span class="NAME">goldenrod</span><span class="PUNC">:</span><span class="NUMB">14329120</span><span class="PUNC">,</span><span class="NAME">gray</span><span class="PUNC">:</span><span class="NUMB">8421504</span><span class="PUNC">,</span><span class="NAME">green</span><span class="PUNC">:</span><span class="NUMB">32768</span><span class="PUNC">,</span><span class="NAME">greenyellow</span><span class="PUNC">:</span><span class="NUMB">11403055</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'> 18</span> </span><span class="NAME">grey</span><span class="PUNC">:</span><span class="NUMB">8421504</span><span class="PUNC">,</span><span class="NAME">honeydew</span><span class="PUNC">:</span><span class="NUMB">15794160</span><span class="PUNC">,</span><span class="NAME">hotpink</span><span class="PUNC">:</span><span class="NUMB">16738740</span><span class="PUNC">,</span><span class="NAME">indianred</span><span class="PUNC">:</span><span class="NUMB">13458524</span><span class="PUNC">,</span><span class="NAME">indigo</span><span class="PUNC">:</span><span class="NUMB">4915330</span><span class="PUNC">,</span><span class="NAME">ivory</span><span class="PUNC">:</span><span class="NUMB">16777200</span><span class="PUNC">,</span><span class="NAME">khaki</span><span class="PUNC">:</span><span class="NUMB">15787660</span><span class="PUNC">,</span><span class="NAME">lavender</span><span class="PUNC">:</span><span class="NUMB">15132410</span><span class="PUNC">,</span><span class="NAME">lavenderblush</span><span class="PUNC">:</span><span class="NUMB">16773365</span><span class="PUNC">,</span><span class="NAME">lawngreen</span><span class="PUNC">:</span><span class="NUMB">8190976</span><span class="PUNC">,</span><span class="NAME">lemonchiffon</span><span class="PUNC">:</span><span class="NUMB">16775885</span><span class="PUNC">,</span><span class="NAME">lightblue</span><span class="PUNC">:</span><span class="NUMB">11393254</span><span class="PUNC">,</span><span class="NAME">lightcoral</span><span class="PUNC">:</span><span class="NUMB">15761536</span><span class="PUNC">,</span><span class="NAME">lightcyan</span><span class="PUNC">:</span><span class="NUMB">14745599</span><span class="PUNC">,</span><span class="NAME">lightgoldenrodyellow</span><span class="PUNC">:</span><span class="NUMB">16448210</span><span class="PUNC">,</span><span class="NAME">lightgray</span><span class="PUNC">:</span><span class="NUMB">13882323</span><span class="PUNC">,</span><span class="NAME">lightgreen</span><span class="PUNC">:</span><span class="NUMB">9498256</span><span class="PUNC">,</span><span class="NAME">lightgrey</span><span class="PUNC">:</span><span class="NUMB">13882323</span><span class="PUNC">,</span><span class="NAME">lightpink</span><span class="PUNC">:</span><span class="NUMB">16758465</span><span class="PUNC">,</span><span class="NAME">lightsalmon</span><span class="PUNC">:</span><span class="NUMB">16752762</span><span class="PUNC">,</span><span class="NAME">lightseagreen</span><span class="PUNC">:</span><span class="NUMB">2142890</span><span class="PUNC">,</span><span class="NAME">lightskyblue</span><span class="PUNC">:</span><span class="NUMB">8900346</span><span class="PUNC">,</span><span class="NAME">lightslategray</span><span class="PUNC">:</span><span class="NUMB">7833753</span><span class="PUNC">,</span><span class="NAME">lightslategrey</span><span class="PUNC">:</span><span class="NUMB">7833753</span><span class="PUNC">,</span><span class="NAME">lightsteelblue</span><span class="PUNC">:</span><span class="NUMB">11584734</span><span class="PUNC">,</span><span class="NAME">lightyellow</span><span class="PUNC">:</span><span class="NUMB">16777184</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'> 19</span> </span><span class="NAME">lime</span><span class="PUNC">:</span><span class="NUMB">65280</span><span class="PUNC">,</span><span class="NAME">limegreen</span><span class="PUNC">:</span><span class="NUMB">3329330</span><span class="PUNC">,</span><span class="NAME">linen</span><span class="PUNC">:</span><span class="NUMB">16445670</span><span class="PUNC">,</span><span class="NAME">magenta</span><span class="PUNC">:</span><span class="NUMB">16711935</span><span class="PUNC">,</span><span class="NAME">maroon</span><span class="PUNC">:</span><span class="NUMB">8388608</span><span class="PUNC">,</span><span class="NAME">mediumaquamarine</span><span class="PUNC">:</span><span class="NUMB">6737322</span><span class="PUNC">,</span><span class="NAME">mediumblue</span><span class="PUNC">:</span><span class="NUMB">205</span><span class="PUNC">,</span><span class="NAME">mediumorchid</span><span class="PUNC">:</span><span class="NUMB">12211667</span><span class="PUNC">,</span><span class="NAME">mediumpurple</span><span class="PUNC">:</span><span class="NUMB">9662683</span><span class="PUNC">,</span><span class="NAME">mediumseagreen</span><span class="PUNC">:</span><span class="NUMB">3978097</span><span class="PUNC">,</span><span class="NAME">mediumslateblue</span><span class="PUNC">:</span><span class="NUMB">8087790</span><span class="PUNC">,</span><span class="NAME">mediumspringgreen</span><span class="PUNC">:</span><span class="NUMB">64154</span><span class="PUNC">,</span><span class="NAME">mediumturquoise</span><span class="PUNC">:</span><span class="NUMB">4772300</span><span class="PUNC">,</span><span class="NAME">mediumvioletred</span><span class="PUNC">:</span><span class="NUMB">13047173</span><span class="PUNC">,</span><span class="NAME">midnightblue</span><span class="PUNC">:</span><span class="NUMB">1644912</span><span class="PUNC">,</span><span class="NAME">mintcream</span><span class="PUNC">:</span><span class="NUMB">16121850</span><span class="PUNC">,</span><span class="NAME">mistyrose</span><span class="PUNC">:</span><span class="NUMB">16770273</span><span class="PUNC">,</span><span class="NAME">moccasin</span><span class="PUNC">:</span><span class="NUMB">16770229</span><span class="PUNC">,</span><span class="NAME">navajowhite</span><span class="PUNC">:</span><span class="NUMB">16768685</span><span class="PUNC">,</span><span class="NAME">navy</span><span class="PUNC">:</span><span class="NUMB">128</span><span class="PUNC">,</span><span class="NAME">oldlace</span><span class="PUNC">:</span><span class="NUMB">16643558</span><span class="PUNC">,</span><span class="NAME">olive</span><span class="PUNC">:</span><span class="NUMB">8421376</span><span class="PUNC">,</span><span class="NAME">olivedrab</span><span class="PUNC">:</span><span class="NUMB">7048739</span><span class="PUNC">,</span><span class="NAME">orange</span><span class="PUNC">:</span><span class="NUMB">16753920</span><span class="PUNC">,</span><span class="NAME">orangered</span><span class="PUNC">:</span><span class="NUMB">16729344</span><span class="PUNC">,</span><span class="NAME">orchid</span><span class="PUNC">:</span><span class="NUMB">14315734</span><span class="PUNC">,</span><span class="NAME">palegoldenrod</span><span class="PUNC">:</span><span class="NUMB">15657130</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'> 20</span> </span><span class="NAME">palegreen</span><span class="PUNC">:</span><span class="NUMB">10025880</span><span class="PUNC">,</span><span class="NAME">paleturquoise</span><span class="PUNC">:</span><span class="NUMB">11529966</span><span class="PUNC">,</span><span class="NAME">palevioletred</span><span class="PUNC">:</span><span class="NUMB">14381203</span><span class="PUNC">,</span><span class="NAME">papayawhip</span><span class="PUNC">:</span><span class="NUMB">16773077</span><span class="PUNC">,</span><span class="NAME">peachpuff</span><span class="PUNC">:</span><span class="NUMB">16767673</span><span class="PUNC">,</span><span class="NAME">peru</span><span class="PUNC">:</span><span class="NUMB">13468991</span><span class="PUNC">,</span><span class="NAME">pink</span><span class="PUNC">:</span><span class="NUMB">16761035</span><span class="PUNC">,</span><span class="NAME">plum</span><span class="PUNC">:</span><span class="NUMB">14524637</span><span class="PUNC">,</span><span class="NAME">powderblue</span><span class="PUNC">:</span><span class="NUMB">11591910</span><span class="PUNC">,</span><span class="NAME">purple</span><span class="PUNC">:</span><span class="NUMB">8388736</span><span class="PUNC">,</span><span class="NAME">red</span><span class="PUNC">:</span><span class="NUMB">16711680</span><span class="PUNC">,</span><span class="NAME">rosybrown</span><span class="PUNC">:</span><span class="NUMB">12357519</span><span class="PUNC">,</span><span class="NAME">royalblue</span><span class="PUNC">:</span><span class="NUMB">4286945</span><span class="PUNC">,</span><span class="NAME">saddlebrown</span><span class="PUNC">:</span><span class="NUMB">9127187</span><span class="PUNC">,</span><span class="NAME">salmon</span><span class="PUNC">:</span><span class="NUMB">16416882</span><span class="PUNC">,</span><span class="NAME">sandybrown</span><span class="PUNC">:</span><span class="NUMB">16032864</span><span class="PUNC">,</span><span class="NAME">seagreen</span><span class="PUNC">:</span><span class="NUMB">3050327</span><span class="PUNC">,</span><span class="NAME">seashell</span><span class="PUNC">:</span><span class="NUMB">16774638</span><span class="PUNC">,</span><span class="NAME">sienna</span><span class="PUNC">:</span><span class="NUMB">10506797</span><span class="PUNC">,</span><span class="NAME">silver</span><span class="PUNC">:</span><span class="NUMB">12632256</span><span class="PUNC">,</span><span class="NAME">skyblue</span><span class="PUNC">:</span><span class="NUMB">8900331</span><span class="PUNC">,</span><span class="NAME">slateblue</span><span class="PUNC">:</span><span class="NUMB">6970061</span><span class="PUNC">,</span><span class="NAME">slategray</span><span class="PUNC">:</span><span class="NUMB">7372944</span><span class="PUNC">,</span><span class="NAME">slategrey</span><span class="PUNC">:</span><span class="NUMB">7372944</span><span class="PUNC">,</span><span class="NAME">snow</span><span class="PUNC">:</span><span class="NUMB">16775930</span><span class="PUNC">,</span><span class="NAME">springgreen</span><span class="PUNC">:</span><span class="NUMB">65407</span><span class="PUNC">,</span><span class="NAME">steelblue</span><span class="PUNC">:</span><span class="NUMB">4620980</span><span class="PUNC">,</span><span class="NAME">tan</span><span class="PUNC">:</span><span class="NUMB">13808780</span><span class="PUNC">,</span><span class="NAME">teal</span><span class="PUNC">:</span><span class="NUMB">32896</span><span class="PUNC">,</span><span class="NAME">thistle</span><span class="PUNC">:</span><span class="NUMB">14204888</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'> 21</span> </span><span class="NAME">tomato</span><span class="PUNC">:</span><span class="NUMB">16737095</span><span class="PUNC">,</span><span class="NAME">turquoise</span><span class="PUNC">:</span><span class="NUMB">4251856</span><span class="PUNC">,</span><span class="NAME">violet</span><span class="PUNC">:</span><span class="NUMB">15631086</span><span class="PUNC">,</span><span class="NAME">wheat</span><span class="PUNC">:</span><span class="NUMB">16113331</span><span class="PUNC">,</span><span class="NAME">white</span><span class="PUNC">:</span><span class="NUMB">16777215</span><span class="PUNC">,</span><span class="NAME">whitesmoke</span><span class="PUNC">:</span><span class="NUMB">16119285</span><span class="PUNC">,</span><span class="NAME">yellow</span><span class="PUNC">:</span><span class="NUMB">16776960</span><span class="PUNC">,</span><span class="NAME">yellowgreen</span><span class="PUNC">:</span><span class="NUMB">10145074</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.Quaternion</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this._x</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">||</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">this._y</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">||</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">this._z</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">||</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">this._w</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">d</span><span class="PUNC">?</span><span class="NAME">d</span><span class="PUNC">:</span><span class="NUMB">1</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 22</span> </span><span class="NAME">THREE.Quaternion.prototype</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="NAME">constructor</span><span class="PUNC">:</span><span class="NAME">THREE.Quaternion</span><span class="PUNC">,</span><span class="NAME">_x</span><span class="PUNC">:</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">_y</span><span class="PUNC">:</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">_z</span><span class="PUNC">:</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">_w</span><span class="PUNC">:</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">_euler</span><span class="PUNC">:</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">_updateEuler</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">this._euler</span><span class="PUNC">&&</span><span class="NAME">this._euler.setFromQuaternion</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">,</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">get</span><span class="WHIT"> </span><span class="NAME">x</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this._x</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">set</span><span class="WHIT"> </span><span class="NAME">x</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this._x</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">this._updateEuler</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">get</span><span class="WHIT"> </span><span class="NAME">y</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this._y</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">set</span><span class="WHIT"> </span><span class="NAME">y</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this._y</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">this._updateEuler</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">get</span><span class="WHIT"> </span><span class="NAME">z</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this._z</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">set</span><span class="WHIT"> </span><span class="NAME">z</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this._z</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">this._updateEuler</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">get</span><span class="WHIT"> </span><span class="NAME">w</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this._w</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">set</span><span class="WHIT"> </span><span class="NAME">w</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this._w</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">this._updateEuler</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">set</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this._x</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">this._y</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">;</span><span class="NAME">this._z</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">;</span><span class="NAME">this._w</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 23</span> </span><span class="NAME">this._updateEuler</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">copy</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this._x</span><span class="PUNC">=</span><span class="NAME">a._x</span><span class="PUNC">;</span><span class="NAME">this._y</span><span class="PUNC">=</span><span class="NAME">a._y</span><span class="PUNC">;</span><span class="NAME">this._z</span><span class="PUNC">=</span><span class="NAME">a._z</span><span class="PUNC">;</span><span class="NAME">this._w</span><span class="PUNC">=</span><span class="NAME">a._w</span><span class="PUNC">;</span><span class="NAME">this._updateEuler</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">setFromEuler</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">===</span><span class="KEYW">typeof</span><span class="WHIT"> </span><span class="NAME">a.order</span><span class="PUNC">&&</span><span class="NAME">console.error</span><span class="PUNC">(</span><span class="STRN">"ERROR: Quaternion's .setFromEuler() now expects a Euler rotation rather than a Vector3 and order.  Please update your code."</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">Math.cos</span><span class="PUNC">(</span><span class="NAME">a._x</span><span class="PUNC">/</span><span class="NUMB">2</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">Math.cos</span><span class="PUNC">(</span><span class="NAME">a._y</span><span class="PUNC">/</span><span class="NUMB">2</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">Math.cos</span><span class="PUNC">(</span><span class="NAME">a._z</span><span class="PUNC">/</span><span class="NUMB">2</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">Math.sin</span><span class="PUNC">(</span><span class="NAME">a._x</span><span class="PUNC">/</span><span class="NUMB">2</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">Math.sin</span><span class="PUNC">(</span><span class="NAME">a._y</span><span class="PUNC">/</span><span class="NUMB">2</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">Math.sin</span><span class="PUNC">(</span><span class="NAME">a._z</span><span class="PUNC">/</span><span class="NUMB">2</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">===</span><span class="NAME">a.order</span><span class="PUNC">||</span><span class="STRN">"XYZ"</span><span class="PUNC">===</span><span class="NAME">a.order</span><span class="PUNC">?</span><span class="PUNC">(</span><span class="NAME">this._x</span><span class="PUNC">=</span><span class="NAME">f</span><span class="PUNC">*</span><span class="NAME">d</span><span class="PUNC">*</span><span class="NAME">e</span><span class="PUNC">+</span><span class="NAME">c</span><span class="PUNC">*</span><span class="NAME">h</span><span class="PUNC">*</span><span class="NAME">g</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'> 24</span> </span><span class="NAME">this._y</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">*</span><span class="NAME">h</span><span class="PUNC">*</span><span class="NAME">e</span><span class="PUNC">-</span><span class="NAME">f</span><span class="PUNC">*</span><span class="NAME">d</span><span class="PUNC">*</span><span class="NAME">g</span><span class="PUNC">,</span><span class="NAME">this._z</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">*</span><span class="NAME">d</span><span class="PUNC">*</span><span class="NAME">g</span><span class="PUNC">+</span><span class="NAME">f</span><span class="PUNC">*</span><span class="NAME">h</span><span class="PUNC">*</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">this._w</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">*</span><span class="NAME">d</span><span class="PUNC">*</span><span class="NAME">e</span><span class="PUNC">-</span><span class="NAME">f</span><span class="PUNC">*</span><span class="NAME">h</span><span class="PUNC">*</span><span class="NAME">g</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="STRN">"YXZ"</span><span class="PUNC">===</span><span class="NAME">a.order</span><span class="PUNC">?</span><span class="PUNC">(</span><span class="NAME">this._x</span><span class="PUNC">=</span><span class="NAME">f</span><span class="PUNC">*</span><span class="NAME">d</span><span class="PUNC">*</span><span class="NAME">e</span><span class="PUNC">+</span><span class="NAME">c</span><span class="PUNC">*</span><span class="NAME">h</span><span class="PUNC">*</span><span class="NAME">g</span><span class="PUNC">,</span><span class="NAME">this._y</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">*</span><span class="NAME">h</span><span class="PUNC">*</span><span class="NAME">e</span><span class="PUNC">-</span><span class="NAME">f</span><span class="PUNC">*</span><span class="NAME">d</span><span class="PUNC">*</span><span class="NAME">g</span><span class="PUNC">,</span><span class="NAME">this._z</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">*</span><span class="NAME">d</span><span class="PUNC">*</span><span class="NAME">g</span><span class="PUNC">-</span><span class="NAME">f</span><span class="PUNC">*</span><span class="NAME">h</span><span class="PUNC">*</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">this._w</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">*</span><span class="NAME">d</span><span class="PUNC">*</span><span class="NAME">e</span><span class="PUNC">+</span><span class="NAME">f</span><span class="PUNC">*</span><span class="NAME">h</span><span class="PUNC">*</span><span class="NAME">g</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="STRN">"ZXY"</span><span class="PUNC">===</span><span class="NAME">a.order</span><span class="PUNC">?</span><span class="PUNC">(</span><span class="NAME">this._x</span><span class="PUNC">=</span><span class="NAME">f</span><span class="PUNC">*</span><span class="NAME">d</span><span class="PUNC">*</span><span class="NAME">e</span><span class="PUNC">-</span><span class="NAME">c</span><span class="PUNC">*</span><span class="NAME">h</span><span class="PUNC">*</span><span class="NAME">g</span><span class="PUNC">,</span><span class="NAME">this._y</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">*</span><span class="NAME">h</span><span class="PUNC">*</span><span class="NAME">e</span><span class="PUNC">+</span><span class="NAME">f</span><span class="PUNC">*</span><span class="NAME">d</span><span class="PUNC">*</span><span class="NAME">g</span><span class="PUNC">,</span><span class="NAME">this._z</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">*</span><span class="NAME">d</span><span class="PUNC">*</span><span class="NAME">g</span><span class="PUNC">+</span><span class="NAME">f</span><span class="PUNC">*</span><span class="NAME">h</span><span class="PUNC">*</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">this._w</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">*</span><span class="NAME">d</span><span class="PUNC">*</span><span class="NAME">e</span><span class="PUNC">-</span><span class="NAME">f</span><span class="PUNC">*</span><span class="NAME">h</span><span class="PUNC">*</span><span class="NAME">g</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="STRN">"ZYX"</span><span class="PUNC">===</span><span class="NAME">a.order</span><span class="PUNC">?</span><span class="PUNC">(</span><span class="NAME">this._x</span><span class="PUNC">=</span><span class="NAME">f</span><span class="PUNC">*</span><span class="NAME">d</span><span class="PUNC">*</span><span class="NAME">e</span><span class="PUNC">-</span><span class="NAME">c</span><span class="PUNC">*</span><span class="NAME">h</span><span class="PUNC">*</span><span class="NAME">g</span><span class="PUNC">,</span><span class="NAME">this._y</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">*</span><span class="NAME">h</span><span class="PUNC">*</span><span class="NAME">e</span><span class="PUNC">+</span><span class="NAME">f</span><span class="PUNC">*</span><span class="NAME">d</span><span class="PUNC">*</span><span class="NAME">g</span><span class="PUNC">,</span><span class="NAME">this._z</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">*</span><span class="NAME">d</span><span class="PUNC">*</span><span class="NAME">g</span><span class="PUNC">-</span><span class="NAME">f</span><span class="PUNC">*</span><span class="NAME">h</span><span class="PUNC">*</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">this._w</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">*</span><span class="NAME">d</span><span class="PUNC">*</span><span class="NAME">e</span><span class="PUNC">+</span><span class="NAME">f</span><span class="PUNC">*</span><span class="NAME">h</span><span class="PUNC">*</span><span class="NAME">g</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="STRN">"YZX"</span><span class="PUNC">===</span><span class="NAME">a.order</span><span class="PUNC">?</span><span class="PUNC">(</span><span class="NAME">this._x</span><span class="PUNC">=</span><span class="NAME">f</span><span class="PUNC">*</span><span class="NAME">d</span><span class="PUNC">*</span><span class="NAME">e</span><span class="PUNC">+</span><span class="NAME">c</span><span class="PUNC">*</span><span class="NAME">h</span><span class="PUNC">*</span><span class="NAME">g</span><span class="PUNC">,</span><span class="NAME">this._y</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">*</span><span class="NAME">h</span><span class="PUNC">*</span><span class="NAME">e</span><span class="PUNC">+</span><span class="NAME">f</span><span class="PUNC">*</span><span class="NAME">d</span><span class="PUNC">*</span><span class="NAME">g</span><span class="PUNC">,</span><span class="NAME">this._z</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">*</span><span class="NAME">d</span><span class="PUNC">*</span><span class="NAME">g</span><span class="PUNC">-</span><span class="NAME">f</span><span class="PUNC">*</span><span class="NAME">h</span><span class="PUNC">*</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">this._w</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">*</span><span class="NAME">d</span><span class="PUNC">*</span><span class="NAME">e</span><span class="PUNC">-</span><span class="NAME">f</span><span class="PUNC">*</span><span class="NAME">h</span><span class="PUNC">*</span><span class="NAME">g</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="STRN">"XZY"</span><span class="PUNC">===</span><span class="NAME">a.order</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">this._x</span><span class="PUNC">=</span><span class="NAME">f</span><span class="PUNC">*</span><span class="NAME">d</span><span class="PUNC">*</span><span class="NAME">e</span><span class="PUNC">-</span><span class="NAME">c</span><span class="PUNC">*</span><span class="NAME">h</span><span class="PUNC">*</span><span class="NAME">g</span><span class="PUNC">,</span><span class="NAME">this._y</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">*</span><span class="WHIT">
<span class='line'> 25</span> </span><span class="NAME">h</span><span class="PUNC">*</span><span class="NAME">e</span><span class="PUNC">-</span><span class="NAME">f</span><span class="PUNC">*</span><span class="NAME">d</span><span class="PUNC">*</span><span class="NAME">g</span><span class="PUNC">,</span><span class="NAME">this._z</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">*</span><span class="NAME">d</span><span class="PUNC">*</span><span class="NAME">g</span><span class="PUNC">+</span><span class="NAME">f</span><span class="PUNC">*</span><span class="NAME">h</span><span class="PUNC">*</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">this._w</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">*</span><span class="NAME">d</span><span class="PUNC">*</span><span class="NAME">e</span><span class="PUNC">+</span><span class="NAME">f</span><span class="PUNC">*</span><span class="NAME">h</span><span class="PUNC">*</span><span class="NAME">g</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">!==</span><span class="NAME">b</span><span class="PUNC">&&</span><span class="NAME">this._updateEuler</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">setFromAxisAngle</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">/</span><span class="NUMB">2</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">Math.sin</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this._x</span><span class="PUNC">=</span><span class="NAME">a.x</span><span class="PUNC">*</span><span class="NAME">d</span><span class="PUNC">;</span><span class="NAME">this._y</span><span class="PUNC">=</span><span class="NAME">a.y</span><span class="PUNC">*</span><span class="NAME">d</span><span class="PUNC">;</span><span class="NAME">this._z</span><span class="PUNC">=</span><span class="NAME">a.z</span><span class="PUNC">*</span><span class="NAME">d</span><span class="PUNC">;</span><span class="NAME">this._w</span><span class="PUNC">=</span><span class="NAME">Math.cos</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this._updateEuler</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">setFromRotationMatrix</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">a.elements</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">4</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">8</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">5</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">9</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">6</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">10</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">j</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">+</span><span class="NAME">f</span><span class="PUNC">+</span><span class="NAME">b</span><span class="PUNC">;</span><span class="NUMB">0</span><span class="PUNC">&lt;</span><span class="NAME">j</span><span class="PUNC">?</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NUMB">0.5</span><span class="PUNC">/</span><span class="NAME">Math.sqrt</span><span class="PUNC">(</span><span class="NAME">j</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this._w</span><span class="PUNC">=</span><span class="NUMB">0.25</span><span class="PUNC">/</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">this._x</span><span class="PUNC">=</span><span class="PUNC">(</span><span class="NAME">i</span><span class="PUNC">-</span><span class="NAME">h</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">this._y</span><span class="PUNC">=</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">-</span><span class="NAME">g</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">this._z</span><span class="PUNC">=</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">-</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">c</span><span class="PUNC">></span><span class="NAME">f</span><span class="PUNC">&&</span><span class="NAME">c</span><span class="PUNC">></span><span class="NAME">b</span><span class="PUNC">?</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NUMB">2</span><span class="PUNC">*</span><span class="NAME">Math.sqrt</span><span class="PUNC">(</span><span class="NUMB">1</span><span class="PUNC">+</span><span class="NAME">c</span><span class="PUNC">-</span><span class="NAME">f</span><span class="PUNC">-</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this._w</span><span class="PUNC">=</span><span class="PUNC">(</span><span class="NAME">i</span><span class="PUNC">-</span><span class="NAME">h</span><span class="PUNC">)</span><span class="PUNC">/</span><span class="WHIT">
<span class='line'> 26</span> </span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">this._x</span><span class="PUNC">=</span><span class="NUMB">0.25</span><span class="PUNC">*</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">this._y</span><span class="PUNC">=</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">+</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">/</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">this._z</span><span class="PUNC">=</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">+</span><span class="NAME">g</span><span class="PUNC">)</span><span class="PUNC">/</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">f</span><span class="PUNC">></span><span class="NAME">b</span><span class="PUNC">?</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NUMB">2</span><span class="PUNC">*</span><span class="NAME">Math.sqrt</span><span class="PUNC">(</span><span class="NUMB">1</span><span class="PUNC">+</span><span class="NAME">f</span><span class="PUNC">-</span><span class="NAME">c</span><span class="PUNC">-</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this._w</span><span class="PUNC">=</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">-</span><span class="NAME">g</span><span class="PUNC">)</span><span class="PUNC">/</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">this._x</span><span class="PUNC">=</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">+</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">/</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">this._y</span><span class="PUNC">=</span><span class="NUMB">0.25</span><span class="PUNC">*</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">this._z</span><span class="PUNC">=</span><span class="PUNC">(</span><span class="NAME">h</span><span class="PUNC">+</span><span class="NAME">i</span><span class="PUNC">)</span><span class="PUNC">/</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NUMB">2</span><span class="PUNC">*</span><span class="NAME">Math.sqrt</span><span class="PUNC">(</span><span class="NUMB">1</span><span class="PUNC">+</span><span class="NAME">b</span><span class="PUNC">-</span><span class="NAME">c</span><span class="PUNC">-</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this._w</span><span class="PUNC">=</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">-</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">/</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">this._x</span><span class="PUNC">=</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">+</span><span class="NAME">g</span><span class="PUNC">)</span><span class="PUNC">/</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">this._y</span><span class="PUNC">=</span><span class="PUNC">(</span><span class="NAME">h</span><span class="PUNC">+</span><span class="NAME">i</span><span class="PUNC">)</span><span class="PUNC">/</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">this._z</span><span class="PUNC">=</span><span class="NUMB">0.25</span><span class="PUNC">*</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this._updateEuler</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">inverse</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.conjugate</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">normalize</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">conjugate</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this._x</span><span class="PUNC">*</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">this._y</span><span class="PUNC">*</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">this._z</span><span class="PUNC">*</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">this._updateEuler</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">lengthSq</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this._x</span><span class="PUNC">*</span><span class="NAME">this._x</span><span class="PUNC">+</span><span class="NAME">this._y</span><span class="PUNC">*</span><span class="NAME">this._y</span><span class="PUNC">+</span><span class="NAME">this._z</span><span class="PUNC">*</span><span class="NAME">this._z</span><span class="PUNC">+</span><span class="NAME">this._w</span><span class="PUNC">*</span><span class="NAME">this._w</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'> 27</span> </span><span class="NAME">length</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">Math.sqrt</span><span class="PUNC">(</span><span class="NAME">this._x</span><span class="PUNC">*</span><span class="NAME">this._x</span><span class="PUNC">+</span><span class="NAME">this._y</span><span class="PUNC">*</span><span class="NAME">this._y</span><span class="PUNC">+</span><span class="NAME">this._z</span><span class="PUNC">*</span><span class="NAME">this._z</span><span class="PUNC">+</span><span class="NAME">this._w</span><span class="PUNC">*</span><span class="NAME">this._w</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">normalize</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">this.length</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NUMB">0</span><span class="PUNC">===</span><span class="NAME">a</span><span class="PUNC">?</span><span class="PUNC">(</span><span class="NAME">this._z</span><span class="PUNC">=</span><span class="NAME">this._y</span><span class="PUNC">=</span><span class="NAME">this._x</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">this._w</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">/</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">this._x</span><span class="PUNC">*</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">this._y</span><span class="PUNC">*</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">this._z</span><span class="PUNC">*</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">this._w</span><span class="PUNC">*</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">multiply</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">b</span><span class="PUNC">?</span><span class="PUNC">(</span><span class="NAME">console.warn</span><span class="PUNC">(</span><span class="STRN">"DEPRECATED: Quaternion's .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this.multiplyQuaternions</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">this.multiplyQuaternions</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">multiplyQuaternions</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'> 28</span> </span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">a._x</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">a._y</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">a._z</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">a._w</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">b._x</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">b._y</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">=</span><span class="NAME">b._z</span><span class="PUNC">,</span><span class="NAME">j</span><span class="PUNC">=</span><span class="NAME">b._w</span><span class="PUNC">;</span><span class="NAME">this._x</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">*</span><span class="NAME">j</span><span class="PUNC">+</span><span class="NAME">f</span><span class="PUNC">*</span><span class="NAME">h</span><span class="PUNC">+</span><span class="NAME">d</span><span class="PUNC">*</span><span class="NAME">i</span><span class="PUNC">-</span><span class="NAME">e</span><span class="PUNC">*</span><span class="NAME">g</span><span class="PUNC">;</span><span class="NAME">this._y</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">*</span><span class="NAME">j</span><span class="PUNC">+</span><span class="NAME">f</span><span class="PUNC">*</span><span class="NAME">g</span><span class="PUNC">+</span><span class="NAME">e</span><span class="PUNC">*</span><span class="NAME">h</span><span class="PUNC">-</span><span class="NAME">c</span><span class="PUNC">*</span><span class="NAME">i</span><span class="PUNC">;</span><span class="NAME">this._z</span><span class="PUNC">=</span><span class="NAME">e</span><span class="PUNC">*</span><span class="NAME">j</span><span class="PUNC">+</span><span class="NAME">f</span><span class="PUNC">*</span><span class="NAME">i</span><span class="PUNC">+</span><span class="NAME">c</span><span class="PUNC">*</span><span class="NAME">g</span><span class="PUNC">-</span><span class="NAME">d</span><span class="PUNC">*</span><span class="NAME">h</span><span class="PUNC">;</span><span class="NAME">this._w</span><span class="PUNC">=</span><span class="NAME">f</span><span class="PUNC">*</span><span class="NAME">j</span><span class="PUNC">-</span><span class="NAME">c</span><span class="PUNC">*</span><span class="NAME">h</span><span class="PUNC">-</span><span class="NAME">d</span><span class="PUNC">*</span><span class="NAME">g</span><span class="PUNC">-</span><span class="NAME">e</span><span class="PUNC">*</span><span class="NAME">i</span><span class="PUNC">;</span><span class="NAME">this._updateEuler</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">multiplyVector3</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">console.warn</span><span class="PUNC">(</span><span class="STRN">"DEPRECATED: Quaternion's .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead."</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a.applyQuaternion</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">slerp</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this._x</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">this._y</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">this._z</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">this._w</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">f</span><span class="PUNC">*</span><span class="NAME">a._w</span><span class="PUNC">+</span><span class="NAME">c</span><span class="PUNC">*</span><span class="NAME">a._x</span><span class="PUNC">+</span><span class="NAME">d</span><span class="PUNC">*</span><span class="NAME">a._y</span><span class="PUNC">+</span><span class="NAME">e</span><span class="PUNC">*</span><span class="NAME">a._z</span><span class="PUNC">;</span><span class="NUMB">0</span><span class="PUNC">></span><span class="NAME">h</span><span class="PUNC">?</span><span class="PUNC">(</span><span class="NAME">this._w</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="NAME">a._w</span><span class="PUNC">,</span><span class="NAME">this._x</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'> 29</span> </span><span class="PUNC">-</span><span class="NAME">a._x</span><span class="PUNC">,</span><span class="NAME">this._y</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="NAME">a._y</span><span class="PUNC">,</span><span class="NAME">this._z</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="NAME">a._z</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="NAME">h</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">this.copy</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NUMB">1</span><span class="PUNC">&lt;=</span><span class="NAME">h</span><span class="PUNC">)</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this._w</span><span class="PUNC">=</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">this._x</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">this._y</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">this._z</span><span class="PUNC">=</span><span class="NAME">e</span><span class="PUNC">,</span><span class="KEYW">this</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">Math.acos</span><span class="PUNC">(</span><span class="NAME">h</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">=</span><span class="NAME">Math.sqrt</span><span class="PUNC">(</span><span class="NUMB">1</span><span class="PUNC">-</span><span class="NAME">h</span><span class="PUNC">*</span><span class="NAME">h</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NUMB">0.001</span><span class="PUNC">></span><span class="NAME">Math.abs</span><span class="PUNC">(</span><span class="NAME">i</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this._w</span><span class="PUNC">=</span><span class="NUMB">0.5</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">+</span><span class="NAME">this._w</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this._x</span><span class="PUNC">=</span><span class="NUMB">0.5</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">+</span><span class="NAME">this._x</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this._y</span><span class="PUNC">=</span><span class="NUMB">0.5</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">+</span><span class="NAME">this._y</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this._z</span><span class="PUNC">=</span><span class="NUMB">0.5</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">+</span><span class="NAME">this._z</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="KEYW">this</span><span class="PUNC">;</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">Math.sin</span><span class="PUNC">(</span><span class="PUNC">(</span><span class="NUMB">1</span><span class="PUNC">-</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">g</span><span class="PUNC">)</span><span class="PUNC">/</span><span class="NAME">i</span><span class="PUNC">;</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">Math.sin</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">*</span><span class="NAME">g</span><span class="PUNC">)</span><span class="PUNC">/</span><span class="NAME">i</span><span class="PUNC">;</span><span class="NAME">this._w</span><span class="PUNC">=</span><span class="NAME">f</span><span class="PUNC">*</span><span class="NAME">h</span><span class="PUNC">+</span><span class="NAME">this._w</span><span class="PUNC">*</span><span class="NAME">g</span><span class="PUNC">;</span><span class="NAME">this._x</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">*</span><span class="NAME">h</span><span class="PUNC">+</span><span class="NAME">this._x</span><span class="PUNC">*</span><span class="NAME">g</span><span class="PUNC">;</span><span class="NAME">this._y</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">*</span><span class="NAME">h</span><span class="PUNC">+</span><span class="NAME">this._y</span><span class="PUNC">*</span><span class="NAME">g</span><span class="PUNC">;</span><span class="NAME">this._z</span><span class="PUNC">=</span><span class="NAME">e</span><span class="PUNC">*</span><span class="NAME">h</span><span class="PUNC">+</span><span class="NAME">this._z</span><span class="PUNC">*</span><span class="NAME">g</span><span class="PUNC">;</span><span class="NAME">this._updateEuler</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">equals</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a._x</span><span class="PUNC">===</span><span class="NAME">this._x</span><span class="PUNC">&&</span><span class="NAME">a._y</span><span class="PUNC">===</span><span class="NAME">this._y</span><span class="PUNC">&&</span><span class="NAME">a._z</span><span class="PUNC">===</span><span class="WHIT">
<span class='line'> 30</span> </span><span class="NAME">this._z</span><span class="PUNC">&&</span><span class="NAME">a._w</span><span class="PUNC">===</span><span class="NAME">this._w</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">fromArray</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this._x</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">this._y</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">this._z</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">this._w</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">3</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">this._updateEuler</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">toArray</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="PUNC">[</span><span class="NAME">this._x</span><span class="PUNC">,</span><span class="NAME">this._y</span><span class="PUNC">,</span><span class="NAME">this._z</span><span class="PUNC">,</span><span class="NAME">this._w</span><span class="PUNC">]</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">clone</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Quaternion</span><span class="PUNC">(</span><span class="NAME">this._x</span><span class="PUNC">,</span><span class="NAME">this._y</span><span class="PUNC">,</span><span class="NAME">this._z</span><span class="PUNC">,</span><span class="NAME">this._w</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.Quaternion.slerp</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">c.copy</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">slerp</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.Vector2</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.x</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">||</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">this.y</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">||</span><span class="NUMB">0</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 31</span> </span><span class="NAME">THREE.Vector2.prototype</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="NAME">constructor</span><span class="PUNC">:</span><span class="NAME">THREE.Vector2</span><span class="PUNC">,</span><span class="NAME">set</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.x</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">this.y</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">setX</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.x</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">setY</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.y</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">setComponent</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">switch</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">:</span><span class="NAME">this.x</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">;</span><span class="KEYW">break</span><span class="PUNC">;</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="PUNC">:</span><span class="NAME">this.y</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">;</span><span class="KEYW">break</span><span class="PUNC">;</span><span class="KEYW">default</span><span class="PUNC">:</span><span class="KEYW">throw</span><span class="WHIT"> </span><span class="NAME">Error</span><span class="PUNC">(</span><span class="STRN">"index is out of range: "</span><span class="PUNC">+</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">getComponent</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">switch</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">:</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.x</span><span class="PUNC">;</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="PUNC">:</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.y</span><span class="PUNC">;</span><span class="KEYW">default</span><span class="PUNC">:</span><span class="KEYW">throw</span><span class="WHIT"> </span><span class="NAME">Error</span><span class="PUNC">(</span><span class="STRN">"index is out of range: "</span><span class="PUNC">+</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">copy</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.x</span><span class="PUNC">=</span><span class="NAME">a.x</span><span class="PUNC">;</span><span class="NAME">this.y</span><span class="PUNC">=</span><span class="NAME">a.y</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">add</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'> 32</span> </span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">b</span><span class="PUNC">)</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">console.warn</span><span class="PUNC">(</span><span class="STRN">"DEPRECATED: Vector2's .add() now only accepts one argument. Use .addVectors( a, b ) instead."</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this.addVectors</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.x</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">a.x</span><span class="PUNC">;</span><span class="NAME">this.y</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">a.y</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">addVectors</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.x</span><span class="PUNC">=</span><span class="NAME">a.x</span><span class="PUNC">+</span><span class="NAME">b.x</span><span class="PUNC">;</span><span class="NAME">this.y</span><span class="PUNC">=</span><span class="NAME">a.y</span><span class="PUNC">+</span><span class="NAME">b.y</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">addScalar</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.x</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">this.y</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">sub</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">b</span><span class="PUNC">)</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">console.warn</span><span class="PUNC">(</span><span class="STRN">"DEPRECATED: Vector2's .sub() now only accepts one argument. Use .subVectors( a, b ) instead."</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this.subVectors</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.x</span><span class="PUNC">-</span><span class="PUNC">=</span><span class="NAME">a.x</span><span class="PUNC">;</span><span class="NAME">this.y</span><span class="PUNC">-</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'> 33</span> </span><span class="NAME">a.y</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">subVectors</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.x</span><span class="PUNC">=</span><span class="NAME">a.x</span><span class="PUNC">-</span><span class="NAME">b.x</span><span class="PUNC">;</span><span class="NAME">this.y</span><span class="PUNC">=</span><span class="NAME">a.y</span><span class="PUNC">-</span><span class="NAME">b.y</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">multiplyScalar</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.x</span><span class="PUNC">*</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">this.y</span><span class="PUNC">*</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">divideScalar</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">a</span><span class="PUNC">?</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">/</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">this.x</span><span class="PUNC">*</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">this.y</span><span class="PUNC">*</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">this.y</span><span class="PUNC">=</span><span class="NAME">this.x</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">min</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.x</span><span class="PUNC">></span><span class="NAME">a.x</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">this.x</span><span class="PUNC">=</span><span class="NAME">a.x</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.y</span><span class="PUNC">></span><span class="NAME">a.y</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">this.y</span><span class="PUNC">=</span><span class="NAME">a.y</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">max</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.x</span><span class="PUNC">&lt;</span><span class="NAME">a.x</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">this.x</span><span class="PUNC">=</span><span class="NAME">a.x</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.y</span><span class="PUNC">&lt;</span><span class="NAME">a.y</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">this.y</span><span class="PUNC">=</span><span class="NAME">a.y</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">clamp</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.x</span><span class="PUNC">&lt;</span><span class="NAME">a.x</span><span class="PUNC">?</span><span class="NAME">this.x</span><span class="PUNC">=</span><span class="NAME">a.x</span><span class="PUNC">:</span><span class="NAME">this.x</span><span class="PUNC">></span><span class="NAME">b.x</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">this.x</span><span class="PUNC">=</span><span class="NAME">b.x</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.y</span><span class="PUNC">&lt;</span><span class="NAME">a.y</span><span class="PUNC">?</span><span class="NAME">this.y</span><span class="PUNC">=</span><span class="NAME">a.y</span><span class="PUNC">:</span><span class="NAME">this.y</span><span class="PUNC">></span><span class="NAME">b.y</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">this.y</span><span class="PUNC">=</span><span class="NAME">b.y</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 34</span> </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">negate</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.multiplyScalar</span><span class="PUNC">(</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">dot</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.x</span><span class="PUNC">*</span><span class="NAME">a.x</span><span class="PUNC">+</span><span class="NAME">this.y</span><span class="PUNC">*</span><span class="NAME">a.y</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">lengthSq</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.x</span><span class="PUNC">*</span><span class="NAME">this.x</span><span class="PUNC">+</span><span class="NAME">this.y</span><span class="PUNC">*</span><span class="NAME">this.y</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">length</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">Math.sqrt</span><span class="PUNC">(</span><span class="NAME">this.x</span><span class="PUNC">*</span><span class="NAME">this.x</span><span class="PUNC">+</span><span class="NAME">this.y</span><span class="PUNC">*</span><span class="NAME">this.y</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">normalize</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.divideScalar</span><span class="PUNC">(</span><span class="NAME">this.length</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">distanceTo</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">Math.sqrt</span><span class="PUNC">(</span><span class="NAME">this.distanceToSquared</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">distanceToSquared</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.x</span><span class="PUNC">-</span><span class="NAME">a.x</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">this.y</span><span class="PUNC">-</span><span class="NAME">a.y</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">*</span><span class="NAME">b</span><span class="PUNC">+</span><span class="NAME">a</span><span class="PUNC">*</span><span class="NAME">a</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">setLength</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.length</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">b</span><span class="PUNC">&&</span><span class="NAME">a</span><span class="PUNC">!==</span><span class="NAME">b</span><span class="PUNC">&&</span><span class="NAME">this.multiplyScalar</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">/</span><span class="WHIT">
<span class='line'> 35</span> </span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">lerp</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.x</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="PUNC">(</span><span class="NAME">a.x</span><span class="PUNC">-</span><span class="NAME">this.x</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">b</span><span class="PUNC">;</span><span class="NAME">this.y</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="PUNC">(</span><span class="NAME">a.y</span><span class="PUNC">-</span><span class="NAME">this.y</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">b</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">equals</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a.x</span><span class="PUNC">===</span><span class="NAME">this.x</span><span class="PUNC">&&</span><span class="NAME">a.y</span><span class="PUNC">===</span><span class="NAME">this.y</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">fromArray</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.x</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">this.y</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">toArray</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="PUNC">[</span><span class="NAME">this.x</span><span class="PUNC">,</span><span class="NAME">this.y</span><span class="PUNC">]</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">clone</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector2</span><span class="PUNC">(</span><span class="NAME">this.x</span><span class="PUNC">,</span><span class="NAME">this.y</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.Vector3</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.x</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">||</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">this.y</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">||</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">this.z</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">||</span><span class="NUMB">0</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 36</span> </span><span class="NAME">THREE.Vector3.prototype</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="NAME">constructor</span><span class="PUNC">:</span><span class="NAME">THREE.Vector3</span><span class="PUNC">,</span><span class="NAME">set</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.x</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">this.y</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">;</span><span class="NAME">this.z</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">setX</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.x</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">setY</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.y</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">setZ</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.z</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">setComponent</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">switch</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">:</span><span class="NAME">this.x</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">;</span><span class="KEYW">break</span><span class="PUNC">;</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="PUNC">:</span><span class="NAME">this.y</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">;</span><span class="KEYW">break</span><span class="PUNC">;</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="NUMB">2</span><span class="PUNC">:</span><span class="NAME">this.z</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">;</span><span class="KEYW">break</span><span class="PUNC">;</span><span class="KEYW">default</span><span class="PUNC">:</span><span class="KEYW">throw</span><span class="WHIT"> </span><span class="NAME">Error</span><span class="PUNC">(</span><span class="STRN">"index is out of range: "</span><span class="PUNC">+</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">getComponent</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">switch</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">:</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.x</span><span class="PUNC">;</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="PUNC">:</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.y</span><span class="PUNC">;</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="NUMB">2</span><span class="PUNC">:</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.z</span><span class="PUNC">;</span><span class="KEYW">default</span><span class="PUNC">:</span><span class="KEYW">throw</span><span class="WHIT"> </span><span class="NAME">Error</span><span class="PUNC">(</span><span class="STRN">"index is out of range: "</span><span class="PUNC">+</span><span class="WHIT">
<span class='line'> 37</span> </span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">copy</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.x</span><span class="PUNC">=</span><span class="NAME">a.x</span><span class="PUNC">;</span><span class="NAME">this.y</span><span class="PUNC">=</span><span class="NAME">a.y</span><span class="PUNC">;</span><span class="NAME">this.z</span><span class="PUNC">=</span><span class="NAME">a.z</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">add</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">b</span><span class="PUNC">)</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">console.warn</span><span class="PUNC">(</span><span class="STRN">"DEPRECATED: Vector3's .add() now only accepts one argument. Use .addVectors( a, b ) instead."</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this.addVectors</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.x</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">a.x</span><span class="PUNC">;</span><span class="NAME">this.y</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">a.y</span><span class="PUNC">;</span><span class="NAME">this.z</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">a.z</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">addScalar</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.x</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">this.y</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">this.z</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">addVectors</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.x</span><span class="PUNC">=</span><span class="NAME">a.x</span><span class="PUNC">+</span><span class="NAME">b.x</span><span class="PUNC">;</span><span class="NAME">this.y</span><span class="PUNC">=</span><span class="NAME">a.y</span><span class="PUNC">+</span><span class="NAME">b.y</span><span class="PUNC">;</span><span class="NAME">this.z</span><span class="PUNC">=</span><span class="NAME">a.z</span><span class="PUNC">+</span><span class="NAME">b.z</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">sub</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">b</span><span class="PUNC">)</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">console.warn</span><span class="PUNC">(</span><span class="STRN">"DEPRECATED: Vector3's .sub() now only accepts one argument. Use .subVectors( a, b ) instead."</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'> 38</span> </span><span class="NAME">this.subVectors</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.x</span><span class="PUNC">-</span><span class="PUNC">=</span><span class="NAME">a.x</span><span class="PUNC">;</span><span class="NAME">this.y</span><span class="PUNC">-</span><span class="PUNC">=</span><span class="NAME">a.y</span><span class="PUNC">;</span><span class="NAME">this.z</span><span class="PUNC">-</span><span class="PUNC">=</span><span class="NAME">a.z</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">subVectors</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.x</span><span class="PUNC">=</span><span class="NAME">a.x</span><span class="PUNC">-</span><span class="NAME">b.x</span><span class="PUNC">;</span><span class="NAME">this.y</span><span class="PUNC">=</span><span class="NAME">a.y</span><span class="PUNC">-</span><span class="NAME">b.y</span><span class="PUNC">;</span><span class="NAME">this.z</span><span class="PUNC">=</span><span class="NAME">a.z</span><span class="PUNC">-</span><span class="NAME">b.z</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">multiply</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">b</span><span class="PUNC">)</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">console.warn</span><span class="PUNC">(</span><span class="STRN">"DEPRECATED: Vector3's .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this.multiplyVectors</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.x</span><span class="PUNC">*</span><span class="PUNC">=</span><span class="NAME">a.x</span><span class="PUNC">;</span><span class="NAME">this.y</span><span class="PUNC">*</span><span class="PUNC">=</span><span class="NAME">a.y</span><span class="PUNC">;</span><span class="NAME">this.z</span><span class="PUNC">*</span><span class="PUNC">=</span><span class="NAME">a.z</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">multiplyScalar</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.x</span><span class="PUNC">*</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">this.y</span><span class="PUNC">*</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">this.z</span><span class="PUNC">*</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">multiplyVectors</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.x</span><span class="PUNC">=</span><span class="NAME">a.x</span><span class="PUNC">*</span><span class="WHIT">
<span class='line'> 39</span> </span><span class="NAME">b.x</span><span class="PUNC">;</span><span class="NAME">this.y</span><span class="PUNC">=</span><span class="NAME">a.y</span><span class="PUNC">*</span><span class="NAME">b.y</span><span class="PUNC">;</span><span class="NAME">this.z</span><span class="PUNC">=</span><span class="NAME">a.z</span><span class="PUNC">*</span><span class="NAME">b.z</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">applyMatrix3</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.x</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.y</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">this.z</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">a.elements</span><span class="PUNC">;</span><span class="NAME">this.x</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">*</span><span class="NAME">b</span><span class="PUNC">+</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">3</span><span class="PUNC">]</span><span class="PUNC">*</span><span class="NAME">c</span><span class="PUNC">+</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">6</span><span class="PUNC">]</span><span class="PUNC">*</span><span class="NAME">d</span><span class="PUNC">;</span><span class="NAME">this.y</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">*</span><span class="NAME">b</span><span class="PUNC">+</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">4</span><span class="PUNC">]</span><span class="PUNC">*</span><span class="NAME">c</span><span class="PUNC">+</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">7</span><span class="PUNC">]</span><span class="PUNC">*</span><span class="NAME">d</span><span class="PUNC">;</span><span class="NAME">this.z</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">*</span><span class="NAME">b</span><span class="PUNC">+</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">5</span><span class="PUNC">]</span><span class="PUNC">*</span><span class="NAME">c</span><span class="PUNC">+</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">8</span><span class="PUNC">]</span><span class="PUNC">*</span><span class="NAME">d</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">applyMatrix4</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.x</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.y</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">this.z</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">a.elements</span><span class="PUNC">;</span><span class="NAME">this.x</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">*</span><span class="NAME">b</span><span class="PUNC">+</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">4</span><span class="PUNC">]</span><span class="PUNC">*</span><span class="NAME">c</span><span class="PUNC">+</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">8</span><span class="PUNC">]</span><span class="PUNC">*</span><span class="NAME">d</span><span class="PUNC">+</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">12</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">this.y</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">*</span><span class="NAME">b</span><span class="PUNC">+</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">5</span><span class="PUNC">]</span><span class="PUNC">*</span><span class="NAME">c</span><span class="PUNC">+</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">9</span><span class="PUNC">]</span><span class="PUNC">*</span><span class="NAME">d</span><span class="PUNC">+</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">13</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">this.z</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">*</span><span class="NAME">b</span><span class="PUNC">+</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">6</span><span class="PUNC">]</span><span class="PUNC">*</span><span class="NAME">c</span><span class="PUNC">+</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">10</span><span class="PUNC">]</span><span class="PUNC">*</span><span class="NAME">d</span><span class="PUNC">+</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">14</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">applyProjection</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.x</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.y</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">this.z</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">a.elements</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">/</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">3</span><span class="PUNC">]</span><span class="PUNC">*</span><span class="NAME">b</span><span class="PUNC">+</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">7</span><span class="PUNC">]</span><span class="PUNC">*</span><span class="NAME">c</span><span class="PUNC">+</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">11</span><span class="PUNC">]</span><span class="PUNC">*</span><span class="NAME">d</span><span class="PUNC">+</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">15</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 40</span> </span><span class="NAME">this.x</span><span class="PUNC">=</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">*</span><span class="NAME">b</span><span class="PUNC">+</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">4</span><span class="PUNC">]</span><span class="PUNC">*</span><span class="NAME">c</span><span class="PUNC">+</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">8</span><span class="PUNC">]</span><span class="PUNC">*</span><span class="NAME">d</span><span class="PUNC">+</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">12</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">e</span><span class="PUNC">;</span><span class="NAME">this.y</span><span class="PUNC">=</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">*</span><span class="NAME">b</span><span class="PUNC">+</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">5</span><span class="PUNC">]</span><span class="PUNC">*</span><span class="NAME">c</span><span class="PUNC">+</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">9</span><span class="PUNC">]</span><span class="PUNC">*</span><span class="NAME">d</span><span class="PUNC">+</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">13</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">e</span><span class="PUNC">;</span><span class="NAME">this.z</span><span class="PUNC">=</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">*</span><span class="NAME">b</span><span class="PUNC">+</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">6</span><span class="PUNC">]</span><span class="PUNC">*</span><span class="NAME">c</span><span class="PUNC">+</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">10</span><span class="PUNC">]</span><span class="PUNC">*</span><span class="NAME">d</span><span class="PUNC">+</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">14</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">e</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">applyQuaternion</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.x</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.y</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">this.z</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">a.x</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">a.y</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">a.z</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">a.w</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">*</span><span class="NAME">b</span><span class="PUNC">+</span><span class="NAME">f</span><span class="PUNC">*</span><span class="NAME">d</span><span class="PUNC">-</span><span class="NAME">h</span><span class="PUNC">*</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">*</span><span class="NAME">c</span><span class="PUNC">+</span><span class="NAME">h</span><span class="PUNC">*</span><span class="NAME">b</span><span class="PUNC">-</span><span class="NAME">e</span><span class="PUNC">*</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">j</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">*</span><span class="NAME">d</span><span class="PUNC">+</span><span class="NAME">e</span><span class="PUNC">*</span><span class="NAME">c</span><span class="PUNC">-</span><span class="NAME">f</span><span class="PUNC">*</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="NAME">e</span><span class="PUNC">*</span><span class="NAME">b</span><span class="PUNC">-</span><span class="NAME">f</span><span class="PUNC">*</span><span class="NAME">c</span><span class="PUNC">-</span><span class="NAME">h</span><span class="PUNC">*</span><span class="NAME">d</span><span class="PUNC">;</span><span class="NAME">this.x</span><span class="PUNC">=</span><span class="NAME">g</span><span class="PUNC">*</span><span class="NAME">a</span><span class="PUNC">+</span><span class="NAME">b</span><span class="PUNC">*</span><span class="PUNC">-</span><span class="NAME">e</span><span class="PUNC">+</span><span class="NAME">i</span><span class="PUNC">*</span><span class="PUNC">-</span><span class="NAME">h</span><span class="PUNC">-</span><span class="NAME">j</span><span class="PUNC">*</span><span class="PUNC">-</span><span class="NAME">f</span><span class="PUNC">;</span><span class="NAME">this.y</span><span class="PUNC">=</span><span class="NAME">i</span><span class="PUNC">*</span><span class="NAME">a</span><span class="PUNC">+</span><span class="NAME">b</span><span class="PUNC">*</span><span class="PUNC">-</span><span class="NAME">f</span><span class="PUNC">+</span><span class="NAME">j</span><span class="PUNC">*</span><span class="PUNC">-</span><span class="NAME">e</span><span class="PUNC">-</span><span class="NAME">g</span><span class="PUNC">*</span><span class="PUNC">-</span><span class="NAME">h</span><span class="PUNC">;</span><span class="NAME">this.z</span><span class="PUNC">=</span><span class="NAME">j</span><span class="PUNC">*</span><span class="NAME">a</span><span class="PUNC">+</span><span class="NAME">b</span><span class="PUNC">*</span><span class="PUNC">-</span><span class="NAME">h</span><span class="PUNC">+</span><span class="NAME">g</span><span class="PUNC">*</span><span class="PUNC">-</span><span class="NAME">f</span><span class="PUNC">-</span><span class="NAME">i</span><span class="PUNC">*</span><span class="PUNC">-</span><span class="NAME">e</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">transformDirection</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.x</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.y</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">this.z</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">a.elements</span><span class="PUNC">;</span><span class="NAME">this.x</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">*</span><span class="NAME">b</span><span class="PUNC">+</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">4</span><span class="PUNC">]</span><span class="PUNC">*</span><span class="NAME">c</span><span class="PUNC">+</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">8</span><span class="PUNC">]</span><span class="PUNC">*</span><span class="NAME">d</span><span class="PUNC">;</span><span class="NAME">this.y</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">*</span><span class="NAME">b</span><span class="PUNC">+</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">5</span><span class="PUNC">]</span><span class="PUNC">*</span><span class="NAME">c</span><span class="PUNC">+</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">9</span><span class="PUNC">]</span><span class="PUNC">*</span><span class="NAME">d</span><span class="PUNC">;</span><span class="NAME">this.z</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">*</span><span class="WHIT">
<span class='line'> 41</span> </span><span class="NAME">b</span><span class="PUNC">+</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">6</span><span class="PUNC">]</span><span class="PUNC">*</span><span class="NAME">c</span><span class="PUNC">+</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">10</span><span class="PUNC">]</span><span class="PUNC">*</span><span class="NAME">d</span><span class="PUNC">;</span><span class="NAME">this.normalize</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">divide</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.x</span><span class="PUNC">/</span><span class="PUNC">=</span><span class="NAME">a.x</span><span class="PUNC">;</span><span class="NAME">this.y</span><span class="PUNC">/</span><span class="PUNC">=</span><span class="NAME">a.y</span><span class="PUNC">;</span><span class="NAME">this.z</span><span class="PUNC">/</span><span class="PUNC">=</span><span class="NAME">a.z</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">divideScalar</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">a</span><span class="PUNC">?</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">/</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">this.x</span><span class="PUNC">*</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">this.y</span><span class="PUNC">*</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">this.z</span><span class="PUNC">*</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">this.z</span><span class="PUNC">=</span><span class="NAME">this.y</span><span class="PUNC">=</span><span class="NAME">this.x</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">min</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.x</span><span class="PUNC">></span><span class="NAME">a.x</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">this.x</span><span class="PUNC">=</span><span class="NAME">a.x</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.y</span><span class="PUNC">></span><span class="NAME">a.y</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">this.y</span><span class="PUNC">=</span><span class="NAME">a.y</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.z</span><span class="PUNC">></span><span class="NAME">a.z</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">this.z</span><span class="PUNC">=</span><span class="NAME">a.z</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">max</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.x</span><span class="PUNC">&lt;</span><span class="NAME">a.x</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">this.x</span><span class="PUNC">=</span><span class="NAME">a.x</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.y</span><span class="PUNC">&lt;</span><span class="NAME">a.y</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">this.y</span><span class="PUNC">=</span><span class="NAME">a.y</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.z</span><span class="PUNC">&lt;</span><span class="NAME">a.z</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">this.z</span><span class="PUNC">=</span><span class="NAME">a.z</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">clamp</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.x</span><span class="PUNC">&lt;</span><span class="NAME">a.x</span><span class="PUNC">?</span><span class="NAME">this.x</span><span class="PUNC">=</span><span class="NAME">a.x</span><span class="PUNC">:</span><span class="NAME">this.x</span><span class="PUNC">></span><span class="NAME">b.x</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">this.x</span><span class="PUNC">=</span><span class="NAME">b.x</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.y</span><span class="PUNC">&lt;</span><span class="WHIT">
<span class='line'> 42</span> </span><span class="NAME">a.y</span><span class="PUNC">?</span><span class="NAME">this.y</span><span class="PUNC">=</span><span class="NAME">a.y</span><span class="PUNC">:</span><span class="NAME">this.y</span><span class="PUNC">></span><span class="NAME">b.y</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">this.y</span><span class="PUNC">=</span><span class="NAME">b.y</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.z</span><span class="PUNC">&lt;</span><span class="NAME">a.z</span><span class="PUNC">?</span><span class="NAME">this.z</span><span class="PUNC">=</span><span class="NAME">a.z</span><span class="PUNC">:</span><span class="NAME">this.z</span><span class="PUNC">></span><span class="NAME">b.z</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">this.z</span><span class="PUNC">=</span><span class="NAME">b.z</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">negate</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.multiplyScalar</span><span class="PUNC">(</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">dot</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.x</span><span class="PUNC">*</span><span class="NAME">a.x</span><span class="PUNC">+</span><span class="NAME">this.y</span><span class="PUNC">*</span><span class="NAME">a.y</span><span class="PUNC">+</span><span class="NAME">this.z</span><span class="PUNC">*</span><span class="NAME">a.z</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">lengthSq</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.x</span><span class="PUNC">*</span><span class="NAME">this.x</span><span class="PUNC">+</span><span class="NAME">this.y</span><span class="PUNC">*</span><span class="NAME">this.y</span><span class="PUNC">+</span><span class="NAME">this.z</span><span class="PUNC">*</span><span class="NAME">this.z</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">length</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">Math.sqrt</span><span class="PUNC">(</span><span class="NAME">this.x</span><span class="PUNC">*</span><span class="NAME">this.x</span><span class="PUNC">+</span><span class="NAME">this.y</span><span class="PUNC">*</span><span class="NAME">this.y</span><span class="PUNC">+</span><span class="NAME">this.z</span><span class="PUNC">*</span><span class="NAME">this.z</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">lengthManhattan</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">Math.abs</span><span class="PUNC">(</span><span class="NAME">this.x</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="NAME">Math.abs</span><span class="PUNC">(</span><span class="NAME">this.y</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="NAME">Math.abs</span><span class="PUNC">(</span><span class="NAME">this.z</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">normalize</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.divideScalar</span><span class="PUNC">(</span><span class="NAME">this.length</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'> 43</span> </span><span class="NAME">setLength</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.length</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">b</span><span class="PUNC">&&</span><span class="NAME">a</span><span class="PUNC">!==</span><span class="NAME">b</span><span class="PUNC">&&</span><span class="NAME">this.multiplyScalar</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">/</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">lerp</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.x</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="PUNC">(</span><span class="NAME">a.x</span><span class="PUNC">-</span><span class="NAME">this.x</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">b</span><span class="PUNC">;</span><span class="NAME">this.y</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="PUNC">(</span><span class="NAME">a.y</span><span class="PUNC">-</span><span class="NAME">this.y</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">b</span><span class="PUNC">;</span><span class="NAME">this.z</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="PUNC">(</span><span class="NAME">a.z</span><span class="PUNC">-</span><span class="NAME">this.z</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">b</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">cross</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">b</span><span class="PUNC">)</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">console.warn</span><span class="PUNC">(</span><span class="STRN">"DEPRECATED: Vector3's .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this.crossVectors</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.x</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">this.y</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">this.z</span><span class="PUNC">;</span><span class="NAME">this.x</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">*</span><span class="NAME">a.z</span><span class="PUNC">-</span><span class="NAME">e</span><span class="PUNC">*</span><span class="NAME">a.y</span><span class="PUNC">;</span><span class="NAME">this.y</span><span class="PUNC">=</span><span class="NAME">e</span><span class="PUNC">*</span><span class="NAME">a.x</span><span class="PUNC">-</span><span class="NAME">c</span><span class="PUNC">*</span><span class="NAME">a.z</span><span class="PUNC">;</span><span class="NAME">this.z</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">*</span><span class="NAME">a.y</span><span class="PUNC">-</span><span class="NAME">d</span><span class="PUNC">*</span><span class="NAME">a.x</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">crossVectors</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.x</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'> 44</span> </span><span class="NAME">a.y</span><span class="PUNC">*</span><span class="NAME">b.z</span><span class="PUNC">-</span><span class="NAME">a.z</span><span class="PUNC">*</span><span class="NAME">b.y</span><span class="PUNC">;</span><span class="NAME">this.y</span><span class="PUNC">=</span><span class="NAME">a.z</span><span class="PUNC">*</span><span class="NAME">b.x</span><span class="PUNC">-</span><span class="NAME">a.x</span><span class="PUNC">*</span><span class="NAME">b.z</span><span class="PUNC">;</span><span class="NAME">this.z</span><span class="PUNC">=</span><span class="NAME">a.x</span><span class="PUNC">*</span><span class="NAME">b.y</span><span class="PUNC">-</span><span class="NAME">a.y</span><span class="PUNC">*</span><span class="NAME">b.x</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">angleTo</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">this.dot</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">/</span><span class="PUNC">(</span><span class="NAME">this.length</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">a.length</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">Math.acos</span><span class="PUNC">(</span><span class="NAME">THREE.Math.clamp</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">distanceTo</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">Math.sqrt</span><span class="PUNC">(</span><span class="NAME">this.distanceToSquared</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">distanceToSquared</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.x</span><span class="PUNC">-</span><span class="NAME">a.x</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.y</span><span class="PUNC">-</span><span class="NAME">a.y</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">this.z</span><span class="PUNC">-</span><span class="NAME">a.z</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">*</span><span class="NAME">b</span><span class="PUNC">+</span><span class="NAME">c</span><span class="PUNC">*</span><span class="NAME">c</span><span class="PUNC">+</span><span class="NAME">a</span><span class="PUNC">*</span><span class="NAME">a</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">setEulerFromRotationMatrix</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">console.error</span><span class="PUNC">(</span><span class="STRN">"REMOVED: Vector3's setEulerFromRotationMatrix has been removed in favor of Euler.setFromRotationMatrix(), please update your code."</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'> 45</span> </span><span class="NAME">setEulerFromQuaternion</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">console.error</span><span class="PUNC">(</span><span class="STRN">"REMOVED: Vector3's setEulerFromQuaternion: has been removed in favor of Euler.setFromQuaternion(), please update your code."</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">getPositionFromMatrix</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.x</span><span class="PUNC">=</span><span class="NAME">a.elements</span><span class="PUNC">[</span><span class="NUMB">12</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">this.y</span><span class="PUNC">=</span><span class="NAME">a.elements</span><span class="PUNC">[</span><span class="NUMB">13</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">this.z</span><span class="PUNC">=</span><span class="NAME">a.elements</span><span class="PUNC">[</span><span class="NUMB">14</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">getScaleFromMatrix</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.set</span><span class="PUNC">(</span><span class="NAME">a.elements</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">a.elements</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">a.elements</span><span class="PUNC">[</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">length</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.set</span><span class="PUNC">(</span><span class="NAME">a.elements</span><span class="PUNC">[</span><span class="NUMB">4</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">a.elements</span><span class="PUNC">[</span><span class="NUMB">5</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">a.elements</span><span class="PUNC">[</span><span class="NUMB">6</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">length</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">this.set</span><span class="PUNC">(</span><span class="NAME">a.elements</span><span class="PUNC">[</span><span class="NUMB">8</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">a.elements</span><span class="PUNC">[</span><span class="NUMB">9</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">a.elements</span><span class="PUNC">[</span><span class="NUMB">10</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">length</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 46</span> </span><span class="NAME">this.x</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">;</span><span class="NAME">this.y</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">;</span><span class="NAME">this.z</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">getColumnFromMatrix</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="NUMB">4</span><span class="PUNC">*</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">b.elements</span><span class="PUNC">;</span><span class="NAME">this.x</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">this.y</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">this.z</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">+</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">equals</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a.x</span><span class="PUNC">===</span><span class="NAME">this.x</span><span class="PUNC">&&</span><span class="NAME">a.y</span><span class="PUNC">===</span><span class="NAME">this.y</span><span class="PUNC">&&</span><span class="NAME">a.z</span><span class="PUNC">===</span><span class="NAME">this.z</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">fromArray</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.x</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">this.y</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">this.z</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">toArray</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="PUNC">[</span><span class="NAME">this.x</span><span class="PUNC">,</span><span class="NAME">this.y</span><span class="PUNC">,</span><span class="NAME">this.z</span><span class="PUNC">]</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">clone</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">(</span><span class="NAME">this.x</span><span class="PUNC">,</span><span class="NAME">this.y</span><span class="PUNC">,</span><span class="NAME">this.z</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 47</span> </span><span class="NAME">THREE.extend</span><span class="PUNC">(</span><span class="NAME">THREE.Vector3.prototype</span><span class="PUNC">,</span><span class="PUNC">{</span><span class="NAME">applyEuler</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Quaternion</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">===</span><span class="KEYW">typeof</span><span class="WHIT"> </span><span class="NAME">b.order</span><span class="PUNC">&&</span><span class="NAME">console.error</span><span class="PUNC">(</span><span class="STRN">"ERROR: Vector3's .applyEuler() now expects a Euler rotation rather than a Vector3 and order.  Please update your code."</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">a.setFromEuler</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.applyQuaternion</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">applyAxisAngle</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Quaternion</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">a.setFromAxisAngle</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.applyQuaternion</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">projectOnVector</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'> 48</span> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">a.copy</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">normalize</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.dot</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.copy</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">multiplyScalar</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">projectOnPlane</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">a.copy</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">projectOnVector</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.sub</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">reflect</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">a.copy</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">projectOnVector</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">multiplyScalar</span><span class="PUNC">(</span><span class="NUMB">2</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.subVectors</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">THREE.Vector4</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.x</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">||</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">this.y</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">||</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">this.z</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">||</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">this.w</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">d</span><span class="PUNC">?</span><span class="NAME">d</span><span class="PUNC">:</span><span class="NUMB">1</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 49</span> </span><span class="NAME">THREE.Vector4.prototype</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="NAME">constructor</span><span class="PUNC">:</span><span class="NAME">THREE.Vector4</span><span class="PUNC">,</span><span class="NAME">set</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.x</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">this.y</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">;</span><span class="NAME">this.z</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">;</span><span class="NAME">this.w</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">setX</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.x</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">setY</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.y</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">setZ</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.z</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">setW</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.w</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">setComponent</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">switch</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">:</span><span class="NAME">this.x</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">;</span><span class="KEYW">break</span><span class="PUNC">;</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="PUNC">:</span><span class="NAME">this.y</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">;</span><span class="KEYW">break</span><span class="PUNC">;</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="NUMB">2</span><span class="PUNC">:</span><span class="NAME">this.z</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">;</span><span class="KEYW">break</span><span class="PUNC">;</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="NUMB">3</span><span class="PUNC">:</span><span class="NAME">this.w</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">;</span><span class="KEYW">break</span><span class="PUNC">;</span><span class="KEYW">default</span><span class="PUNC">:</span><span class="KEYW">throw</span><span class="WHIT"> </span><span class="NAME">Error</span><span class="PUNC">(</span><span class="STRN">"index is out of range: "</span><span class="PUNC">+</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">getComponent</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">switch</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">:</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.x</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 50</span> </span><span class="KEYW">case</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="PUNC">:</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.y</span><span class="PUNC">;</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="NUMB">2</span><span class="PUNC">:</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.z</span><span class="PUNC">;</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="NUMB">3</span><span class="PUNC">:</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.w</span><span class="PUNC">;</span><span class="KEYW">default</span><span class="PUNC">:</span><span class="KEYW">throw</span><span class="WHIT"> </span><span class="NAME">Error</span><span class="PUNC">(</span><span class="STRN">"index is out of range: "</span><span class="PUNC">+</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">copy</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.x</span><span class="PUNC">=</span><span class="NAME">a.x</span><span class="PUNC">;</span><span class="NAME">this.y</span><span class="PUNC">=</span><span class="NAME">a.y</span><span class="PUNC">;</span><span class="NAME">this.z</span><span class="PUNC">=</span><span class="NAME">a.z</span><span class="PUNC">;</span><span class="NAME">this.w</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">a.w</span><span class="PUNC">?</span><span class="NAME">a.w</span><span class="PUNC">:</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">add</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">b</span><span class="PUNC">)</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">console.warn</span><span class="PUNC">(</span><span class="STRN">"DEPRECATED: Vector4's .add() now only accepts one argument. Use .addVectors( a, b ) instead."</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this.addVectors</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.x</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">a.x</span><span class="PUNC">;</span><span class="NAME">this.y</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">a.y</span><span class="PUNC">;</span><span class="NAME">this.z</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">a.z</span><span class="PUNC">;</span><span class="NAME">this.w</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">a.w</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">addScalar</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.x</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">this.y</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">this.z</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">this.w</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'> 51</span> </span><span class="NAME">addVectors</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.x</span><span class="PUNC">=</span><span class="NAME">a.x</span><span class="PUNC">+</span><span class="NAME">b.x</span><span class="PUNC">;</span><span class="NAME">this.y</span><span class="PUNC">=</span><span class="NAME">a.y</span><span class="PUNC">+</span><span class="NAME">b.y</span><span class="PUNC">;</span><span class="NAME">this.z</span><span class="PUNC">=</span><span class="NAME">a.z</span><span class="PUNC">+</span><span class="NAME">b.z</span><span class="PUNC">;</span><span class="NAME">this.w</span><span class="PUNC">=</span><span class="NAME">a.w</span><span class="PUNC">+</span><span class="NAME">b.w</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">sub</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">b</span><span class="PUNC">)</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">console.warn</span><span class="PUNC">(</span><span class="STRN">"DEPRECATED: Vector4's .sub() now only accepts one argument. Use .subVectors( a, b ) instead."</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this.subVectors</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.x</span><span class="PUNC">-</span><span class="PUNC">=</span><span class="NAME">a.x</span><span class="PUNC">;</span><span class="NAME">this.y</span><span class="PUNC">-</span><span class="PUNC">=</span><span class="NAME">a.y</span><span class="PUNC">;</span><span class="NAME">this.z</span><span class="PUNC">-</span><span class="PUNC">=</span><span class="NAME">a.z</span><span class="PUNC">;</span><span class="NAME">this.w</span><span class="PUNC">-</span><span class="PUNC">=</span><span class="NAME">a.w</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">subVectors</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.x</span><span class="PUNC">=</span><span class="NAME">a.x</span><span class="PUNC">-</span><span class="NAME">b.x</span><span class="PUNC">;</span><span class="NAME">this.y</span><span class="PUNC">=</span><span class="NAME">a.y</span><span class="PUNC">-</span><span class="NAME">b.y</span><span class="PUNC">;</span><span class="NAME">this.z</span><span class="PUNC">=</span><span class="NAME">a.z</span><span class="PUNC">-</span><span class="NAME">b.z</span><span class="PUNC">;</span><span class="NAME">this.w</span><span class="PUNC">=</span><span class="NAME">a.w</span><span class="PUNC">-</span><span class="NAME">b.w</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">multiplyScalar</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.x</span><span class="PUNC">*</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">this.y</span><span class="PUNC">*</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">this.z</span><span class="PUNC">*</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">this.w</span><span class="PUNC">*</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'> 52</span> </span><span class="NAME">applyMatrix4</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.x</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.y</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">this.z</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">this.w</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">a.elements</span><span class="PUNC">;</span><span class="NAME">this.x</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">*</span><span class="NAME">b</span><span class="PUNC">+</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">4</span><span class="PUNC">]</span><span class="PUNC">*</span><span class="NAME">c</span><span class="PUNC">+</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">8</span><span class="PUNC">]</span><span class="PUNC">*</span><span class="NAME">d</span><span class="PUNC">+</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">12</span><span class="PUNC">]</span><span class="PUNC">*</span><span class="NAME">e</span><span class="PUNC">;</span><span class="NAME">this.y</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">*</span><span class="NAME">b</span><span class="PUNC">+</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">5</span><span class="PUNC">]</span><span class="PUNC">*</span><span class="NAME">c</span><span class="PUNC">+</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">9</span><span class="PUNC">]</span><span class="PUNC">*</span><span class="NAME">d</span><span class="PUNC">+</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">13</span><span class="PUNC">]</span><span class="PUNC">*</span><span class="NAME">e</span><span class="PUNC">;</span><span class="NAME">this.z</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">*</span><span class="NAME">b</span><span class="PUNC">+</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">6</span><span class="PUNC">]</span><span class="PUNC">*</span><span class="NAME">c</span><span class="PUNC">+</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">10</span><span class="PUNC">]</span><span class="PUNC">*</span><span class="NAME">d</span><span class="PUNC">+</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">14</span><span class="PUNC">]</span><span class="PUNC">*</span><span class="NAME">e</span><span class="PUNC">;</span><span class="NAME">this.w</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">3</span><span class="PUNC">]</span><span class="PUNC">*</span><span class="NAME">b</span><span class="PUNC">+</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">7</span><span class="PUNC">]</span><span class="PUNC">*</span><span class="NAME">c</span><span class="PUNC">+</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">11</span><span class="PUNC">]</span><span class="PUNC">*</span><span class="NAME">d</span><span class="PUNC">+</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">15</span><span class="PUNC">]</span><span class="PUNC">*</span><span class="NAME">e</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">divideScalar</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">a</span><span class="PUNC">?</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">/</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">this.x</span><span class="PUNC">*</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">this.y</span><span class="PUNC">*</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">this.z</span><span class="PUNC">*</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">this.w</span><span class="PUNC">*</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="PUNC">(</span><span class="NAME">this.z</span><span class="PUNC">=</span><span class="NAME">this.y</span><span class="PUNC">=</span><span class="NAME">this.x</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">this.w</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">setAxisAngleFromQuaternion</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.w</span><span class="PUNC">=</span><span class="NUMB">2</span><span class="PUNC">*</span><span class="NAME">Math.acos</span><span class="PUNC">(</span><span class="NAME">a.w</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">Math.sqrt</span><span class="PUNC">(</span><span class="NUMB">1</span><span class="PUNC">-</span><span class="NAME">a.w</span><span class="PUNC">*</span><span class="NAME">a.w</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NUMB">1</span><span class="NAME">E</span><span class="PUNC">-</span><span class="NUMB">4</span><span class="PUNC">></span><span class="NAME">b</span><span class="PUNC">?</span><span class="PUNC">(</span><span class="NAME">this.x</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">this.z</span><span class="PUNC">=</span><span class="NAME">this.y</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="PUNC">(</span><span class="NAME">this.x</span><span class="PUNC">=</span><span class="NAME">a.x</span><span class="PUNC">/</span><span class="NAME">b</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'> 53</span> </span><span class="NAME">this.y</span><span class="PUNC">=</span><span class="NAME">a.y</span><span class="PUNC">/</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">this.z</span><span class="PUNC">=</span><span class="NAME">a.z</span><span class="PUNC">/</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">setAxisAngleFromRotationMatrix</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">a.elements</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">4</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">8</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">5</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">9</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">6</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">j</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">10</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NUMB">0.01</span><span class="PUNC">></span><span class="NAME">Math.abs</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">-</span><span class="NAME">h</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="NUMB">0.01</span><span class="PUNC">></span><span class="NAME">Math.abs</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">-</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="NUMB">0.01</span><span class="PUNC">></span><span class="NAME">Math.abs</span><span class="PUNC">(</span><span class="NAME">i</span><span class="PUNC">-</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NUMB">0.1</span><span class="PUNC">></span><span class="NAME">Math.abs</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">+</span><span class="NAME">h</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="NUMB">0.1</span><span class="PUNC">></span><span class="NAME">Math.abs</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">+</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="NUMB">0.1</span><span class="PUNC">></span><span class="NAME">Math.abs</span><span class="PUNC">(</span><span class="NAME">i</span><span class="PUNC">+</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="NUMB">0.1</span><span class="PUNC">></span><span class="NAME">Math.abs</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">+</span><span class="NAME">g</span><span class="PUNC">+</span><span class="NAME">j</span><span class="PUNC">-</span><span class="NUMB">3</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.set</span><span class="PUNC">(</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="KEYW">this</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">Math.PI</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">=</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">/</span><span class="NUMB">2</span><span class="PUNC">;</span><span class="NAME">g</span><span class="PUNC">=</span><span class="PUNC">(</span><span class="NAME">g</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">/</span><span class="NUMB">2</span><span class="PUNC">;</span><span class="NAME">j</span><span class="PUNC">=</span><span class="PUNC">(</span><span class="NAME">j</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">/</span><span class="NUMB">2</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">=</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">+</span><span class="NAME">h</span><span class="PUNC">)</span><span class="PUNC">/</span><span class="NUMB">4</span><span class="PUNC">;</span><span class="NAME">f</span><span class="PUNC">=</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">+</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">/</span><span class="NUMB">4</span><span class="PUNC">;</span><span class="NAME">i</span><span class="PUNC">=</span><span class="PUNC">(</span><span class="NAME">i</span><span class="PUNC">+</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">/</span><span class="NUMB">4</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">></span><span class="NAME">g</span><span class="PUNC">&&</span><span class="NAME">e</span><span class="PUNC">></span><span class="NAME">j</span><span class="PUNC">?</span><span class="NUMB">0.01</span><span class="PUNC">></span><span class="NAME">e</span><span class="PUNC">?</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NUMB">0.707106781</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">Math.sqrt</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">/</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">f</span><span class="PUNC">/</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">g</span><span class="PUNC">></span><span class="NAME">j</span><span class="PUNC">?</span><span class="NUMB">0.01</span><span class="PUNC">></span><span class="NAME">g</span><span class="PUNC">?</span><span class="WHIT">
<span class='line'> 54</span> </span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NUMB">0.707106781</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NUMB">0.707106781</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">Math.sqrt</span><span class="PUNC">(</span><span class="NAME">g</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">/</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">i</span><span class="PUNC">/</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NUMB">0.01</span><span class="PUNC">></span><span class="NAME">j</span><span class="PUNC">?</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NUMB">0.707106781</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">Math.sqrt</span><span class="PUNC">(</span><span class="NAME">j</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">f</span><span class="PUNC">/</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">i</span><span class="PUNC">/</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.set</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">}</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">Math.sqrt</span><span class="PUNC">(</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">-</span><span class="NAME">i</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">-</span><span class="NAME">i</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">-</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">-</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="PUNC">(</span><span class="NAME">h</span><span class="PUNC">-</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">h</span><span class="PUNC">-</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NUMB">0.001</span><span class="PUNC">></span><span class="NAME">Math.abs</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.x</span><span class="PUNC">=</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">-</span><span class="NAME">i</span><span class="PUNC">)</span><span class="PUNC">/</span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">this.y</span><span class="PUNC">=</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">-</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">/</span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">this.z</span><span class="PUNC">=</span><span class="PUNC">(</span><span class="NAME">h</span><span class="PUNC">-</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">/</span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">this.w</span><span class="PUNC">=</span><span class="NAME">Math.acos</span><span class="PUNC">(</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">+</span><span class="NAME">g</span><span class="PUNC">+</span><span class="NAME">j</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">/</span><span class="NUMB">2</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">min</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.x</span><span class="PUNC">></span><span class="NAME">a.x</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">this.x</span><span class="PUNC">=</span><span class="NAME">a.x</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.y</span><span class="PUNC">></span><span class="NAME">a.y</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">this.y</span><span class="PUNC">=</span><span class="NAME">a.y</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.z</span><span class="PUNC">></span><span class="NAME">a.z</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">this.z</span><span class="PUNC">=</span><span class="NAME">a.z</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.w</span><span class="PUNC">></span><span class="NAME">a.w</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">this.w</span><span class="PUNC">=</span><span class="NAME">a.w</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">max</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.x</span><span class="PUNC">&lt;</span><span class="NAME">a.x</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">this.x</span><span class="PUNC">=</span><span class="NAME">a.x</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.y</span><span class="PUNC">&lt;</span><span class="NAME">a.y</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">this.y</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'> 55</span> </span><span class="NAME">a.y</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.z</span><span class="PUNC">&lt;</span><span class="NAME">a.z</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">this.z</span><span class="PUNC">=</span><span class="NAME">a.z</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.w</span><span class="PUNC">&lt;</span><span class="NAME">a.w</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">this.w</span><span class="PUNC">=</span><span class="NAME">a.w</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">clamp</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.x</span><span class="PUNC">&lt;</span><span class="NAME">a.x</span><span class="PUNC">?</span><span class="NAME">this.x</span><span class="PUNC">=</span><span class="NAME">a.x</span><span class="PUNC">:</span><span class="NAME">this.x</span><span class="PUNC">></span><span class="NAME">b.x</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">this.x</span><span class="PUNC">=</span><span class="NAME">b.x</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.y</span><span class="PUNC">&lt;</span><span class="NAME">a.y</span><span class="PUNC">?</span><span class="NAME">this.y</span><span class="PUNC">=</span><span class="NAME">a.y</span><span class="PUNC">:</span><span class="NAME">this.y</span><span class="PUNC">></span><span class="NAME">b.y</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">this.y</span><span class="PUNC">=</span><span class="NAME">b.y</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.z</span><span class="PUNC">&lt;</span><span class="NAME">a.z</span><span class="PUNC">?</span><span class="NAME">this.z</span><span class="PUNC">=</span><span class="NAME">a.z</span><span class="PUNC">:</span><span class="NAME">this.z</span><span class="PUNC">></span><span class="NAME">b.z</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">this.z</span><span class="PUNC">=</span><span class="NAME">b.z</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.w</span><span class="PUNC">&lt;</span><span class="NAME">a.w</span><span class="PUNC">?</span><span class="NAME">this.w</span><span class="PUNC">=</span><span class="NAME">a.w</span><span class="PUNC">:</span><span class="NAME">this.w</span><span class="PUNC">></span><span class="NAME">b.w</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">this.w</span><span class="PUNC">=</span><span class="NAME">b.w</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">negate</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.multiplyScalar</span><span class="PUNC">(</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">dot</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.x</span><span class="PUNC">*</span><span class="NAME">a.x</span><span class="PUNC">+</span><span class="NAME">this.y</span><span class="PUNC">*</span><span class="NAME">a.y</span><span class="PUNC">+</span><span class="NAME">this.z</span><span class="PUNC">*</span><span class="NAME">a.z</span><span class="PUNC">+</span><span class="NAME">this.w</span><span class="PUNC">*</span><span class="NAME">a.w</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">lengthSq</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.x</span><span class="PUNC">*</span><span class="NAME">this.x</span><span class="PUNC">+</span><span class="NAME">this.y</span><span class="PUNC">*</span><span class="NAME">this.y</span><span class="PUNC">+</span><span class="NAME">this.z</span><span class="PUNC">*</span><span class="NAME">this.z</span><span class="PUNC">+</span><span class="NAME">this.w</span><span class="PUNC">*</span><span class="NAME">this.w</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">length</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">Math.sqrt</span><span class="PUNC">(</span><span class="NAME">this.x</span><span class="PUNC">*</span><span class="WHIT">
<span class='line'> 56</span> </span><span class="NAME">this.x</span><span class="PUNC">+</span><span class="NAME">this.y</span><span class="PUNC">*</span><span class="NAME">this.y</span><span class="PUNC">+</span><span class="NAME">this.z</span><span class="PUNC">*</span><span class="NAME">this.z</span><span class="PUNC">+</span><span class="NAME">this.w</span><span class="PUNC">*</span><span class="NAME">this.w</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">lengthManhattan</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">Math.abs</span><span class="PUNC">(</span><span class="NAME">this.x</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="NAME">Math.abs</span><span class="PUNC">(</span><span class="NAME">this.y</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="NAME">Math.abs</span><span class="PUNC">(</span><span class="NAME">this.z</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="NAME">Math.abs</span><span class="PUNC">(</span><span class="NAME">this.w</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">normalize</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.divideScalar</span><span class="PUNC">(</span><span class="NAME">this.length</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">setLength</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.length</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">b</span><span class="PUNC">&&</span><span class="NAME">a</span><span class="PUNC">!==</span><span class="NAME">b</span><span class="PUNC">&&</span><span class="NAME">this.multiplyScalar</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">/</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">lerp</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.x</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="PUNC">(</span><span class="NAME">a.x</span><span class="PUNC">-</span><span class="NAME">this.x</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">b</span><span class="PUNC">;</span><span class="NAME">this.y</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="PUNC">(</span><span class="NAME">a.y</span><span class="PUNC">-</span><span class="NAME">this.y</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">b</span><span class="PUNC">;</span><span class="NAME">this.z</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="PUNC">(</span><span class="NAME">a.z</span><span class="PUNC">-</span><span class="NAME">this.z</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">b</span><span class="PUNC">;</span><span class="NAME">this.w</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="PUNC">(</span><span class="NAME">a.w</span><span class="PUNC">-</span><span class="NAME">this.w</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">b</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">equals</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a.x</span><span class="PUNC">===</span><span class="NAME">this.x</span><span class="PUNC">&&</span><span class="NAME">a.y</span><span class="PUNC">===</span><span class="NAME">this.y</span><span class="PUNC">&&</span><span class="NAME">a.z</span><span class="PUNC">===</span><span class="NAME">this.z</span><span class="PUNC">&&</span><span class="WHIT">
<span class='line'> 57</span> </span><span class="NAME">a.w</span><span class="PUNC">===</span><span class="NAME">this.w</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">fromArray</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.x</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">this.y</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">this.z</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">this.w</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">3</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">toArray</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="PUNC">[</span><span class="NAME">this.x</span><span class="PUNC">,</span><span class="NAME">this.y</span><span class="PUNC">,</span><span class="NAME">this.z</span><span class="PUNC">,</span><span class="NAME">this.w</span><span class="PUNC">]</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">clone</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector4</span><span class="PUNC">(</span><span class="NAME">this.x</span><span class="PUNC">,</span><span class="NAME">this.y</span><span class="PUNC">,</span><span class="NAME">this.z</span><span class="PUNC">,</span><span class="NAME">this.w</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.Euler</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this._x</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">||</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">this._y</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">||</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">this._z</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">||</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">this._order</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">||</span><span class="NAME">THREE.Euler.DefaultOrder</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.Euler.RotationOrders</span><span class="PUNC">=</span><span class="STRN">"XYZ YZX ZXY XZY YXZ ZYX"</span><span class="PUNC">.</span><span class="NAME">split</span><span class="PUNC">(</span><span class="STRN">" "</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">THREE.Euler.DefaultOrder</span><span class="PUNC">=</span><span class="STRN">"XYZ"</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 58</span> </span><span class="NAME">THREE.Euler.prototype</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="NAME">constructor</span><span class="PUNC">:</span><span class="NAME">THREE.Euler</span><span class="PUNC">,</span><span class="NAME">_x</span><span class="PUNC">:</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">_y</span><span class="PUNC">:</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">_z</span><span class="PUNC">:</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">_order</span><span class="PUNC">:</span><span class="NAME">THREE.Euler.DefaultOrder</span><span class="PUNC">,</span><span class="NAME">_quaternion</span><span class="PUNC">:</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">_updateQuaternion</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">this._quaternion</span><span class="PUNC">&&</span><span class="NAME">this._quaternion.setFromEuler</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">get</span><span class="WHIT"> </span><span class="NAME">x</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this._x</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">set</span><span class="WHIT"> </span><span class="NAME">x</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this._x</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">this._updateQuaternion</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">get</span><span class="WHIT"> </span><span class="NAME">y</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this._y</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">set</span><span class="WHIT"> </span><span class="NAME">y</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this._y</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">this._updateQuaternion</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">get</span><span class="WHIT"> </span><span class="NAME">z</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this._z</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">set</span><span class="WHIT"> </span><span class="NAME">z</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this._z</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">this._updateQuaternion</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">get</span><span class="WHIT"> </span><span class="NAME">order</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this._order</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">set</span><span class="WHIT"> </span><span class="NAME">order</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this._order</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">this._updateQuaternion</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'> 59</span> </span><span class="NAME">set</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this._x</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">this._y</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">;</span><span class="NAME">this._z</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">;</span><span class="NAME">this._order</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">||</span><span class="NAME">this._order</span><span class="PUNC">;</span><span class="NAME">this._updateQuaternion</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">copy</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this._x</span><span class="PUNC">=</span><span class="NAME">a._x</span><span class="PUNC">;</span><span class="NAME">this._y</span><span class="PUNC">=</span><span class="NAME">a._y</span><span class="PUNC">;</span><span class="NAME">this._z</span><span class="PUNC">=</span><span class="NAME">a._z</span><span class="PUNC">;</span><span class="NAME">this._order</span><span class="PUNC">=</span><span class="NAME">a._order</span><span class="PUNC">;</span><span class="NAME">this._updateQuaternion</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">setFromRotationMatrix</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">Math.min</span><span class="PUNC">(</span><span class="NAME">Math.max</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">a.elements</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">[</span><span class="NUMB">4</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">[</span><span class="NUMB">8</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">[</span><span class="NUMB">5</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">j</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">[</span><span class="NUMB">9</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">l</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">[</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">m</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">[</span><span class="NUMB">6</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">[</span><span class="NUMB">10</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">||</span><span class="NAME">this._order</span><span class="PUNC">;</span><span class="STRN">"XYZ"</span><span class="PUNC">===</span><span class="NAME">b</span><span class="PUNC">?</span><span class="PUNC">(</span><span class="NAME">this._y</span><span class="PUNC">=</span><span class="NAME">Math.asin</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">(</span><span class="NAME">h</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NUMB">0.99999</span><span class="PUNC">></span><span class="NAME">Math.abs</span><span class="PUNC">(</span><span class="NAME">h</span><span class="PUNC">)</span><span class="PUNC">?</span><span class="PUNC">(</span><span class="NAME">this._x</span><span class="PUNC">=</span><span class="NAME">Math.atan2</span><span class="PUNC">(</span><span class="PUNC">-</span><span class="NAME">j</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this._z</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'> 60</span> </span><span class="NAME">Math.atan2</span><span class="PUNC">(</span><span class="PUNC">-</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="PUNC">(</span><span class="NAME">this._x</span><span class="PUNC">=</span><span class="NAME">Math.atan2</span><span class="PUNC">(</span><span class="NAME">m</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this._z</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="STRN">"YXZ"</span><span class="PUNC">===</span><span class="NAME">b</span><span class="PUNC">?</span><span class="PUNC">(</span><span class="NAME">this._x</span><span class="PUNC">=</span><span class="NAME">Math.asin</span><span class="PUNC">(</span><span class="PUNC">-</span><span class="NAME">c</span><span class="PUNC">(</span><span class="NAME">j</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NUMB">0.99999</span><span class="PUNC">></span><span class="NAME">Math.abs</span><span class="PUNC">(</span><span class="NAME">j</span><span class="PUNC">)</span><span class="PUNC">?</span><span class="PUNC">(</span><span class="NAME">this._y</span><span class="PUNC">=</span><span class="NAME">Math.atan2</span><span class="PUNC">(</span><span class="NAME">h</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this._z</span><span class="PUNC">=</span><span class="NAME">Math.atan2</span><span class="PUNC">(</span><span class="NAME">g</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="PUNC">(</span><span class="NAME">this._y</span><span class="PUNC">=</span><span class="NAME">Math.atan2</span><span class="PUNC">(</span><span class="PUNC">-</span><span class="NAME">l</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this._z</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="STRN">"ZXY"</span><span class="PUNC">===</span><span class="NAME">b</span><span class="PUNC">?</span><span class="PUNC">(</span><span class="NAME">this._x</span><span class="PUNC">=</span><span class="NAME">Math.asin</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">(</span><span class="NAME">m</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NUMB">0.99999</span><span class="PUNC">></span><span class="NAME">Math.abs</span><span class="PUNC">(</span><span class="NAME">m</span><span class="PUNC">)</span><span class="PUNC">?</span><span class="PUNC">(</span><span class="NAME">this._y</span><span class="PUNC">=</span><span class="NAME">Math.atan2</span><span class="PUNC">(</span><span class="PUNC">-</span><span class="NAME">l</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this._z</span><span class="PUNC">=</span><span class="NAME">Math.atan2</span><span class="PUNC">(</span><span class="PUNC">-</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="PUNC">(</span><span class="NAME">this._y</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">this._z</span><span class="PUNC">=</span><span class="NAME">Math.atan2</span><span class="PUNC">(</span><span class="NAME">g</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="STRN">"ZYX"</span><span class="PUNC">===</span><span class="NAME">b</span><span class="PUNC">?</span><span class="PUNC">(</span><span class="NAME">this._y</span><span class="PUNC">=</span><span class="NAME">Math.asin</span><span class="PUNC">(</span><span class="PUNC">-</span><span class="NAME">c</span><span class="PUNC">(</span><span class="NAME">l</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NUMB">0.99999</span><span class="PUNC">></span><span class="NAME">Math.abs</span><span class="PUNC">(</span><span class="NAME">l</span><span class="PUNC">)</span><span class="PUNC">?</span><span class="PUNC">(</span><span class="NAME">this._x</span><span class="PUNC">=</span><span class="NAME">Math.atan2</span><span class="PUNC">(</span><span class="NAME">m</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this._z</span><span class="PUNC">=</span><span class="NAME">Math.atan2</span><span class="PUNC">(</span><span class="NAME">g</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="PUNC">(</span><span class="NAME">this._x</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">this._z</span><span class="PUNC">=</span><span class="NAME">Math.atan2</span><span class="PUNC">(</span><span class="PUNC">-</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="STRN">"YZX"</span><span class="PUNC">===</span><span class="NAME">b</span><span class="PUNC">?</span><span class="PUNC">(</span><span class="NAME">this._z</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'> 61</span> </span><span class="NAME">Math.asin</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">(</span><span class="NAME">g</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NUMB">0.99999</span><span class="PUNC">></span><span class="NAME">Math.abs</span><span class="PUNC">(</span><span class="NAME">g</span><span class="PUNC">)</span><span class="PUNC">?</span><span class="PUNC">(</span><span class="NAME">this._x</span><span class="PUNC">=</span><span class="NAME">Math.atan2</span><span class="PUNC">(</span><span class="PUNC">-</span><span class="NAME">j</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this._y</span><span class="PUNC">=</span><span class="NAME">Math.atan2</span><span class="PUNC">(</span><span class="PUNC">-</span><span class="NAME">l</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="PUNC">(</span><span class="NAME">this._x</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">this._y</span><span class="PUNC">=</span><span class="NAME">Math.atan2</span><span class="PUNC">(</span><span class="NAME">h</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="STRN">"XZY"</span><span class="PUNC">===</span><span class="NAME">b</span><span class="PUNC">?</span><span class="PUNC">(</span><span class="NAME">this._z</span><span class="PUNC">=</span><span class="NAME">Math.asin</span><span class="PUNC">(</span><span class="PUNC">-</span><span class="NAME">c</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NUMB">0.99999</span><span class="PUNC">></span><span class="NAME">Math.abs</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">?</span><span class="PUNC">(</span><span class="NAME">this._x</span><span class="PUNC">=</span><span class="NAME">Math.atan2</span><span class="PUNC">(</span><span class="NAME">m</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this._y</span><span class="PUNC">=</span><span class="NAME">Math.atan2</span><span class="PUNC">(</span><span class="NAME">h</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="PUNC">(</span><span class="NAME">this._x</span><span class="PUNC">=</span><span class="NAME">Math.atan2</span><span class="PUNC">(</span><span class="PUNC">-</span><span class="NAME">j</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this._y</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">console.warn</span><span class="PUNC">(</span><span class="STRN">"WARNING: Euler.setFromRotationMatrix() given unsupported order: "</span><span class="PUNC">+</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this._order</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">;</span><span class="NAME">this._updateQuaternion</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">setFromQuaternion</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">Math.min</span><span class="PUNC">(</span><span class="NAME">Math.max</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">a.x</span><span class="PUNC">*</span><span class="NAME">a.x</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'> 62</span> </span><span class="NAME">a.y</span><span class="PUNC">*</span><span class="NAME">a.y</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">a.z</span><span class="PUNC">*</span><span class="NAME">a.z</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">a.w</span><span class="PUNC">*</span><span class="NAME">a.w</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">||</span><span class="NAME">this._order</span><span class="PUNC">;</span><span class="STRN">"XYZ"</span><span class="PUNC">===</span><span class="NAME">b</span><span class="PUNC">?</span><span class="PUNC">(</span><span class="NAME">this._x</span><span class="PUNC">=</span><span class="NAME">Math.atan2</span><span class="PUNC">(</span><span class="NUMB">2</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">a.x</span><span class="PUNC">*</span><span class="NAME">a.w</span><span class="PUNC">-</span><span class="NAME">a.y</span><span class="PUNC">*</span><span class="NAME">a.z</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">-</span><span class="NAME">e</span><span class="PUNC">-</span><span class="NAME">f</span><span class="PUNC">+</span><span class="NAME">h</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this._y</span><span class="PUNC">=</span><span class="NAME">Math.asin</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">(</span><span class="NUMB">2</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">a.x</span><span class="PUNC">*</span><span class="NAME">a.z</span><span class="PUNC">+</span><span class="NAME">a.y</span><span class="PUNC">*</span><span class="NAME">a.w</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this._z</span><span class="PUNC">=</span><span class="NAME">Math.atan2</span><span class="PUNC">(</span><span class="NUMB">2</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">a.z</span><span class="PUNC">*</span><span class="NAME">a.w</span><span class="PUNC">-</span><span class="NAME">a.x</span><span class="PUNC">*</span><span class="NAME">a.y</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">+</span><span class="NAME">e</span><span class="PUNC">-</span><span class="NAME">f</span><span class="PUNC">-</span><span class="NAME">h</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="STRN">"YXZ"</span><span class="PUNC">===</span><span class="NAME">b</span><span class="PUNC">?</span><span class="PUNC">(</span><span class="NAME">this._x</span><span class="PUNC">=</span><span class="NAME">Math.asin</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">(</span><span class="NUMB">2</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">a.x</span><span class="PUNC">*</span><span class="NAME">a.w</span><span class="PUNC">-</span><span class="NAME">a.y</span><span class="PUNC">*</span><span class="NAME">a.z</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this._y</span><span class="PUNC">=</span><span class="NAME">Math.atan2</span><span class="PUNC">(</span><span class="NUMB">2</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">a.x</span><span class="PUNC">*</span><span class="NAME">a.z</span><span class="PUNC">+</span><span class="NAME">a.y</span><span class="PUNC">*</span><span class="NAME">a.w</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">-</span><span class="NAME">e</span><span class="PUNC">-</span><span class="NAME">f</span><span class="PUNC">+</span><span class="NAME">h</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this._z</span><span class="PUNC">=</span><span class="NAME">Math.atan2</span><span class="PUNC">(</span><span class="NUMB">2</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">a.x</span><span class="PUNC">*</span><span class="NAME">a.y</span><span class="PUNC">+</span><span class="NAME">a.z</span><span class="PUNC">*</span><span class="NAME">a.w</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">-</span><span class="NAME">e</span><span class="PUNC">+</span><span class="NAME">f</span><span class="PUNC">-</span><span class="NAME">h</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="STRN">"ZXY"</span><span class="PUNC">===</span><span class="NAME">b</span><span class="PUNC">?</span><span class="PUNC">(</span><span class="NAME">this._x</span><span class="PUNC">=</span><span class="NAME">Math.asin</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">(</span><span class="NUMB">2</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">a.x</span><span class="PUNC">*</span><span class="NAME">a.w</span><span class="PUNC">+</span><span class="NAME">a.y</span><span class="PUNC">*</span><span class="NAME">a.z</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this._y</span><span class="PUNC">=</span><span class="NAME">Math.atan2</span><span class="PUNC">(</span><span class="NUMB">2</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">a.y</span><span class="PUNC">*</span><span class="NAME">a.w</span><span class="PUNC">-</span><span class="NAME">a.z</span><span class="PUNC">*</span><span class="NAME">a.x</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">-</span><span class="NAME">e</span><span class="PUNC">-</span><span class="NAME">f</span><span class="PUNC">+</span><span class="NAME">h</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this._z</span><span class="PUNC">=</span><span class="NAME">Math.atan2</span><span class="PUNC">(</span><span class="NUMB">2</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">a.z</span><span class="PUNC">*</span><span class="NAME">a.w</span><span class="PUNC">-</span><span class="NAME">a.x</span><span class="PUNC">*</span><span class="NAME">a.y</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">-</span><span class="NAME">e</span><span class="PUNC">+</span><span class="NAME">f</span><span class="PUNC">-</span><span class="NAME">h</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="STRN">"ZYX"</span><span class="PUNC">===</span><span class="WHIT">
<span class='line'> 63</span> </span><span class="NAME">b</span><span class="PUNC">?</span><span class="PUNC">(</span><span class="NAME">this._x</span><span class="PUNC">=</span><span class="NAME">Math.atan2</span><span class="PUNC">(</span><span class="NUMB">2</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">a.x</span><span class="PUNC">*</span><span class="NAME">a.w</span><span class="PUNC">+</span><span class="NAME">a.z</span><span class="PUNC">*</span><span class="NAME">a.y</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">-</span><span class="NAME">e</span><span class="PUNC">-</span><span class="NAME">f</span><span class="PUNC">+</span><span class="NAME">h</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this._y</span><span class="PUNC">=</span><span class="NAME">Math.asin</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">(</span><span class="NUMB">2</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">a.y</span><span class="PUNC">*</span><span class="NAME">a.w</span><span class="PUNC">-</span><span class="NAME">a.x</span><span class="PUNC">*</span><span class="NAME">a.z</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this._z</span><span class="PUNC">=</span><span class="NAME">Math.atan2</span><span class="PUNC">(</span><span class="NUMB">2</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">a.x</span><span class="PUNC">*</span><span class="NAME">a.y</span><span class="PUNC">+</span><span class="NAME">a.z</span><span class="PUNC">*</span><span class="NAME">a.w</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">+</span><span class="NAME">e</span><span class="PUNC">-</span><span class="NAME">f</span><span class="PUNC">-</span><span class="NAME">h</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="STRN">"YZX"</span><span class="PUNC">===</span><span class="NAME">b</span><span class="PUNC">?</span><span class="PUNC">(</span><span class="NAME">this._x</span><span class="PUNC">=</span><span class="NAME">Math.atan2</span><span class="PUNC">(</span><span class="NUMB">2</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">a.x</span><span class="PUNC">*</span><span class="NAME">a.w</span><span class="PUNC">-</span><span class="NAME">a.z</span><span class="PUNC">*</span><span class="NAME">a.y</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">-</span><span class="NAME">e</span><span class="PUNC">+</span><span class="NAME">f</span><span class="PUNC">-</span><span class="NAME">h</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this._y</span><span class="PUNC">=</span><span class="NAME">Math.atan2</span><span class="PUNC">(</span><span class="NUMB">2</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">a.y</span><span class="PUNC">*</span><span class="NAME">a.w</span><span class="PUNC">-</span><span class="NAME">a.x</span><span class="PUNC">*</span><span class="NAME">a.z</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">+</span><span class="NAME">e</span><span class="PUNC">-</span><span class="NAME">f</span><span class="PUNC">-</span><span class="NAME">h</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this._z</span><span class="PUNC">=</span><span class="NAME">Math.asin</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">(</span><span class="NUMB">2</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">a.x</span><span class="PUNC">*</span><span class="NAME">a.y</span><span class="PUNC">+</span><span class="NAME">a.z</span><span class="PUNC">*</span><span class="NAME">a.w</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="STRN">"XZY"</span><span class="PUNC">===</span><span class="NAME">b</span><span class="PUNC">?</span><span class="PUNC">(</span><span class="NAME">this._x</span><span class="PUNC">=</span><span class="NAME">Math.atan2</span><span class="PUNC">(</span><span class="NUMB">2</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">a.x</span><span class="PUNC">*</span><span class="NAME">a.w</span><span class="PUNC">+</span><span class="NAME">a.y</span><span class="PUNC">*</span><span class="NAME">a.z</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">-</span><span class="NAME">e</span><span class="PUNC">+</span><span class="NAME">f</span><span class="PUNC">-</span><span class="NAME">h</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this._y</span><span class="PUNC">=</span><span class="NAME">Math.atan2</span><span class="PUNC">(</span><span class="NUMB">2</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">a.x</span><span class="PUNC">*</span><span class="NAME">a.z</span><span class="PUNC">+</span><span class="NAME">a.y</span><span class="PUNC">*</span><span class="NAME">a.w</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">+</span><span class="NAME">e</span><span class="PUNC">-</span><span class="NAME">f</span><span class="PUNC">-</span><span class="NAME">h</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this._z</span><span class="PUNC">=</span><span class="NAME">Math.asin</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">(</span><span class="NUMB">2</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">a.z</span><span class="PUNC">*</span><span class="NAME">a.w</span><span class="PUNC">-</span><span class="NAME">a.x</span><span class="PUNC">*</span><span class="NAME">a.y</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">console.warn</span><span class="PUNC">(</span><span class="STRN">"WARNING: Euler.setFromQuaternion() given unsupported order: "</span><span class="PUNC">+</span><span class="WHIT">
<span class='line'> 64</span> </span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this._order</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">;</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">!==</span><span class="NAME">c</span><span class="PUNC">&&</span><span class="NAME">this._updateQuaternion</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">reorder</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Quaternion</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">a.setFromEuler</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.setFromQuaternion</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">fromArray</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this._x</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">this._y</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">this._z</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">3</span><span class="PUNC">]</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">this._order</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">3</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this._updateQuaternion</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">toArray</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="PUNC">[</span><span class="NAME">this._x</span><span class="PUNC">,</span><span class="NAME">this._y</span><span class="PUNC">,</span><span class="NAME">this._z</span><span class="PUNC">,</span><span class="NAME">this._order</span><span class="PUNC">]</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">equals</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a._x</span><span class="PUNC">===</span><span class="NAME">this._x</span><span class="PUNC">&&</span><span class="NAME">a._y</span><span class="PUNC">===</span><span class="NAME">this._y</span><span class="PUNC">&&</span><span class="NAME">a._z</span><span class="PUNC">===</span><span class="NAME">this._z</span><span class="PUNC">&&</span><span class="NAME">a._order</span><span class="PUNC">===</span><span class="NAME">this._order</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">clone</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Euler</span><span class="PUNC">(</span><span class="NAME">this._x</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'> 65</span> </span><span class="NAME">this._y</span><span class="PUNC">,</span><span class="NAME">this._z</span><span class="PUNC">,</span><span class="NAME">this._order</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.Line3</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.start</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">a</span><span class="PUNC">?</span><span class="NAME">a</span><span class="PUNC">:</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">;</span><span class="NAME">this.end</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">b</span><span class="PUNC">?</span><span class="NAME">b</span><span class="PUNC">:</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 66</span> </span><span class="NAME">THREE.Line3.prototype</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="NAME">constructor</span><span class="PUNC">:</span><span class="NAME">THREE.Line3</span><span class="PUNC">,</span><span class="NAME">set</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.start.copy</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.end.copy</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">copy</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.start.copy</span><span class="PUNC">(</span><span class="NAME">a.start</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.end.copy</span><span class="PUNC">(</span><span class="NAME">a.end</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">center</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">||</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">addVectors</span><span class="PUNC">(</span><span class="NAME">this.start</span><span class="PUNC">,</span><span class="NAME">this.end</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">multiplyScalar</span><span class="PUNC">(</span><span class="NUMB">0.5</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">delta</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">||</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">subVectors</span><span class="PUNC">(</span><span class="NAME">this.end</span><span class="PUNC">,</span><span class="NAME">this.start</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">distanceSq</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.start.distanceToSquared</span><span class="PUNC">(</span><span class="NAME">this.end</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">distance</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.start.distanceTo</span><span class="PUNC">(</span><span class="NAME">this.end</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">at</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'> 67</span> </span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">||</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.delta</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">multiplyScalar</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">add</span><span class="PUNC">(</span><span class="NAME">this.start</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">closestPointToPointParameter</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">a.subVectors</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">this.start</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b.subVectors</span><span class="PUNC">(</span><span class="NAME">this.end</span><span class="PUNC">,</span><span class="NAME">this.start</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">b.dot</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">b.dot</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">/</span><span class="NAME">e</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">THREE.Math.clamp</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">e</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">closestPointToPoint</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">this.closestPointToPointParameter</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">||</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.delta</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">multiplyScalar</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">add</span><span class="PUNC">(</span><span class="NAME">this.start</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">applyMatrix4</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.start.applyMatrix4</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 68</span> </span><span class="NAME">this.end.applyMatrix4</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">equals</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a.start.equals</span><span class="PUNC">(</span><span class="NAME">this.start</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="NAME">a.end.equals</span><span class="PUNC">(</span><span class="NAME">this.end</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">clone</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="PUNC">(</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Line3</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">copy</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.Box2</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.min</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">a</span><span class="PUNC">?</span><span class="NAME">a</span><span class="PUNC">:</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector2</span><span class="PUNC">(</span><span class="NAME">Infinity</span><span class="PUNC">,</span><span class="NAME">Infinity</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.max</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">b</span><span class="PUNC">?</span><span class="NAME">b</span><span class="PUNC">:</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector2</span><span class="PUNC">(</span><span class="PUNC">-</span><span class="NAME">Infinity</span><span class="PUNC">,</span><span class="PUNC">-</span><span class="NAME">Infinity</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 69</span> </span><span class="NAME">THREE.Box2.prototype</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="NAME">constructor</span><span class="PUNC">:</span><span class="NAME">THREE.Box2</span><span class="PUNC">,</span><span class="NAME">set</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.min.copy</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.max.copy</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">setFromPoints</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">&lt;</span><span class="NAME">a.length</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">this.min.copy</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.max.copy</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">a.length</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">&lt;</span><span class="NAME">d</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">b.x</span><span class="PUNC">&lt;</span><span class="NAME">this.min.x</span><span class="PUNC">?</span><span class="NAME">this.min.x</span><span class="PUNC">=</span><span class="NAME">b.x</span><span class="PUNC">:</span><span class="NAME">b.x</span><span class="PUNC">></span><span class="NAME">this.max.x</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">this.max.x</span><span class="PUNC">=</span><span class="NAME">b.x</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">b.y</span><span class="PUNC">&lt;</span><span class="NAME">this.min.y</span><span class="PUNC">?</span><span class="NAME">this.min.y</span><span class="PUNC">=</span><span class="NAME">b.y</span><span class="PUNC">:</span><span class="NAME">b.y</span><span class="PUNC">></span><span class="NAME">this.max.y</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">this.max.y</span><span class="PUNC">=</span><span class="NAME">b.y</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="NAME">this.makeEmpty</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">setFromCenterAndSize</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector2</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">a.copy</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">multiplyScalar</span><span class="PUNC">(</span><span class="NUMB">0.5</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 70</span> </span><span class="NAME">this.min.copy</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">sub</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.max.copy</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">add</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">copy</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.min.copy</span><span class="PUNC">(</span><span class="NAME">a.min</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.max.copy</span><span class="PUNC">(</span><span class="NAME">a.max</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">makeEmpty</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.min.x</span><span class="PUNC">=</span><span class="NAME">this.min.y</span><span class="PUNC">=</span><span class="NAME">Infinity</span><span class="PUNC">;</span><span class="NAME">this.max.x</span><span class="PUNC">=</span><span class="NAME">this.max.y</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="NAME">Infinity</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">empty</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.max.x</span><span class="PUNC">&lt;</span><span class="NAME">this.min.x</span><span class="PUNC">||</span><span class="NAME">this.max.y</span><span class="PUNC">&lt;</span><span class="NAME">this.min.y</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">center</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">||</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector2</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">addVectors</span><span class="PUNC">(</span><span class="NAME">this.min</span><span class="PUNC">,</span><span class="NAME">this.max</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">multiplyScalar</span><span class="PUNC">(</span><span class="NUMB">0.5</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">size</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">||</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector2</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">subVectors</span><span class="PUNC">(</span><span class="NAME">this.max</span><span class="PUNC">,</span><span class="NAME">this.min</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">expandByPoint</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.min.min</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 71</span> </span><span class="NAME">this.max.max</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">expandByVector</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.min.sub</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.max.add</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">expandByScalar</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.min.addScalar</span><span class="PUNC">(</span><span class="PUNC">-</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.max.addScalar</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">containsPoint</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a.x</span><span class="PUNC">&lt;</span><span class="NAME">this.min.x</span><span class="PUNC">||</span><span class="NAME">a.x</span><span class="PUNC">></span><span class="NAME">this.max.x</span><span class="PUNC">||</span><span class="NAME">a.y</span><span class="PUNC">&lt;</span><span class="NAME">this.min.y</span><span class="PUNC">||</span><span class="NAME">a.y</span><span class="PUNC">></span><span class="NAME">this.max.y</span><span class="PUNC">?</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">:</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">containsBox</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.min.x</span><span class="PUNC">&lt;=</span><span class="NAME">a.min.x</span><span class="PUNC">&&</span><span class="NAME">a.max.x</span><span class="PUNC">&lt;=</span><span class="NAME">this.max.x</span><span class="PUNC">&&</span><span class="NAME">this.min.y</span><span class="PUNC">&lt;=</span><span class="NAME">a.min.y</span><span class="PUNC">&&</span><span class="NAME">a.max.y</span><span class="PUNC">&lt;=</span><span class="NAME">this.max.y</span><span class="PUNC">?</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">:</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">getParameter</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector2</span><span class="PUNC">(</span><span class="PUNC">(</span><span class="NAME">a.x</span><span class="PUNC">-</span><span class="NAME">this.min.x</span><span class="PUNC">)</span><span class="PUNC">/</span><span class="PUNC">(</span><span class="NAME">this.max.x</span><span class="PUNC">-</span><span class="NAME">this.min.x</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'> 72</span> </span><span class="PUNC">(</span><span class="NAME">a.y</span><span class="PUNC">-</span><span class="NAME">this.min.y</span><span class="PUNC">)</span><span class="PUNC">/</span><span class="PUNC">(</span><span class="NAME">this.max.y</span><span class="PUNC">-</span><span class="NAME">this.min.y</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">isIntersectionBox</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a.max.x</span><span class="PUNC">&lt;</span><span class="NAME">this.min.x</span><span class="PUNC">||</span><span class="NAME">a.min.x</span><span class="PUNC">></span><span class="NAME">this.max.x</span><span class="PUNC">||</span><span class="NAME">a.max.y</span><span class="PUNC">&lt;</span><span class="NAME">this.min.y</span><span class="PUNC">||</span><span class="NAME">a.min.y</span><span class="PUNC">></span><span class="NAME">this.max.y</span><span class="PUNC">?</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">:</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">clampPoint</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">||</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector2</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">copy</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">clamp</span><span class="PUNC">(</span><span class="NAME">this.min</span><span class="PUNC">,</span><span class="NAME">this.max</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">distanceToPoint</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector2</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a.copy</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">clamp</span><span class="PUNC">(</span><span class="NAME">this.min</span><span class="PUNC">,</span><span class="NAME">this.max</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">sub</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">length</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">intersect</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.min.max</span><span class="PUNC">(</span><span class="NAME">a.min</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.max.min</span><span class="PUNC">(</span><span class="NAME">a.max</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">union</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.min.min</span><span class="PUNC">(</span><span class="NAME">a.min</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.max.max</span><span class="PUNC">(</span><span class="NAME">a.max</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 73</span> </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">translate</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.min.add</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.max.add</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">equals</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a.min.equals</span><span class="PUNC">(</span><span class="NAME">this.min</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="NAME">a.max.equals</span><span class="PUNC">(</span><span class="NAME">this.max</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">clone</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="PUNC">(</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Box2</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">copy</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.Box3</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.min</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">a</span><span class="PUNC">?</span><span class="NAME">a</span><span class="PUNC">:</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">(</span><span class="NAME">Infinity</span><span class="PUNC">,</span><span class="NAME">Infinity</span><span class="PUNC">,</span><span class="NAME">Infinity</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.max</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">b</span><span class="PUNC">?</span><span class="NAME">b</span><span class="PUNC">:</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">(</span><span class="PUNC">-</span><span class="NAME">Infinity</span><span class="PUNC">,</span><span class="PUNC">-</span><span class="NAME">Infinity</span><span class="PUNC">,</span><span class="PUNC">-</span><span class="NAME">Infinity</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 74</span> </span><span class="NAME">THREE.Box3.prototype</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="NAME">constructor</span><span class="PUNC">:</span><span class="NAME">THREE.Box3</span><span class="PUNC">,</span><span class="NAME">set</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.min.copy</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.max.copy</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">setFromPoints</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">&lt;</span><span class="NAME">a.length</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">this.min.copy</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.max.copy</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">a.length</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">&lt;</span><span class="NAME">d</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">b.x</span><span class="PUNC">&lt;</span><span class="NAME">this.min.x</span><span class="PUNC">?</span><span class="NAME">this.min.x</span><span class="PUNC">=</span><span class="NAME">b.x</span><span class="PUNC">:</span><span class="NAME">b.x</span><span class="PUNC">></span><span class="NAME">this.max.x</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">this.max.x</span><span class="PUNC">=</span><span class="NAME">b.x</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">b.y</span><span class="PUNC">&lt;</span><span class="NAME">this.min.y</span><span class="PUNC">?</span><span class="NAME">this.min.y</span><span class="PUNC">=</span><span class="NAME">b.y</span><span class="PUNC">:</span><span class="NAME">b.y</span><span class="PUNC">></span><span class="NAME">this.max.y</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">this.max.y</span><span class="PUNC">=</span><span class="NAME">b.y</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">b.z</span><span class="PUNC">&lt;</span><span class="NAME">this.min.z</span><span class="PUNC">?</span><span class="NAME">this.min.z</span><span class="PUNC">=</span><span class="NAME">b.z</span><span class="PUNC">:</span><span class="NAME">b.z</span><span class="PUNC">></span><span class="NAME">this.max.z</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">this.max.z</span><span class="PUNC">=</span><span class="NAME">b.z</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="NAME">this.makeEmpty</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">setFromCenterAndSize</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 75</span> </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">a.copy</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">multiplyScalar</span><span class="PUNC">(</span><span class="NUMB">0.5</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.min.copy</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">sub</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.max.copy</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">add</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">setFromObject</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="KEYW">this</span><span class="PUNC">;</span><span class="NAME">b.updateMatrixWorld</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.makeEmpty</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b.traverse</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">b.geometry</span><span class="PUNC">&&</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">b.geometry.vertices</span><span class="PUNC">)</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">b.geometry.vertices</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">e.length</span><span class="PUNC">;</span><span class="NAME">f</span><span class="PUNC">&lt;</span><span class="NAME">h</span><span class="PUNC">;</span><span class="NAME">f</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">a.copy</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">[</span><span class="NAME">f</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">a.applyMatrix4</span><span class="PUNC">(</span><span class="NAME">b.matrixWorld</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">c.expandByPoint</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">copy</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.min.copy</span><span class="PUNC">(</span><span class="NAME">a.min</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.max.copy</span><span class="PUNC">(</span><span class="NAME">a.max</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 76</span> </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">makeEmpty</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.min.x</span><span class="PUNC">=</span><span class="NAME">this.min.y</span><span class="PUNC">=</span><span class="NAME">this.min.z</span><span class="PUNC">=</span><span class="NAME">Infinity</span><span class="PUNC">;</span><span class="NAME">this.max.x</span><span class="PUNC">=</span><span class="NAME">this.max.y</span><span class="PUNC">=</span><span class="NAME">this.max.z</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="NAME">Infinity</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">empty</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.max.x</span><span class="PUNC">&lt;</span><span class="NAME">this.min.x</span><span class="PUNC">||</span><span class="NAME">this.max.y</span><span class="PUNC">&lt;</span><span class="NAME">this.min.y</span><span class="PUNC">||</span><span class="NAME">this.max.z</span><span class="PUNC">&lt;</span><span class="NAME">this.min.z</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">center</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">||</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">addVectors</span><span class="PUNC">(</span><span class="NAME">this.min</span><span class="PUNC">,</span><span class="NAME">this.max</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">multiplyScalar</span><span class="PUNC">(</span><span class="NUMB">0.5</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">size</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">||</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">subVectors</span><span class="PUNC">(</span><span class="NAME">this.max</span><span class="PUNC">,</span><span class="NAME">this.min</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">expandByPoint</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.min.min</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.max.max</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">expandByVector</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.min.sub</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 77</span> </span><span class="NAME">this.max.add</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">expandByScalar</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.min.addScalar</span><span class="PUNC">(</span><span class="PUNC">-</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.max.addScalar</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">containsPoint</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a.x</span><span class="PUNC">&lt;</span><span class="NAME">this.min.x</span><span class="PUNC">||</span><span class="NAME">a.x</span><span class="PUNC">></span><span class="NAME">this.max.x</span><span class="PUNC">||</span><span class="NAME">a.y</span><span class="PUNC">&lt;</span><span class="NAME">this.min.y</span><span class="PUNC">||</span><span class="NAME">a.y</span><span class="PUNC">></span><span class="NAME">this.max.y</span><span class="PUNC">||</span><span class="NAME">a.z</span><span class="PUNC">&lt;</span><span class="NAME">this.min.z</span><span class="PUNC">||</span><span class="NAME">a.z</span><span class="PUNC">></span><span class="NAME">this.max.z</span><span class="PUNC">?</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">:</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">containsBox</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.min.x</span><span class="PUNC">&lt;=</span><span class="NAME">a.min.x</span><span class="PUNC">&&</span><span class="NAME">a.max.x</span><span class="PUNC">&lt;=</span><span class="NAME">this.max.x</span><span class="PUNC">&&</span><span class="NAME">this.min.y</span><span class="PUNC">&lt;=</span><span class="NAME">a.min.y</span><span class="PUNC">&&</span><span class="NAME">a.max.y</span><span class="PUNC">&lt;=</span><span class="NAME">this.max.y</span><span class="PUNC">&&</span><span class="NAME">this.min.z</span><span class="PUNC">&lt;=</span><span class="NAME">a.min.z</span><span class="PUNC">&&</span><span class="NAME">a.max.z</span><span class="PUNC">&lt;=</span><span class="NAME">this.max.z</span><span class="PUNC">?</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">:</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">getParameter</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">(</span><span class="PUNC">(</span><span class="NAME">a.x</span><span class="PUNC">-</span><span class="NAME">this.min.x</span><span class="PUNC">)</span><span class="PUNC">/</span><span class="PUNC">(</span><span class="NAME">this.max.x</span><span class="PUNC">-</span><span class="NAME">this.min.x</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'> 78</span> </span><span class="PUNC">(</span><span class="NAME">a.y</span><span class="PUNC">-</span><span class="NAME">this.min.y</span><span class="PUNC">)</span><span class="PUNC">/</span><span class="PUNC">(</span><span class="NAME">this.max.y</span><span class="PUNC">-</span><span class="NAME">this.min.y</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="PUNC">(</span><span class="NAME">a.z</span><span class="PUNC">-</span><span class="NAME">this.min.z</span><span class="PUNC">)</span><span class="PUNC">/</span><span class="PUNC">(</span><span class="NAME">this.max.z</span><span class="PUNC">-</span><span class="NAME">this.min.z</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">isIntersectionBox</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a.max.x</span><span class="PUNC">&lt;</span><span class="NAME">this.min.x</span><span class="PUNC">||</span><span class="NAME">a.min.x</span><span class="PUNC">></span><span class="NAME">this.max.x</span><span class="PUNC">||</span><span class="NAME">a.max.y</span><span class="PUNC">&lt;</span><span class="NAME">this.min.y</span><span class="PUNC">||</span><span class="NAME">a.min.y</span><span class="PUNC">></span><span class="NAME">this.max.y</span><span class="PUNC">||</span><span class="NAME">a.max.z</span><span class="PUNC">&lt;</span><span class="NAME">this.min.z</span><span class="PUNC">||</span><span class="NAME">a.min.z</span><span class="PUNC">></span><span class="NAME">this.max.z</span><span class="PUNC">?</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">:</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">clampPoint</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">||</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">copy</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">clamp</span><span class="PUNC">(</span><span class="NAME">this.min</span><span class="PUNC">,</span><span class="NAME">this.max</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">distanceToPoint</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a.copy</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">clamp</span><span class="PUNC">(</span><span class="NAME">this.min</span><span class="PUNC">,</span><span class="NAME">this.max</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">sub</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">length</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">getBoundingSphere</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'> 79</span> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">||</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Sphere</span><span class="PUNC">;</span><span class="NAME">b.center</span><span class="PUNC">=</span><span class="NAME">this.center</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b.radius</span><span class="PUNC">=</span><span class="NUMB">0.5</span><span class="PUNC">*</span><span class="NAME">this.size</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">length</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">intersect</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.min.max</span><span class="PUNC">(</span><span class="NAME">a.min</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.max.min</span><span class="PUNC">(</span><span class="NAME">a.max</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">union</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.min.min</span><span class="PUNC">(</span><span class="NAME">a.min</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.max.max</span><span class="PUNC">(</span><span class="NAME">a.max</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">applyMatrix4</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">,</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">,</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">,</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">,</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">,</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">,</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">,</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">set</span><span class="PUNC">(</span><span class="NAME">this.min.x</span><span class="PUNC">,</span><span class="NAME">this.min.y</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'> 80</span> </span><span class="NAME">this.min.z</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">applyMatrix4</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">set</span><span class="PUNC">(</span><span class="NAME">this.min.x</span><span class="PUNC">,</span><span class="NAME">this.min.y</span><span class="PUNC">,</span><span class="NAME">this.max.z</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">applyMatrix4</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">set</span><span class="PUNC">(</span><span class="NAME">this.min.x</span><span class="PUNC">,</span><span class="NAME">this.max.y</span><span class="PUNC">,</span><span class="NAME">this.min.z</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">applyMatrix4</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">3</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">set</span><span class="PUNC">(</span><span class="NAME">this.min.x</span><span class="PUNC">,</span><span class="NAME">this.max.y</span><span class="PUNC">,</span><span class="NAME">this.max.z</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">applyMatrix4</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">4</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">set</span><span class="PUNC">(</span><span class="NAME">this.max.x</span><span class="PUNC">,</span><span class="NAME">this.min.y</span><span class="PUNC">,</span><span class="NAME">this.min.z</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">applyMatrix4</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">5</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">set</span><span class="PUNC">(</span><span class="NAME">this.max.x</span><span class="PUNC">,</span><span class="NAME">this.min.y</span><span class="PUNC">,</span><span class="NAME">this.max.z</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">applyMatrix4</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">6</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">set</span><span class="PUNC">(</span><span class="NAME">this.max.x</span><span class="PUNC">,</span><span class="NAME">this.max.y</span><span class="PUNC">,</span><span class="NAME">this.min.z</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">applyMatrix4</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">7</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">set</span><span class="PUNC">(</span><span class="NAME">this.max.x</span><span class="PUNC">,</span><span class="NAME">this.max.y</span><span class="PUNC">,</span><span class="NAME">this.max.z</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">applyMatrix4</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.makeEmpty</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.setFromPoints</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">translate</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.min.add</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 81</span> </span><span class="NAME">this.max.add</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">equals</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a.min.equals</span><span class="PUNC">(</span><span class="NAME">this.min</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="NAME">a.max.equals</span><span class="PUNC">(</span><span class="NAME">this.max</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">clone</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="PUNC">(</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Box3</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">copy</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.Matrix3</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.elements</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Float32Array</span><span class="PUNC">(</span><span class="NUMB">9</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.set</span><span class="PUNC">(</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">a</span><span class="PUNC">?</span><span class="NAME">a</span><span class="PUNC">:</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">||</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">||</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">||</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">e</span><span class="PUNC">?</span><span class="NAME">e</span><span class="PUNC">:</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">||</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">||</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">||</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">i</span><span class="PUNC">?</span><span class="NAME">i</span><span class="PUNC">:</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 82</span> </span><span class="NAME">THREE.Matrix3.prototype</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="NAME">constructor</span><span class="PUNC">:</span><span class="NAME">THREE.Matrix3</span><span class="PUNC">,</span><span class="NAME">set</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">j</span><span class="PUNC">=</span><span class="NAME">this.elements</span><span class="PUNC">;</span><span class="NAME">j</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">j</span><span class="PUNC">[</span><span class="NUMB">3</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">;</span><span class="NAME">j</span><span class="PUNC">[</span><span class="NUMB">6</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">;</span><span class="NAME">j</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">;</span><span class="NAME">j</span><span class="PUNC">[</span><span class="NUMB">4</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">e</span><span class="PUNC">;</span><span class="NAME">j</span><span class="PUNC">[</span><span class="NUMB">7</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">f</span><span class="PUNC">;</span><span class="NAME">j</span><span class="PUNC">[</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">h</span><span class="PUNC">;</span><span class="NAME">j</span><span class="PUNC">[</span><span class="NUMB">5</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">g</span><span class="PUNC">;</span><span class="NAME">j</span><span class="PUNC">[</span><span class="NUMB">8</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">i</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">identity</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.set</span><span class="PUNC">(</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">copy</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">a.elements</span><span class="PUNC">;</span><span class="NAME">this.set</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">3</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">6</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">4</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">7</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">5</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">8</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">multiplyVector3</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">console.warn</span><span class="PUNC">(</span><span class="STRN">"DEPRECATED: Matrix3's .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead."</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a.applyMatrix3</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'> 83</span> </span><span class="NAME">multiplyVector3Array</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">b.length</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">&lt;</span><span class="NAME">d</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NUMB">3</span><span class="PUNC">)</span><span class="NAME">a.x</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">a.y</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">a.z</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">+</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">a.applyMatrix3</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">a.x</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">a.y</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">+</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">a.z</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">multiplyScalar</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.elements</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">*</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">3</span><span class="PUNC">]</span><span class="PUNC">*</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">6</span><span class="PUNC">]</span><span class="PUNC">*</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">*</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">4</span><span class="PUNC">]</span><span class="PUNC">*</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">7</span><span class="PUNC">]</span><span class="PUNC">*</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">*</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">5</span><span class="PUNC">]</span><span class="PUNC">*</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">8</span><span class="PUNC">]</span><span class="PUNC">*</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">determinant</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">this.elements</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">3</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">4</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">5</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">6</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">7</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">8</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">*</span><span class="NAME">f</span><span class="PUNC">*</span><span class="NAME">a</span><span class="PUNC">-</span><span class="NAME">b</span><span class="PUNC">*</span><span class="NAME">h</span><span class="PUNC">*</span><span class="NAME">i</span><span class="PUNC">-</span><span class="NAME">c</span><span class="PUNC">*</span><span class="NAME">e</span><span class="PUNC">*</span><span class="NAME">a</span><span class="PUNC">+</span><span class="NAME">c</span><span class="PUNC">*</span><span class="NAME">h</span><span class="PUNC">*</span><span class="NAME">g</span><span class="PUNC">+</span><span class="NAME">d</span><span class="PUNC">*</span><span class="NAME">e</span><span class="PUNC">*</span><span class="NAME">i</span><span class="PUNC">-</span><span class="NAME">d</span><span class="PUNC">*</span><span class="NAME">f</span><span class="PUNC">*</span><span class="NAME">g</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">getInverse</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'> 84</span> </span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">a.elements</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">this.elements</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NUMB">10</span><span class="PUNC">]</span><span class="PUNC">*</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NUMB">5</span><span class="PUNC">]</span><span class="PUNC">-</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NUMB">6</span><span class="PUNC">]</span><span class="PUNC">*</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NUMB">9</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NUMB">10</span><span class="PUNC">]</span><span class="PUNC">*</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">+</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">*</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NUMB">9</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">[</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NUMB">6</span><span class="PUNC">]</span><span class="PUNC">*</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">-</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">*</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NUMB">5</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">[</span><span class="NUMB">3</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NUMB">10</span><span class="PUNC">]</span><span class="PUNC">*</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NUMB">4</span><span class="PUNC">]</span><span class="PUNC">+</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NUMB">6</span><span class="PUNC">]</span><span class="PUNC">*</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NUMB">8</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">[</span><span class="NUMB">4</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NUMB">10</span><span class="PUNC">]</span><span class="PUNC">*</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">-</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">*</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NUMB">8</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">[</span><span class="NUMB">5</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NUMB">6</span><span class="PUNC">]</span><span class="PUNC">*</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">+</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">*</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NUMB">4</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">[</span><span class="NUMB">6</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NUMB">9</span><span class="PUNC">]</span><span class="PUNC">*</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NUMB">4</span><span class="PUNC">]</span><span class="PUNC">-</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NUMB">5</span><span class="PUNC">]</span><span class="PUNC">*</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NUMB">8</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">[</span><span class="NUMB">7</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NUMB">9</span><span class="PUNC">]</span><span class="PUNC">*</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">+</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">*</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NUMB">8</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">[</span><span class="NUMB">8</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NUMB">5</span><span class="PUNC">]</span><span class="PUNC">*</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">-</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">*</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NUMB">4</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">*</span><span class="NAME">d</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">+</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">*</span><span class="NAME">d</span><span class="PUNC">[</span><span class="NUMB">3</span><span class="PUNC">]</span><span class="PUNC">+</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">*</span><span class="NAME">d</span><span class="PUNC">[</span><span class="NUMB">6</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">===</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="KEYW">throw</span><span class="WHIT"> </span><span class="NAME">Error</span><span class="PUNC">(</span><span class="STRN">"Matrix3.getInverse(): can't invert matrix, determinant is 0"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">console.warn</span><span class="PUNC">(</span><span class="STRN">"Matrix3.getInverse(): can't invert matrix, determinant is 0"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.identity</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">}</span><span class="NAME">this.multiplyScalar</span><span class="PUNC">(</span><span class="NUMB">1</span><span class="PUNC">/</span><span class="WHIT">
<span class='line'> 85</span> </span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">transpose</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.elements</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">3</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">3</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">6</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">6</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">5</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">5</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">7</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">7</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">getNormalMatrix</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.getInverse</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">transpose</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">transposeIntoArray</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.elements</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">3</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">6</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">3</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">4</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">4</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">5</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">7</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">6</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">7</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">5</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">8</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">8</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">clone</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">this.elements</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Matrix3</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">3</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">6</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">4</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">7</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">5</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">8</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.Matrix4</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">,</span><span class="NAME">j</span><span class="PUNC">,</span><span class="NAME">l</span><span class="PUNC">,</span><span class="NAME">m</span><span class="PUNC">,</span><span class="NAME">n</span><span class="PUNC">,</span><span class="NAME">p</span><span class="PUNC">,</span><span class="NAME">t</span><span class="PUNC">,</span><span class="NAME">q</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">r</span><span class="PUNC">=</span><span class="NAME">this.elements</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Float32Array</span><span class="PUNC">(</span><span class="NUMB">16</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">r</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">a</span><span class="PUNC">?</span><span class="NAME">a</span><span class="PUNC">:</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">r</span><span class="PUNC">[</span><span class="NUMB">4</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">||</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">r</span><span class="PUNC">[</span><span class="NUMB">8</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">||</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">r</span><span class="PUNC">[</span><span class="NUMB">12</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">||</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">r</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">e</span><span class="PUNC">||</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">r</span><span class="PUNC">[</span><span class="NUMB">5</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">f</span><span class="PUNC">?</span><span class="NAME">f</span><span class="PUNC">:</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">r</span><span class="PUNC">[</span><span class="NUMB">9</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">h</span><span class="PUNC">||</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">r</span><span class="PUNC">[</span><span class="NUMB">13</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">g</span><span class="PUNC">||</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">r</span><span class="PUNC">[</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">i</span><span class="PUNC">||</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">r</span><span class="PUNC">[</span><span class="NUMB">6</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">j</span><span class="PUNC">||</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">r</span><span class="PUNC">[</span><span class="NUMB">10</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">l</span><span class="PUNC">?</span><span class="NAME">l</span><span class="PUNC">:</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">r</span><span class="PUNC">[</span><span class="NUMB">14</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">m</span><span class="PUNC">||</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">r</span><span class="PUNC">[</span><span class="NUMB">3</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">n</span><span class="PUNC">||</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">r</span><span class="PUNC">[</span><span class="NUMB">7</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">p</span><span class="PUNC">||</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">r</span><span class="PUNC">[</span><span class="NUMB">11</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">t</span><span class="PUNC">||</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">r</span><span class="PUNC">[</span><span class="NUMB">15</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">q</span><span class="PUNC">?</span><span class="NAME">q</span><span class="PUNC">:</span><span class="NUMB">1</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 86</span> </span><span class="NAME">THREE.Matrix4.prototype</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="NAME">constructor</span><span class="PUNC">:</span><span class="NAME">THREE.Matrix4</span><span class="PUNC">,</span><span class="NAME">set</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">,</span><span class="NAME">j</span><span class="PUNC">,</span><span class="NAME">l</span><span class="PUNC">,</span><span class="NAME">m</span><span class="PUNC">,</span><span class="NAME">n</span><span class="PUNC">,</span><span class="NAME">p</span><span class="PUNC">,</span><span class="NAME">t</span><span class="PUNC">,</span><span class="NAME">q</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">r</span><span class="PUNC">=</span><span class="NAME">this.elements</span><span class="PUNC">;</span><span class="NAME">r</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">r</span><span class="PUNC">[</span><span class="NUMB">4</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">;</span><span class="NAME">r</span><span class="PUNC">[</span><span class="NUMB">8</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">;</span><span class="NAME">r</span><span class="PUNC">[</span><span class="NUMB">12</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">;</span><span class="NAME">r</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">e</span><span class="PUNC">;</span><span class="NAME">r</span><span class="PUNC">[</span><span class="NUMB">5</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">f</span><span class="PUNC">;</span><span class="NAME">r</span><span class="PUNC">[</span><span class="NUMB">9</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">h</span><span class="PUNC">;</span><span class="NAME">r</span><span class="PUNC">[</span><span class="NUMB">13</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">g</span><span class="PUNC">;</span><span class="NAME">r</span><span class="PUNC">[</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">i</span><span class="PUNC">;</span><span class="NAME">r</span><span class="PUNC">[</span><span class="NUMB">6</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">j</span><span class="PUNC">;</span><span class="NAME">r</span><span class="PUNC">[</span><span class="NUMB">10</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">l</span><span class="PUNC">;</span><span class="NAME">r</span><span class="PUNC">[</span><span class="NUMB">14</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">m</span><span class="PUNC">;</span><span class="NAME">r</span><span class="PUNC">[</span><span class="NUMB">3</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">n</span><span class="PUNC">;</span><span class="NAME">r</span><span class="PUNC">[</span><span class="NUMB">7</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">p</span><span class="PUNC">;</span><span class="NAME">r</span><span class="PUNC">[</span><span class="NUMB">11</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">t</span><span class="PUNC">;</span><span class="NAME">r</span><span class="PUNC">[</span><span class="NUMB">15</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">q</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">identity</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.set</span><span class="PUNC">(</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">copy</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.elements.set</span><span class="PUNC">(</span><span class="NAME">a.elements</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">extractPosition</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">console.warn</span><span class="PUNC">(</span><span class="STRN">"DEPRECATED: Matrix4's .extractPosition() has been renamed to .copyPosition()."</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 87</span> </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.copyPosition</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">copyPosition</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.elements</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">a.elements</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">12</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">12</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">13</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">13</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">14</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">14</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">extractRotation</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.elements</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">b.elements</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">/</span><span class="NAME">a.set</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">length</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">/</span><span class="NAME">a.set</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">4</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">5</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">6</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">length</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">/</span><span class="NAME">a.set</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">8</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">9</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">10</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">length</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">*</span><span class="NAME">d</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">*</span><span class="NAME">d</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">*</span><span class="NAME">d</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NUMB">4</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">4</span><span class="PUNC">]</span><span class="PUNC">*</span><span class="NAME">e</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NUMB">5</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">5</span><span class="PUNC">]</span><span class="PUNC">*</span><span class="NAME">e</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NUMB">6</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">6</span><span class="PUNC">]</span><span class="PUNC">*</span><span class="NAME">e</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NUMB">8</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">8</span><span class="PUNC">]</span><span class="PUNC">*</span><span class="NAME">f</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NUMB">9</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">9</span><span class="PUNC">]</span><span class="PUNC">*</span><span class="NAME">f</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NUMB">10</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">10</span><span class="PUNC">]</span><span class="PUNC">*</span><span class="NAME">f</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">makeRotationFromEuler</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">===</span><span class="WHIT">
<span class='line'> 88</span> </span><span class="KEYW">typeof</span><span class="WHIT"> </span><span class="NAME">a.order</span><span class="PUNC">&&</span><span class="NAME">console.error</span><span class="PUNC">(</span><span class="STRN">"ERROR: Matrix's .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.  Please update your code."</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.elements</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">a.x</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">a.y</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">a.z</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">Math.cos</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">Math.sin</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">Math.cos</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">Math.sin</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">Math.cos</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">Math.sin</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">===</span><span class="NAME">a.order</span><span class="PUNC">||</span><span class="STRN">"XYZ"</span><span class="PUNC">===</span><span class="NAME">a.order</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">f</span><span class="PUNC">*</span><span class="NAME">g</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">=</span><span class="NAME">f</span><span class="PUNC">*</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">j</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">*</span><span class="NAME">g</span><span class="PUNC">,</span><span class="NAME">l</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">*</span><span class="NAME">e</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">h</span><span class="PUNC">*</span><span class="NAME">g</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">4</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="NAME">h</span><span class="PUNC">*</span><span class="NAME">e</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">8</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">i</span><span class="PUNC">+</span><span class="NAME">j</span><span class="PUNC">*</span><span class="NAME">d</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">5</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">-</span><span class="NAME">l</span><span class="PUNC">*</span><span class="NAME">d</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">9</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="NAME">c</span><span class="PUNC">*</span><span class="NAME">h</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">l</span><span class="PUNC">-</span><span class="NAME">a</span><span class="PUNC">*</span><span class="NAME">d</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">6</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">j</span><span class="PUNC">+</span><span class="NAME">i</span><span class="PUNC">*</span><span class="NAME">d</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">10</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">f</span><span class="PUNC">*</span><span class="NAME">h</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="STRN">"YXZ"</span><span class="PUNC">===</span><span class="NAME">a.order</span><span class="PUNC">?</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">h</span><span class="PUNC">*</span><span class="NAME">g</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">=</span><span class="NAME">h</span><span class="PUNC">*</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">j</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">*</span><span class="NAME">g</span><span class="PUNC">,</span><span class="NAME">l</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">*</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">+</span><span class="NAME">l</span><span class="PUNC">*</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">4</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'> 89</span> </span><span class="NAME">j</span><span class="PUNC">*</span><span class="NAME">c</span><span class="PUNC">-</span><span class="NAME">i</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">8</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">f</span><span class="PUNC">*</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">f</span><span class="PUNC">*</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">5</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">f</span><span class="PUNC">*</span><span class="NAME">g</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">9</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">i</span><span class="PUNC">*</span><span class="NAME">c</span><span class="PUNC">-</span><span class="NAME">j</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">6</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">l</span><span class="PUNC">+</span><span class="NAME">a</span><span class="PUNC">*</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">10</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">f</span><span class="PUNC">*</span><span class="NAME">h</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="STRN">"ZXY"</span><span class="PUNC">===</span><span class="NAME">a.order</span><span class="PUNC">?</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">h</span><span class="PUNC">*</span><span class="NAME">g</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">=</span><span class="NAME">h</span><span class="PUNC">*</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">j</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">*</span><span class="NAME">g</span><span class="PUNC">,</span><span class="NAME">l</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">*</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">-</span><span class="NAME">l</span><span class="PUNC">*</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">4</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="NAME">f</span><span class="PUNC">*</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">8</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">j</span><span class="PUNC">+</span><span class="NAME">i</span><span class="PUNC">*</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">i</span><span class="PUNC">+</span><span class="NAME">j</span><span class="PUNC">*</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">5</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">f</span><span class="PUNC">*</span><span class="NAME">g</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">9</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">l</span><span class="PUNC">-</span><span class="NAME">a</span><span class="PUNC">*</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="NAME">f</span><span class="PUNC">*</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">6</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">10</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">f</span><span class="PUNC">*</span><span class="NAME">h</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="STRN">"ZYX"</span><span class="PUNC">===</span><span class="NAME">a.order</span><span class="PUNC">?</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">f</span><span class="PUNC">*</span><span class="NAME">g</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">=</span><span class="NAME">f</span><span class="PUNC">*</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">j</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">*</span><span class="NAME">g</span><span class="PUNC">,</span><span class="NAME">l</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">*</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">h</span><span class="PUNC">*</span><span class="NAME">g</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">4</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">j</span><span class="PUNC">*</span><span class="NAME">d</span><span class="PUNC">-</span><span class="NAME">i</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">8</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">*</span><span class="NAME">d</span><span class="PUNC">+</span><span class="NAME">l</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">h</span><span class="PUNC">*</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">5</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">l</span><span class="PUNC">*</span><span class="NAME">d</span><span class="PUNC">+</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">9</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">i</span><span class="PUNC">*</span><span class="NAME">d</span><span class="PUNC">-</span><span class="NAME">j</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">6</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">*</span><span class="NAME">h</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">10</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">f</span><span class="PUNC">*</span><span class="NAME">h</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="STRN">"YZX"</span><span class="PUNC">===</span><span class="NAME">a.order</span><span class="PUNC">?</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">f</span><span class="PUNC">*</span><span class="NAME">h</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">=</span><span class="NAME">f</span><span class="PUNC">*</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">j</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">*</span><span class="NAME">h</span><span class="PUNC">,</span><span class="NAME">l</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">*</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">h</span><span class="PUNC">*</span><span class="NAME">g</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">4</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">l</span><span class="PUNC">-</span><span class="NAME">a</span><span class="PUNC">*</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">8</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">j</span><span class="PUNC">*</span><span class="NAME">e</span><span class="PUNC">+</span><span class="NAME">i</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">5</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">f</span><span class="PUNC">*</span><span class="NAME">g</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">9</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="NAME">c</span><span class="PUNC">*</span><span class="NAME">g</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="NAME">d</span><span class="PUNC">*</span><span class="NAME">g</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">6</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">i</span><span class="PUNC">*</span><span class="NAME">e</span><span class="PUNC">+</span><span class="NAME">j</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">10</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">-</span><span class="NAME">l</span><span class="PUNC">*</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="STRN">"XZY"</span><span class="PUNC">===</span><span class="NAME">a.order</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">f</span><span class="PUNC">*</span><span class="NAME">h</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">=</span><span class="NAME">f</span><span class="PUNC">*</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">j</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'> 90</span> </span><span class="NAME">c</span><span class="PUNC">*</span><span class="NAME">h</span><span class="PUNC">,</span><span class="NAME">l</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">*</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">h</span><span class="PUNC">*</span><span class="NAME">g</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">4</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">8</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">*</span><span class="NAME">g</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">*</span><span class="NAME">e</span><span class="PUNC">+</span><span class="NAME">l</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">5</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">f</span><span class="PUNC">*</span><span class="NAME">g</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">9</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">i</span><span class="PUNC">*</span><span class="NAME">e</span><span class="PUNC">-</span><span class="NAME">j</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">j</span><span class="PUNC">*</span><span class="NAME">e</span><span class="PUNC">-</span><span class="NAME">i</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">6</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">*</span><span class="NAME">g</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">10</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">l</span><span class="PUNC">*</span><span class="NAME">e</span><span class="PUNC">+</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">3</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">7</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">11</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">12</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">13</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">14</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">15</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">setRotationFromQuaternion</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">console.warn</span><span class="PUNC">(</span><span class="STRN">"DEPRECATED: Matrix4's .setRotationFromQuaternion() has been deprecated in favor of makeRotationFromQuaternion.  Please update your code."</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.makeRotationFromQuaternion</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">makeRotationFromQuaternion</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.elements</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">a.x</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">a.y</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">a.z</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">a.w</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">+</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">+</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">=</span><span class="NAME">e</span><span class="PUNC">+</span><span class="NAME">e</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'> 91</span> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">*</span><span class="NAME">h</span><span class="PUNC">,</span><span class="NAME">j</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">*</span><span class="NAME">g</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">*</span><span class="NAME">i</span><span class="PUNC">,</span><span class="NAME">l</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">*</span><span class="NAME">g</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">*</span><span class="NAME">i</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">e</span><span class="PUNC">*</span><span class="NAME">i</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">f</span><span class="PUNC">*</span><span class="NAME">h</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">f</span><span class="PUNC">*</span><span class="NAME">g</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">f</span><span class="PUNC">*</span><span class="NAME">i</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">-</span><span class="PUNC">(</span><span class="NAME">l</span><span class="PUNC">+</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">4</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">j</span><span class="PUNC">-</span><span class="NAME">f</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">8</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">+</span><span class="NAME">g</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">j</span><span class="PUNC">+</span><span class="NAME">f</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">5</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">-</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">+</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">9</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">-</span><span class="NAME">h</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">-</span><span class="NAME">g</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">6</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">+</span><span class="NAME">h</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">10</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">-</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">+</span><span class="NAME">l</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">3</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">7</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">11</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">12</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">13</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">14</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">15</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">lookAt</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">this.elements</span><span class="PUNC">;</span><span class="NAME">c.subVectors</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">normalize</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NUMB">0</span><span class="PUNC">===</span><span class="NAME">c.length</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">c.z</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a.crossVectors</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">normalize</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NUMB">0</span><span class="PUNC">===</span><span class="NAME">a.length</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">c.x</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="NAME">E</span><span class="PUNC">-</span><span class="NUMB">4</span><span class="PUNC">,</span><span class="NAME">a.crossVectors</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">normalize</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b.crossVectors</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'> 92</span> </span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">h</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">a.x</span><span class="PUNC">;</span><span class="NAME">h</span><span class="PUNC">[</span><span class="NUMB">4</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">b.x</span><span class="PUNC">;</span><span class="NAME">h</span><span class="PUNC">[</span><span class="NUMB">8</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">c.x</span><span class="PUNC">;</span><span class="NAME">h</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">a.y</span><span class="PUNC">;</span><span class="NAME">h</span><span class="PUNC">[</span><span class="NUMB">5</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">b.y</span><span class="PUNC">;</span><span class="NAME">h</span><span class="PUNC">[</span><span class="NUMB">9</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">c.y</span><span class="PUNC">;</span><span class="NAME">h</span><span class="PUNC">[</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">a.z</span><span class="PUNC">;</span><span class="NAME">h</span><span class="PUNC">[</span><span class="NUMB">6</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">b.z</span><span class="PUNC">;</span><span class="NAME">h</span><span class="PUNC">[</span><span class="NUMB">10</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">c.z</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">multiply</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">b</span><span class="PUNC">?</span><span class="PUNC">(</span><span class="NAME">console.warn</span><span class="PUNC">(</span><span class="STRN">"DEPRECATED: Matrix4's .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this.multiplyMatrices</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">this.multiplyMatrices</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">multiplyMatrices</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">a.elements</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">b.elements</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">this.elements</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NUMB">4</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NUMB">8</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NUMB">12</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">j</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">l</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NUMB">5</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">m</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NUMB">9</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">n</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NUMB">13</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">p</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">t</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NUMB">6</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">q</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NUMB">10</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">r</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NUMB">14</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">s</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NUMB">3</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">v</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NUMB">7</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'> 93</span> </span><span class="NAME">z</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NUMB">11</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NUMB">15</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">C</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">F</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">[</span><span class="NUMB">4</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">H</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">[</span><span class="NUMB">8</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">I</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">[</span><span class="NUMB">12</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">G</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">A</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">[</span><span class="NUMB">5</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">K</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">[</span><span class="NUMB">9</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">B</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">[</span><span class="NUMB">13</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">J</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">[</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">N</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">[</span><span class="NUMB">6</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">y</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">[</span><span class="NUMB">10</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">M</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">[</span><span class="NUMB">14</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">w</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">[</span><span class="NUMB">3</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">Z</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">[</span><span class="NUMB">7</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">L</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">[</span><span class="NUMB">11</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">[</span><span class="NUMB">15</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">f</span><span class="PUNC">*</span><span class="NAME">C</span><span class="PUNC">+</span><span class="NAME">h</span><span class="PUNC">*</span><span class="NAME">G</span><span class="PUNC">+</span><span class="NAME">g</span><span class="PUNC">*</span><span class="NAME">J</span><span class="PUNC">+</span><span class="NAME">i</span><span class="PUNC">*</span><span class="NAME">w</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">[</span><span class="NUMB">4</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">f</span><span class="PUNC">*</span><span class="NAME">F</span><span class="PUNC">+</span><span class="NAME">h</span><span class="PUNC">*</span><span class="NAME">A</span><span class="PUNC">+</span><span class="NAME">g</span><span class="PUNC">*</span><span class="NAME">N</span><span class="PUNC">+</span><span class="NAME">i</span><span class="PUNC">*</span><span class="NAME">Z</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">[</span><span class="NUMB">8</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">f</span><span class="PUNC">*</span><span class="NAME">H</span><span class="PUNC">+</span><span class="NAME">h</span><span class="PUNC">*</span><span class="NAME">K</span><span class="PUNC">+</span><span class="NAME">g</span><span class="PUNC">*</span><span class="NAME">y</span><span class="PUNC">+</span><span class="NAME">i</span><span class="PUNC">*</span><span class="NAME">L</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">[</span><span class="NUMB">12</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">f</span><span class="PUNC">*</span><span class="NAME">I</span><span class="PUNC">+</span><span class="NAME">h</span><span class="PUNC">*</span><span class="NAME">B</span><span class="PUNC">+</span><span class="NAME">g</span><span class="PUNC">*</span><span class="NAME">M</span><span class="PUNC">+</span><span class="NAME">i</span><span class="PUNC">*</span><span class="NAME">d</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">j</span><span class="PUNC">*</span><span class="NAME">C</span><span class="PUNC">+</span><span class="NAME">l</span><span class="PUNC">*</span><span class="NAME">G</span><span class="PUNC">+</span><span class="NAME">m</span><span class="PUNC">*</span><span class="NAME">J</span><span class="PUNC">+</span><span class="NAME">n</span><span class="PUNC">*</span><span class="NAME">w</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">[</span><span class="NUMB">5</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">j</span><span class="PUNC">*</span><span class="NAME">F</span><span class="PUNC">+</span><span class="NAME">l</span><span class="PUNC">*</span><span class="NAME">A</span><span class="PUNC">+</span><span class="NAME">m</span><span class="PUNC">*</span><span class="NAME">N</span><span class="PUNC">+</span><span class="NAME">n</span><span class="PUNC">*</span><span class="NAME">Z</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">[</span><span class="NUMB">9</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">j</span><span class="PUNC">*</span><span class="NAME">H</span><span class="PUNC">+</span><span class="NAME">l</span><span class="PUNC">*</span><span class="NAME">K</span><span class="PUNC">+</span><span class="NAME">m</span><span class="PUNC">*</span><span class="NAME">y</span><span class="PUNC">+</span><span class="NAME">n</span><span class="PUNC">*</span><span class="NAME">L</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">[</span><span class="NUMB">13</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">j</span><span class="PUNC">*</span><span class="NAME">I</span><span class="PUNC">+</span><span class="NAME">l</span><span class="PUNC">*</span><span class="NAME">B</span><span class="PUNC">+</span><span class="NAME">m</span><span class="PUNC">*</span><span class="NAME">M</span><span class="PUNC">+</span><span class="NAME">n</span><span class="PUNC">*</span><span class="NAME">d</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">[</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">p</span><span class="PUNC">*</span><span class="NAME">C</span><span class="PUNC">+</span><span class="NAME">t</span><span class="PUNC">*</span><span class="NAME">G</span><span class="PUNC">+</span><span class="NAME">q</span><span class="PUNC">*</span><span class="NAME">J</span><span class="PUNC">+</span><span class="NAME">r</span><span class="PUNC">*</span><span class="NAME">w</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">[</span><span class="NUMB">6</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">p</span><span class="PUNC">*</span><span class="NAME">F</span><span class="PUNC">+</span><span class="NAME">t</span><span class="PUNC">*</span><span class="NAME">A</span><span class="PUNC">+</span><span class="NAME">q</span><span class="PUNC">*</span><span class="NAME">N</span><span class="PUNC">+</span><span class="NAME">r</span><span class="PUNC">*</span><span class="NAME">Z</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">[</span><span class="NUMB">10</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">p</span><span class="PUNC">*</span><span class="NAME">H</span><span class="PUNC">+</span><span class="NAME">t</span><span class="PUNC">*</span><span class="NAME">K</span><span class="PUNC">+</span><span class="NAME">q</span><span class="PUNC">*</span><span class="NAME">y</span><span class="PUNC">+</span><span class="NAME">r</span><span class="PUNC">*</span><span class="NAME">L</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">[</span><span class="NUMB">14</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">p</span><span class="PUNC">*</span><span class="NAME">I</span><span class="PUNC">+</span><span class="NAME">t</span><span class="PUNC">*</span><span class="NAME">B</span><span class="PUNC">+</span><span class="NAME">q</span><span class="PUNC">*</span><span class="NAME">M</span><span class="PUNC">+</span><span class="NAME">r</span><span class="PUNC">*</span><span class="NAME">d</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">[</span><span class="NUMB">3</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">s</span><span class="PUNC">*</span><span class="NAME">C</span><span class="PUNC">+</span><span class="NAME">v</span><span class="PUNC">*</span><span class="NAME">G</span><span class="PUNC">+</span><span class="NAME">z</span><span class="PUNC">*</span><span class="NAME">J</span><span class="PUNC">+</span><span class="NAME">c</span><span class="PUNC">*</span><span class="NAME">w</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">[</span><span class="NUMB">7</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">s</span><span class="PUNC">*</span><span class="NAME">F</span><span class="PUNC">+</span><span class="NAME">v</span><span class="PUNC">*</span><span class="NAME">A</span><span class="PUNC">+</span><span class="NAME">z</span><span class="PUNC">*</span><span class="NAME">N</span><span class="PUNC">+</span><span class="NAME">c</span><span class="PUNC">*</span><span class="NAME">Z</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">[</span><span class="NUMB">11</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">s</span><span class="PUNC">*</span><span class="NAME">H</span><span class="PUNC">+</span><span class="NAME">v</span><span class="PUNC">*</span><span class="NAME">K</span><span class="PUNC">+</span><span class="NAME">z</span><span class="PUNC">*</span><span class="NAME">y</span><span class="PUNC">+</span><span class="NAME">c</span><span class="PUNC">*</span><span class="NAME">L</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">[</span><span class="NUMB">15</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">s</span><span class="PUNC">*</span><span class="NAME">I</span><span class="PUNC">+</span><span class="NAME">v</span><span class="PUNC">*</span><span class="NAME">B</span><span class="PUNC">+</span><span class="NAME">z</span><span class="PUNC">*</span><span class="NAME">M</span><span class="PUNC">+</span><span class="NAME">c</span><span class="PUNC">*</span><span class="NAME">d</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">multiplyToArray</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'> 94</span> </span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">this.elements</span><span class="PUNC">;</span><span class="NAME">this.multiplyMatrices</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">[</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NUMB">3</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">[</span><span class="NUMB">3</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NUMB">4</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">[</span><span class="NUMB">4</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NUMB">5</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">[</span><span class="NUMB">5</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NUMB">6</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">[</span><span class="NUMB">6</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NUMB">7</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">[</span><span class="NUMB">7</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NUMB">8</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">[</span><span class="NUMB">8</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NUMB">9</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">[</span><span class="NUMB">9</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NUMB">10</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">[</span><span class="NUMB">10</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NUMB">11</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">[</span><span class="NUMB">11</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NUMB">12</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">[</span><span class="NUMB">12</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NUMB">13</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">[</span><span class="NUMB">13</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NUMB">14</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">[</span><span class="NUMB">14</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NUMB">15</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">[</span><span class="NUMB">15</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">multiplyScalar</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.elements</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">*</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">4</span><span class="PUNC">]</span><span class="PUNC">*</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">8</span><span class="PUNC">]</span><span class="PUNC">*</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">12</span><span class="PUNC">]</span><span class="PUNC">*</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">*</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">5</span><span class="PUNC">]</span><span class="PUNC">*</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">9</span><span class="PUNC">]</span><span class="PUNC">*</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">13</span><span class="PUNC">]</span><span class="PUNC">*</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">*</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">6</span><span class="PUNC">]</span><span class="PUNC">*</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">10</span><span class="PUNC">]</span><span class="PUNC">*</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">14</span><span class="PUNC">]</span><span class="PUNC">*</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">3</span><span class="PUNC">]</span><span class="PUNC">*</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">7</span><span class="PUNC">]</span><span class="PUNC">*</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">11</span><span class="PUNC">]</span><span class="PUNC">*</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">15</span><span class="PUNC">]</span><span class="PUNC">*</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">multiplyVector3</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">console.warn</span><span class="PUNC">(</span><span class="STRN">"DEPRECATED: Matrix4's .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) or vector.applyProjection( matrix ) instead."</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 95</span> </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a.applyProjection</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">multiplyVector4</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">console.warn</span><span class="PUNC">(</span><span class="STRN">"DEPRECATED: Matrix4's .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead."</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a.applyMatrix4</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">multiplyVector3Array</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">b.length</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">&lt;</span><span class="NAME">d</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NUMB">3</span><span class="PUNC">)</span><span class="NAME">a.x</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">a.y</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">a.z</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">+</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">a.applyProjection</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">a.x</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">a.y</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">+</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">a.z</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">rotateAxis</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">console.warn</span><span class="PUNC">(</span><span class="STRN">"DEPRECATED: Matrix4's .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead."</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 96</span> </span><span class="NAME">a.transformDirection</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">crossVector</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">console.warn</span><span class="PUNC">(</span><span class="STRN">"DEPRECATED: Matrix4's .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead."</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a.applyMatrix4</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">determinant</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">this.elements</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">4</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">8</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">12</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">5</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">9</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">13</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">j</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">l</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">6</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">m</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">10</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">n</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">14</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">3</span><span class="PUNC">]</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="PUNC">+</span><span class="NAME">e</span><span class="PUNC">*</span><span class="NAME">g</span><span class="PUNC">*</span><span class="NAME">l</span><span class="PUNC">-</span><span class="NAME">d</span><span class="PUNC">*</span><span class="NAME">i</span><span class="PUNC">*</span><span class="NAME">l</span><span class="PUNC">-</span><span class="NAME">e</span><span class="PUNC">*</span><span class="NAME">h</span><span class="PUNC">*</span><span class="NAME">m</span><span class="PUNC">+</span><span class="NAME">c</span><span class="PUNC">*</span><span class="NAME">i</span><span class="PUNC">*</span><span class="NAME">m</span><span class="PUNC">+</span><span class="NAME">d</span><span class="PUNC">*</span><span class="NAME">h</span><span class="PUNC">*</span><span class="NAME">n</span><span class="PUNC">-</span><span class="NAME">c</span><span class="PUNC">*</span><span class="NAME">g</span><span class="PUNC">*</span><span class="NAME">n</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">7</span><span class="PUNC">]</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="PUNC">+</span><span class="NAME">b</span><span class="PUNC">*</span><span class="NAME">g</span><span class="PUNC">*</span><span class="NAME">n</span><span class="PUNC">-</span><span class="NAME">b</span><span class="PUNC">*</span><span class="NAME">i</span><span class="PUNC">*</span><span class="NAME">m</span><span class="PUNC">+</span><span class="NAME">e</span><span class="PUNC">*</span><span class="NAME">f</span><span class="PUNC">*</span><span class="NAME">m</span><span class="PUNC">-</span><span class="NAME">d</span><span class="PUNC">*</span><span class="NAME">f</span><span class="PUNC">*</span><span class="NAME">n</span><span class="PUNC">+</span><span class="NAME">d</span><span class="PUNC">*</span><span class="NAME">i</span><span class="PUNC">*</span><span class="NAME">j</span><span class="PUNC">-</span><span class="NAME">e</span><span class="PUNC">*</span><span class="NAME">g</span><span class="PUNC">*</span><span class="NAME">j</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">11</span><span class="PUNC">]</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="PUNC">+</span><span class="NAME">b</span><span class="PUNC">*</span><span class="NAME">i</span><span class="PUNC">*</span><span class="NAME">l</span><span class="PUNC">-</span><span class="NAME">b</span><span class="PUNC">*</span><span class="NAME">h</span><span class="PUNC">*</span><span class="NAME">n</span><span class="PUNC">-</span><span class="NAME">e</span><span class="PUNC">*</span><span class="NAME">f</span><span class="PUNC">*</span><span class="NAME">l</span><span class="PUNC">+</span><span class="NAME">c</span><span class="PUNC">*</span><span class="NAME">f</span><span class="PUNC">*</span><span class="NAME">n</span><span class="PUNC">+</span><span class="NAME">e</span><span class="PUNC">*</span><span class="NAME">h</span><span class="PUNC">*</span><span class="NAME">j</span><span class="PUNC">-</span><span class="NAME">c</span><span class="PUNC">*</span><span class="NAME">i</span><span class="PUNC">*</span><span class="NAME">j</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">15</span><span class="PUNC">]</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="PUNC">-</span><span class="NAME">d</span><span class="PUNC">*</span><span class="NAME">h</span><span class="PUNC">*</span><span class="NAME">j</span><span class="PUNC">-</span><span class="NAME">b</span><span class="PUNC">*</span><span class="NAME">g</span><span class="PUNC">*</span><span class="NAME">l</span><span class="PUNC">+</span><span class="NAME">b</span><span class="PUNC">*</span><span class="NAME">h</span><span class="PUNC">*</span><span class="NAME">m</span><span class="PUNC">+</span><span class="NAME">d</span><span class="PUNC">*</span><span class="NAME">f</span><span class="PUNC">*</span><span class="NAME">l</span><span class="PUNC">-</span><span class="NAME">c</span><span class="PUNC">*</span><span class="NAME">f</span><span class="PUNC">*</span><span class="WHIT">
<span class='line'> 97</span> </span><span class="NAME">m</span><span class="PUNC">+</span><span class="NAME">c</span><span class="PUNC">*</span><span class="NAME">g</span><span class="PUNC">*</span><span class="NAME">j</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">transpose</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">this.elements</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">4</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">4</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">8</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">8</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">6</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">6</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">9</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">9</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">3</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">3</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">12</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">12</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">7</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">7</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">13</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">13</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">11</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">11</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">14</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">14</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">flattenToArray</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.elements</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">3</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">3</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">4</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">4</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">5</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">5</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">6</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">6</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">7</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">7</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">8</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">8</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">9</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">9</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">10</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">10</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">11</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">11</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">12</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">12</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">13</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">13</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">14</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">14</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">15</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">15</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">flattenToArrayOffset</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.elements</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 98</span> </span><span class="NAME">a</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">+</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">+</span><span class="NUMB">3</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NUMB">3</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">+</span><span class="NUMB">4</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NUMB">4</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">+</span><span class="NUMB">5</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NUMB">5</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">+</span><span class="NUMB">6</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NUMB">6</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">+</span><span class="NUMB">7</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NUMB">7</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">+</span><span class="NUMB">8</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NUMB">8</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">+</span><span class="NUMB">9</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NUMB">9</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">+</span><span class="NUMB">10</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NUMB">10</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">+</span><span class="NUMB">11</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NUMB">11</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">+</span><span class="NUMB">12</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NUMB">12</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">+</span><span class="NUMB">13</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NUMB">13</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">+</span><span class="NUMB">14</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NUMB">14</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">+</span><span class="NUMB">15</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NUMB">15</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">getPosition</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">console.warn</span><span class="PUNC">(</span><span class="STRN">"DEPRECATED: Matrix4's .getPosition() has been removed. Use Vector3.getPositionFromMatrix( matrix ) instead."</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.elements</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a.set</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">12</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">13</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">14</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">setPosition</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.elements</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 99</span> </span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">12</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">a.x</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">13</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">a.y</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">14</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">a.z</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">getInverse</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.elements</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">a.elements</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">[</span><span class="NUMB">4</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">[</span><span class="NUMB">8</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">[</span><span class="NUMB">12</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">j</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">[</span><span class="NUMB">5</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">l</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">[</span><span class="NUMB">9</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">m</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">[</span><span class="NUMB">13</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">n</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">[</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">p</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">[</span><span class="NUMB">6</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">t</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">[</span><span class="NUMB">10</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">q</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">[</span><span class="NUMB">14</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">r</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">[</span><span class="NUMB">3</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">s</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">[</span><span class="NUMB">7</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">v</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">[</span><span class="NUMB">11</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">[</span><span class="NUMB">15</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">l</span><span class="PUNC">*</span><span class="NAME">q</span><span class="PUNC">*</span><span class="NAME">s</span><span class="PUNC">-</span><span class="NAME">m</span><span class="PUNC">*</span><span class="NAME">t</span><span class="PUNC">*</span><span class="NAME">s</span><span class="PUNC">+</span><span class="NAME">m</span><span class="PUNC">*</span><span class="NAME">p</span><span class="PUNC">*</span><span class="NAME">v</span><span class="PUNC">-</span><span class="NAME">j</span><span class="PUNC">*</span><span class="NAME">q</span><span class="PUNC">*</span><span class="NAME">v</span><span class="PUNC">-</span><span class="NAME">l</span><span class="PUNC">*</span><span class="NAME">p</span><span class="PUNC">*</span><span class="NAME">d</span><span class="PUNC">+</span><span class="NAME">j</span><span class="PUNC">*</span><span class="NAME">t</span><span class="PUNC">*</span><span class="NAME">d</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NUMB">4</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">g</span><span class="PUNC">*</span><span class="NAME">t</span><span class="PUNC">*</span><span class="NAME">s</span><span class="PUNC">-</span><span class="NAME">h</span><span class="PUNC">*</span><span class="NAME">q</span><span class="PUNC">*</span><span class="NAME">s</span><span class="PUNC">-</span><span class="NAME">g</span><span class="PUNC">*</span><span class="NAME">p</span><span class="PUNC">*</span><span class="NAME">v</span><span class="PUNC">+</span><span class="NAME">f</span><span class="PUNC">*</span><span class="NAME">q</span><span class="PUNC">*</span><span class="NAME">v</span><span class="PUNC">+</span><span class="NAME">h</span><span class="PUNC">*</span><span class="NAME">p</span><span class="PUNC">*</span><span class="NAME">d</span><span class="PUNC">-</span><span class="NAME">f</span><span class="PUNC">*</span><span class="NAME">t</span><span class="PUNC">*</span><span class="NAME">d</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NUMB">8</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">h</span><span class="PUNC">*</span><span class="NAME">m</span><span class="PUNC">*</span><span class="NAME">s</span><span class="PUNC">-</span><span class="NAME">g</span><span class="PUNC">*</span><span class="NAME">l</span><span class="PUNC">*</span><span class="NAME">s</span><span class="PUNC">+</span><span class="NAME">g</span><span class="PUNC">*</span><span class="NAME">j</span><span class="PUNC">*</span><span class="NAME">v</span><span class="PUNC">-</span><span class="NAME">f</span><span class="PUNC">*</span><span class="NAME">m</span><span class="PUNC">*</span><span class="NAME">v</span><span class="PUNC">-</span><span class="NAME">h</span><span class="PUNC">*</span><span class="NAME">j</span><span class="PUNC">*</span><span class="NAME">d</span><span class="PUNC">+</span><span class="NAME">f</span><span class="PUNC">*</span><span class="NAME">l</span><span class="PUNC">*</span><span class="NAME">d</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NUMB">12</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">g</span><span class="PUNC">*</span><span class="NAME">l</span><span class="PUNC">*</span><span class="NAME">p</span><span class="PUNC">-</span><span class="NAME">h</span><span class="PUNC">*</span><span class="NAME">m</span><span class="PUNC">*</span><span class="NAME">p</span><span class="PUNC">-</span><span class="NAME">g</span><span class="PUNC">*</span><span class="NAME">j</span><span class="PUNC">*</span><span class="NAME">t</span><span class="PUNC">+</span><span class="NAME">f</span><span class="PUNC">*</span><span class="NAME">m</span><span class="PUNC">*</span><span class="NAME">t</span><span class="PUNC">+</span><span class="NAME">h</span><span class="PUNC">*</span><span class="NAME">j</span><span class="PUNC">*</span><span class="NAME">q</span><span class="PUNC">-</span><span class="NAME">f</span><span class="PUNC">*</span><span class="NAME">l</span><span class="PUNC">*</span><span class="NAME">q</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">m</span><span class="PUNC">*</span><span class="NAME">t</span><span class="PUNC">*</span><span class="NAME">r</span><span class="PUNC">-</span><span class="NAME">l</span><span class="PUNC">*</span><span class="NAME">q</span><span class="PUNC">*</span><span class="NAME">r</span><span class="PUNC">-</span><span class="NAME">m</span><span class="PUNC">*</span><span class="NAME">n</span><span class="PUNC">*</span><span class="NAME">v</span><span class="PUNC">+</span><span class="NAME">i</span><span class="PUNC">*</span><span class="NAME">q</span><span class="PUNC">*</span><span class="NAME">v</span><span class="PUNC">+</span><span class="NAME">l</span><span class="PUNC">*</span><span class="NAME">n</span><span class="PUNC">*</span><span class="NAME">d</span><span class="PUNC">-</span><span class="NAME">i</span><span class="PUNC">*</span><span class="NAME">t</span><span class="PUNC">*</span><span class="NAME">d</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NUMB">5</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">h</span><span class="PUNC">*</span><span class="NAME">q</span><span class="PUNC">*</span><span class="NAME">r</span><span class="PUNC">-</span><span class="NAME">g</span><span class="PUNC">*</span><span class="NAME">t</span><span class="PUNC">*</span><span class="NAME">r</span><span class="PUNC">+</span><span class="NAME">g</span><span class="PUNC">*</span><span class="NAME">n</span><span class="PUNC">*</span><span class="NAME">v</span><span class="PUNC">-</span><span class="NAME">e</span><span class="PUNC">*</span><span class="NAME">q</span><span class="PUNC">*</span><span class="NAME">v</span><span class="PUNC">-</span><span class="NAME">h</span><span class="PUNC">*</span><span class="NAME">n</span><span class="PUNC">*</span><span class="NAME">d</span><span class="PUNC">+</span><span class="NAME">e</span><span class="PUNC">*</span><span class="NAME">t</span><span class="PUNC">*</span><span class="NAME">d</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NUMB">9</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">g</span><span class="PUNC">*</span><span class="NAME">l</span><span class="PUNC">*</span><span class="NAME">r</span><span class="PUNC">-</span><span class="NAME">h</span><span class="PUNC">*</span><span class="NAME">m</span><span class="PUNC">*</span><span class="NAME">r</span><span class="PUNC">-</span><span class="NAME">g</span><span class="PUNC">*</span><span class="NAME">i</span><span class="PUNC">*</span><span class="NAME">v</span><span class="PUNC">+</span><span class="NAME">e</span><span class="PUNC">*</span><span class="NAME">m</span><span class="PUNC">*</span><span class="NAME">v</span><span class="PUNC">+</span><span class="NAME">h</span><span class="PUNC">*</span><span class="NAME">i</span><span class="PUNC">*</span><span class="NAME">d</span><span class="PUNC">-</span><span class="WHIT">
<span class='line'>100</span> </span><span class="NAME">e</span><span class="PUNC">*</span><span class="NAME">l</span><span class="PUNC">*</span><span class="NAME">d</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NUMB">13</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">h</span><span class="PUNC">*</span><span class="NAME">m</span><span class="PUNC">*</span><span class="NAME">n</span><span class="PUNC">-</span><span class="NAME">g</span><span class="PUNC">*</span><span class="NAME">l</span><span class="PUNC">*</span><span class="NAME">n</span><span class="PUNC">+</span><span class="NAME">g</span><span class="PUNC">*</span><span class="NAME">i</span><span class="PUNC">*</span><span class="NAME">t</span><span class="PUNC">-</span><span class="NAME">e</span><span class="PUNC">*</span><span class="NAME">m</span><span class="PUNC">*</span><span class="NAME">t</span><span class="PUNC">-</span><span class="NAME">h</span><span class="PUNC">*</span><span class="NAME">i</span><span class="PUNC">*</span><span class="NAME">q</span><span class="PUNC">+</span><span class="NAME">e</span><span class="PUNC">*</span><span class="NAME">l</span><span class="PUNC">*</span><span class="NAME">q</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">j</span><span class="PUNC">*</span><span class="NAME">q</span><span class="PUNC">*</span><span class="NAME">r</span><span class="PUNC">-</span><span class="NAME">m</span><span class="PUNC">*</span><span class="NAME">p</span><span class="PUNC">*</span><span class="NAME">r</span><span class="PUNC">+</span><span class="NAME">m</span><span class="PUNC">*</span><span class="NAME">n</span><span class="PUNC">*</span><span class="NAME">s</span><span class="PUNC">-</span><span class="NAME">i</span><span class="PUNC">*</span><span class="NAME">q</span><span class="PUNC">*</span><span class="NAME">s</span><span class="PUNC">-</span><span class="NAME">j</span><span class="PUNC">*</span><span class="NAME">n</span><span class="PUNC">*</span><span class="NAME">d</span><span class="PUNC">+</span><span class="NAME">i</span><span class="PUNC">*</span><span class="NAME">p</span><span class="PUNC">*</span><span class="NAME">d</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NUMB">6</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">g</span><span class="PUNC">*</span><span class="NAME">p</span><span class="PUNC">*</span><span class="NAME">r</span><span class="PUNC">-</span><span class="NAME">f</span><span class="PUNC">*</span><span class="NAME">q</span><span class="PUNC">*</span><span class="NAME">r</span><span class="PUNC">-</span><span class="NAME">g</span><span class="PUNC">*</span><span class="NAME">n</span><span class="PUNC">*</span><span class="NAME">s</span><span class="PUNC">+</span><span class="NAME">e</span><span class="PUNC">*</span><span class="NAME">q</span><span class="PUNC">*</span><span class="NAME">s</span><span class="PUNC">+</span><span class="NAME">f</span><span class="PUNC">*</span><span class="NAME">n</span><span class="PUNC">*</span><span class="NAME">d</span><span class="PUNC">-</span><span class="NAME">e</span><span class="PUNC">*</span><span class="NAME">p</span><span class="PUNC">*</span><span class="NAME">d</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NUMB">10</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">f</span><span class="PUNC">*</span><span class="NAME">m</span><span class="PUNC">*</span><span class="NAME">r</span><span class="PUNC">-</span><span class="NAME">g</span><span class="PUNC">*</span><span class="NAME">j</span><span class="PUNC">*</span><span class="NAME">r</span><span class="PUNC">+</span><span class="NAME">g</span><span class="PUNC">*</span><span class="NAME">i</span><span class="PUNC">*</span><span class="NAME">s</span><span class="PUNC">-</span><span class="NAME">e</span><span class="PUNC">*</span><span class="NAME">m</span><span class="PUNC">*</span><span class="NAME">s</span><span class="PUNC">-</span><span class="NAME">f</span><span class="PUNC">*</span><span class="NAME">i</span><span class="PUNC">*</span><span class="NAME">d</span><span class="PUNC">+</span><span class="NAME">e</span><span class="PUNC">*</span><span class="NAME">j</span><span class="PUNC">*</span><span class="NAME">d</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NUMB">14</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">g</span><span class="PUNC">*</span><span class="NAME">j</span><span class="PUNC">*</span><span class="NAME">n</span><span class="PUNC">-</span><span class="NAME">f</span><span class="PUNC">*</span><span class="NAME">m</span><span class="PUNC">*</span><span class="NAME">n</span><span class="PUNC">-</span><span class="NAME">g</span><span class="PUNC">*</span><span class="NAME">i</span><span class="PUNC">*</span><span class="NAME">p</span><span class="PUNC">+</span><span class="NAME">e</span><span class="PUNC">*</span><span class="NAME">m</span><span class="PUNC">*</span><span class="NAME">p</span><span class="PUNC">+</span><span class="NAME">f</span><span class="PUNC">*</span><span class="NAME">i</span><span class="PUNC">*</span><span class="NAME">q</span><span class="PUNC">-</span><span class="NAME">e</span><span class="PUNC">*</span><span class="NAME">j</span><span class="PUNC">*</span><span class="NAME">q</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NUMB">3</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">l</span><span class="PUNC">*</span><span class="NAME">p</span><span class="PUNC">*</span><span class="NAME">r</span><span class="PUNC">-</span><span class="NAME">j</span><span class="PUNC">*</span><span class="NAME">t</span><span class="PUNC">*</span><span class="NAME">r</span><span class="PUNC">-</span><span class="NAME">l</span><span class="PUNC">*</span><span class="NAME">n</span><span class="PUNC">*</span><span class="NAME">s</span><span class="PUNC">+</span><span class="NAME">i</span><span class="PUNC">*</span><span class="NAME">t</span><span class="PUNC">*</span><span class="NAME">s</span><span class="PUNC">+</span><span class="NAME">j</span><span class="PUNC">*</span><span class="NAME">n</span><span class="PUNC">*</span><span class="NAME">v</span><span class="PUNC">-</span><span class="NAME">i</span><span class="PUNC">*</span><span class="NAME">p</span><span class="PUNC">*</span><span class="NAME">v</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NUMB">7</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">f</span><span class="PUNC">*</span><span class="NAME">t</span><span class="PUNC">*</span><span class="NAME">r</span><span class="PUNC">-</span><span class="NAME">h</span><span class="PUNC">*</span><span class="NAME">p</span><span class="PUNC">*</span><span class="NAME">r</span><span class="PUNC">+</span><span class="NAME">h</span><span class="PUNC">*</span><span class="NAME">n</span><span class="PUNC">*</span><span class="NAME">s</span><span class="PUNC">-</span><span class="NAME">e</span><span class="PUNC">*</span><span class="NAME">t</span><span class="PUNC">*</span><span class="NAME">s</span><span class="PUNC">-</span><span class="NAME">f</span><span class="PUNC">*</span><span class="NAME">n</span><span class="PUNC">*</span><span class="NAME">v</span><span class="PUNC">+</span><span class="NAME">e</span><span class="PUNC">*</span><span class="NAME">p</span><span class="PUNC">*</span><span class="NAME">v</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NUMB">11</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">h</span><span class="PUNC">*</span><span class="NAME">j</span><span class="PUNC">*</span><span class="NAME">r</span><span class="PUNC">-</span><span class="NAME">f</span><span class="PUNC">*</span><span class="NAME">l</span><span class="PUNC">*</span><span class="NAME">r</span><span class="PUNC">-</span><span class="NAME">h</span><span class="PUNC">*</span><span class="NAME">i</span><span class="PUNC">*</span><span class="NAME">s</span><span class="PUNC">+</span><span class="NAME">e</span><span class="PUNC">*</span><span class="NAME">l</span><span class="PUNC">*</span><span class="NAME">s</span><span class="PUNC">+</span><span class="NAME">f</span><span class="PUNC">*</span><span class="NAME">i</span><span class="PUNC">*</span><span class="NAME">v</span><span class="PUNC">-</span><span class="NAME">e</span><span class="PUNC">*</span><span class="NAME">j</span><span class="PUNC">*</span><span class="NAME">v</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NUMB">15</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">f</span><span class="PUNC">*</span><span class="NAME">l</span><span class="PUNC">*</span><span class="NAME">n</span><span class="PUNC">-</span><span class="NAME">h</span><span class="PUNC">*</span><span class="NAME">j</span><span class="PUNC">*</span><span class="NAME">n</span><span class="PUNC">+</span><span class="NAME">h</span><span class="PUNC">*</span><span class="NAME">i</span><span class="PUNC">*</span><span class="NAME">p</span><span class="PUNC">-</span><span class="NAME">e</span><span class="PUNC">*</span><span class="NAME">l</span><span class="PUNC">*</span><span class="NAME">p</span><span class="PUNC">-</span><span class="NAME">f</span><span class="PUNC">*</span><span class="NAME">i</span><span class="PUNC">*</span><span class="NAME">t</span><span class="PUNC">+</span><span class="NAME">e</span><span class="PUNC">*</span><span class="NAME">j</span><span class="PUNC">*</span><span class="NAME">t</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">e</span><span class="PUNC">*</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">+</span><span class="NAME">i</span><span class="PUNC">*</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NUMB">4</span><span class="PUNC">]</span><span class="PUNC">+</span><span class="NAME">n</span><span class="PUNC">*</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NUMB">8</span><span class="PUNC">]</span><span class="PUNC">+</span><span class="NAME">r</span><span class="PUNC">*</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NUMB">12</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">==</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="KEYW">throw</span><span class="WHIT"> </span><span class="NAME">Error</span><span class="PUNC">(</span><span class="STRN">"Matrix4.getInverse(): can't invert matrix, determinant is 0"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">console.warn</span><span class="PUNC">(</span><span class="STRN">"Matrix4.getInverse(): can't invert matrix, determinant is 0"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>101</span> </span><span class="NAME">this.identity</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">}</span><span class="NAME">this.multiplyScalar</span><span class="PUNC">(</span><span class="NUMB">1</span><span class="PUNC">/</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">translate</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">console.warn</span><span class="PUNC">(</span><span class="STRN">"DEPRECATED: Matrix4's .translate() has been removed."</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">rotateX</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">console.warn</span><span class="PUNC">(</span><span class="STRN">"DEPRECATED: Matrix4's .rotateX() has been removed."</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">rotateY</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">console.warn</span><span class="PUNC">(</span><span class="STRN">"DEPRECATED: Matrix4's .rotateY() has been removed."</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">rotateZ</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">console.warn</span><span class="PUNC">(</span><span class="STRN">"DEPRECATED: Matrix4's .rotateZ() has been removed."</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">rotateByAxis</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">console.warn</span><span class="PUNC">(</span><span class="STRN">"DEPRECATED: Matrix4's .rotateByAxis() has been removed."</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>102</span> </span><span class="NAME">scale</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.elements</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">a.x</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">a.y</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">a.z</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">*</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">4</span><span class="PUNC">]</span><span class="PUNC">*</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">8</span><span class="PUNC">]</span><span class="PUNC">*</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">*</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">5</span><span class="PUNC">]</span><span class="PUNC">*</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">9</span><span class="PUNC">]</span><span class="PUNC">*</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">*</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">6</span><span class="PUNC">]</span><span class="PUNC">*</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">10</span><span class="PUNC">]</span><span class="PUNC">*</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">3</span><span class="PUNC">]</span><span class="PUNC">*</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">7</span><span class="PUNC">]</span><span class="PUNC">*</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">11</span><span class="PUNC">]</span><span class="PUNC">*</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">getMaxScaleOnAxis</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">this.elements</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">Math.sqrt</span><span class="PUNC">(</span><span class="NAME">Math.max</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">*</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">+</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">*</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">+</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">*</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">Math.max</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">4</span><span class="PUNC">]</span><span class="PUNC">*</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">4</span><span class="PUNC">]</span><span class="PUNC">+</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">5</span><span class="PUNC">]</span><span class="PUNC">*</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">5</span><span class="PUNC">]</span><span class="PUNC">+</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">6</span><span class="PUNC">]</span><span class="PUNC">*</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">6</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">8</span><span class="PUNC">]</span><span class="PUNC">*</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">8</span><span class="PUNC">]</span><span class="PUNC">+</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">9</span><span class="PUNC">]</span><span class="PUNC">*</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">9</span><span class="PUNC">]</span><span class="PUNC">+</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">10</span><span class="PUNC">]</span><span class="PUNC">*</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">10</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">makeTranslation</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.set</span><span class="PUNC">(</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">makeRotationX</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">Math.cos</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">Math.sin</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.set</span><span class="PUNC">(</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>103</span> </span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="PUNC">-</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">makeRotationY</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">Math.cos</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">Math.sin</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.set</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="PUNC">-</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">makeRotationZ</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">Math.cos</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">Math.sin</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.set</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">,</span><span class="PUNC">-</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">makeRotationAxis</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">Math.cos</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">Math.sin</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">-</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">a.x</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">a.y</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">a.z</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">=</span><span class="NAME">e</span><span class="PUNC">*</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">j</span><span class="PUNC">=</span><span class="NAME">e</span><span class="PUNC">*</span><span class="NAME">h</span><span class="PUNC">;</span><span class="NAME">this.set</span><span class="PUNC">(</span><span class="NAME">i</span><span class="PUNC">*</span><span class="NAME">f</span><span class="PUNC">+</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">*</span><span class="NAME">h</span><span class="PUNC">-</span><span class="NAME">d</span><span class="PUNC">*</span><span class="NAME">g</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">*</span><span class="NAME">g</span><span class="PUNC">+</span><span class="NAME">d</span><span class="PUNC">*</span><span class="NAME">h</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">*</span><span class="NAME">h</span><span class="PUNC">+</span><span class="NAME">d</span><span class="PUNC">*</span><span class="NAME">g</span><span class="PUNC">,</span><span class="NAME">j</span><span class="PUNC">*</span><span class="NAME">h</span><span class="PUNC">+</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">j</span><span class="PUNC">*</span><span class="NAME">g</span><span class="PUNC">-</span><span class="NAME">d</span><span class="PUNC">*</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">*</span><span class="NAME">g</span><span class="PUNC">-</span><span class="NAME">d</span><span class="PUNC">*</span><span class="NAME">h</span><span class="PUNC">,</span><span class="NAME">j</span><span class="PUNC">*</span><span class="NAME">g</span><span class="PUNC">+</span><span class="NAME">d</span><span class="PUNC">*</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">*</span><span class="NAME">g</span><span class="PUNC">*</span><span class="NAME">g</span><span class="PUNC">+</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">makeScale</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.set</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>104</span> </span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">compose</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.makeRotationFromQuaternion</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.scale</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.setPosition</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">decompose</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Matrix4</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">this.elements</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">a.set</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">[</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">length</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">a.set</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">[</span><span class="NUMB">4</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">[</span><span class="NUMB">5</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">[</span><span class="NUMB">6</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">length</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">=</span><span class="NAME">a.set</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">[</span><span class="NUMB">8</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">[</span><span class="NUMB">9</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">[</span><span class="NUMB">10</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">length</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">c.x</span><span class="PUNC">=</span><span class="NAME">f</span><span class="PUNC">[</span><span class="NUMB">12</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">c.y</span><span class="PUNC">=</span><span class="NAME">f</span><span class="PUNC">[</span><span class="NUMB">13</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">c.z</span><span class="PUNC">=</span><span class="NAME">f</span><span class="PUNC">[</span><span class="NUMB">14</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">b.elements.set</span><span class="PUNC">(</span><span class="NAME">this.elements</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">/</span><span class="NAME">h</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">/</span><span class="NAME">g</span><span class="PUNC">,</span><span class="NAME">j</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">/</span><span class="NAME">i</span><span class="PUNC">;</span><span class="NAME">b.elements</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">*</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">;</span><span class="NAME">b.elements</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">*</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">;</span><span class="NAME">b.elements</span><span class="PUNC">[</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">*</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">;</span><span class="NAME">b.elements</span><span class="PUNC">[</span><span class="NUMB">4</span><span class="PUNC">]</span><span class="PUNC">*</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>105</span> </span><span class="NAME">f</span><span class="PUNC">;</span><span class="NAME">b.elements</span><span class="PUNC">[</span><span class="NUMB">5</span><span class="PUNC">]</span><span class="PUNC">*</span><span class="PUNC">=</span><span class="NAME">f</span><span class="PUNC">;</span><span class="NAME">b.elements</span><span class="PUNC">[</span><span class="NUMB">6</span><span class="PUNC">]</span><span class="PUNC">*</span><span class="PUNC">=</span><span class="NAME">f</span><span class="PUNC">;</span><span class="NAME">b.elements</span><span class="PUNC">[</span><span class="NUMB">8</span><span class="PUNC">]</span><span class="PUNC">*</span><span class="PUNC">=</span><span class="NAME">j</span><span class="PUNC">;</span><span class="NAME">b.elements</span><span class="PUNC">[</span><span class="NUMB">9</span><span class="PUNC">]</span><span class="PUNC">*</span><span class="PUNC">=</span><span class="NAME">j</span><span class="PUNC">;</span><span class="NAME">b.elements</span><span class="PUNC">[</span><span class="NUMB">10</span><span class="PUNC">]</span><span class="PUNC">*</span><span class="PUNC">=</span><span class="NAME">j</span><span class="PUNC">;</span><span class="NAME">d.setFromRotationMatrix</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">e.x</span><span class="PUNC">=</span><span class="NAME">h</span><span class="PUNC">;</span><span class="NAME">e.y</span><span class="PUNC">=</span><span class="NAME">g</span><span class="PUNC">;</span><span class="NAME">e.z</span><span class="PUNC">=</span><span class="NAME">i</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">makeFrustum</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">this.elements</span><span class="PUNC">;</span><span class="NAME">h</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NUMB">2</span><span class="PUNC">*</span><span class="NAME">e</span><span class="PUNC">/</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">-</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">h</span><span class="PUNC">[</span><span class="NUMB">4</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">h</span><span class="PUNC">[</span><span class="NUMB">8</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">+</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">/</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">-</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">h</span><span class="PUNC">[</span><span class="NUMB">12</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">h</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">h</span><span class="PUNC">[</span><span class="NUMB">5</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NUMB">2</span><span class="PUNC">*</span><span class="NAME">e</span><span class="PUNC">/</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">-</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">h</span><span class="PUNC">[</span><span class="NUMB">9</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">+</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">/</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">-</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">h</span><span class="PUNC">[</span><span class="NUMB">13</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">h</span><span class="PUNC">[</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">h</span><span class="PUNC">[</span><span class="NUMB">6</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">h</span><span class="PUNC">[</span><span class="NUMB">10</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">+</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">/</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">-</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">h</span><span class="PUNC">[</span><span class="NUMB">14</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="NUMB">2</span><span class="PUNC">*</span><span class="NAME">f</span><span class="PUNC">*</span><span class="NAME">e</span><span class="PUNC">/</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">-</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">h</span><span class="PUNC">[</span><span class="NUMB">3</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">h</span><span class="PUNC">[</span><span class="NUMB">7</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">h</span><span class="PUNC">[</span><span class="NUMB">11</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">h</span><span class="PUNC">[</span><span class="NUMB">15</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">makePerspective</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">*</span><span class="NAME">Math.tan</span><span class="PUNC">(</span><span class="NAME">THREE.Math.degToRad</span><span class="PUNC">(</span><span class="NUMB">0.5</span><span class="PUNC">*</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="NAME">a</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.makeFrustum</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">*</span><span class="WHIT">
<span class='line'>106</span> </span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">*</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">makeOrthographic</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">this.elements</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">-</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">-</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">j</span><span class="PUNC">=</span><span class="NAME">f</span><span class="PUNC">-</span><span class="NAME">e</span><span class="PUNC">;</span><span class="NAME">h</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NUMB">2</span><span class="PUNC">/</span><span class="NAME">g</span><span class="PUNC">;</span><span class="NAME">h</span><span class="PUNC">[</span><span class="NUMB">4</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">h</span><span class="PUNC">[</span><span class="NUMB">8</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">h</span><span class="PUNC">[</span><span class="NUMB">12</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="PUNC">(</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">+</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">/</span><span class="NAME">g</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">h</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">h</span><span class="PUNC">[</span><span class="NUMB">5</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NUMB">2</span><span class="PUNC">/</span><span class="NAME">i</span><span class="PUNC">;</span><span class="NAME">h</span><span class="PUNC">[</span><span class="NUMB">9</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">h</span><span class="PUNC">[</span><span class="NUMB">13</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="PUNC">(</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">+</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">/</span><span class="NAME">i</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">h</span><span class="PUNC">[</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">h</span><span class="PUNC">[</span><span class="NUMB">6</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">h</span><span class="PUNC">[</span><span class="NUMB">10</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="NUMB">2</span><span class="PUNC">/</span><span class="NAME">j</span><span class="PUNC">;</span><span class="NAME">h</span><span class="PUNC">[</span><span class="NUMB">14</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="PUNC">(</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">+</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">/</span><span class="NAME">j</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">h</span><span class="PUNC">[</span><span class="NUMB">3</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">h</span><span class="PUNC">[</span><span class="NUMB">7</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">h</span><span class="PUNC">[</span><span class="NUMB">11</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">h</span><span class="PUNC">[</span><span class="NUMB">15</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">fromArray</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.elements.set</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">toArray</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">this.elements</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">3</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">4</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">5</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">6</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">7</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">8</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">9</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">10</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">11</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">12</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">13</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">14</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">15</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">clone</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">this.elements</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Matrix4</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>107</span> </span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">4</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">8</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">12</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">5</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">9</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">13</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">6</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">10</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">14</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">3</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">7</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">11</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">15</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.Ray</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.origin</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">a</span><span class="PUNC">?</span><span class="NAME">a</span><span class="PUNC">:</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">;</span><span class="NAME">this.direction</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">b</span><span class="PUNC">?</span><span class="NAME">b</span><span class="PUNC">:</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>108</span> </span><span class="NAME">THREE.Ray.prototype</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="NAME">constructor</span><span class="PUNC">:</span><span class="NAME">THREE.Ray</span><span class="PUNC">,</span><span class="NAME">set</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.origin.copy</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.direction.copy</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">copy</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.origin.copy</span><span class="PUNC">(</span><span class="NAME">a.origin</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.direction.copy</span><span class="PUNC">(</span><span class="NAME">a.direction</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">at</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">||</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">copy</span><span class="PUNC">(</span><span class="NAME">this.direction</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">multiplyScalar</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">add</span><span class="PUNC">(</span><span class="NAME">this.origin</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">recast</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.origin.copy</span><span class="PUNC">(</span><span class="NAME">this.at</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">closestPointToPoint</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">||</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">;</span><span class="NAME">c.subVectors</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">this.origin</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>109</span> </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">c.dot</span><span class="PUNC">(</span><span class="NAME">this.direction</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">></span><span class="NAME">d</span><span class="PUNC">?</span><span class="NAME">c.copy</span><span class="PUNC">(</span><span class="NAME">this.origin</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">c.copy</span><span class="PUNC">(</span><span class="NAME">this.direction</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">multiplyScalar</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">add</span><span class="PUNC">(</span><span class="NAME">this.origin</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">distanceToPoint</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">a.subVectors</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">this.origin</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">dot</span><span class="PUNC">(</span><span class="NAME">this.direction</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">></span><span class="NAME">c</span><span class="PUNC">)</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.origin.distanceTo</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a.copy</span><span class="PUNC">(</span><span class="NAME">this.direction</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">multiplyScalar</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">add</span><span class="PUNC">(</span><span class="NAME">this.origin</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a.distanceTo</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">distanceSqToSegment</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">a.clone</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">add</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">multiplyScalar</span><span class="PUNC">(</span><span class="NUMB">0.5</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">b.clone</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">sub</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">normalize</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NUMB">0.5</span><span class="PUNC">*</span><span class="NAME">a.distanceTo</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>110</span> </span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">this.origin.clone</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">sub</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="NAME">this.direction.dot</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">g.dot</span><span class="PUNC">(</span><span class="NAME">this.direction</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="NAME">g.dot</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">j</span><span class="PUNC">=</span><span class="NAME">g.lengthSq</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">l</span><span class="PUNC">=</span><span class="NAME">Math.abs</span><span class="PUNC">(</span><span class="NUMB">1</span><span class="PUNC">-</span><span class="NAME">a</span><span class="PUNC">*</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">m</span><span class="PUNC">,</span><span class="NAME">n</span><span class="PUNC">;</span><span class="NUMB">0</span><span class="PUNC">&lt;=</span><span class="NAME">l</span><span class="PUNC">?</span><span class="PUNC">(</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">*</span><span class="NAME">i</span><span class="PUNC">-</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">m</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">*</span><span class="NAME">b</span><span class="PUNC">-</span><span class="NAME">i</span><span class="PUNC">,</span><span class="NAME">n</span><span class="PUNC">=</span><span class="NAME">h</span><span class="PUNC">*</span><span class="NAME">l</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">&lt;=</span><span class="NAME">g</span><span class="PUNC">?</span><span class="NAME">m</span><span class="PUNC">>=</span><span class="PUNC">-</span><span class="NAME">n</span><span class="PUNC">?</span><span class="NAME">m</span><span class="PUNC">&lt;=</span><span class="NAME">n</span><span class="PUNC">?</span><span class="PUNC">(</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">/</span><span class="NAME">l</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">*</span><span class="PUNC">=</span><span class="NAME">h</span><span class="PUNC">,</span><span class="NAME">m</span><span class="PUNC">*</span><span class="PUNC">=</span><span class="NAME">h</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">g</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">g</span><span class="PUNC">+</span><span class="NAME">a</span><span class="PUNC">*</span><span class="NAME">m</span><span class="PUNC">+</span><span class="NUMB">2</span><span class="PUNC">*</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="NAME">m</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">*</span><span class="NAME">g</span><span class="PUNC">+</span><span class="NAME">m</span><span class="PUNC">+</span><span class="NUMB">2</span><span class="PUNC">*</span><span class="NAME">i</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="NAME">j</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="PUNC">(</span><span class="NAME">m</span><span class="PUNC">=</span><span class="NAME">h</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">Math.max</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="PUNC">-</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">*</span><span class="NAME">m</span><span class="PUNC">+</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="NAME">g</span><span class="PUNC">*</span><span class="NAME">g</span><span class="PUNC">+</span><span class="NAME">m</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">m</span><span class="PUNC">+</span><span class="NUMB">2</span><span class="PUNC">*</span><span class="NAME">i</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="NAME">j</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="PUNC">(</span><span class="NAME">m</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="NAME">h</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">Math.max</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="PUNC">-</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">*</span><span class="NAME">m</span><span class="PUNC">+</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="NAME">g</span><span class="PUNC">*</span><span class="NAME">g</span><span class="PUNC">+</span><span class="NAME">m</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">m</span><span class="PUNC">+</span><span class="NUMB">2</span><span class="PUNC">*</span><span class="NAME">i</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="NAME">j</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">m</span><span class="PUNC">&lt;=</span><span class="PUNC">-</span><span class="NAME">n</span><span class="PUNC">?</span><span class="PUNC">(</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">Math.max</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="PUNC">-</span><span class="PUNC">(</span><span class="PUNC">-</span><span class="NAME">a</span><span class="PUNC">*</span><span class="NAME">h</span><span class="PUNC">+</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">m</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">&lt;</span><span class="NAME">g</span><span class="PUNC">?</span><span class="PUNC">-</span><span class="NAME">h</span><span class="PUNC">:</span><span class="NAME">Math.min</span><span class="PUNC">(</span><span class="NAME">Math.max</span><span class="PUNC">(</span><span class="PUNC">-</span><span class="NAME">h</span><span class="PUNC">,</span><span class="PUNC">-</span><span class="NAME">i</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="NAME">g</span><span class="PUNC">*</span><span class="NAME">g</span><span class="PUNC">+</span><span class="NAME">m</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">m</span><span class="PUNC">+</span><span class="NUMB">2</span><span class="PUNC">*</span><span class="NAME">i</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="NAME">j</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">m</span><span class="PUNC">&lt;=</span><span class="NAME">n</span><span class="PUNC">?</span><span class="PUNC">(</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">m</span><span class="PUNC">=</span><span class="NAME">Math.min</span><span class="PUNC">(</span><span class="NAME">Math.max</span><span class="PUNC">(</span><span class="PUNC">-</span><span class="NAME">h</span><span class="PUNC">,</span><span class="PUNC">-</span><span class="NAME">i</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">m</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">m</span><span class="PUNC">+</span><span class="NUMB">2</span><span class="PUNC">*</span><span class="NAME">i</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="NAME">j</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="PUNC">(</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">Math.max</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="PUNC">-</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">*</span><span class="NAME">h</span><span class="PUNC">+</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">m</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">&lt;</span><span class="NAME">g</span><span class="PUNC">?</span><span class="NAME">h</span><span class="PUNC">:</span><span class="NAME">Math.min</span><span class="PUNC">(</span><span class="NAME">Math.max</span><span class="PUNC">(</span><span class="PUNC">-</span><span class="NAME">h</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>111</span> </span><span class="PUNC">-</span><span class="NAME">i</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="NAME">g</span><span class="PUNC">*</span><span class="NAME">g</span><span class="PUNC">+</span><span class="NAME">m</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">m</span><span class="PUNC">+</span><span class="NUMB">2</span><span class="PUNC">*</span><span class="NAME">i</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="NAME">j</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="PUNC">(</span><span class="NAME">m</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">&lt;</span><span class="NAME">a</span><span class="PUNC">?</span><span class="PUNC">-</span><span class="NAME">h</span><span class="PUNC">:</span><span class="NAME">h</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">Math.max</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="PUNC">-</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">*</span><span class="NAME">m</span><span class="PUNC">+</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="NAME">g</span><span class="PUNC">*</span><span class="NAME">g</span><span class="PUNC">+</span><span class="NAME">m</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">m</span><span class="PUNC">+</span><span class="NUMB">2</span><span class="PUNC">*</span><span class="NAME">i</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="NAME">j</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">&&</span><span class="NAME">c.copy</span><span class="PUNC">(</span><span class="NAME">this.direction.clone</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">multiplyScalar</span><span class="PUNC">(</span><span class="NAME">g</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">add</span><span class="PUNC">(</span><span class="NAME">this.origin</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">&&</span><span class="NAME">d.copy</span><span class="PUNC">(</span><span class="NAME">f.clone</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">multiplyScalar</span><span class="PUNC">(</span><span class="NAME">m</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">add</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">isIntersectionSphere</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.distanceToPoint</span><span class="PUNC">(</span><span class="NAME">a.center</span><span class="PUNC">)</span><span class="PUNC">&lt;=</span><span class="NAME">a.radius</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">isIntersectionPlane</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">a.distanceToPoint</span><span class="PUNC">(</span><span class="NAME">this.origin</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">===</span><span class="NAME">b</span><span class="PUNC">||</span><span class="NUMB">0</span><span class="PUNC">></span><span class="NAME">a.normal.dot</span><span class="PUNC">(</span><span class="NAME">this.direction</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">b</span><span class="PUNC">?</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">:</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">distanceToPlane</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">a.normal.dot</span><span class="PUNC">(</span><span class="NAME">this.direction</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">==</span><span class="NAME">b</span><span class="PUNC">)</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">==</span><span class="NAME">a.distanceToPoint</span><span class="PUNC">(</span><span class="NAME">this.origin</span><span class="PUNC">)</span><span class="PUNC">?</span><span class="WHIT">
<span class='line'>112</span> </span><span class="NUMB">0</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="PUNC">(</span><span class="NAME">this.origin.dot</span><span class="PUNC">(</span><span class="NAME">a.normal</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="NAME">a.constant</span><span class="PUNC">)</span><span class="PUNC">/</span><span class="NAME">b</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">&lt;=</span><span class="NAME">a</span><span class="PUNC">?</span><span class="NAME">a</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">intersectPlane</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.distanceToPlane</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">===</span><span class="NAME">c</span><span class="PUNC">?</span><span class="KEYW">null</span><span class="PUNC">:</span><span class="NAME">this.at</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">applyMatrix4</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.direction.add</span><span class="PUNC">(</span><span class="NAME">this.origin</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">applyMatrix4</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.origin.applyMatrix4</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.direction.sub</span><span class="PUNC">(</span><span class="NAME">this.origin</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">equals</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a.origin.equals</span><span class="PUNC">(</span><span class="NAME">this.origin</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="NAME">a.direction.equals</span><span class="PUNC">(</span><span class="NAME">this.direction</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">clone</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="PUNC">(</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Ray</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">copy</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.Sphere</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.center</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">a</span><span class="PUNC">?</span><span class="NAME">a</span><span class="PUNC">:</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">;</span><span class="NAME">this.radius</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">b</span><span class="PUNC">?</span><span class="NAME">b</span><span class="PUNC">:</span><span class="NUMB">0</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>113</span> </span><span class="NAME">THREE.Sphere.prototype</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="NAME">constructor</span><span class="PUNC">:</span><span class="NAME">THREE.Sphere</span><span class="PUNC">,</span><span class="NAME">set</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.center.copy</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.radius</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">setFromPoints</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">a.length</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">&lt;</span><span class="NAME">e</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NAME">d</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">lengthSq</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">Math.max</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.center.set</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.radius</span><span class="PUNC">=</span><span class="NAME">Math.sqrt</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">copy</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.center.copy</span><span class="PUNC">(</span><span class="NAME">a.center</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.radius</span><span class="PUNC">=</span><span class="NAME">a.radius</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">empty</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">>=</span><span class="NAME">this.radius</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">containsPoint</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a.distanceToSquared</span><span class="PUNC">(</span><span class="NAME">this.center</span><span class="PUNC">)</span><span class="PUNC">&lt;=</span><span class="NAME">this.radius</span><span class="PUNC">*</span><span class="NAME">this.radius</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">distanceToPoint</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a.distanceTo</span><span class="PUNC">(</span><span class="NAME">this.center</span><span class="PUNC">)</span><span class="PUNC">-</span><span class="WHIT">
<span class='line'>114</span> </span><span class="NAME">this.radius</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">intersectsSphere</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.radius</span><span class="PUNC">+</span><span class="NAME">a.radius</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a.center.distanceToSquared</span><span class="PUNC">(</span><span class="NAME">this.center</span><span class="PUNC">)</span><span class="PUNC">&lt;=</span><span class="NAME">b</span><span class="PUNC">*</span><span class="NAME">b</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">clampPoint</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.center.distanceToSquared</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">||</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">;</span><span class="NAME">d.copy</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">></span><span class="NAME">this.radius</span><span class="PUNC">*</span><span class="NAME">this.radius</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">d.sub</span><span class="PUNC">(</span><span class="NAME">this.center</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">normalize</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">d.multiplyScalar</span><span class="PUNC">(</span><span class="NAME">this.radius</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">add</span><span class="PUNC">(</span><span class="NAME">this.center</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">getBoundingBox</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">||</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Box3</span><span class="PUNC">;</span><span class="NAME">a.set</span><span class="PUNC">(</span><span class="NAME">this.center</span><span class="PUNC">,</span><span class="NAME">this.center</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a.expandByScalar</span><span class="PUNC">(</span><span class="NAME">this.radius</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">applyMatrix4</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.center.applyMatrix4</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>115</span> </span><span class="NAME">this.radius</span><span class="PUNC">*</span><span class="PUNC">=</span><span class="NAME">a.getMaxScaleOnAxis</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">translate</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.center.add</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">equals</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a.center.equals</span><span class="PUNC">(</span><span class="NAME">this.center</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="NAME">a.radius</span><span class="PUNC">===</span><span class="NAME">this.radius</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">clone</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="PUNC">(</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Sphere</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">copy</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.Frustum</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.planes</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">a</span><span class="PUNC">?</span><span class="NAME">a</span><span class="PUNC">:</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Plane</span><span class="PUNC">,</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">b</span><span class="PUNC">?</span><span class="NAME">b</span><span class="PUNC">:</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Plane</span><span class="PUNC">,</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">c</span><span class="PUNC">?</span><span class="NAME">c</span><span class="PUNC">:</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Plane</span><span class="PUNC">,</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">d</span><span class="PUNC">?</span><span class="NAME">d</span><span class="PUNC">:</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Plane</span><span class="PUNC">,</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">e</span><span class="PUNC">?</span><span class="NAME">e</span><span class="PUNC">:</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Plane</span><span class="PUNC">,</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">f</span><span class="PUNC">?</span><span class="NAME">f</span><span class="PUNC">:</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Plane</span><span class="PUNC">]</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>116</span> </span><span class="NAME">THREE.Frustum.prototype</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="NAME">constructor</span><span class="PUNC">:</span><span class="NAME">THREE.Frustum</span><span class="PUNC">,</span><span class="NAME">set</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">this.planes</span><span class="PUNC">;</span><span class="NAME">h</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">copy</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">h</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">copy</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">h</span><span class="PUNC">[</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">copy</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">h</span><span class="PUNC">[</span><span class="NUMB">3</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">copy</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">h</span><span class="PUNC">[</span><span class="NUMB">4</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">copy</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">h</span><span class="PUNC">[</span><span class="NUMB">5</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">copy</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">copy</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.planes</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NUMB">6</span><span class="PUNC">></span><span class="NAME">c</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">copy</span><span class="PUNC">(</span><span class="NAME">a.planes</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">setFromMatrix</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.planes</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">a.elements</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NUMB">3</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NUMB">4</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NUMB">5</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NUMB">6</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">j</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NUMB">7</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">l</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NUMB">8</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">m</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NUMB">9</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">n</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NUMB">10</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">p</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NUMB">11</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">t</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NUMB">12</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">q</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NUMB">13</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">r</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NUMB">14</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NUMB">15</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">setComponents</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">-</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">j</span><span class="PUNC">-</span><span class="NAME">h</span><span class="PUNC">,</span><span class="NAME">p</span><span class="PUNC">-</span><span class="NAME">l</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">-</span><span class="NAME">t</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">normalize</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">setComponents</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">+</span><span class="WHIT">
<span class='line'>117</span> </span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">j</span><span class="PUNC">+</span><span class="NAME">h</span><span class="PUNC">,</span><span class="NAME">p</span><span class="PUNC">+</span><span class="NAME">l</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">+</span><span class="NAME">t</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">normalize</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">setComponents</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">+</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">j</span><span class="PUNC">+</span><span class="NAME">g</span><span class="PUNC">,</span><span class="NAME">p</span><span class="PUNC">+</span><span class="NAME">m</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">+</span><span class="NAME">q</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">normalize</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">3</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">setComponents</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">-</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">j</span><span class="PUNC">-</span><span class="NAME">g</span><span class="PUNC">,</span><span class="NAME">p</span><span class="PUNC">-</span><span class="NAME">m</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">-</span><span class="NAME">q</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">normalize</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">4</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">setComponents</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">-</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">j</span><span class="PUNC">-</span><span class="NAME">i</span><span class="PUNC">,</span><span class="NAME">p</span><span class="PUNC">-</span><span class="NAME">n</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">-</span><span class="NAME">r</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">normalize</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">5</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">setComponents</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">+</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">j</span><span class="PUNC">+</span><span class="NAME">i</span><span class="PUNC">,</span><span class="NAME">p</span><span class="PUNC">+</span><span class="NAME">n</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">+</span><span class="NAME">r</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">normalize</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">intersectsObject</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">b.geometry</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">b.matrixWorld</span><span class="PUNC">;</span><span class="KEYW">null</span><span class="PUNC">===</span><span class="NAME">c.boundingSphere</span><span class="PUNC">&&</span><span class="NAME">c.computeBoundingSphere</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="NAME">c.boundingSphere.radius</span><span class="PUNC">*</span><span class="NAME">b.getMaxScaleOnAxis</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a.getPositionFromMatrix</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.planes</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NUMB">6</span><span class="PUNC">></span><span class="NAME">d</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NAME">d</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">distanceToPoint</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">&lt;</span><span class="WHIT">
<span class='line'>118</span> </span><span class="NAME">c</span><span class="PUNC">)</span><span class="KEYW">return</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">intersectsSphere</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.planes</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">a.center</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="NAME">a.radius</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NUMB">6</span><span class="PUNC">></span><span class="NAME">d</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NAME">d</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">distanceToPoint</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">&lt;</span><span class="NAME">a</span><span class="PUNC">)</span><span class="KEYW">return</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">intersectsBox</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">this.planes</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NUMB">6</span><span class="PUNC">></span><span class="NAME">e</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">[</span><span class="NAME">e</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">a.x</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">&lt;</span><span class="NAME">f.normal.x</span><span class="PUNC">?</span><span class="NAME">c.min.x</span><span class="PUNC">:</span><span class="NAME">c.max.x</span><span class="PUNC">;</span><span class="NAME">b.x</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">&lt;</span><span class="NAME">f.normal.x</span><span class="PUNC">?</span><span class="NAME">c.max.x</span><span class="PUNC">:</span><span class="NAME">c.min.x</span><span class="PUNC">;</span><span class="NAME">a.y</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">&lt;</span><span class="NAME">f.normal.y</span><span class="PUNC">?</span><span class="NAME">c.min.y</span><span class="PUNC">:</span><span class="NAME">c.max.y</span><span class="PUNC">;</span><span class="NAME">b.y</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">&lt;</span><span class="NAME">f.normal.y</span><span class="PUNC">?</span><span class="NAME">c.max.y</span><span class="PUNC">:</span><span class="NAME">c.min.y</span><span class="PUNC">;</span><span class="NAME">a.z</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">&lt;</span><span class="NAME">f.normal.z</span><span class="PUNC">?</span><span class="NAME">c.min.z</span><span class="PUNC">:</span><span class="NAME">c.max.z</span><span class="PUNC">;</span><span class="NAME">b.z</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">&lt;</span><span class="NAME">f.normal.z</span><span class="PUNC">?</span><span class="NAME">c.max.z</span><span class="PUNC">:</span><span class="NAME">c.min.z</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">f.distanceToPoint</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>119</span> </span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">f.distanceToPoint</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">></span><span class="NAME">h</span><span class="PUNC">&&</span><span class="NUMB">0</span><span class="PUNC">></span><span class="NAME">f</span><span class="PUNC">)</span><span class="KEYW">return</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">}</span><span class="KEYW">return</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">containsPoint</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.planes</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NUMB">6</span><span class="PUNC">></span><span class="NAME">c</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">></span><span class="NAME">b</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">distanceToPoint</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="KEYW">return</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">clone</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="PUNC">(</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Frustum</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">copy</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.Plane</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.normal</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">a</span><span class="PUNC">?</span><span class="NAME">a</span><span class="PUNC">:</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">(</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.constant</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">b</span><span class="PUNC">?</span><span class="NAME">b</span><span class="PUNC">:</span><span class="NUMB">0</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>120</span> </span><span class="NAME">THREE.Plane.prototype</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="NAME">constructor</span><span class="PUNC">:</span><span class="NAME">THREE.Plane</span><span class="PUNC">,</span><span class="NAME">set</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.normal.copy</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.constant</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">setComponents</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.normal.set</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.constant</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">setFromNormalAndCoplanarPoint</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.normal.copy</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.constant</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="NAME">b.dot</span><span class="PUNC">(</span><span class="NAME">this.normal</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">setFromCoplanarPoints</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">a.subVectors</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">cross</span><span class="PUNC">(</span><span class="NAME">b.subVectors</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">normalize</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.setFromNormalAndCoplanarPoint</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>121</span> </span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">copy</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.normal.copy</span><span class="PUNC">(</span><span class="NAME">a.normal</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.constant</span><span class="PUNC">=</span><span class="NAME">a.constant</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">normalize</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">/</span><span class="NAME">this.normal.length</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.normal.multiplyScalar</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.constant</span><span class="PUNC">*</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">negate</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.constant</span><span class="PUNC">*</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">this.normal.negate</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">distanceToPoint</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.normal.dot</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="NAME">this.constant</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">distanceToSphere</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.distanceToPoint</span><span class="PUNC">(</span><span class="NAME">a.center</span><span class="PUNC">)</span><span class="PUNC">-</span><span class="NAME">a.radius</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">projectPoint</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.orthoPoint</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">sub</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">negate</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">orthoPoint</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>122</span> </span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.distanceToPoint</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">||</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">copy</span><span class="PUNC">(</span><span class="NAME">this.normal</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">multiplyScalar</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">isIntersectionLine</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.distanceToPoint</span><span class="PUNC">(</span><span class="NAME">a.start</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">this.distanceToPoint</span><span class="PUNC">(</span><span class="NAME">a.end</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">></span><span class="NAME">b</span><span class="PUNC">&&</span><span class="NUMB">0</span><span class="PUNC">&lt;</span><span class="NAME">a</span><span class="PUNC">||</span><span class="NUMB">0</span><span class="PUNC">></span><span class="NAME">a</span><span class="PUNC">&&</span><span class="NUMB">0</span><span class="PUNC">&lt;</span><span class="NAME">b</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">intersectLine</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">||</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">b.delta</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">this.normal.dot</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">==</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">==</span><span class="NAME">this.distanceToPoint</span><span class="PUNC">(</span><span class="NAME">b.start</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">d.copy</span><span class="PUNC">(</span><span class="NAME">b.start</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">f</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="PUNC">(</span><span class="NAME">b.start.dot</span><span class="PUNC">(</span><span class="NAME">this.normal</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="NAME">this.constant</span><span class="PUNC">)</span><span class="PUNC">/</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">></span><span class="NAME">f</span><span class="PUNC">||</span><span class="NUMB">1</span><span class="PUNC">&lt;</span><span class="NAME">f</span><span class="PUNC">?</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">:</span><span class="NAME">d.copy</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">multiplyScalar</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">add</span><span class="PUNC">(</span><span class="NAME">b.start</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>123</span> </span><span class="NAME">coplanarPoint</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">||</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">copy</span><span class="PUNC">(</span><span class="NAME">this.normal</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">multiplyScalar</span><span class="PUNC">(</span><span class="PUNC">-</span><span class="NAME">this.constant</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">applyMatrix4</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">||</span><span class="PUNC">(</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Matrix3</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">getNormalMatrix</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">a.copy</span><span class="PUNC">(</span><span class="NAME">this.normal</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">applyMatrix3</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">this.coplanarPoint</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">f.applyMatrix4</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.setFromNormalAndCoplanarPoint</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">translate</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.constant</span><span class="PUNC">-</span><span class="PUNC">=</span><span class="NAME">a.dot</span><span class="PUNC">(</span><span class="NAME">this.normal</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">equals</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a.normal.equals</span><span class="PUNC">(</span><span class="NAME">this.normal</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="WHIT">
<span class='line'>124</span> </span><span class="NAME">a.constant</span><span class="PUNC">==</span><span class="NAME">this.constant</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">clone</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="PUNC">(</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Plane</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">copy</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.Math</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="NAME">PI2</span><span class="PUNC">:</span><span class="NUMB">2</span><span class="PUNC">*</span><span class="NAME">Math.PI</span><span class="PUNC">,</span><span class="NAME">generateUUID</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="STRN">"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz"</span><span class="PUNC">.</span><span class="NAME">split</span><span class="PUNC">(</span><span class="STRN">""</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">Array</span><span class="PUNC">(</span><span class="NUMB">36</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">e</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NUMB">36</span><span class="PUNC">></span><span class="NAME">e</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NUMB">8</span><span class="PUNC">==</span><span class="NAME">e</span><span class="PUNC">||</span><span class="NUMB">13</span><span class="PUNC">==</span><span class="NAME">e</span><span class="PUNC">||</span><span class="NUMB">18</span><span class="PUNC">==</span><span class="NAME">e</span><span class="PUNC">||</span><span class="NUMB">23</span><span class="PUNC">==</span><span class="NAME">e</span><span class="PUNC">?</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NAME">e</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="STRN">"-"</span><span class="PUNC">:</span><span class="NUMB">14</span><span class="PUNC">==</span><span class="NAME">e</span><span class="PUNC">?</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NAME">e</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="STRN">"4"</span><span class="PUNC">:</span><span class="PUNC">(</span><span class="NUMB">2</span><span class="PUNC">>=</span><span class="NAME">c</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NUMB">33554432</span><span class="PUNC">+</span><span class="NUMB">16777216</span><span class="PUNC">*</span><span class="NAME">Math.random</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">|</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">&</span><span class="NUMB">15</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">>></span><span class="PUNC">=</span><span class="NUMB">4</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NAME">e</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">19</span><span class="PUNC">==</span><span class="NAME">e</span><span class="PUNC">?</span><span class="NAME">d</span><span class="PUNC">&</span><span class="NUMB">3</span><span class="PUNC">|</span><span class="NUMB">8</span><span class="PUNC">:</span><span class="NAME">d</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">b.join</span><span class="PUNC">(</span><span class="STRN">""</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">clamp</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">&lt;</span><span class="NAME">b</span><span class="PUNC">?</span><span class="NAME">b</span><span class="PUNC">:</span><span class="NAME">a</span><span class="PUNC">></span><span class="NAME">c</span><span class="PUNC">?</span><span class="NAME">c</span><span class="PUNC">:</span><span class="NAME">a</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">clampBottom</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">&lt;</span><span class="NAME">b</span><span class="PUNC">?</span><span class="NAME">b</span><span class="PUNC">:</span><span class="NAME">a</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">mapLinear</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">+</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">-</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">-</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">/</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">-</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">smoothstep</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>125</span> </span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">&lt;=</span><span class="NAME">b</span><span class="PUNC">)</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">>=</span><span class="NAME">c</span><span class="PUNC">)</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">=</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">-</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">/</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">-</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">*</span><span class="NAME">a</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NUMB">3</span><span class="PUNC">-</span><span class="NUMB">2</span><span class="PUNC">*</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">smootherstep</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">&lt;=</span><span class="NAME">b</span><span class="PUNC">)</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">>=</span><span class="NAME">c</span><span class="PUNC">)</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">=</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">-</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">/</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">-</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">*</span><span class="NAME">a</span><span class="PUNC">*</span><span class="NAME">a</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NUMB">6</span><span class="PUNC">*</span><span class="NAME">a</span><span class="PUNC">-</span><span class="NUMB">15</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="NUMB">10</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">random16</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="PUNC">(</span><span class="NUMB">65280</span><span class="PUNC">*</span><span class="NAME">Math.random</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="NUMB">255</span><span class="PUNC">*</span><span class="NAME">Math.random</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">/</span><span class="NUMB">65535</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">randInt</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">+</span><span class="NAME">Math.floor</span><span class="PUNC">(</span><span class="NAME">Math.random</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">-</span><span class="NAME">a</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">randFloat</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">+</span><span class="NAME">Math.random</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">-</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">randFloatSpread</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NUMB">0.5</span><span class="PUNC">-</span><span class="NAME">Math.random</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">sign</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">></span><span class="NAME">a</span><span class="PUNC">?</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">:</span><span class="NUMB">0</span><span class="PUNC">&lt;</span><span class="NAME">a</span><span class="PUNC">?</span><span class="NUMB">1</span><span class="PUNC">:</span><span class="NUMB">0</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">degToRad</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">Math.PI</span><span class="PUNC">/</span><span class="WHIT">
<span class='line'>126</span> </span><span class="NUMB">180</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">*</span><span class="NAME">a</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">radToDeg</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="NUMB">180</span><span class="PUNC">/</span><span class="NAME">Math.PI</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">*</span><span class="NAME">a</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.Spline</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NUMB">0.5</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">-</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NUMB">0.5</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">-</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="PUNC">(</span><span class="NUMB">2</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">-</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="NAME">a</span><span class="PUNC">+</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">h</span><span class="PUNC">+</span><span class="PUNC">(</span><span class="PUNC">-</span><span class="NUMB">3</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">-</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">-</span><span class="NUMB">2</span><span class="PUNC">*</span><span class="NAME">a</span><span class="PUNC">-</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">f</span><span class="PUNC">+</span><span class="NAME">a</span><span class="PUNC">*</span><span class="NAME">e</span><span class="PUNC">+</span><span class="NAME">b</span><span class="PUNC">}</span><span class="NAME">this.points</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="NAME">x</span><span class="PUNC">:</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">y</span><span class="PUNC">:</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">z</span><span class="PUNC">:</span><span class="NUMB">0</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">,</span><span class="NAME">j</span><span class="PUNC">,</span><span class="NAME">l</span><span class="PUNC">,</span><span class="NAME">m</span><span class="PUNC">,</span><span class="NAME">n</span><span class="PUNC">;</span><span class="NAME">this.initFromArray</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.points</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">&lt;</span><span class="NAME">a.length</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">this.points</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="NAME">x</span><span class="PUNC">:</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">]</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">y</span><span class="PUNC">:</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">]</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">z</span><span class="PUNC">:</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">]</span><span class="PUNC">[</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">this.getPoint</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">e</span><span class="PUNC">=</span><span class="PUNC">(</span><span class="NAME">this.points.length</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">Math.floor</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">e</span><span class="PUNC">-</span><span class="NAME">f</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">===</span><span class="NAME">f</span><span class="PUNC">?</span><span class="NAME">f</span><span class="PUNC">:</span><span class="NAME">f</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">f</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">f</span><span class="PUNC">></span><span class="NAME">this.points.length</span><span class="PUNC">-</span><span class="NUMB">2</span><span class="PUNC">?</span><span class="NAME">this.points.length</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">:</span><span class="NAME">f</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NUMB">3</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">f</span><span class="PUNC">></span><span class="NAME">this.points.length</span><span class="PUNC">-</span><span class="NUMB">3</span><span class="PUNC">?</span><span class="NAME">this.points.length</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">:</span><span class="WHIT">
<span class='line'>127</span> </span><span class="NAME">f</span><span class="PUNC">+</span><span class="NUMB">2</span><span class="PUNC">;</span><span class="NAME">j</span><span class="PUNC">=</span><span class="NAME">this.points</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">l</span><span class="PUNC">=</span><span class="NAME">this.points</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">m</span><span class="PUNC">=</span><span class="NAME">this.points</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">n</span><span class="PUNC">=</span><span class="NAME">this.points</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NUMB">3</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">h</span><span class="PUNC">*</span><span class="NAME">h</span><span class="PUNC">;</span><span class="NAME">i</span><span class="PUNC">=</span><span class="NAME">h</span><span class="PUNC">*</span><span class="NAME">g</span><span class="PUNC">;</span><span class="NAME">d.x</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">(</span><span class="NAME">j.x</span><span class="PUNC">,</span><span class="NAME">l.x</span><span class="PUNC">,</span><span class="NAME">m.x</span><span class="PUNC">,</span><span class="NAME">n.x</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">d.y</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">(</span><span class="NAME">j.y</span><span class="PUNC">,</span><span class="NAME">l.y</span><span class="PUNC">,</span><span class="NAME">m.y</span><span class="PUNC">,</span><span class="NAME">n.y</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">d.z</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">(</span><span class="NAME">j.z</span><span class="PUNC">,</span><span class="NAME">l.z</span><span class="PUNC">,</span><span class="NAME">m.z</span><span class="PUNC">,</span><span class="NAME">n.z</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">this.getControlPointsArray</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.points.length</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">&lt;</span><span class="NAME">c</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.points</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="NAME">b.x</span><span class="PUNC">,</span><span class="NAME">b.y</span><span class="PUNC">,</span><span class="NAME">b.z</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">this.getLength</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">g</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">||</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NUMB">100</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.points.length</span><span class="PUNC">*</span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">f.copy</span><span class="PUNC">(</span><span class="NAME">this.points</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">&lt;</span><span class="NAME">c</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">b</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>128</span> </span><span class="NAME">a</span><span class="PUNC">/</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">this.getPoint</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">h.copy</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">h.distanceTo</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">f.copy</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">*</span><span class="PUNC">=</span><span class="NAME">this.points.length</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">Math.floor</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">!=</span><span class="NAME">e</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">g</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">i</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">g</span><span class="PUNC">[</span><span class="NAME">g.length</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">i</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="PUNC">{</span><span class="NAME">chunks</span><span class="PUNC">:</span><span class="NAME">g</span><span class="PUNC">,</span><span class="NAME">total</span><span class="PUNC">:</span><span class="NAME">i</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">this.reparametrizeByArcLength</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">,</span><span class="NAME">j</span><span class="PUNC">=</span><span class="NAME">this.getLength</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">g.push</span><span class="PUNC">(</span><span class="NAME">i.copy</span><span class="PUNC">(</span><span class="NAME">this.points</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">clone</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">&lt;</span><span class="NAME">this.points.length</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">j.chunks</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">]</span><span class="PUNC">-</span><span class="NAME">j.chunks</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">Math.ceil</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">*</span><span class="NAME">c</span><span class="PUNC">/</span><span class="NAME">j.total</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">=</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">/</span><span class="PUNC">(</span><span class="NAME">this.points.length</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">/</span><span class="PUNC">(</span><span class="NAME">this.points.length</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">&lt;</span><span class="NAME">h</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">e</span><span class="PUNC">+</span><span class="NAME">c</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NUMB">1</span><span class="PUNC">/</span><span class="NAME">h</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">-</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">this.getPoint</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>129</span> </span><span class="NAME">g.push</span><span class="PUNC">(</span><span class="NAME">i.copy</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">clone</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">g.push</span><span class="PUNC">(</span><span class="NAME">i.copy</span><span class="PUNC">(</span><span class="NAME">this.points</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">clone</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="NAME">this.points</span><span class="PUNC">=</span><span class="NAME">g</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.Triangle</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.a</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">a</span><span class="PUNC">?</span><span class="NAME">a</span><span class="PUNC">:</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">;</span><span class="NAME">this.b</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">b</span><span class="PUNC">?</span><span class="NAME">b</span><span class="PUNC">:</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">;</span><span class="NAME">this.c</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">c</span><span class="PUNC">?</span><span class="NAME">c</span><span class="PUNC">:</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.Triangle.normal</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">e</span><span class="PUNC">||</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">;</span><span class="NAME">e.subVectors</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a.subVectors</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">e.cross</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">e.lengthSq</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">&lt;</span><span class="NAME">b</span><span class="PUNC">?</span><span class="NAME">e.multiplyScalar</span><span class="PUNC">(</span><span class="NUMB">1</span><span class="PUNC">/</span><span class="NAME">Math.sqrt</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">e.set</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>130</span> </span><span class="NAME">THREE.Triangle.barycoordFromPoint</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">a.subVectors</span><span class="PUNC">(</span><span class="NAME">h</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b.subVectors</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">c.subVectors</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">a.dot</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">a.dot</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">a.dot</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">=</span><span class="NAME">b.dot</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">b.dot</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">j</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">*</span><span class="NAME">i</span><span class="PUNC">-</span><span class="NAME">e</span><span class="PUNC">*</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">g</span><span class="PUNC">||</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">==</span><span class="NAME">j</span><span class="PUNC">)</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">g.set</span><span class="PUNC">(</span><span class="PUNC">-</span><span class="NUMB">2</span><span class="PUNC">,</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">j</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">/</span><span class="NAME">j</span><span class="PUNC">;</span><span class="NAME">i</span><span class="PUNC">=</span><span class="PUNC">(</span><span class="NAME">i</span><span class="PUNC">*</span><span class="NAME">f</span><span class="PUNC">-</span><span class="NAME">e</span><span class="PUNC">*</span><span class="NAME">h</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">j</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">=</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">*</span><span class="NAME">h</span><span class="PUNC">-</span><span class="NAME">e</span><span class="PUNC">*</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">j</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">g.set</span><span class="PUNC">(</span><span class="NUMB">1</span><span class="PUNC">-</span><span class="NAME">i</span><span class="PUNC">-</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>131</span> </span><span class="NAME">THREE.Triangle.containsPoint</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">THREE.Triangle.barycoordFromPoint</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">&lt;=</span><span class="NAME">b.x</span><span class="PUNC">&&</span><span class="NUMB">0</span><span class="PUNC">&lt;=</span><span class="NAME">b.y</span><span class="PUNC">&&</span><span class="NUMB">1</span><span class="PUNC">>=</span><span class="NAME">b.x</span><span class="PUNC">+</span><span class="NAME">b.y</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>132</span> </span><span class="NAME">THREE.Triangle.prototype</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="NAME">constructor</span><span class="PUNC">:</span><span class="NAME">THREE.Triangle</span><span class="PUNC">,</span><span class="NAME">set</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.a.copy</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.b.copy</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.c.copy</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">setFromPointsAndIndices</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.a.copy</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.b.copy</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.c.copy</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NAME">d</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">copy</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.a.copy</span><span class="PUNC">(</span><span class="NAME">a.a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.b.copy</span><span class="PUNC">(</span><span class="NAME">a.b</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.c.copy</span><span class="PUNC">(</span><span class="NAME">a.c</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">area</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">a.subVectors</span><span class="PUNC">(</span><span class="NAME">this.c</span><span class="PUNC">,</span><span class="NAME">this.b</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b.subVectors</span><span class="PUNC">(</span><span class="NAME">this.a</span><span class="PUNC">,</span><span class="NAME">this.b</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NUMB">0.5</span><span class="PUNC">*</span><span class="NAME">a.cross</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">length</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">midpoint</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">||</span><span class="WHIT">
<span class='line'>133</span> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">addVectors</span><span class="PUNC">(</span><span class="NAME">this.a</span><span class="PUNC">,</span><span class="NAME">this.b</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">add</span><span class="PUNC">(</span><span class="NAME">this.c</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">multiplyScalar</span><span class="PUNC">(</span><span class="NUMB">1</span><span class="PUNC">/</span><span class="NUMB">3</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">normal</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">THREE.Triangle.normal</span><span class="PUNC">(</span><span class="NAME">this.a</span><span class="PUNC">,</span><span class="NAME">this.b</span><span class="PUNC">,</span><span class="NAME">this.c</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">plane</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">||</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Plane</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">setFromCoplanarPoints</span><span class="PUNC">(</span><span class="NAME">this.a</span><span class="PUNC">,</span><span class="NAME">this.b</span><span class="PUNC">,</span><span class="NAME">this.c</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">barycoordFromPoint</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">THREE.Triangle.barycoordFromPoint</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">this.a</span><span class="PUNC">,</span><span class="NAME">this.b</span><span class="PUNC">,</span><span class="NAME">this.c</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">containsPoint</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">THREE.Triangle.containsPoint</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">this.a</span><span class="PUNC">,</span><span class="NAME">this.b</span><span class="PUNC">,</span><span class="NAME">this.c</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">equals</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a.a.equals</span><span class="PUNC">(</span><span class="NAME">this.a</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="NAME">a.b.equals</span><span class="PUNC">(</span><span class="NAME">this.b</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="NAME">a.c.equals</span><span class="PUNC">(</span><span class="NAME">this.c</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>134</span> </span><span class="NAME">clone</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="PUNC">(</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Triangle</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">copy</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.Vertex</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">console.warn</span><span class="PUNC">(</span><span class="STRN">"THREE.Vertex has been DEPRECATED. Use THREE.Vector3 instead."</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.UV</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">console.warn</span><span class="PUNC">(</span><span class="STRN">"THREE.UV has been DEPRECATED. Use THREE.Vector2 instead."</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector2</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.Clock</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.autoStart</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">a</span><span class="PUNC">?</span><span class="NAME">a</span><span class="PUNC">:</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">this.elapsedTime</span><span class="PUNC">=</span><span class="NAME">this.oldTime</span><span class="PUNC">=</span><span class="NAME">this.startTime</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">this.running</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>135</span> </span><span class="NAME">THREE.Clock.prototype</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="NAME">constructor</span><span class="PUNC">:</span><span class="NAME">THREE.Clock</span><span class="PUNC">,</span><span class="NAME">start</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.oldTime</span><span class="PUNC">=</span><span class="NAME">this.startTime</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">self.performance</span><span class="PUNC">&&</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">self.performance.now</span><span class="PUNC">?</span><span class="NAME">self.performance.now</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">Date.now</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.running</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">stop</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.getElapsedTime</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.running</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">getElapsedTime</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.getDelta</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.elapsedTime</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">getDelta</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">this.autoStart</span><span class="PUNC">&&</span><span class="PUNC">!</span><span class="NAME">this.running</span><span class="PUNC">&&</span><span class="NAME">this.start</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.running</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">self.performance</span><span class="PUNC">&&</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">self.performance.now</span><span class="PUNC">?</span><span class="NAME">self.performance.now</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">Date.now</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>136</span> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="NUMB">0.001</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">-</span><span class="NAME">this.oldTime</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.oldTime</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">;</span><span class="NAME">this.elapsedTime</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">}</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.EventDispatcher</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>137</span> </span><span class="NAME">THREE.EventDispatcher.prototype</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="NAME">constructor</span><span class="PUNC">:</span><span class="NAME">THREE.EventDispatcher</span><span class="PUNC">,</span><span class="NAME">apply</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">a.addEventListener</span><span class="PUNC">=</span><span class="NAME">THREE.EventDispatcher.prototype.addEventListener</span><span class="PUNC">;</span><span class="NAME">a.hasEventListener</span><span class="PUNC">=</span><span class="NAME">THREE.EventDispatcher.prototype.hasEventListener</span><span class="PUNC">;</span><span class="NAME">a.removeEventListener</span><span class="PUNC">=</span><span class="NAME">THREE.EventDispatcher.prototype.removeEventListener</span><span class="PUNC">;</span><span class="NAME">a.dispatchEvent</span><span class="PUNC">=</span><span class="NAME">THREE.EventDispatcher.prototype.dispatchEvent</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">addEventListener</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">===</span><span class="NAME">this._listeners</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">this._listeners</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this._listeners</span><span class="PUNC">;</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">===</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">]</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">===</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">indexOf</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="WHIT">
<span class='line'>138</span> </span><span class="NAME">c</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">push</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">hasEventListener</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">===</span><span class="NAME">this._listeners</span><span class="PUNC">)</span><span class="KEYW">return</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this._listeners</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">]</span><span class="PUNC">&&</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">!==</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">indexOf</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">?</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">:</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">removeEventListener</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">this._listeners</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this._listeners</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">indexOf</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">!==</span><span class="NAME">d</span><span class="PUNC">&&</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">splice</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">dispatchEvent</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">this._listeners</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this._listeners</span><span class="PUNC">[</span><span class="NAME">a.type</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">a.target</span><span class="PUNC">=</span><span class="KEYW">this</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">b.length</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">&lt;</span><span class="NAME">d</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">call</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">a.Raycaster</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.ray</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">a.Ray</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NUMB">0</span><span class="PUNC">&lt;</span><span class="NAME">this.ray.direction.lengthSq</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="NAME">this.ray.direction.normalize</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.near</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">||</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">this.far</span><span class="PUNC">=</span><span class="NAME">e</span><span class="PUNC">||</span><span class="NAME">Infinity</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">a.Sphere</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">a.Ray</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">a.Plane</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">a.Vector3</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">a.Vector3</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">a.Matrix4</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a.distance</span><span class="PUNC">-</span><span class="NAME">b.distance</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">g</span><span class="PUNC">,</span><span class="NAME">j</span><span class="PUNC">,</span><span class="NAME">n</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">g</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">a.Particle</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">f.getPositionFromMatrix</span><span class="PUNC">(</span><span class="NAME">g.matrixWorld</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">p</span><span class="PUNC">=</span><span class="NAME">j.ray.distanceToPoint</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">p</span><span class="PUNC">></span><span class="NAME">g.scale.x</span><span class="PUNC">)</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">n</span><span class="PUNC">;</span><span class="NAME">n.push</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">distance</span><span class="PUNC">:</span><span class="NAME">p</span><span class="PUNC">,</span><span class="NAME">point</span><span class="PUNC">:</span><span class="NAME">g.position</span><span class="PUNC">,</span><span class="NAME">face</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">object</span><span class="PUNC">:</span><span class="NAME">g</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">g</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT">
<span class='line'>139</span> </span><span class="NAME">a.LOD</span><span class="PUNC">)</span><span class="NAME">f.getPositionFromMatrix</span><span class="PUNC">(</span><span class="NAME">g.matrixWorld</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">p</span><span class="PUNC">=</span><span class="NAME">j.ray.origin.distanceTo</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">(</span><span class="NAME">g.getObjectForDistance</span><span class="PUNC">(</span><span class="NAME">p</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">j</span><span class="PUNC">,</span><span class="NAME">n</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">g</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">a.Mesh</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">p</span><span class="PUNC">=</span><span class="NAME">g.geometry</span><span class="PUNC">;</span><span class="NAME">f.getPositionFromMatrix</span><span class="PUNC">(</span><span class="NAME">g.matrixWorld</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">null</span><span class="PUNC">===</span><span class="NAME">p.boundingSphere</span><span class="PUNC">&&</span><span class="NAME">p.computeBoundingSphere</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b.set</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">p.boundingSphere.radius</span><span class="PUNC">*</span><span class="NAME">g.matrixWorld.getMaxScaleOnAxis</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">===</span><span class="NAME">j.ray.isIntersectionSphere</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">n</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">t</span><span class="PUNC">=</span><span class="NAME">p.vertices</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">p</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">a.BufferGeometry</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">q</span><span class="PUNC">=</span><span class="NAME">g.material</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">===</span><span class="NAME">q</span><span class="PUNC">||</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">===</span><span class="NAME">p.dynamic</span><span class="PUNC">)</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">n</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">r</span><span class="PUNC">=</span><span class="NAME">g.material</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">a.MeshFaceMaterial</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>140</span> </span><span class="NAME">s</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">===</span><span class="NAME">r</span><span class="PUNC">?</span><span class="NAME">g.material.materials</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">v</span><span class="PUNC">=</span><span class="NAME">g.material.side</span><span class="PUNC">,</span><span class="NAME">z</span><span class="PUNC">,</span><span class="NAME">C</span><span class="PUNC">,</span><span class="NAME">F</span><span class="PUNC">=</span><span class="NAME">j.precision</span><span class="PUNC">;</span><span class="NAME">h.getInverse</span><span class="PUNC">(</span><span class="NAME">g.matrixWorld</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">c.copy</span><span class="PUNC">(</span><span class="NAME">j.ray</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">applyMatrix4</span><span class="PUNC">(</span><span class="NAME">h</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">H</span><span class="PUNC">,</span><span class="NAME">t</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">p.attributes.index</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">t</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">s</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">a.Vector3</span><span class="PUNC">;</span><span class="NAME">H</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">a.Vector3</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">I</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">a.Vector3</span><span class="PUNC">;</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">a.Vector3</span><span class="PUNC">;</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">a.Vector3</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">G</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">G</span><span class="PUNC">&lt;</span><span class="NAME">p.offsets.length</span><span class="PUNC">;</span><span class="PUNC">++</span><span class="NAME">G</span><span class="PUNC">)</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">A</span><span class="PUNC">=</span><span class="NAME">p.offsets</span><span class="PUNC">[</span><span class="NAME">G</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">start</span><span class="PUNC">,</span><span class="NAME">K</span><span class="PUNC">=</span><span class="NAME">p.offsets</span><span class="PUNC">[</span><span class="NAME">G</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">index</span><span class="PUNC">,</span><span class="NAME">r</span><span class="PUNC">=</span><span class="NAME">A</span><span class="PUNC">,</span><span class="NAME">B</span><span class="PUNC">=</span><span class="NAME">A</span><span class="PUNC">+</span><span class="NAME">p.offsets</span><span class="PUNC">[</span><span class="NAME">G</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">count</span><span class="PUNC">;</span><span class="NAME">r</span><span class="PUNC">&lt;</span><span class="NAME">B</span><span class="PUNC">;</span><span class="NAME">r</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NUMB">3</span><span class="PUNC">)</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">t</span><span class="PUNC">?</span><span class="PUNC">(</span><span class="NAME">v</span><span class="PUNC">=</span><span class="NAME">K</span><span class="PUNC">+</span><span class="NAME">p.attributes.index.array</span><span class="PUNC">[</span><span class="NAME">r</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">z</span><span class="PUNC">=</span><span class="NAME">K</span><span class="PUNC">+</span><span class="NAME">p.attributes.index.array</span><span class="PUNC">[</span><span class="NAME">r</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">C</span><span class="PUNC">=</span><span class="NAME">K</span><span class="PUNC">+</span><span class="NAME">p.attributes.index.array</span><span class="PUNC">[</span><span class="NAME">r</span><span class="PUNC">+</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="PUNC">(</span><span class="NAME">v</span><span class="PUNC">=</span><span class="NAME">K</span><span class="PUNC">,</span><span class="NAME">z</span><span class="PUNC">=</span><span class="NAME">K</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">C</span><span class="PUNC">=</span><span class="NAME">K</span><span class="PUNC">+</span><span class="NUMB">2</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">s.set</span><span class="PUNC">(</span><span class="NAME">p.attributes.position.array</span><span class="PUNC">[</span><span class="NUMB">3</span><span class="PUNC">*</span><span class="WHIT">
<span class='line'>141</span> </span><span class="NAME">v</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">p.attributes.position.array</span><span class="PUNC">[</span><span class="NUMB">3</span><span class="PUNC">*</span><span class="NAME">v</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">p.attributes.position.array</span><span class="PUNC">[</span><span class="NUMB">3</span><span class="PUNC">*</span><span class="NAME">v</span><span class="PUNC">+</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">H.set</span><span class="PUNC">(</span><span class="NAME">p.attributes.position.array</span><span class="PUNC">[</span><span class="NUMB">3</span><span class="PUNC">*</span><span class="NAME">z</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">p.attributes.position.array</span><span class="PUNC">[</span><span class="NUMB">3</span><span class="PUNC">*</span><span class="NAME">z</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">p.attributes.position.array</span><span class="PUNC">[</span><span class="NUMB">3</span><span class="PUNC">*</span><span class="NAME">z</span><span class="PUNC">+</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">I.set</span><span class="PUNC">(</span><span class="NAME">p.attributes.position.array</span><span class="PUNC">[</span><span class="NUMB">3</span><span class="PUNC">*</span><span class="NAME">C</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">p.attributes.position.array</span><span class="PUNC">[</span><span class="NUMB">3</span><span class="PUNC">*</span><span class="NAME">C</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">p.attributes.position.array</span><span class="PUNC">[</span><span class="NUMB">3</span><span class="PUNC">*</span><span class="NAME">C</span><span class="PUNC">+</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">d.setFromCoplanarPoints</span><span class="PUNC">(</span><span class="NAME">s</span><span class="PUNC">,</span><span class="NAME">H</span><span class="PUNC">,</span><span class="NAME">I</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">A</span><span class="PUNC">=</span><span class="NAME">c.distanceToPlane</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="PUNC">!</span><span class="PUNC">(</span><span class="NAME">A</span><span class="PUNC">&lt;</span><span class="NAME">F</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="KEYW">null</span><span class="PUNC">!==</span><span class="NAME">A</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">v</span><span class="PUNC">=</span><span class="NAME">q.side</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">v</span><span class="PUNC">!==</span><span class="NAME">a.DoubleSide</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">z</span><span class="PUNC">=</span><span class="NAME">c.direction.dot</span><span class="PUNC">(</span><span class="NAME">d.normal</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="PUNC">!</span><span class="PUNC">(</span><span class="NAME">v</span><span class="PUNC">===</span><span class="NAME">a.FrontSide</span><span class="PUNC">?</span><span class="NUMB">0</span><span class="PUNC">></span><span class="NAME">z</span><span class="PUNC">:</span><span class="NUMB">0</span><span class="PUNC">&lt;</span><span class="NAME">z</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="KEYW">continue</span><span class="PUNC">;</span><span class="NAME">A</span><span class="PUNC">&lt;</span><span class="NAME">j.near</span><span class="PUNC">||</span><span class="NAME">A</span><span class="PUNC">></span><span class="NAME">j.far</span><span class="PUNC">||</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">c.at</span><span class="PUNC">(</span><span class="NAME">A</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">!==</span><span class="NAME">a.Triangle.containsPoint</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>142</span> </span><span class="NAME">s</span><span class="PUNC">,</span><span class="NAME">H</span><span class="PUNC">,</span><span class="NAME">I</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="NAME">n.push</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">distance</span><span class="PUNC">:</span><span class="NAME">A</span><span class="PUNC">,</span><span class="NAME">point</span><span class="PUNC">:</span><span class="NAME">j.ray.at</span><span class="PUNC">(</span><span class="NAME">A</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">face</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">faceIndex</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">object</span><span class="PUNC">:</span><span class="NAME">g</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">p</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">a.Geometry</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">r</span><span class="PUNC">=</span><span class="NAME">g.material</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">a.MeshFaceMaterial</span><span class="PUNC">;</span><span class="NAME">s</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">===</span><span class="NAME">r</span><span class="PUNC">?</span><span class="NAME">g.material.materials</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">;</span><span class="NAME">F</span><span class="PUNC">=</span><span class="NAME">j.precision</span><span class="PUNC">;</span><span class="NAME">h.getInverse</span><span class="PUNC">(</span><span class="NAME">g.matrixWorld</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">c.copy</span><span class="PUNC">(</span><span class="NAME">j.ray</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">applyMatrix4</span><span class="PUNC">(</span><span class="NAME">h</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">I</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">H</span><span class="PUNC">=</span><span class="NAME">p.faces.length</span><span class="PUNC">;</span><span class="NAME">I</span><span class="PUNC">&lt;</span><span class="NAME">H</span><span class="PUNC">;</span><span class="NAME">I</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">G</span><span class="PUNC">=</span><span class="NAME">p.faces</span><span class="PUNC">[</span><span class="NAME">I</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">q</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">===</span><span class="NAME">r</span><span class="PUNC">?</span><span class="NAME">s</span><span class="PUNC">[</span><span class="NAME">G.materialIndex</span><span class="PUNC">]</span><span class="PUNC">:</span><span class="NAME">g.material</span><span class="PUNC">,</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">q</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">d.setFromNormalAndCoplanarPoint</span><span class="PUNC">(</span><span class="NAME">G.normal</span><span class="PUNC">,</span><span class="NAME">t</span><span class="PUNC">[</span><span class="NAME">G.a</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">A</span><span class="PUNC">=</span><span class="NAME">c.distanceToPlane</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="PUNC">!</span><span class="PUNC">(</span><span class="NAME">A</span><span class="PUNC">&lt;</span><span class="NAME">F</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="KEYW">null</span><span class="PUNC">!==</span><span class="NAME">A</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">v</span><span class="PUNC">=</span><span class="NAME">q.side</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">v</span><span class="PUNC">!==</span><span class="NAME">a.DoubleSide</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">z</span><span class="PUNC">=</span><span class="NAME">c.direction.dot</span><span class="PUNC">(</span><span class="NAME">d.normal</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>143</span> </span><span class="PUNC">!</span><span class="PUNC">(</span><span class="NAME">v</span><span class="PUNC">===</span><span class="NAME">a.FrontSide</span><span class="PUNC">?</span><span class="NUMB">0</span><span class="PUNC">></span><span class="NAME">z</span><span class="PUNC">:</span><span class="NUMB">0</span><span class="PUNC">&lt;</span><span class="NAME">z</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="KEYW">continue</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="PUNC">(</span><span class="NAME">A</span><span class="PUNC">&lt;</span><span class="NAME">j.near</span><span class="PUNC">||</span><span class="NAME">A</span><span class="PUNC">></span><span class="NAME">j.far</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">c.at</span><span class="PUNC">(</span><span class="NAME">A</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">G</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">a.Face3</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">v</span><span class="PUNC">=</span><span class="NAME">t</span><span class="PUNC">[</span><span class="NAME">G.a</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">z</span><span class="PUNC">=</span><span class="NAME">t</span><span class="PUNC">[</span><span class="NAME">G.b</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">C</span><span class="PUNC">=</span><span class="NAME">t</span><span class="PUNC">[</span><span class="NAME">G.c</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">===</span><span class="NAME">a.Triangle.containsPoint</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">v</span><span class="PUNC">,</span><span class="NAME">z</span><span class="PUNC">,</span><span class="NAME">C</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="KEYW">continue</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">G</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">a.Face4</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">v</span><span class="PUNC">=</span><span class="NAME">t</span><span class="PUNC">[</span><span class="NAME">G.a</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">z</span><span class="PUNC">=</span><span class="NAME">t</span><span class="PUNC">[</span><span class="NAME">G.b</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">C</span><span class="PUNC">=</span><span class="NAME">t</span><span class="PUNC">[</span><span class="NAME">G.c</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">q</span><span class="PUNC">=</span><span class="NAME">t</span><span class="PUNC">[</span><span class="NAME">G.d</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">===</span><span class="NAME">a.Triangle.containsPoint</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">v</span><span class="PUNC">,</span><span class="NAME">z</span><span class="PUNC">,</span><span class="NAME">q</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">===</span><span class="NAME">a.Triangle.containsPoint</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">z</span><span class="PUNC">,</span><span class="NAME">C</span><span class="PUNC">,</span><span class="NAME">q</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="KEYW">continue</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">throw</span><span class="WHIT"> </span><span class="NAME">Error</span><span class="PUNC">(</span><span class="STRN">"face type not supported"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">n.push</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">distance</span><span class="PUNC">:</span><span class="NAME">A</span><span class="PUNC">,</span><span class="NAME">point</span><span class="PUNC">:</span><span class="NAME">j.ray.at</span><span class="PUNC">(</span><span class="NAME">A</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">face</span><span class="PUNC">:</span><span class="NAME">G</span><span class="PUNC">,</span><span class="NAME">faceIndex</span><span class="PUNC">:</span><span class="NAME">I</span><span class="PUNC">,</span><span class="NAME">object</span><span class="PUNC">:</span><span class="NAME">g</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">g</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">a.Line</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">F</span><span class="PUNC">=</span><span class="NAME">j.linePrecision</span><span class="PUNC">;</span><span class="NAME">F</span><span class="PUNC">*</span><span class="PUNC">=</span><span class="NAME">F</span><span class="PUNC">;</span><span class="NAME">p</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>144</span> </span><span class="NAME">g.geometry</span><span class="PUNC">;</span><span class="KEYW">null</span><span class="PUNC">===</span><span class="NAME">p.boundingSphere</span><span class="PUNC">&&</span><span class="NAME">p.computeBoundingSphere</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">f.getPositionFromMatrix</span><span class="PUNC">(</span><span class="NAME">g.matrixWorld</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b.set</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">p.boundingSphere.radius</span><span class="PUNC">*</span><span class="NAME">g.matrixWorld.getMaxScaleOnAxis</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">===</span><span class="NAME">j.ray.isIntersectionSphere</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">n</span><span class="PUNC">;</span><span class="NAME">h.getInverse</span><span class="PUNC">(</span><span class="NAME">g.matrixWorld</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">c.copy</span><span class="PUNC">(</span><span class="NAME">j.ray</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">applyMatrix4</span><span class="PUNC">(</span><span class="NAME">h</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">c.direction.normalize</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">t</span><span class="PUNC">=</span><span class="NAME">p.vertices</span><span class="PUNC">;</span><span class="NAME">q</span><span class="PUNC">=</span><span class="NAME">t.length</span><span class="PUNC">;</span><span class="NAME">A</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">a.Vector3</span><span class="PUNC">;</span><span class="NAME">v</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">a.Vector3</span><span class="PUNC">;</span><span class="NAME">z</span><span class="PUNC">=</span><span class="NAME">g.type</span><span class="PUNC">===</span><span class="NAME">a.LineStrip</span><span class="PUNC">?</span><span class="NUMB">1</span><span class="PUNC">:</span><span class="NUMB">2</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">r</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">r</span><span class="PUNC">&lt;</span><span class="NAME">q</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">r</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">z</span><span class="PUNC">)</span><span class="NAME">c.distanceSqToSegment</span><span class="PUNC">(</span><span class="NAME">t</span><span class="PUNC">[</span><span class="NAME">r</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">t</span><span class="PUNC">[</span><span class="NAME">r</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">v</span><span class="PUNC">,</span><span class="NAME">A</span><span class="PUNC">)</span><span class="PUNC">&lt;=</span><span class="NAME">F</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">p</span><span class="PUNC">=</span><span class="NAME">c.origin.distanceTo</span><span class="PUNC">(</span><span class="NAME">v</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">j.near</span><span class="PUNC">&lt;=</span><span class="NAME">p</span><span class="PUNC">&&</span><span class="NAME">p</span><span class="PUNC">&lt;=</span><span class="NAME">j.far</span><span class="PUNC">&&</span><span class="NAME">n.push</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">distance</span><span class="PUNC">:</span><span class="NAME">p</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>145</span> </span><span class="NAME">point</span><span class="PUNC">:</span><span class="NAME">A.clone</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">applyMatrix4</span><span class="PUNC">(</span><span class="NAME">g.matrixWorld</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">face</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">faceIndex</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">object</span><span class="PUNC">:</span><span class="NAME">g</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">j</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">a.getDescendants</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">a.length</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">&lt;</span><span class="NAME">e</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">i</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NAME">d</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">a.Raycaster.prototype.precision</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="NAME">E</span><span class="PUNC">-</span><span class="NUMB">4</span><span class="PUNC">;</span><span class="NAME">a.Raycaster.prototype.linePrecision</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">a.Raycaster.prototype.set</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.ray.set</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NUMB">0</span><span class="PUNC">&lt;</span><span class="NAME">this.ray.direction.length</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="NAME">this.ray.direction.normalize</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">a.Raycaster.prototype.intersectObject</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">===</span><span class="NAME">b</span><span class="PUNC">&&</span><span class="NAME">j</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">i</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">c.sort</span><span class="PUNC">(</span><span class="NAME">g</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">a.Raycaster.prototype.intersectObjects</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>146</span> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">a.length</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">&lt;</span><span class="NAME">e</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">i</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NAME">d</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">===</span><span class="NAME">b</span><span class="PUNC">&&</span><span class="NAME">j</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NAME">d</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">c.sort</span><span class="PUNC">(</span><span class="NAME">g</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">(</span><span class="NAME">THREE</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">THREE.Object3D</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.id</span><span class="PUNC">=</span><span class="NAME">THREE.Object3DIdCount</span><span class="PUNC">++</span><span class="PUNC">;</span><span class="NAME">this.uuid</span><span class="PUNC">=</span><span class="NAME">THREE.Math.generateUUID</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.name</span><span class="PUNC">=</span><span class="STRN">""</span><span class="PUNC">;</span><span class="NAME">this.parent</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">this.children</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">this.up</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.position</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">;</span><span class="NAME">this.rotation</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Euler</span><span class="PUNC">;</span><span class="NAME">this.quaternion</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Quaternion</span><span class="PUNC">;</span><span class="NAME">this.scale</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">(</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.rotation._quaternion</span><span class="PUNC">=</span><span class="NAME">this.quaternion</span><span class="PUNC">;</span><span class="NAME">this.quaternion._euler</span><span class="PUNC">=</span><span class="NAME">this.rotation</span><span class="PUNC">;</span><span class="NAME">this.renderDepth</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">;</span><span class="NAME">this.rotationAutoUpdate</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">this.matrix</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Matrix4</span><span class="PUNC">;</span><span class="NAME">this.matrixWorld</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Matrix4</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>147</span> </span><span class="NAME">this.visible</span><span class="PUNC">=</span><span class="NAME">this.matrixWorldNeedsUpdate</span><span class="PUNC">=</span><span class="NAME">this.matrixAutoUpdate</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">this.receiveShadow</span><span class="PUNC">=</span><span class="NAME">this.castShadow</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">this.frustumCulled</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">this.userData</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>148</span> </span><span class="NAME">THREE.Object3D.prototype</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="NAME">constructor</span><span class="PUNC">:</span><span class="NAME">THREE.Object3D</span><span class="PUNC">,</span><span class="NAME">get</span><span class="WHIT"> </span><span class="NAME">eulerOrder</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">console.warn</span><span class="PUNC">(</span><span class="STRN">"DEPRECATED: Object3D's .eulerOrder has been moved to Object3D's .rotation.order."</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.rotation.order</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">set</span><span class="WHIT"> </span><span class="NAME">eulerOrder</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">console.warn</span><span class="PUNC">(</span><span class="STRN">"DEPRECATED: Object3D's .eulerOrder has been moved to Object3D's .rotation.order."</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.rotation.order</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">get</span><span class="WHIT"> </span><span class="NAME">useQuaternion</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">console.warn</span><span class="PUNC">(</span><span class="STRN">"DEPRECATED: Object3D's .useQuaternion has been removed. The library now uses quaternions by default."</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">set</span><span class="WHIT"> </span><span class="NAME">useQuaternion</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">console.warn</span><span class="PUNC">(</span><span class="STRN">"DEPRECATED: Object3D's .useQuaternion has been removed. The library now uses quaternions by default."</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>149</span> </span><span class="NAME">applyMatrix</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Matrix4</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.matrix.multiplyMatrices</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">this.matrix</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.position.getPositionFromMatrix</span><span class="PUNC">(</span><span class="NAME">this.matrix</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.scale.getScaleFromMatrix</span><span class="PUNC">(</span><span class="NAME">this.matrix</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a.extractRotation</span><span class="PUNC">(</span><span class="NAME">this.matrix</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.quaternion.setFromRotationMatrix</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">setRotationFromAxisAngle</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.quaternion.setFromAxisAngle</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">setRotationFromEuler</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.quaternion.setFromEuler</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">setRotationFromMatrix</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.quaternion.setFromRotationMatrix</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>150</span> </span><span class="NAME">setRotationFromQuaternion</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.quaternion.copy</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">rotateOnAxis</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Quaternion</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">a.setFromAxisAngle</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.quaternion.multiply</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">rotateX</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">(</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.rotateOnAxis</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">rotateY</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.rotateOnAxis</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">rotateZ</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.rotateOnAxis</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>151</span> </span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">translateOnAxis</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">a.copy</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a.applyQuaternion</span><span class="PUNC">(</span><span class="NAME">this.quaternion</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.position.add</span><span class="PUNC">(</span><span class="NAME">a.multiplyScalar</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">translate</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">console.warn</span><span class="PUNC">(</span><span class="STRN">"DEPRECATED: Object3D's .translate() has been removed. Use .translateOnAxis( axis, distance ) instead. Note args have been changed."</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.translateOnAxis</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">translateX</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">(</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.translateOnAxis</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">translateY</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>152</span> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.translateOnAxis</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">translateZ</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.translateOnAxis</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">localToWorld</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a.applyMatrix4</span><span class="PUNC">(</span><span class="NAME">this.matrixWorld</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">worldToLocal</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Matrix4</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">b.applyMatrix4</span><span class="PUNC">(</span><span class="NAME">a.getInverse</span><span class="PUNC">(</span><span class="NAME">this.matrixWorld</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">lookAt</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Matrix4</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">a.lookAt</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">this.position</span><span class="PUNC">,</span><span class="NAME">this.up</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.quaternion.setFromRotationMatrix</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>153</span> </span><span class="NAME">add</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">===</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="NAME">console.warn</span><span class="PUNC">(</span><span class="STRN">"THREE.Object3D.add: An object can't be added as a child of itself."</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">a</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">THREE.Object3D</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">a.parent</span><span class="PUNC">&&</span><span class="NAME">a.parent.remove</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a.parent</span><span class="PUNC">=</span><span class="KEYW">this</span><span class="PUNC">;</span><span class="NAME">a.dispatchEvent</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">type</span><span class="PUNC">:</span><span class="STRN">"added"</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.children.push</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="KEYW">this</span><span class="PUNC">;</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">b.parent</span><span class="PUNC">;</span><span class="PUNC">)</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">b.parent</span><span class="PUNC">;</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">b</span><span class="PUNC">&&</span><span class="NAME">b</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">THREE.Scene</span><span class="PUNC">&&</span><span class="NAME">b.__addObject</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">remove</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.children.indexOf</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">!==</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">a.parent</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">a.dispatchEvent</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">type</span><span class="PUNC">:</span><span class="STRN">"removed"</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.children.splice</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">=</span><span class="KEYW">this</span><span class="PUNC">;</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="WHIT">
<span class='line'>154</span> </span><span class="NAME">b.parent</span><span class="PUNC">;</span><span class="PUNC">)</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">b.parent</span><span class="PUNC">;</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">b</span><span class="PUNC">&&</span><span class="NAME">b</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">THREE.Scene</span><span class="PUNC">&&</span><span class="NAME">b.__removeObject</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">traverse</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">a</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.children.length</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">&lt;</span><span class="NAME">c</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">this.children</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">traverse</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">getObjectById</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">this.children.length</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">&lt;</span><span class="NAME">d</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">this.children</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">e.id</span><span class="PUNC">===</span><span class="NAME">a</span><span class="PUNC">||</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">===</span><span class="NAME">b</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">e.getObjectById</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">e</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">getObjectByName</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">this.children.length</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">&lt;</span><span class="NAME">d</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">this.children</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">e.name</span><span class="PUNC">===</span><span class="NAME">a</span><span class="PUNC">||</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">===</span><span class="NAME">b</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">e.getObjectByName</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="WHIT">
<span class='line'>155</span> </span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">e</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">getChildByName</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">console.warn</span><span class="PUNC">(</span><span class="STRN">"DEPRECATED: Object3D's .getChildByName() has been renamed to .getObjectByName()."</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.getObjectByName</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">getDescendants</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">===</span><span class="NAME">a</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">Array.prototype.push.apply</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">this.children</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.children.length</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">&lt;</span><span class="NAME">c</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">this.children</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">getDescendants</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">updateMatrix</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.matrix.compose</span><span class="PUNC">(</span><span class="NAME">this.position</span><span class="PUNC">,</span><span class="NAME">this.quaternion</span><span class="PUNC">,</span><span class="NAME">this.scale</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.matrixWorldNeedsUpdate</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">updateMatrixWorld</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">===</span><span class="WHIT">
<span class='line'>156</span> </span><span class="NAME">this.matrixAutoUpdate</span><span class="PUNC">&&</span><span class="NAME">this.updateMatrix</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">===</span><span class="NAME">this.matrixWorldNeedsUpdate</span><span class="PUNC">||</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">===</span><span class="NAME">a</span><span class="PUNC">)</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">===</span><span class="NAME">this.parent</span><span class="PUNC">?</span><span class="NAME">this.matrixWorld.copy</span><span class="PUNC">(</span><span class="NAME">this.matrix</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">this.matrixWorld.multiplyMatrices</span><span class="PUNC">(</span><span class="NAME">this.parent.matrixWorld</span><span class="PUNC">,</span><span class="NAME">this.matrix</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this.matrixWorldNeedsUpdate</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.children.length</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">&lt;</span><span class="NAME">c</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">this.children</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">updateMatrixWorld</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">clone</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">===</span><span class="NAME">a</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Object3D</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">===</span><span class="NAME">b</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a.name</span><span class="PUNC">=</span><span class="NAME">this.name</span><span class="PUNC">;</span><span class="NAME">a.up.copy</span><span class="PUNC">(</span><span class="NAME">this.up</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a.position.copy</span><span class="PUNC">(</span><span class="NAME">this.position</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a.quaternion.copy</span><span class="PUNC">(</span><span class="NAME">this.quaternion</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>157</span> </span><span class="NAME">a.scale.copy</span><span class="PUNC">(</span><span class="NAME">this.scale</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a.renderDepth</span><span class="PUNC">=</span><span class="NAME">this.renderDepth</span><span class="PUNC">;</span><span class="NAME">a.rotationAutoUpdate</span><span class="PUNC">=</span><span class="NAME">this.rotationAutoUpdate</span><span class="PUNC">;</span><span class="NAME">a.matrix.copy</span><span class="PUNC">(</span><span class="NAME">this.matrix</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a.matrixWorld.copy</span><span class="PUNC">(</span><span class="NAME">this.matrixWorld</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a.matrixAutoUpdate</span><span class="PUNC">=</span><span class="NAME">this.matrixAutoUpdate</span><span class="PUNC">;</span><span class="NAME">a.matrixWorldNeedsUpdate</span><span class="PUNC">=</span><span class="NAME">this.matrixWorldNeedsUpdate</span><span class="PUNC">;</span><span class="NAME">a.visible</span><span class="PUNC">=</span><span class="NAME">this.visible</span><span class="PUNC">;</span><span class="NAME">a.castShadow</span><span class="PUNC">=</span><span class="NAME">this.castShadow</span><span class="PUNC">;</span><span class="NAME">a.receiveShadow</span><span class="PUNC">=</span><span class="NAME">this.receiveShadow</span><span class="PUNC">;</span><span class="NAME">a.frustumCulled</span><span class="PUNC">=</span><span class="NAME">this.frustumCulled</span><span class="PUNC">;</span><span class="NAME">a.userData</span><span class="PUNC">=</span><span class="NAME">JSON.parse</span><span class="PUNC">(</span><span class="NAME">JSON.stringify</span><span class="PUNC">(</span><span class="NAME">this.userData</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">===</span><span class="NAME">b</span><span class="PUNC">)</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">&lt;</span><span class="NAME">this.children.length</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">a.add</span><span class="PUNC">(</span><span class="NAME">this.children</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">clone</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>158</span> </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.EventDispatcher.prototype.apply</span><span class="PUNC">(</span><span class="NAME">THREE.Object3D.prototype</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">THREE.Object3DIdCount</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">THREE.Projector</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">i</span><span class="PUNC">===</span><span class="NAME">l</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.RenderableVertex</span><span class="PUNC">;</span><span class="NAME">j.push</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">l</span><span class="PUNC">++</span><span class="PUNC">;</span><span class="NAME">i</span><span class="PUNC">++</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">}</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">j</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">++</span><span class="PUNC">]</span><span class="PUNC">}</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a.z</span><span class="PUNC">!==</span><span class="NAME">b.z</span><span class="PUNC">?</span><span class="NAME">b.z</span><span class="PUNC">-</span><span class="NAME">a.z</span><span class="PUNC">:</span><span class="NAME">a.id</span><span class="PUNC">!==</span><span class="NAME">b.id</span><span class="PUNC">?</span><span class="NAME">a.id</span><span class="PUNC">-</span><span class="NAME">b.id</span><span class="PUNC">:</span><span class="NUMB">0</span><span class="PUNC">}</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">a.z</span><span class="PUNC">+</span><span class="NAME">a.w</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">b.z</span><span class="PUNC">+</span><span class="NAME">b.w</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="NAME">a.z</span><span class="PUNC">+</span><span class="NAME">a.w</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="NAME">b.z</span><span class="PUNC">+</span><span class="NAME">b.w</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">&lt;=</span><span class="NAME">e</span><span class="PUNC">&&</span><span class="NUMB">0</span><span class="PUNC">&lt;=</span><span class="NAME">f</span><span class="PUNC">&&</span><span class="NUMB">0</span><span class="PUNC">&lt;=</span><span class="NAME">h</span><span class="PUNC">&&</span><span class="NUMB">0</span><span class="PUNC">&lt;=</span><span class="NAME">g</span><span class="PUNC">)</span><span class="KEYW">return</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">></span><span class="NAME">e</span><span class="PUNC">&&</span><span class="NUMB">0</span><span class="PUNC">></span><span class="NAME">f</span><span class="PUNC">||</span><span class="NUMB">0</span><span class="PUNC">></span><span class="NAME">h</span><span class="PUNC">&&</span><span class="NUMB">0</span><span class="PUNC">></span><span class="NAME">g</span><span class="PUNC">)</span><span class="KEYW">return</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NUMB">0</span><span class="PUNC">></span><span class="NAME">e</span><span class="PUNC">?</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">Math.max</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">/</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">-</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NUMB">0</span><span class="PUNC">></span><span class="NAME">f</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">Math.min</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">/</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">-</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NUMB">0</span><span class="PUNC">></span><span class="NAME">h</span><span class="PUNC">?</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">Math.max</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">/</span><span class="PUNC">(</span><span class="NAME">h</span><span class="PUNC">-</span><span class="NAME">g</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NUMB">0</span><span class="PUNC">></span><span class="NAME">g</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">Math.min</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">/</span><span class="PUNC">(</span><span class="NAME">h</span><span class="PUNC">-</span><span class="NAME">g</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">&lt;</span><span class="NAME">c</span><span class="PUNC">)</span><span class="KEYW">return</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">a.lerp</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b.lerp</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">-</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">}</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>159</span> </span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">,</span><span class="NAME">j</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">l</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">m</span><span class="PUNC">,</span><span class="NAME">n</span><span class="PUNC">,</span><span class="NAME">p</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">t</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">q</span><span class="PUNC">,</span><span class="NAME">r</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">s</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">v</span><span class="PUNC">,</span><span class="NAME">z</span><span class="PUNC">,</span><span class="NAME">C</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">F</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">H</span><span class="PUNC">,</span><span class="NAME">I</span><span class="PUNC">,</span><span class="NAME">G</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">A</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">K</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="NAME">objects</span><span class="PUNC">:</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">sprites</span><span class="PUNC">:</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">lights</span><span class="PUNC">:</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">elements</span><span class="PUNC">:</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">B</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">,</span><span class="NAME">J</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector4</span><span class="PUNC">,</span><span class="NAME">N</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Box3</span><span class="PUNC">(</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">(</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">(</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">y</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Box3</span><span class="PUNC">,</span><span class="NAME">M</span><span class="PUNC">=</span><span class="NAME">Array</span><span class="PUNC">(</span><span class="NUMB">3</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">w</span><span class="PUNC">=</span><span class="NAME">Array</span><span class="PUNC">(</span><span class="NUMB">4</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">Z</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Matrix4</span><span class="PUNC">,</span><span class="NAME">L</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Matrix4</span><span class="PUNC">,</span><span class="NAME">pa</span><span class="PUNC">,</span><span class="NAME">Pa</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Matrix4</span><span class="PUNC">,</span><span class="NAME">Ua</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Matrix3</span><span class="PUNC">,</span><span class="NAME">O</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Matrix3</span><span class="PUNC">,</span><span class="NAME">ka</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">,</span><span class="NAME">Fa</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Frustum</span><span class="PUNC">,</span><span class="NAME">wa</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector4</span><span class="PUNC">,</span><span class="NAME">D</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector4</span><span class="PUNC">;</span><span class="NAME">this.projectVector</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">b.matrixWorldInverse.getInverse</span><span class="PUNC">(</span><span class="NAME">b.matrixWorld</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>160</span> </span><span class="NAME">L.multiplyMatrices</span><span class="PUNC">(</span><span class="NAME">b.projectionMatrix</span><span class="PUNC">,</span><span class="NAME">b.matrixWorldInverse</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a.applyProjection</span><span class="PUNC">(</span><span class="NAME">L</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">this.unprojectVector</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">b.projectionMatrixInverse.getInverse</span><span class="PUNC">(</span><span class="NAME">b.projectionMatrix</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">L.multiplyMatrices</span><span class="PUNC">(</span><span class="NAME">b.matrixWorld</span><span class="PUNC">,</span><span class="NAME">b.projectionMatrixInverse</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a.applyProjection</span><span class="PUNC">(</span><span class="NAME">L</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">this.pickingRay</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">a.z</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">(</span><span class="NAME">a.x</span><span class="PUNC">,</span><span class="NAME">a.y</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.unprojectVector</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.unprojectVector</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">c.sub</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">normalize</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Raycaster</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">V</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">===</span><span class="NAME">h</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.RenderableObject</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>161</span> </span><span class="NAME">f.push</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">h</span><span class="PUNC">++</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">++</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">f</span><span class="PUNC">[</span><span class="NAME">e</span><span class="PUNC">++</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">d.id</span><span class="PUNC">=</span><span class="NAME">a.id</span><span class="PUNC">;</span><span class="NAME">d.object</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">;</span><span class="KEYW">null</span><span class="PUNC">!==</span><span class="NAME">a.renderDepth</span><span class="PUNC">?</span><span class="NAME">d.z</span><span class="PUNC">=</span><span class="NAME">a.renderDepth</span><span class="PUNC">:</span><span class="PUNC">(</span><span class="NAME">B.getPositionFromMatrix</span><span class="PUNC">(</span><span class="NAME">a.matrixWorld</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">B.applyProjection</span><span class="PUNC">(</span><span class="NAME">L</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">d.z</span><span class="PUNC">=</span><span class="NAME">B.z</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">ea</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">!==</span><span class="NAME">a.visible</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">a</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">THREE.Light</span><span class="PUNC">?</span><span class="NAME">K.lights.push</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">a</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">THREE.Mesh</span><span class="PUNC">||</span><span class="NAME">a</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">THREE.Line</span><span class="PUNC">?</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">===</span><span class="NAME">a.frustumCulled</span><span class="PUNC">||</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">===</span><span class="NAME">Fa.intersectsObject</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="NAME">K.objects.push</span><span class="PUNC">(</span><span class="NAME">V</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="PUNC">(</span><span class="NAME">a</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">THREE.Sprite</span><span class="PUNC">||</span><span class="NAME">a</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">THREE.Particle</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="NAME">K.sprites.push</span><span class="PUNC">(</span><span class="NAME">V</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">a.children.length</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">&lt;</span><span class="NAME">c</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">ea</span><span class="PUNC">(</span><span class="NAME">a.children</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>162</span> </span><span class="NAME">this.projectScene</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">,</span><span class="NAME">l</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">V</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">B</span><span class="PUNC">,</span><span class="NAME">fa</span><span class="PUNC">,</span><span class="NAME">da</span><span class="PUNC">,</span><span class="NAME">T</span><span class="PUNC">,</span><span class="NAME">aa</span><span class="PUNC">,</span><span class="NAME">na</span><span class="PUNC">,</span><span class="NAME">ha</span><span class="PUNC">,</span><span class="NAME">X</span><span class="PUNC">,</span><span class="NAME">xa</span><span class="PUNC">,</span><span class="NAME">ab</span><span class="PUNC">,</span><span class="NAME">la</span><span class="PUNC">,</span><span class="NAME">ia</span><span class="PUNC">,</span><span class="NAME">ra</span><span class="PUNC">;</span><span class="NAME">I</span><span class="PUNC">=</span><span class="NAME">z</span><span class="PUNC">=</span><span class="NAME">q</span><span class="PUNC">=</span><span class="NAME">n</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">K.elements.length</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">===</span><span class="NAME">d.autoUpdate</span><span class="PUNC">&&</span><span class="NAME">d.updateMatrixWorld</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">===</span><span class="NAME">f.parent</span><span class="PUNC">&&</span><span class="NAME">f.updateMatrixWorld</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">Z.copy</span><span class="PUNC">(</span><span class="NAME">f.matrixWorldInverse.getInverse</span><span class="PUNC">(</span><span class="NAME">f.matrixWorld</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">L.multiplyMatrices</span><span class="PUNC">(</span><span class="NAME">f.projectionMatrix</span><span class="PUNC">,</span><span class="NAME">Z</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">O.getNormalMatrix</span><span class="PUNC">(</span><span class="NAME">Z</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">Fa.setFromMatrix</span><span class="PUNC">(</span><span class="NAME">L</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">K.objects.length</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">K.sprites.length</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">K.lights.length</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">ea</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">===</span><span class="NAME">h</span><span class="PUNC">&&</span><span class="NAME">K.objects.sort</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">K.objects.length</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">&lt;</span><span class="NAME">h</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">X</span><span class="PUNC">=</span><span class="NAME">K.objects</span><span class="PUNC">[</span><span class="NAME">d</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">object</span><span class="PUNC">,</span><span class="NAME">pa</span><span class="PUNC">=</span><span class="NAME">X.matrixWorld</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>163</span> </span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">X</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">THREE.Mesh</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">xa</span><span class="PUNC">=</span><span class="NAME">X.geometry</span><span class="PUNC">;</span><span class="NAME">da</span><span class="PUNC">=</span><span class="NAME">xa.vertices</span><span class="PUNC">;</span><span class="NAME">ab</span><span class="PUNC">=</span><span class="NAME">xa.faces</span><span class="PUNC">;</span><span class="NAME">xa</span><span class="PUNC">=</span><span class="NAME">xa.faceVertexUvs</span><span class="PUNC">;</span><span class="NAME">Ua.getNormalMatrix</span><span class="PUNC">(</span><span class="NAME">pa</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">ia</span><span class="PUNC">=</span><span class="NAME">X.material</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">THREE.MeshFaceMaterial</span><span class="PUNC">;</span><span class="NAME">ra</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">===</span><span class="NAME">ia</span><span class="PUNC">?</span><span class="NAME">X.material</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">;</span><span class="NAME">B</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">fa</span><span class="PUNC">=</span><span class="NAME">da.length</span><span class="PUNC">;</span><span class="NAME">B</span><span class="PUNC">&lt;</span><span class="NAME">fa</span><span class="PUNC">;</span><span class="NAME">B</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">g.positionWorld.copy</span><span class="PUNC">(</span><span class="NAME">da</span><span class="PUNC">[</span><span class="NAME">B</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">applyMatrix4</span><span class="PUNC">(</span><span class="NAME">pa</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">g.positionScreen.copy</span><span class="PUNC">(</span><span class="NAME">g.positionWorld</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">applyMatrix4</span><span class="PUNC">(</span><span class="NAME">L</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">ja</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">/</span><span class="NAME">g.positionScreen.w</span><span class="PUNC">;</span><span class="NAME">g.positionScreen.x</span><span class="PUNC">*</span><span class="PUNC">=</span><span class="NAME">ja</span><span class="PUNC">;</span><span class="NAME">g.positionScreen.y</span><span class="PUNC">*</span><span class="PUNC">=</span><span class="NAME">ja</span><span class="PUNC">;</span><span class="NAME">g.positionScreen.z</span><span class="PUNC">*</span><span class="PUNC">=</span><span class="NAME">ja</span><span class="PUNC">;</span><span class="NAME">g.visible</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="PUNC">(</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">></span><span class="NAME">g.positionScreen.x</span><span class="PUNC">||</span><span class="NUMB">1</span><span class="PUNC">&lt;</span><span class="NAME">g.positionScreen.x</span><span class="PUNC">||</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">></span><span class="NAME">g.positionScreen.y</span><span class="PUNC">||</span><span class="NUMB">1</span><span class="PUNC">&lt;</span><span class="WHIT">
<span class='line'>164</span> </span><span class="NAME">g.positionScreen.y</span><span class="PUNC">||</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">></span><span class="NAME">g.positionScreen.z</span><span class="PUNC">||</span><span class="NUMB">1</span><span class="PUNC">&lt;</span><span class="NAME">g.positionScreen.z</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="NAME">da</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">B</span><span class="PUNC">=</span><span class="NAME">ab.length</span><span class="PUNC">;</span><span class="NAME">da</span><span class="PUNC">&lt;</span><span class="NAME">B</span><span class="PUNC">;</span><span class="NAME">da</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">fa</span><span class="PUNC">=</span><span class="NAME">ab</span><span class="PUNC">[</span><span class="NAME">da</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">ja</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">===</span><span class="NAME">ia</span><span class="PUNC">?</span><span class="NAME">ra.materials</span><span class="PUNC">[</span><span class="NAME">fa.materialIndex</span><span class="PUNC">]</span><span class="PUNC">:</span><span class="NAME">X.material</span><span class="PUNC">,</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">ja</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">na</span><span class="PUNC">=</span><span class="NAME">ja.side</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">fa</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">THREE.Face3</span><span class="PUNC">)</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">T</span><span class="PUNC">=</span><span class="NAME">j</span><span class="PUNC">[</span><span class="NAME">fa.a</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">aa</span><span class="PUNC">=</span><span class="NAME">j</span><span class="PUNC">[</span><span class="NAME">fa.b</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">ha</span><span class="PUNC">=</span><span class="NAME">j</span><span class="PUNC">[</span><span class="NAME">fa.c</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">M</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">T.positionScreen</span><span class="PUNC">,</span><span class="NAME">M</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">aa.positionScreen</span><span class="PUNC">,</span><span class="NAME">M</span><span class="PUNC">[</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">ha.positionScreen</span><span class="PUNC">,</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">===</span><span class="NAME">T.visible</span><span class="PUNC">||</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">===</span><span class="NAME">aa.visible</span><span class="PUNC">||</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">===</span><span class="NAME">ha.visible</span><span class="PUNC">||</span><span class="NAME">N.isIntersectionBox</span><span class="PUNC">(</span><span class="NAME">y.setFromPoints</span><span class="PUNC">(</span><span class="NAME">M</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">V</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">></span><span class="PUNC">(</span><span class="NAME">ha.positionScreen.x</span><span class="PUNC">-</span><span class="NAME">T.positionScreen.x</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">aa.positionScreen.y</span><span class="PUNC">-</span><span class="NAME">T.positionScreen.y</span><span class="PUNC">)</span><span class="PUNC">-</span><span class="PUNC">(</span><span class="NAME">ha.positionScreen.y</span><span class="PUNC">-</span><span class="WHIT">
<span class='line'>165</span> </span><span class="NAME">T.positionScreen.y</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">aa.positionScreen.x</span><span class="PUNC">-</span><span class="NAME">T.positionScreen.x</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">na</span><span class="PUNC">===</span><span class="NAME">THREE.DoubleSide</span><span class="PUNC">||</span><span class="NAME">V</span><span class="PUNC">===</span><span class="PUNC">(</span><span class="NAME">na</span><span class="PUNC">===</span><span class="NAME">THREE.FrontSide</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="NAME">n</span><span class="PUNC">===</span><span class="NAME">t</span><span class="PUNC">?</span><span class="PUNC">(</span><span class="NAME">la</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.RenderableFace3</span><span class="PUNC">,</span><span class="NAME">p.push</span><span class="PUNC">(</span><span class="NAME">la</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">t</span><span class="PUNC">++</span><span class="PUNC">,</span><span class="NAME">n</span><span class="PUNC">++</span><span class="PUNC">,</span><span class="NAME">m</span><span class="PUNC">=</span><span class="NAME">la</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">m</span><span class="PUNC">=</span><span class="NAME">p</span><span class="PUNC">[</span><span class="NAME">n</span><span class="PUNC">++</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">m.id</span><span class="PUNC">=</span><span class="NAME">X.id</span><span class="PUNC">,</span><span class="NAME">m.v1.copy</span><span class="PUNC">(</span><span class="NAME">T</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">m.v2.copy</span><span class="PUNC">(</span><span class="NAME">aa</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">m.v3.copy</span><span class="PUNC">(</span><span class="NAME">ha</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">continue</span><span class="PUNC">;</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">continue</span><span class="PUNC">;</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">fa</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">THREE.Face4</span><span class="PUNC">)</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">T</span><span class="PUNC">=</span><span class="NAME">j</span><span class="PUNC">[</span><span class="NAME">fa.a</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">aa</span><span class="PUNC">=</span><span class="NAME">j</span><span class="PUNC">[</span><span class="NAME">fa.b</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">ha</span><span class="PUNC">=</span><span class="NAME">j</span><span class="PUNC">[</span><span class="NAME">fa.c</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">la</span><span class="PUNC">=</span><span class="NAME">j</span><span class="PUNC">[</span><span class="NAME">fa.d</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">w</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">T.positionScreen</span><span class="PUNC">,</span><span class="NAME">w</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">aa.positionScreen</span><span class="PUNC">,</span><span class="NAME">w</span><span class="PUNC">[</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">ha.positionScreen</span><span class="PUNC">,</span><span class="NAME">w</span><span class="PUNC">[</span><span class="NUMB">3</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">la.positionScreen</span><span class="PUNC">,</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">===</span><span class="NAME">T.visible</span><span class="PUNC">||</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">===</span><span class="NAME">aa.visible</span><span class="PUNC">||</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">===</span><span class="NAME">ha.visible</span><span class="PUNC">||</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">===</span><span class="NAME">la.visible</span><span class="PUNC">||</span><span class="NAME">N.isIntersectionBox</span><span class="PUNC">(</span><span class="NAME">y.setFromPoints</span><span class="PUNC">(</span><span class="NAME">w</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">V</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>166</span> </span><span class="NUMB">0</span><span class="PUNC">></span><span class="PUNC">(</span><span class="NAME">la.positionScreen.x</span><span class="PUNC">-</span><span class="NAME">T.positionScreen.x</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">aa.positionScreen.y</span><span class="PUNC">-</span><span class="NAME">T.positionScreen.y</span><span class="PUNC">)</span><span class="PUNC">-</span><span class="PUNC">(</span><span class="NAME">la.positionScreen.y</span><span class="PUNC">-</span><span class="NAME">T.positionScreen.y</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">aa.positionScreen.x</span><span class="PUNC">-</span><span class="NAME">T.positionScreen.x</span><span class="PUNC">)</span><span class="PUNC">||</span><span class="NUMB">0</span><span class="PUNC">></span><span class="PUNC">(</span><span class="NAME">aa.positionScreen.x</span><span class="PUNC">-</span><span class="NAME">ha.positionScreen.x</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">la.positionScreen.y</span><span class="PUNC">-</span><span class="NAME">ha.positionScreen.y</span><span class="PUNC">)</span><span class="PUNC">-</span><span class="PUNC">(</span><span class="NAME">aa.positionScreen.y</span><span class="PUNC">-</span><span class="NAME">ha.positionScreen.y</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">la.positionScreen.x</span><span class="PUNC">-</span><span class="NAME">ha.positionScreen.x</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">na</span><span class="PUNC">===</span><span class="NAME">THREE.DoubleSide</span><span class="PUNC">||</span><span class="NAME">V</span><span class="PUNC">===</span><span class="PUNC">(</span><span class="NAME">na</span><span class="PUNC">===</span><span class="NAME">THREE.FrontSide</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">q</span><span class="PUNC">===</span><span class="NAME">s</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">ua</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.RenderableFace4</span><span class="PUNC">;</span><span class="NAME">r.push</span><span class="PUNC">(</span><span class="NAME">ua</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">s</span><span class="PUNC">++</span><span class="PUNC">;</span><span class="NAME">q</span><span class="PUNC">++</span><span class="PUNC">;</span><span class="NAME">m</span><span class="PUNC">=</span><span class="NAME">ua</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="NAME">m</span><span class="PUNC">=</span><span class="NAME">r</span><span class="PUNC">[</span><span class="NAME">q</span><span class="PUNC">++</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">m.id</span><span class="PUNC">=</span><span class="NAME">X.id</span><span class="PUNC">;</span><span class="NAME">m.v1.copy</span><span class="PUNC">(</span><span class="NAME">T</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">m.v2.copy</span><span class="PUNC">(</span><span class="NAME">aa</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>167</span> </span><span class="NAME">m.v3.copy</span><span class="PUNC">(</span><span class="NAME">ha</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">m.v4.copy</span><span class="PUNC">(</span><span class="NAME">la</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">continue</span><span class="PUNC">;</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">continue</span><span class="PUNC">;</span><span class="NAME">m.normalModel.copy</span><span class="PUNC">(</span><span class="NAME">fa.normal</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">===</span><span class="NAME">V</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">na</span><span class="PUNC">===</span><span class="NAME">THREE.BackSide</span><span class="PUNC">||</span><span class="NAME">na</span><span class="PUNC">===</span><span class="NAME">THREE.DoubleSide</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="NAME">m.normalModel.negate</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">m.normalModel.applyMatrix3</span><span class="PUNC">(</span><span class="NAME">Ua</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">normalize</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">m.normalModelView.copy</span><span class="PUNC">(</span><span class="NAME">m.normalModel</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">applyMatrix3</span><span class="PUNC">(</span><span class="NAME">O</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">m.centroidModel.copy</span><span class="PUNC">(</span><span class="NAME">fa.centroid</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">applyMatrix4</span><span class="PUNC">(</span><span class="NAME">pa</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">ha</span><span class="PUNC">=</span><span class="NAME">fa.vertexNormals</span><span class="PUNC">;</span><span class="NAME">T</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">aa</span><span class="PUNC">=</span><span class="NAME">ha.length</span><span class="PUNC">;</span><span class="NAME">T</span><span class="PUNC">&lt;</span><span class="NAME">aa</span><span class="PUNC">;</span><span class="NAME">T</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">la</span><span class="PUNC">=</span><span class="NAME">m.vertexNormalsModel</span><span class="PUNC">[</span><span class="NAME">T</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">la.copy</span><span class="PUNC">(</span><span class="NAME">ha</span><span class="PUNC">[</span><span class="NAME">T</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">===</span><span class="NAME">V</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">na</span><span class="PUNC">===</span><span class="NAME">THREE.BackSide</span><span class="PUNC">||</span><span class="NAME">na</span><span class="PUNC">===</span><span class="NAME">THREE.DoubleSide</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="NAME">la.negate</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">la.applyMatrix3</span><span class="PUNC">(</span><span class="NAME">Ua</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">normalize</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>168</span> </span><span class="NAME">m.vertexNormalsModelView</span><span class="PUNC">[</span><span class="NAME">T</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">copy</span><span class="PUNC">(</span><span class="NAME">la</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">applyMatrix3</span><span class="PUNC">(</span><span class="NAME">O</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">m.vertexNormalsLength</span><span class="PUNC">=</span><span class="NAME">ha.length</span><span class="PUNC">;</span><span class="NAME">T</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">aa</span><span class="PUNC">=</span><span class="NAME">xa.length</span><span class="PUNC">;</span><span class="NAME">T</span><span class="PUNC">&lt;</span><span class="NAME">aa</span><span class="PUNC">;</span><span class="NAME">T</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">la</span><span class="PUNC">=</span><span class="NAME">xa</span><span class="PUNC">[</span><span class="NAME">T</span><span class="PUNC">]</span><span class="PUNC">[</span><span class="NAME">da</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">la</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">na</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">ha</span><span class="PUNC">=</span><span class="NAME">la.length</span><span class="PUNC">;</span><span class="NAME">na</span><span class="PUNC">&lt;</span><span class="NAME">ha</span><span class="PUNC">;</span><span class="NAME">na</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">m.uvs</span><span class="PUNC">[</span><span class="NAME">T</span><span class="PUNC">]</span><span class="PUNC">[</span><span class="NAME">na</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">la</span><span class="PUNC">[</span><span class="NAME">na</span><span class="PUNC">]</span><span class="PUNC">}</span><span class="NAME">m.color</span><span class="PUNC">=</span><span class="NAME">fa.color</span><span class="PUNC">;</span><span class="NAME">m.material</span><span class="PUNC">=</span><span class="NAME">ja</span><span class="PUNC">;</span><span class="NAME">ka.copy</span><span class="PUNC">(</span><span class="NAME">m.centroidModel</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">applyProjection</span><span class="PUNC">(</span><span class="NAME">L</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">m.z</span><span class="PUNC">=</span><span class="NAME">ka.z</span><span class="PUNC">;</span><span class="NAME">K.elements.push</span><span class="PUNC">(</span><span class="NAME">m</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">X</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">THREE.Line</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">Pa.multiplyMatrices</span><span class="PUNC">(</span><span class="NAME">L</span><span class="PUNC">,</span><span class="NAME">pa</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">da</span><span class="PUNC">=</span><span class="NAME">X.geometry.vertices</span><span class="PUNC">;</span><span class="NAME">T</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">T.positionScreen.copy</span><span class="PUNC">(</span><span class="NAME">da</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">applyMatrix4</span><span class="PUNC">(</span><span class="NAME">Pa</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">ab</span><span class="PUNC">=</span><span class="NAME">X.type</span><span class="PUNC">===</span><span class="NAME">THREE.LinePieces</span><span class="PUNC">?</span><span class="NUMB">2</span><span class="PUNC">:</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">B</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">fa</span><span class="PUNC">=</span><span class="NAME">da.length</span><span class="PUNC">;</span><span class="NAME">B</span><span class="PUNC">&lt;</span><span class="NAME">fa</span><span class="PUNC">;</span><span class="NAME">B</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">T</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>169</span> </span><span class="NAME">T.positionScreen.copy</span><span class="PUNC">(</span><span class="NAME">da</span><span class="PUNC">[</span><span class="NAME">B</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">applyMatrix4</span><span class="PUNC">(</span><span class="NAME">Pa</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">&lt;</span><span class="PUNC">(</span><span class="NAME">B</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">%</span><span class="NAME">ab</span><span class="PUNC">||</span><span class="PUNC">(</span><span class="NAME">aa</span><span class="PUNC">=</span><span class="NAME">j</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">-</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">wa.copy</span><span class="PUNC">(</span><span class="NAME">T.positionScreen</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">D.copy</span><span class="PUNC">(</span><span class="NAME">aa.positionScreen</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">===</span><span class="NAME">c</span><span class="PUNC">(</span><span class="NAME">wa</span><span class="PUNC">,</span><span class="NAME">D</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">wa.multiplyScalar</span><span class="PUNC">(</span><span class="NUMB">1</span><span class="PUNC">/</span><span class="NAME">wa.w</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">D.multiplyScalar</span><span class="PUNC">(</span><span class="NUMB">1</span><span class="PUNC">/</span><span class="NAME">D.w</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">z</span><span class="PUNC">===</span><span class="NAME">F</span><span class="PUNC">?</span><span class="PUNC">(</span><span class="NAME">xa</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.RenderableLine</span><span class="PUNC">,</span><span class="NAME">C.push</span><span class="PUNC">(</span><span class="NAME">xa</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">F</span><span class="PUNC">++</span><span class="PUNC">,</span><span class="NAME">z</span><span class="PUNC">++</span><span class="PUNC">,</span><span class="NAME">v</span><span class="PUNC">=</span><span class="NAME">xa</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">v</span><span class="PUNC">=</span><span class="NAME">C</span><span class="PUNC">[</span><span class="NAME">z</span><span class="PUNC">++</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">v.id</span><span class="PUNC">=</span><span class="NAME">X.id</span><span class="PUNC">,</span><span class="NAME">v.v1.positionScreen.copy</span><span class="PUNC">(</span><span class="NAME">wa</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">v.v2.positionScreen.copy</span><span class="PUNC">(</span><span class="NAME">D</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">v.z</span><span class="PUNC">=</span><span class="NAME">Math.max</span><span class="PUNC">(</span><span class="NAME">wa.z</span><span class="PUNC">,</span><span class="NAME">D.z</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">v.material</span><span class="PUNC">=</span><span class="NAME">X.material</span><span class="PUNC">,</span><span class="NAME">X.material.vertexColors</span><span class="PUNC">===</span><span class="NAME">THREE.VertexColors</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">v.vertexColors</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">copy</span><span class="PUNC">(</span><span class="NAME">X.geometry.colors</span><span class="PUNC">[</span><span class="NAME">B</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">v.vertexColors</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">copy</span><span class="PUNC">(</span><span class="NAME">X.geometry.colors</span><span class="PUNC">[</span><span class="NAME">B</span><span class="PUNC">-</span><span class="WHIT">
<span class='line'>170</span> </span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">K.elements.push</span><span class="PUNC">(</span><span class="NAME">v</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">K.sprites.length</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">&lt;</span><span class="NAME">h</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">X</span><span class="PUNC">=</span><span class="NAME">K.sprites</span><span class="PUNC">[</span><span class="NAME">d</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">object</span><span class="PUNC">,</span><span class="NAME">pa</span><span class="PUNC">=</span><span class="NAME">X.matrixWorld</span><span class="PUNC">,</span><span class="NAME">X</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">THREE.Particle</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">J.set</span><span class="PUNC">(</span><span class="NAME">pa.elements</span><span class="PUNC">[</span><span class="NUMB">12</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">pa.elements</span><span class="PUNC">[</span><span class="NUMB">13</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">pa.elements</span><span class="PUNC">[</span><span class="NUMB">14</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">J.applyMatrix4</span><span class="PUNC">(</span><span class="NAME">L</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">ja</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">/</span><span class="NAME">J.w</span><span class="PUNC">,</span><span class="NAME">J.z</span><span class="PUNC">*</span><span class="PUNC">=</span><span class="NAME">ja</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">&lt;</span><span class="NAME">J.z</span><span class="PUNC">&&</span><span class="NUMB">1</span><span class="PUNC">></span><span class="NAME">J.z</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">I</span><span class="PUNC">===</span><span class="NAME">A</span><span class="PUNC">?</span><span class="PUNC">(</span><span class="NAME">V</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.RenderableParticle</span><span class="PUNC">,</span><span class="NAME">G.push</span><span class="PUNC">(</span><span class="NAME">V</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">A</span><span class="PUNC">++</span><span class="PUNC">,</span><span class="NAME">I</span><span class="PUNC">++</span><span class="PUNC">,</span><span class="NAME">H</span><span class="PUNC">=</span><span class="NAME">V</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">H</span><span class="PUNC">=</span><span class="NAME">G</span><span class="PUNC">[</span><span class="NAME">I</span><span class="PUNC">++</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">H.id</span><span class="PUNC">=</span><span class="NAME">X.id</span><span class="PUNC">,</span><span class="NAME">H.x</span><span class="PUNC">=</span><span class="NAME">J.x</span><span class="PUNC">*</span><span class="NAME">ja</span><span class="PUNC">,</span><span class="NAME">H.y</span><span class="PUNC">=</span><span class="NAME">J.y</span><span class="PUNC">*</span><span class="NAME">ja</span><span class="PUNC">,</span><span class="NAME">H.z</span><span class="PUNC">=</span><span class="NAME">J.z</span><span class="PUNC">,</span><span class="NAME">H.object</span><span class="PUNC">=</span><span class="NAME">X</span><span class="PUNC">,</span><span class="NAME">H.rotation</span><span class="PUNC">=</span><span class="NAME">X.rotation.z</span><span class="PUNC">,</span><span class="NAME">H.scale.x</span><span class="PUNC">=</span><span class="NAME">X.scale.x</span><span class="PUNC">*</span><span class="NAME">Math.abs</span><span class="PUNC">(</span><span class="NAME">H.x</span><span class="PUNC">-</span><span class="PUNC">(</span><span class="NAME">J.x</span><span class="PUNC">+</span><span class="NAME">f.projectionMatrix.elements</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">/</span><span class="PUNC">(</span><span class="NAME">J.w</span><span class="PUNC">+</span><span class="NAME">f.projectionMatrix.elements</span><span class="PUNC">[</span><span class="NUMB">12</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">H.scale.y</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>171</span> </span><span class="NAME">X.scale.y</span><span class="PUNC">*</span><span class="NAME">Math.abs</span><span class="PUNC">(</span><span class="NAME">H.y</span><span class="PUNC">-</span><span class="PUNC">(</span><span class="NAME">J.y</span><span class="PUNC">+</span><span class="NAME">f.projectionMatrix.elements</span><span class="PUNC">[</span><span class="NUMB">5</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">/</span><span class="PUNC">(</span><span class="NAME">J.w</span><span class="PUNC">+</span><span class="NAME">f.projectionMatrix.elements</span><span class="PUNC">[</span><span class="NUMB">13</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">H.material</span><span class="PUNC">=</span><span class="NAME">X.material</span><span class="PUNC">,</span><span class="NAME">K.elements.push</span><span class="PUNC">(</span><span class="NAME">H</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">===</span><span class="NAME">l</span><span class="PUNC">&&</span><span class="NAME">K.elements.sort</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">K</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.Face3</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.a</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">this.b</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">;</span><span class="NAME">this.c</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">;</span><span class="NAME">this.normal</span><span class="PUNC">=</span><span class="NAME">d</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">?</span><span class="NAME">d</span><span class="PUNC">:</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">;</span><span class="NAME">this.vertexNormals</span><span class="PUNC">=</span><span class="NAME">d</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">Array</span><span class="PUNC">?</span><span class="NAME">d</span><span class="PUNC">:</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">this.color</span><span class="PUNC">=</span><span class="NAME">e</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">THREE.Color</span><span class="PUNC">?</span><span class="NAME">e</span><span class="PUNC">:</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Color</span><span class="PUNC">;</span><span class="NAME">this.vertexColors</span><span class="PUNC">=</span><span class="NAME">e</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">Array</span><span class="PUNC">?</span><span class="NAME">e</span><span class="PUNC">:</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">this.vertexTangents</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">this.materialIndex</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">f</span><span class="PUNC">?</span><span class="NAME">f</span><span class="PUNC">:</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">this.centroid</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>172</span> </span><span class="NAME">THREE.Face3.prototype</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="NAME">constructor</span><span class="PUNC">:</span><span class="NAME">THREE.Face3</span><span class="PUNC">,</span><span class="NAME">clone</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Face3</span><span class="PUNC">(</span><span class="NAME">this.a</span><span class="PUNC">,</span><span class="NAME">this.b</span><span class="PUNC">,</span><span class="NAME">this.c</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a.normal.copy</span><span class="PUNC">(</span><span class="NAME">this.normal</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a.color.copy</span><span class="PUNC">(</span><span class="NAME">this.color</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a.centroid.copy</span><span class="PUNC">(</span><span class="NAME">this.centroid</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a.materialIndex</span><span class="PUNC">=</span><span class="NAME">this.materialIndex</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.vertexNormals.length</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">&lt;</span><span class="NAME">c</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">a.vertexNormals</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">this.vertexNormals</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">clone</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.vertexColors.length</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">&lt;</span><span class="NAME">c</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">a.vertexColors</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">this.vertexColors</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">clone</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.vertexTangents.length</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">&lt;</span><span class="NAME">c</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">a.vertexTangents</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">this.vertexTangents</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">clone</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>173</span> </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.Face4</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.a</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">this.b</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">;</span><span class="NAME">this.c</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">;</span><span class="NAME">this.d</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">;</span><span class="NAME">this.normal</span><span class="PUNC">=</span><span class="NAME">e</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">?</span><span class="NAME">e</span><span class="PUNC">:</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">;</span><span class="NAME">this.vertexNormals</span><span class="PUNC">=</span><span class="NAME">e</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">Array</span><span class="PUNC">?</span><span class="NAME">e</span><span class="PUNC">:</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">this.color</span><span class="PUNC">=</span><span class="NAME">f</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">THREE.Color</span><span class="PUNC">?</span><span class="NAME">f</span><span class="PUNC">:</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Color</span><span class="PUNC">;</span><span class="NAME">this.vertexColors</span><span class="PUNC">=</span><span class="NAME">f</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">Array</span><span class="PUNC">?</span><span class="NAME">f</span><span class="PUNC">:</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">this.vertexTangents</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">this.materialIndex</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">h</span><span class="PUNC">?</span><span class="NAME">h</span><span class="PUNC">:</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">this.centroid</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>174</span> </span><span class="NAME">THREE.Face4.prototype</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="NAME">constructor</span><span class="PUNC">:</span><span class="NAME">THREE.Face4</span><span class="PUNC">,</span><span class="NAME">clone</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Face4</span><span class="PUNC">(</span><span class="NAME">this.a</span><span class="PUNC">,</span><span class="NAME">this.b</span><span class="PUNC">,</span><span class="NAME">this.c</span><span class="PUNC">,</span><span class="NAME">this.d</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a.normal.copy</span><span class="PUNC">(</span><span class="NAME">this.normal</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a.color.copy</span><span class="PUNC">(</span><span class="NAME">this.color</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a.centroid.copy</span><span class="PUNC">(</span><span class="NAME">this.centroid</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a.materialIndex</span><span class="PUNC">=</span><span class="NAME">this.materialIndex</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.vertexNormals.length</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">&lt;</span><span class="NAME">c</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">a.vertexNormals</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">this.vertexNormals</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">clone</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.vertexColors.length</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">&lt;</span><span class="NAME">c</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">a.vertexColors</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">this.vertexColors</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">clone</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.vertexTangents.length</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">&lt;</span><span class="NAME">c</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">a.vertexTangents</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">this.vertexTangents</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">clone</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>175</span> </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.Geometry</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.id</span><span class="PUNC">=</span><span class="NAME">THREE.GeometryIdCount</span><span class="PUNC">++</span><span class="PUNC">;</span><span class="NAME">this.uuid</span><span class="PUNC">=</span><span class="NAME">THREE.Math.generateUUID</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.name</span><span class="PUNC">=</span><span class="STRN">""</span><span class="PUNC">;</span><span class="NAME">this.vertices</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">this.colors</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">this.normals</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">this.faces</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">this.faceUvs</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">this.faceVertexUvs</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">this.morphTargets</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">this.morphColors</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">this.morphNormals</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">this.skinWeights</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">this.skinIndices</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">this.lineDistances</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">this.boundingSphere</span><span class="PUNC">=</span><span class="NAME">this.boundingBox</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">;</span><span class="NAME">this.hasTangents</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">this.dynamic</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">this.buffersNeedUpdate</span><span class="PUNC">=</span><span class="NAME">this.lineDistancesNeedUpdate</span><span class="PUNC">=</span><span class="NAME">this.colorsNeedUpdate</span><span class="PUNC">=</span><span class="NAME">this.tangentsNeedUpdate</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>176</span> </span><span class="NAME">this.normalsNeedUpdate</span><span class="PUNC">=</span><span class="NAME">this.uvsNeedUpdate</span><span class="PUNC">=</span><span class="NAME">this.elementsNeedUpdate</span><span class="PUNC">=</span><span class="NAME">this.verticesNeedUpdate</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>177</span> </span><span class="NAME">THREE.Geometry.prototype</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="NAME">constructor</span><span class="PUNC">:</span><span class="NAME">THREE.Geometry</span><span class="PUNC">,</span><span class="NAME">applyMatrix</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="PUNC">(</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Matrix3</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">getNormalMatrix</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">this.vertices.length</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">&lt;</span><span class="NAME">d</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">this.vertices</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">applyMatrix4</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">this.faces.length</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">&lt;</span><span class="NAME">d</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">this.faces</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">e.normal.applyMatrix3</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">normalize</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">f</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">e.vertexNormals.length</span><span class="PUNC">;</span><span class="NAME">f</span><span class="PUNC">&lt;</span><span class="NAME">h</span><span class="PUNC">;</span><span class="NAME">f</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">e.vertexNormals</span><span class="PUNC">[</span><span class="NAME">f</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">applyMatrix3</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">normalize</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">e.centroid.applyMatrix4</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="NAME">this.boundingBox</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">THREE.Box3</span><span class="PUNC">&&</span><span class="NAME">this.computeBoundingBox</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.boundingSphere</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT">
<span class='line'>178</span> </span><span class="NAME">THREE.Sphere</span><span class="PUNC">&&</span><span class="NAME">this.computeBoundingSphere</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">computeCentroids</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.faces.length</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">&lt;</span><span class="NAME">b</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.faces</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">c.centroid.set</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">c</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">THREE.Face3</span><span class="PUNC">?</span><span class="PUNC">(</span><span class="NAME">c.centroid.add</span><span class="PUNC">(</span><span class="NAME">this.vertices</span><span class="PUNC">[</span><span class="NAME">c.a</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">c.centroid.add</span><span class="PUNC">(</span><span class="NAME">this.vertices</span><span class="PUNC">[</span><span class="NAME">c.b</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">c.centroid.add</span><span class="PUNC">(</span><span class="NAME">this.vertices</span><span class="PUNC">[</span><span class="NAME">c.c</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">c.centroid.divideScalar</span><span class="PUNC">(</span><span class="NUMB">3</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">c</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">THREE.Face4</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">c.centroid.add</span><span class="PUNC">(</span><span class="NAME">this.vertices</span><span class="PUNC">[</span><span class="NAME">c.a</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">c.centroid.add</span><span class="PUNC">(</span><span class="NAME">this.vertices</span><span class="PUNC">[</span><span class="NAME">c.b</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">c.centroid.add</span><span class="PUNC">(</span><span class="NAME">this.vertices</span><span class="PUNC">[</span><span class="NAME">c.c</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">c.centroid.add</span><span class="PUNC">(</span><span class="NAME">this.vertices</span><span class="PUNC">[</span><span class="NAME">c.d</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">c.centroid.divideScalar</span><span class="PUNC">(</span><span class="NUMB">4</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>179</span> </span><span class="NAME">computeFaceNormals</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">this.faces.length</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">&lt;</span><span class="NAME">d</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">this.faces</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">this.vertices</span><span class="PUNC">[</span><span class="NAME">e.a</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">this.vertices</span><span class="PUNC">[</span><span class="NAME">e.b</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">a.subVectors</span><span class="PUNC">(</span><span class="NAME">this.vertices</span><span class="PUNC">[</span><span class="NAME">e.c</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b.subVectors</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a.cross</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a.normalize</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">e.normal.copy</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">computeVertexNormals</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">===</span><span class="NAME">this.__tmpVertices</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">this.__tmpVertices</span><span class="PUNC">=</span><span class="NAME">Array</span><span class="PUNC">(</span><span class="NAME">this.vertices.length</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.vertices.length</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">&lt;</span><span class="NAME">c</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">e</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.faces.length</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">&lt;</span><span class="NAME">c</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">this.faces</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>180</span> </span><span class="NAME">d</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">THREE.Face3</span><span class="PUNC">?</span><span class="NAME">d.vertexNormals</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">,</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">,</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">]</span><span class="PUNC">:</span><span class="NAME">d</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">THREE.Face4</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">d.vertexNormals</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">,</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">,</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">,</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="PUNC">{</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">this.__tmpVertices</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.vertices.length</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">&lt;</span><span class="NAME">c</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">e</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">set</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">,</span><span class="NAME">j</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">,</span><span class="NAME">l</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">,</span><span class="NAME">m</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">,</span><span class="NAME">n</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.faces.length</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">&lt;</span><span class="NAME">c</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">this.faces</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">d</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">THREE.Face3</span><span class="PUNC">?</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">this.vertices</span><span class="PUNC">[</span><span class="NAME">d.a</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>181</span> </span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">this.vertices</span><span class="PUNC">[</span><span class="NAME">d.b</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">this.vertices</span><span class="PUNC">[</span><span class="NAME">d.c</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">i.subVectors</span><span class="PUNC">(</span><span class="NAME">h</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">j.subVectors</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">i.cross</span><span class="PUNC">(</span><span class="NAME">j</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">[</span><span class="NAME">d.a</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">add</span><span class="PUNC">(</span><span class="NAME">i</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">[</span><span class="NAME">d.b</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">add</span><span class="PUNC">(</span><span class="NAME">i</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">[</span><span class="NAME">d.c</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">add</span><span class="PUNC">(</span><span class="NAME">i</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">d</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">THREE.Face4</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">this.vertices</span><span class="PUNC">[</span><span class="NAME">d.a</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">this.vertices</span><span class="PUNC">[</span><span class="NAME">d.b</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">this.vertices</span><span class="PUNC">[</span><span class="NAME">d.c</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">this.vertices</span><span class="PUNC">[</span><span class="NAME">d.d</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">l.subVectors</span><span class="PUNC">(</span><span class="NAME">g</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">j.subVectors</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">l.cross</span><span class="PUNC">(</span><span class="NAME">j</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">[</span><span class="NAME">d.a</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">add</span><span class="PUNC">(</span><span class="NAME">l</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">[</span><span class="NAME">d.b</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">add</span><span class="PUNC">(</span><span class="NAME">l</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">[</span><span class="NAME">d.d</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">add</span><span class="PUNC">(</span><span class="NAME">l</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">m.subVectors</span><span class="PUNC">(</span><span class="NAME">g</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">n.subVectors</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">m.cross</span><span class="PUNC">(</span><span class="NAME">n</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">[</span><span class="NAME">d.b</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">add</span><span class="PUNC">(</span><span class="NAME">m</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">[</span><span class="NAME">d.c</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">add</span><span class="PUNC">(</span><span class="NAME">m</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">[</span><span class="NAME">d.d</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">add</span><span class="PUNC">(</span><span class="NAME">m</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="PUNC">{</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.faces.length</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">&lt;</span><span class="NAME">c</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">this.faces</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">d</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">THREE.Face3</span><span class="PUNC">?</span><span class="WHIT">
<span class='line'>182</span> </span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">[</span><span class="NAME">d.a</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">add</span><span class="PUNC">(</span><span class="NAME">d.normal</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">[</span><span class="NAME">d.b</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">add</span><span class="PUNC">(</span><span class="NAME">d.normal</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">[</span><span class="NAME">d.c</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">add</span><span class="PUNC">(</span><span class="NAME">d.normal</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">d</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">THREE.Face4</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">[</span><span class="NAME">d.a</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">add</span><span class="PUNC">(</span><span class="NAME">d.normal</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">[</span><span class="NAME">d.b</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">add</span><span class="PUNC">(</span><span class="NAME">d.normal</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">[</span><span class="NAME">d.c</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">add</span><span class="PUNC">(</span><span class="NAME">d.normal</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">[</span><span class="NAME">d.d</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">add</span><span class="PUNC">(</span><span class="NAME">d.normal</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.vertices.length</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">&lt;</span><span class="NAME">c</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">e</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">normalize</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.faces.length</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">&lt;</span><span class="NAME">c</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">this.faces</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">d</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">THREE.Face3</span><span class="PUNC">?</span><span class="PUNC">(</span><span class="NAME">d.vertexNormals</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">copy</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">[</span><span class="NAME">d.a</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">d.vertexNormals</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">copy</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">[</span><span class="NAME">d.b</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">d.vertexNormals</span><span class="PUNC">[</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">copy</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">[</span><span class="NAME">d.c</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">d</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">THREE.Face4</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">d.vertexNormals</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">copy</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">[</span><span class="NAME">d.a</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">d.vertexNormals</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">copy</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">[</span><span class="NAME">d.b</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">d.vertexNormals</span><span class="PUNC">[</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">copy</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">[</span><span class="NAME">d.c</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>183</span> </span><span class="NAME">d.vertexNormals</span><span class="PUNC">[</span><span class="NUMB">3</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">copy</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">[</span><span class="NAME">d.d</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">computeMorphNormals</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">this.faces.length</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">&lt;</span><span class="NAME">d</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">this.faces</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">e.__originalFaceNormal</span><span class="PUNC">?</span><span class="NAME">e.__originalFaceNormal.copy</span><span class="PUNC">(</span><span class="NAME">e.normal</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">e.__originalFaceNormal</span><span class="PUNC">=</span><span class="NAME">e.normal.clone</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">e.__originalVertexNormals</span><span class="PUNC">||</span><span class="PUNC">(</span><span class="NAME">e.__originalVertexNormals</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">e.vertexNormals.length</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">&lt;</span><span class="NAME">b</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">e.__originalVertexNormals</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">]</span><span class="PUNC">?</span><span class="NAME">e.__originalVertexNormals</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">copy</span><span class="PUNC">(</span><span class="NAME">e.vertexNormals</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">e.__originalVertexNormals</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">e.vertexNormals</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">clone</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">f</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Geometry</span><span class="PUNC">;</span><span class="NAME">f.faces</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>184</span> </span><span class="NAME">this.faces</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.morphTargets.length</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">&lt;</span><span class="NAME">b</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">this.morphNormals</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.morphNormals</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">this.morphNormals</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">faceNormals</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">this.morphNormals</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">vertexNormals</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">this.morphNormals</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">faceNormals</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">this.morphNormals</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">vertexNormals</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">,</span><span class="NAME">j</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">this.faces.length</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">&lt;</span><span class="NAME">d</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">this.faces</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">,</span><span class="NAME">j</span><span class="PUNC">=</span><span class="NAME">e</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">THREE.Face3</span><span class="PUNC">?</span><span class="PUNC">{</span><span class="NAME">a</span><span class="PUNC">:</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">:</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">:</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">}</span><span class="PUNC">:</span><span class="PUNC">{</span><span class="NAME">a</span><span class="PUNC">:</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">:</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">:</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">:</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>185</span> </span><span class="NAME">h.push</span><span class="PUNC">(</span><span class="NAME">i</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">g.push</span><span class="PUNC">(</span><span class="NAME">j</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">this.morphNormals</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">f.vertices</span><span class="PUNC">=</span><span class="NAME">this.morphTargets</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">vertices</span><span class="PUNC">;</span><span class="NAME">f.computeFaceNormals</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">f.computeVertexNormals</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">this.faces.length</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">&lt;</span><span class="NAME">d</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">this.faces</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">=</span><span class="NAME">h.faceNormals</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">j</span><span class="PUNC">=</span><span class="NAME">h.vertexNormals</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">i.copy</span><span class="PUNC">(</span><span class="NAME">e.normal</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">e</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">THREE.Face3</span><span class="PUNC">?</span><span class="PUNC">(</span><span class="NAME">j.a.copy</span><span class="PUNC">(</span><span class="NAME">e.vertexNormals</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">j.b.copy</span><span class="PUNC">(</span><span class="NAME">e.vertexNormals</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">j.c.copy</span><span class="PUNC">(</span><span class="NAME">e.vertexNormals</span><span class="PUNC">[</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="PUNC">(</span><span class="NAME">j.a.copy</span><span class="PUNC">(</span><span class="NAME">e.vertexNormals</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">j.b.copy</span><span class="PUNC">(</span><span class="NAME">e.vertexNormals</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">j.c.copy</span><span class="PUNC">(</span><span class="NAME">e.vertexNormals</span><span class="PUNC">[</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">j.d.copy</span><span class="PUNC">(</span><span class="NAME">e.vertexNormals</span><span class="PUNC">[</span><span class="NUMB">3</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">this.faces.length</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">&lt;</span><span class="WHIT">
<span class='line'>186</span> </span><span class="NAME">d</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">this.faces</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">e.normal</span><span class="PUNC">=</span><span class="NAME">e.__originalFaceNormal</span><span class="PUNC">,</span><span class="NAME">e.vertexNormals</span><span class="PUNC">=</span><span class="NAME">e.__originalVertexNormals</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">computeTangents</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">y</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">a.vertices</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">i</span><span class="PUNC">=</span><span class="NAME">a.vertices</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">j</span><span class="PUNC">=</span><span class="NAME">a.vertices</span><span class="PUNC">[</span><span class="NAME">d</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">l</span><span class="PUNC">=</span><span class="NAME">h</span><span class="PUNC">[</span><span class="NAME">e</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">m</span><span class="PUNC">=</span><span class="NAME">h</span><span class="PUNC">[</span><span class="NAME">f</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">n</span><span class="PUNC">=</span><span class="NAME">h</span><span class="PUNC">[</span><span class="NAME">y</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">p</span><span class="PUNC">=</span><span class="NAME">i.x</span><span class="PUNC">-</span><span class="NAME">g.x</span><span class="PUNC">;</span><span class="NAME">t</span><span class="PUNC">=</span><span class="NAME">j.x</span><span class="PUNC">-</span><span class="NAME">g.x</span><span class="PUNC">;</span><span class="NAME">q</span><span class="PUNC">=</span><span class="NAME">i.y</span><span class="PUNC">-</span><span class="NAME">g.y</span><span class="PUNC">;</span><span class="NAME">r</span><span class="PUNC">=</span><span class="NAME">j.y</span><span class="PUNC">-</span><span class="NAME">g.y</span><span class="PUNC">;</span><span class="NAME">s</span><span class="PUNC">=</span><span class="NAME">i.z</span><span class="PUNC">-</span><span class="NAME">g.z</span><span class="PUNC">;</span><span class="NAME">v</span><span class="PUNC">=</span><span class="NAME">j.z</span><span class="PUNC">-</span><span class="NAME">g.z</span><span class="PUNC">;</span><span class="NAME">z</span><span class="PUNC">=</span><span class="NAME">m.x</span><span class="PUNC">-</span><span class="NAME">l.x</span><span class="PUNC">;</span><span class="NAME">C</span><span class="PUNC">=</span><span class="NAME">n.x</span><span class="PUNC">-</span><span class="NAME">l.x</span><span class="PUNC">;</span><span class="NAME">F</span><span class="PUNC">=</span><span class="NAME">m.y</span><span class="PUNC">-</span><span class="NAME">l.y</span><span class="PUNC">;</span><span class="NAME">H</span><span class="PUNC">=</span><span class="NAME">n.y</span><span class="PUNC">-</span><span class="NAME">l.y</span><span class="PUNC">;</span><span class="NAME">I</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">/</span><span class="PUNC">(</span><span class="NAME">z</span><span class="PUNC">*</span><span class="NAME">H</span><span class="PUNC">-</span><span class="NAME">C</span><span class="PUNC">*</span><span class="NAME">F</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">B.set</span><span class="PUNC">(</span><span class="PUNC">(</span><span class="NAME">H</span><span class="PUNC">*</span><span class="NAME">p</span><span class="PUNC">-</span><span class="NAME">F</span><span class="PUNC">*</span><span class="NAME">t</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">I</span><span class="PUNC">,</span><span class="PUNC">(</span><span class="NAME">H</span><span class="PUNC">*</span><span class="NAME">q</span><span class="PUNC">-</span><span class="NAME">F</span><span class="PUNC">*</span><span class="NAME">r</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">I</span><span class="PUNC">,</span><span class="PUNC">(</span><span class="NAME">H</span><span class="PUNC">*</span><span class="NAME">s</span><span class="PUNC">-</span><span class="NAME">F</span><span class="PUNC">*</span><span class="NAME">v</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">I</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">J.set</span><span class="PUNC">(</span><span class="PUNC">(</span><span class="NAME">z</span><span class="PUNC">*</span><span class="NAME">t</span><span class="PUNC">-</span><span class="NAME">C</span><span class="PUNC">*</span><span class="NAME">p</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">I</span><span class="PUNC">,</span><span class="PUNC">(</span><span class="NAME">z</span><span class="PUNC">*</span><span class="NAME">r</span><span class="PUNC">-</span><span class="NAME">C</span><span class="PUNC">*</span><span class="NAME">q</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">I</span><span class="PUNC">,</span><span class="PUNC">(</span><span class="NAME">z</span><span class="PUNC">*</span><span class="NAME">v</span><span class="PUNC">-</span><span class="NAME">C</span><span class="PUNC">*</span><span class="NAME">s</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">I</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">A</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">add</span><span class="PUNC">(</span><span class="NAME">B</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">A</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">add</span><span class="PUNC">(</span><span class="NAME">B</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">A</span><span class="PUNC">[</span><span class="NAME">d</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">add</span><span class="PUNC">(</span><span class="NAME">B</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">K</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">add</span><span class="PUNC">(</span><span class="NAME">J</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">K</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">add</span><span class="PUNC">(</span><span class="NAME">J</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">K</span><span class="PUNC">[</span><span class="NAME">d</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">add</span><span class="PUNC">(</span><span class="NAME">J</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>187</span> </span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">,</span><span class="NAME">j</span><span class="PUNC">,</span><span class="NAME">l</span><span class="PUNC">,</span><span class="NAME">m</span><span class="PUNC">,</span><span class="NAME">n</span><span class="PUNC">,</span><span class="NAME">p</span><span class="PUNC">,</span><span class="NAME">t</span><span class="PUNC">,</span><span class="NAME">q</span><span class="PUNC">,</span><span class="NAME">r</span><span class="PUNC">,</span><span class="NAME">s</span><span class="PUNC">,</span><span class="NAME">v</span><span class="PUNC">,</span><span class="NAME">z</span><span class="PUNC">,</span><span class="NAME">C</span><span class="PUNC">,</span><span class="NAME">F</span><span class="PUNC">,</span><span class="NAME">H</span><span class="PUNC">,</span><span class="NAME">I</span><span class="PUNC">,</span><span class="NAME">G</span><span class="PUNC">,</span><span class="NAME">A</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">K</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">B</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">,</span><span class="NAME">J</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">,</span><span class="NAME">N</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">,</span><span class="NAME">y</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">,</span><span class="NAME">M</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.vertices.length</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">&lt;</span><span class="NAME">c</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">A</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">,</span><span class="NAME">K</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.faces.length</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">&lt;</span><span class="NAME">c</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">this.faces</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">this.faceVertexUvs</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">f</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">THREE.Face3</span><span class="PUNC">?</span><span class="NAME">a</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">f.a</span><span class="PUNC">,</span><span class="NAME">f.b</span><span class="PUNC">,</span><span class="NAME">f.c</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NUMB">2</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">f</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">THREE.Face4</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">f.a</span><span class="PUNC">,</span><span class="NAME">f.b</span><span class="PUNC">,</span><span class="NAME">f.d</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NUMB">3</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">f.b</span><span class="PUNC">,</span><span class="NAME">f.c</span><span class="PUNC">,</span><span class="NAME">f.d</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NUMB">2</span><span class="PUNC">,</span><span class="NUMB">3</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">w</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="STRN">"a"</span><span class="PUNC">,</span><span class="STRN">"b"</span><span class="PUNC">,</span><span class="STRN">"c"</span><span class="PUNC">,</span><span class="STRN">"d"</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.faces.length</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">&lt;</span><span class="WHIT">
<span class='line'>188</span> </span><span class="NAME">c</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">this.faces</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">&lt;</span><span class="NAME">f.vertexNormals.length</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">M.copy</span><span class="PUNC">(</span><span class="NAME">f.vertexNormals</span><span class="PUNC">[</span><span class="NAME">d</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">f</span><span class="PUNC">[</span><span class="NAME">w</span><span class="PUNC">[</span><span class="NAME">d</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">G</span><span class="PUNC">=</span><span class="NAME">A</span><span class="PUNC">[</span><span class="NAME">e</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">N.copy</span><span class="PUNC">(</span><span class="NAME">G</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">N.sub</span><span class="PUNC">(</span><span class="NAME">M.multiplyScalar</span><span class="PUNC">(</span><span class="NAME">M.dot</span><span class="PUNC">(</span><span class="NAME">G</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">normalize</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">y.crossVectors</span><span class="PUNC">(</span><span class="NAME">f.vertexNormals</span><span class="PUNC">[</span><span class="NAME">d</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">G</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">y.dot</span><span class="PUNC">(</span><span class="NAME">K</span><span class="PUNC">[</span><span class="NAME">e</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">></span><span class="NAME">e</span><span class="PUNC">?</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">:</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">f.vertexTangents</span><span class="PUNC">[</span><span class="NAME">d</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector4</span><span class="PUNC">(</span><span class="NAME">N.x</span><span class="PUNC">,</span><span class="NAME">N.y</span><span class="PUNC">,</span><span class="NAME">N.z</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="NAME">this.hasTangents</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">computeLineDistances</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.vertices</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">b.length</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">&lt;</span><span class="NAME">d</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NUMB">0</span><span class="PUNC">&lt;</span><span class="NAME">c</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">distanceTo</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this.lineDistances</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">computeBoundingBox</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">null</span><span class="PUNC">===</span><span class="NAME">this.boundingBox</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">this.boundingBox</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>189</span> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Box3</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.boundingBox.setFromPoints</span><span class="PUNC">(</span><span class="NAME">this.vertices</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">computeBoundingSphere</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">null</span><span class="PUNC">===</span><span class="NAME">this.boundingSphere</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">this.boundingSphere</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Sphere</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.boundingSphere.setFromPoints</span><span class="PUNC">(</span><span class="NAME">this.vertices</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">mergeVertices</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">Math.pow</span><span class="PUNC">(</span><span class="NUMB">10</span><span class="PUNC">,</span><span class="NUMB">4</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">,</span><span class="NAME">j</span><span class="PUNC">;</span><span class="NAME">this.__tmpVertices</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">this.vertices.length</span><span class="PUNC">;</span><span class="NAME">f</span><span class="PUNC">&lt;</span><span class="NAME">h</span><span class="PUNC">;</span><span class="NAME">f</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">this.vertices</span><span class="PUNC">[</span><span class="NAME">f</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">Math.round</span><span class="PUNC">(</span><span class="NAME">d.x</span><span class="PUNC">*</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="STRN">"_"</span><span class="PUNC">+</span><span class="NAME">Math.round</span><span class="PUNC">(</span><span class="NAME">d.y</span><span class="PUNC">*</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="STRN">"_"</span><span class="PUNC">+</span><span class="NAME">Math.round</span><span class="PUNC">(</span><span class="NAME">d.z</span><span class="PUNC">*</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">===</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NAME">d</span><span class="PUNC">]</span><span class="PUNC">?</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NAME">d</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">b.push</span><span class="PUNC">(</span><span class="NAME">this.vertices</span><span class="PUNC">[</span><span class="NAME">f</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NAME">f</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">b.length</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NAME">f</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>190</span> </span><span class="NAME">c</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NAME">d</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">this.faces.length</span><span class="PUNC">;</span><span class="NAME">f</span><span class="PUNC">&lt;</span><span class="NAME">h</span><span class="PUNC">;</span><span class="NAME">f</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">this.faces</span><span class="PUNC">[</span><span class="NAME">f</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">a</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">THREE.Face3</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">a.a</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NAME">a.a</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">a.b</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NAME">a.b</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">a.c</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NAME">a.c</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">g</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="NAME">a.a</span><span class="PUNC">,</span><span class="NAME">a.b</span><span class="PUNC">,</span><span class="NAME">a.c</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">i</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NUMB">3</span><span class="PUNC">></span><span class="NAME">i</span><span class="PUNC">;</span><span class="NAME">i</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">g</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">==</span><span class="NAME">g</span><span class="PUNC">[</span><span class="PUNC">(</span><span class="NAME">i</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">%</span><span class="NUMB">3</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">e.push</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">break</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">a</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">THREE.Face4</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">a.a</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NAME">a.a</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">a.b</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NAME">a.b</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">a.c</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NAME">a.c</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">a.d</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NAME">a.d</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">g</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="NAME">a.a</span><span class="PUNC">,</span><span class="NAME">a.b</span><span class="PUNC">,</span><span class="NAME">a.c</span><span class="PUNC">,</span><span class="NAME">a.d</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">i</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NUMB">4</span><span class="PUNC">></span><span class="NAME">i</span><span class="PUNC">;</span><span class="NAME">i</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">g</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">==</span><span class="NAME">g</span><span class="PUNC">[</span><span class="PUNC">(</span><span class="NAME">i</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">%</span><span class="NUMB">4</span><span class="PUNC">]</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">&lt;=</span><span class="NAME">d</span><span class="PUNC">&&</span><span class="NAME">e.push</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">i</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">&lt;=</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">g.splice</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">l</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Face3</span><span class="PUNC">(</span><span class="NAME">g</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">[</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">a.normal</span><span class="PUNC">,</span><span class="NAME">a.color</span><span class="PUNC">,</span><span class="NAME">a.materialIndex</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">i</span><span class="PUNC">=</span><span class="NAME">this.faceVertexUvs.length</span><span class="PUNC">;</span><span class="NAME">g</span><span class="PUNC">&lt;</span><span class="NAME">i</span><span class="PUNC">;</span><span class="NAME">g</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="PUNC">(</span><span class="NAME">j</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>191</span> </span><span class="NAME">this.faceVertexUvs</span><span class="PUNC">[</span><span class="NAME">g</span><span class="PUNC">]</span><span class="PUNC">[</span><span class="NAME">f</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="NAME">j.splice</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a.vertexNormals</span><span class="PUNC">&&</span><span class="NUMB">0</span><span class="PUNC">&lt;</span><span class="NAME">a.vertexNormals.length</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">l.vertexNormals</span><span class="PUNC">=</span><span class="NAME">a.vertexNormals</span><span class="PUNC">,</span><span class="NAME">l.vertexNormals.splice</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a.vertexColors</span><span class="PUNC">&&</span><span class="NUMB">0</span><span class="PUNC">&lt;</span><span class="NAME">a.vertexColors.length</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">l.vertexColors</span><span class="PUNC">=</span><span class="NAME">a.vertexColors</span><span class="PUNC">,</span><span class="NAME">l.vertexColors.splice</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.faces</span><span class="PUNC">[</span><span class="NAME">f</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">l</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">e.length</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NUMB">0</span><span class="PUNC">&lt;=</span><span class="NAME">f</span><span class="PUNC">;</span><span class="NAME">f</span><span class="PUNC">--</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.faces.splice</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">i</span><span class="PUNC">=</span><span class="NAME">this.faceVertexUvs.length</span><span class="PUNC">;</span><span class="NAME">g</span><span class="PUNC">&lt;</span><span class="NAME">i</span><span class="PUNC">;</span><span class="NAME">g</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">this.faceVertexUvs</span><span class="PUNC">[</span><span class="NAME">g</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">splice</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.vertices.length</span><span class="PUNC">-</span><span class="NAME">b.length</span><span class="PUNC">;</span><span class="NAME">this.vertices</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">clone</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Geometry</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.vertices</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>192</span> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">b.length</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">&lt;</span><span class="NAME">d</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">a.vertices.push</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">clone</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.faces</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">b.length</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">&lt;</span><span class="NAME">d</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">a.faces.push</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">clone</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.faceVertexUvs</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">b.length</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">&lt;</span><span class="NAME">d</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">e.length</span><span class="PUNC">;</span><span class="NAME">h</span><span class="PUNC">&lt;</span><span class="NAME">g</span><span class="PUNC">;</span><span class="NAME">h</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">f.push</span><span class="PUNC">(</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector2</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">[</span><span class="NAME">h</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">x</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">[</span><span class="NAME">h</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">y</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a.faceVertexUvs</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">push</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">dispose</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.dispatchEvent</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">type</span><span class="PUNC">:</span><span class="STRN">"dispose"</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.EventDispatcher.prototype.apply</span><span class="PUNC">(</span><span class="NAME">THREE.Geometry.prototype</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">THREE.GeometryIdCount</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">THREE.BufferGeometry</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.id</span><span class="PUNC">=</span><span class="NAME">THREE.GeometryIdCount</span><span class="PUNC">++</span><span class="PUNC">;</span><span class="NAME">this.uuid</span><span class="PUNC">=</span><span class="NAME">THREE.Math.generateUUID</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.attributes</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">this.dynamic</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">this.offsets</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">this.boundingSphere</span><span class="PUNC">=</span><span class="NAME">this.boundingBox</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">;</span><span class="NAME">this.hasTangents</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">this.morphTargets</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>193</span> </span><span class="NAME">THREE.BufferGeometry.prototype</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="NAME">constructor</span><span class="PUNC">:</span><span class="NAME">THREE.BufferGeometry</span><span class="PUNC">,</span><span class="NAME">applyMatrix</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">;</span><span class="NAME">this.attributes.position</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.attributes.position.array</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.attributes.normal</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.attributes.normal.array</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">b</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">a.multiplyVector3Array</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this.verticesNeedUpdate</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">c</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="PUNC">(</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Matrix3</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">getNormalMatrix</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">multiplyVector3Array</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this.normalizeNormals</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this.normalsNeedUpdate</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">computeBoundingBox</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">null</span><span class="PUNC">===</span><span class="NAME">this.boundingBox</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">this.boundingBox</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Box3</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>194</span> </span><span class="NAME">this.attributes.position.array</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.boundingBox</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">;</span><span class="NUMB">3</span><span class="PUNC">&lt;=</span><span class="NAME">a.length</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">b.min.x</span><span class="PUNC">=</span><span class="NAME">b.max.x</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">b.min.y</span><span class="PUNC">=</span><span class="NAME">b.max.y</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">b.min.z</span><span class="PUNC">=</span><span class="NAME">b.max.z</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">f</span><span class="PUNC">=</span><span class="NUMB">3</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">a.length</span><span class="PUNC">;</span><span class="NAME">f</span><span class="PUNC">&lt;</span><span class="NAME">h</span><span class="PUNC">;</span><span class="NAME">f</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NUMB">3</span><span class="PUNC">)</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NAME">f</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NAME">f</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NAME">f</span><span class="PUNC">+</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">&lt;</span><span class="NAME">b.min.x</span><span class="PUNC">?</span><span class="NAME">b.min.x</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">:</span><span class="NAME">c</span><span class="PUNC">></span><span class="NAME">b.max.x</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">b.max.x</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">&lt;</span><span class="NAME">b.min.y</span><span class="PUNC">?</span><span class="NAME">b.min.y</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">:</span><span class="NAME">d</span><span class="PUNC">></span><span class="NAME">b.max.y</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">b.max.y</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">&lt;</span><span class="NAME">b.min.z</span><span class="PUNC">?</span><span class="NAME">b.min.z</span><span class="PUNC">=</span><span class="NAME">e</span><span class="PUNC">:</span><span class="NAME">e</span><span class="PUNC">></span><span class="NAME">b.max.z</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">b.max.z</span><span class="PUNC">=</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">===</span><span class="NAME">a</span><span class="PUNC">||</span><span class="NUMB">0</span><span class="PUNC">===</span><span class="NAME">a.length</span><span class="PUNC">)</span><span class="NAME">this.boundingBox.min.set</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this.boundingBox.max.set</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">computeBoundingSphere</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">null</span><span class="PUNC">===</span><span class="NAME">this.boundingSphere</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">this.boundingSphere</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>195</span> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Sphere</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">this.attributes.position.array</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">a.length</span><span class="PUNC">;</span><span class="NAME">f</span><span class="PUNC">&lt;</span><span class="NAME">h</span><span class="PUNC">;</span><span class="NAME">f</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NUMB">3</span><span class="PUNC">)</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NAME">f</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NAME">f</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NAME">f</span><span class="PUNC">+</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">*</span><span class="NAME">b</span><span class="PUNC">+</span><span class="NAME">d</span><span class="PUNC">*</span><span class="NAME">d</span><span class="PUNC">+</span><span class="NAME">e</span><span class="PUNC">*</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">></span><span class="NAME">c</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.boundingSphere.radius</span><span class="PUNC">=</span><span class="NAME">Math.sqrt</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">computeVertexNormals</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.attributes.position</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">this.attributes.position.array.length</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">===</span><span class="NAME">this.attributes.normal</span><span class="PUNC">)</span><span class="NAME">this.attributes.normal</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="NAME">itemSize</span><span class="PUNC">:</span><span class="NUMB">3</span><span class="PUNC">,</span><span class="NAME">array</span><span class="PUNC">:</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Float32Array</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="KEYW">else</span><span class="PUNC">{</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.attributes.normal.array.length</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">&lt;</span><span class="NAME">b</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">this.attributes.normal.array</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">}</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">e</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>196</span> </span><span class="NAME">this.attributes.position.array</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">this.attributes.normal.array</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">,</span><span class="NAME">j</span><span class="PUNC">,</span><span class="NAME">l</span><span class="PUNC">,</span><span class="NAME">m</span><span class="PUNC">,</span><span class="NAME">n</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">,</span><span class="NAME">p</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">,</span><span class="NAME">t</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">,</span><span class="NAME">q</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">,</span><span class="NAME">r</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.attributes.index</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">s</span><span class="PUNC">=</span><span class="NAME">this.attributes.index.array</span><span class="PUNC">,</span><span class="NAME">v</span><span class="PUNC">=</span><span class="NAME">this.offsets</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">v.length</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">&lt;</span><span class="NAME">d</span><span class="PUNC">;</span><span class="PUNC">++</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">v</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">start</span><span class="PUNC">;</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">v</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">count</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">z</span><span class="PUNC">=</span><span class="NAME">v</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">index</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">h</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">&lt;</span><span class="NAME">b</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NUMB">3</span><span class="PUNC">)</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">z</span><span class="PUNC">+</span><span class="NAME">s</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">z</span><span class="PUNC">+</span><span class="NAME">s</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">=</span><span class="NAME">z</span><span class="PUNC">+</span><span class="NAME">s</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">+</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">j</span><span class="PUNC">=</span><span class="NAME">e</span><span class="PUNC">[</span><span class="NUMB">3</span><span class="PUNC">*</span><span class="NAME">h</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">l</span><span class="PUNC">=</span><span class="NAME">e</span><span class="PUNC">[</span><span class="NUMB">3</span><span class="PUNC">*</span><span class="NAME">h</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">m</span><span class="PUNC">=</span><span class="NAME">e</span><span class="PUNC">[</span><span class="NUMB">3</span><span class="PUNC">*</span><span class="NAME">h</span><span class="PUNC">+</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">n.set</span><span class="PUNC">(</span><span class="NAME">j</span><span class="PUNC">,</span><span class="NAME">l</span><span class="PUNC">,</span><span class="NAME">m</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">j</span><span class="PUNC">=</span><span class="NAME">e</span><span class="PUNC">[</span><span class="NUMB">3</span><span class="PUNC">*</span><span class="NAME">g</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">l</span><span class="PUNC">=</span><span class="NAME">e</span><span class="PUNC">[</span><span class="NUMB">3</span><span class="PUNC">*</span><span class="NAME">g</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">m</span><span class="PUNC">=</span><span class="NAME">e</span><span class="PUNC">[</span><span class="NUMB">3</span><span class="PUNC">*</span><span class="NAME">g</span><span class="PUNC">+</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">p.set</span><span class="PUNC">(</span><span class="NAME">j</span><span class="PUNC">,</span><span class="NAME">l</span><span class="PUNC">,</span><span class="NAME">m</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">j</span><span class="PUNC">=</span><span class="NAME">e</span><span class="PUNC">[</span><span class="NUMB">3</span><span class="PUNC">*</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">l</span><span class="PUNC">=</span><span class="NAME">e</span><span class="PUNC">[</span><span class="NUMB">3</span><span class="PUNC">*</span><span class="NAME">i</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">m</span><span class="PUNC">=</span><span class="NAME">e</span><span class="PUNC">[</span><span class="NUMB">3</span><span class="PUNC">*</span><span class="NAME">i</span><span class="PUNC">+</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">t.set</span><span class="PUNC">(</span><span class="NAME">j</span><span class="PUNC">,</span><span class="NAME">l</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>197</span> </span><span class="NAME">m</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">q.subVectors</span><span class="PUNC">(</span><span class="NAME">t</span><span class="PUNC">,</span><span class="NAME">p</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">r.subVectors</span><span class="PUNC">(</span><span class="NAME">n</span><span class="PUNC">,</span><span class="NAME">p</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">q.cross</span><span class="PUNC">(</span><span class="NAME">r</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">[</span><span class="NUMB">3</span><span class="PUNC">*</span><span class="NAME">h</span><span class="PUNC">]</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">q.x</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">[</span><span class="NUMB">3</span><span class="PUNC">*</span><span class="NAME">h</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">q.y</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">[</span><span class="NUMB">3</span><span class="PUNC">*</span><span class="NAME">h</span><span class="PUNC">+</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">q.z</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">[</span><span class="NUMB">3</span><span class="PUNC">*</span><span class="NAME">g</span><span class="PUNC">]</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">q.x</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">[</span><span class="NUMB">3</span><span class="PUNC">*</span><span class="NAME">g</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">q.y</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">[</span><span class="NUMB">3</span><span class="PUNC">*</span><span class="NAME">g</span><span class="PUNC">+</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">q.z</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">[</span><span class="NUMB">3</span><span class="PUNC">*</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">q.x</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">[</span><span class="NUMB">3</span><span class="PUNC">*</span><span class="NAME">i</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">q.y</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">[</span><span class="NUMB">3</span><span class="PUNC">*</span><span class="NAME">i</span><span class="PUNC">+</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">q.z</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="PUNC">{</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">e.length</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">&lt;</span><span class="NAME">b</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NUMB">9</span><span class="PUNC">)</span><span class="NAME">j</span><span class="PUNC">=</span><span class="NAME">e</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">l</span><span class="PUNC">=</span><span class="NAME">e</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">m</span><span class="PUNC">=</span><span class="NAME">e</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">+</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">n.set</span><span class="PUNC">(</span><span class="NAME">j</span><span class="PUNC">,</span><span class="NAME">l</span><span class="PUNC">,</span><span class="NAME">m</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">j</span><span class="PUNC">=</span><span class="NAME">e</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">+</span><span class="NUMB">3</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">l</span><span class="PUNC">=</span><span class="NAME">e</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">+</span><span class="NUMB">4</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">m</span><span class="PUNC">=</span><span class="NAME">e</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">+</span><span class="NUMB">5</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">p.set</span><span class="PUNC">(</span><span class="NAME">j</span><span class="PUNC">,</span><span class="NAME">l</span><span class="PUNC">,</span><span class="NAME">m</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">j</span><span class="PUNC">=</span><span class="NAME">e</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">+</span><span class="NUMB">6</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">l</span><span class="PUNC">=</span><span class="NAME">e</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">+</span><span class="NUMB">7</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">m</span><span class="PUNC">=</span><span class="NAME">e</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">+</span><span class="NUMB">8</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">t.set</span><span class="PUNC">(</span><span class="NAME">j</span><span class="PUNC">,</span><span class="NAME">l</span><span class="PUNC">,</span><span class="NAME">m</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">q.subVectors</span><span class="PUNC">(</span><span class="NAME">t</span><span class="PUNC">,</span><span class="NAME">p</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">r.subVectors</span><span class="PUNC">(</span><span class="NAME">n</span><span class="PUNC">,</span><span class="NAME">p</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">q.cross</span><span class="PUNC">(</span><span class="NAME">r</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">q.x</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">q.y</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">+</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">q.z</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">+</span><span class="NUMB">3</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">q.x</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">+</span><span class="NUMB">4</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">q.y</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">+</span><span class="NUMB">5</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">q.z</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">+</span><span class="NUMB">6</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">q.x</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">+</span><span class="NUMB">7</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">q.y</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">+</span><span class="NUMB">8</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">q.z</span><span class="PUNC">}</span><span class="NAME">this.normalizeNormals</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.normalsNeedUpdate</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>198</span> </span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">normalizeNormals</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">this.attributes.normal.array</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">a.length</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">&lt;</span><span class="NAME">f</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NUMB">3</span><span class="PUNC">)</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NAME">e</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NAME">e</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NAME">e</span><span class="PUNC">+</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">/</span><span class="NAME">Math.sqrt</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">*</span><span class="NAME">b</span><span class="PUNC">+</span><span class="NAME">c</span><span class="PUNC">*</span><span class="NAME">c</span><span class="PUNC">+</span><span class="NAME">d</span><span class="PUNC">*</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NAME">e</span><span class="PUNC">]</span><span class="PUNC">*</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NAME">e</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">*</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NAME">e</span><span class="PUNC">+</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">*</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">computeTangents</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">Pa.x</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">[</span><span class="NUMB">3</span><span class="PUNC">*</span><span class="NAME">a</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">Pa.y</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">[</span><span class="NUMB">3</span><span class="PUNC">*</span><span class="NAME">a</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">Pa.z</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">[</span><span class="NUMB">3</span><span class="PUNC">*</span><span class="NAME">a</span><span class="PUNC">+</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">Ua.copy</span><span class="PUNC">(</span><span class="NAME">Pa</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">ka</span><span class="PUNC">=</span><span class="NAME">g</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">L.copy</span><span class="PUNC">(</span><span class="NAME">ka</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">L.sub</span><span class="PUNC">(</span><span class="NAME">Pa.multiplyScalar</span><span class="PUNC">(</span><span class="NAME">Pa.dot</span><span class="PUNC">(</span><span class="NAME">ka</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">normalize</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">pa.crossVectors</span><span class="PUNC">(</span><span class="NAME">Ua</span><span class="PUNC">,</span><span class="NAME">ka</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">Fa</span><span class="PUNC">=</span><span class="NAME">pa.dot</span><span class="PUNC">(</span><span class="NAME">i</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">O</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">></span><span class="NAME">Fa</span><span class="PUNC">?</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">:</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">h</span><span class="PUNC">[</span><span class="NUMB">4</span><span class="PUNC">*</span><span class="NAME">a</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">L.x</span><span class="PUNC">;</span><span class="NAME">h</span><span class="PUNC">[</span><span class="NUMB">4</span><span class="PUNC">*</span><span class="NAME">a</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">L.y</span><span class="PUNC">;</span><span class="NAME">h</span><span class="PUNC">[</span><span class="NUMB">4</span><span class="PUNC">*</span><span class="NAME">a</span><span class="PUNC">+</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">L.z</span><span class="PUNC">;</span><span class="NAME">h</span><span class="PUNC">[</span><span class="NUMB">4</span><span class="PUNC">*</span><span class="NAME">a</span><span class="PUNC">+</span><span class="NUMB">3</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">O</span><span class="PUNC">}</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">===</span><span class="NAME">this.attributes.index</span><span class="PUNC">||</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">===</span><span class="NAME">this.attributes.position</span><span class="PUNC">||</span><span class="WHIT">
<span class='line'>199</span> </span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">===</span><span class="NAME">this.attributes.normal</span><span class="PUNC">||</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">===</span><span class="NAME">this.attributes.uv</span><span class="PUNC">)</span><span class="NAME">console.warn</span><span class="PUNC">(</span><span class="STRN">"Missing required attributes (index, position, normal or uv) in BufferGeometry.computeTangents()"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">else</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.attributes.index.array</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.attributes.position.array</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">this.attributes.normal.array</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">this.attributes.uv.array</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">c.length</span><span class="PUNC">/</span><span class="NUMB">3</span><span class="PUNC">;</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">===</span><span class="NAME">this.attributes.tangent</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">this.attributes.tangent</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="NAME">itemSize</span><span class="PUNC">:</span><span class="NUMB">4</span><span class="PUNC">,</span><span class="NAME">array</span><span class="PUNC">:</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Float32Array</span><span class="PUNC">(</span><span class="NUMB">4</span><span class="PUNC">*</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">this.attributes.tangent.array</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">j</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">j</span><span class="PUNC">&lt;</span><span class="NAME">f</span><span class="PUNC">;</span><span class="NAME">j</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">g</span><span class="PUNC">[</span><span class="NAME">j</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>200</span> </span><span class="NAME">i</span><span class="PUNC">[</span><span class="NAME">j</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">l</span><span class="PUNC">,</span><span class="NAME">m</span><span class="PUNC">,</span><span class="NAME">n</span><span class="PUNC">,</span><span class="NAME">p</span><span class="PUNC">,</span><span class="NAME">t</span><span class="PUNC">,</span><span class="NAME">q</span><span class="PUNC">,</span><span class="NAME">r</span><span class="PUNC">,</span><span class="NAME">s</span><span class="PUNC">,</span><span class="NAME">v</span><span class="PUNC">,</span><span class="NAME">z</span><span class="PUNC">,</span><span class="NAME">C</span><span class="PUNC">,</span><span class="NAME">F</span><span class="PUNC">,</span><span class="NAME">H</span><span class="PUNC">,</span><span class="NAME">I</span><span class="PUNC">,</span><span class="NAME">G</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">,</span><span class="NAME">j</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">,</span><span class="NAME">A</span><span class="PUNC">,</span><span class="NAME">K</span><span class="PUNC">,</span><span class="NAME">B</span><span class="PUNC">,</span><span class="NAME">J</span><span class="PUNC">,</span><span class="NAME">N</span><span class="PUNC">,</span><span class="NAME">y</span><span class="PUNC">,</span><span class="NAME">M</span><span class="PUNC">,</span><span class="NAME">w</span><span class="PUNC">=</span><span class="NAME">this.offsets</span><span class="PUNC">;</span><span class="NAME">B</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">J</span><span class="PUNC">=</span><span class="NAME">w.length</span><span class="PUNC">;</span><span class="NAME">B</span><span class="PUNC">&lt;</span><span class="NAME">J</span><span class="PUNC">;</span><span class="PUNC">++</span><span class="NAME">B</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">K</span><span class="PUNC">=</span><span class="NAME">w</span><span class="PUNC">[</span><span class="NAME">B</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">start</span><span class="PUNC">;</span><span class="NAME">N</span><span class="PUNC">=</span><span class="NAME">w</span><span class="PUNC">[</span><span class="NAME">B</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">count</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">Z</span><span class="PUNC">=</span><span class="NAME">w</span><span class="PUNC">[</span><span class="NAME">B</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">index</span><span class="PUNC">;</span><span class="NAME">A</span><span class="PUNC">=</span><span class="NAME">K</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">K</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">N</span><span class="PUNC">;</span><span class="NAME">A</span><span class="PUNC">&lt;</span><span class="NAME">K</span><span class="PUNC">;</span><span class="NAME">A</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NUMB">3</span><span class="PUNC">)</span><span class="NAME">N</span><span class="PUNC">=</span><span class="NAME">Z</span><span class="PUNC">+</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NAME">A</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">y</span><span class="PUNC">=</span><span class="NAME">Z</span><span class="PUNC">+</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NAME">A</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">M</span><span class="PUNC">=</span><span class="NAME">Z</span><span class="PUNC">+</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NAME">A</span><span class="PUNC">+</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">l</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NUMB">3</span><span class="PUNC">*</span><span class="NAME">N</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">m</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NUMB">3</span><span class="PUNC">*</span><span class="NAME">N</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">n</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NUMB">3</span><span class="PUNC">*</span><span class="NAME">N</span><span class="PUNC">+</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">p</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NUMB">3</span><span class="PUNC">*</span><span class="NAME">y</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">t</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NUMB">3</span><span class="PUNC">*</span><span class="NAME">y</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">q</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NUMB">3</span><span class="PUNC">*</span><span class="NAME">y</span><span class="PUNC">+</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">r</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NUMB">3</span><span class="PUNC">*</span><span class="NAME">M</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">s</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NUMB">3</span><span class="PUNC">*</span><span class="NAME">M</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">v</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NUMB">3</span><span class="PUNC">*</span><span class="NAME">M</span><span class="PUNC">+</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">z</span><span class="PUNC">=</span><span class="NAME">e</span><span class="PUNC">[</span><span class="NUMB">2</span><span class="PUNC">*</span><span class="NAME">N</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">C</span><span class="PUNC">=</span><span class="NAME">e</span><span class="PUNC">[</span><span class="NUMB">2</span><span class="PUNC">*</span><span class="NAME">N</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">F</span><span class="PUNC">=</span><span class="NAME">e</span><span class="PUNC">[</span><span class="NUMB">2</span><span class="PUNC">*</span><span class="NAME">y</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">H</span><span class="PUNC">=</span><span class="NAME">e</span><span class="PUNC">[</span><span class="NUMB">2</span><span class="PUNC">*</span><span class="NAME">y</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">I</span><span class="PUNC">=</span><span class="NAME">e</span><span class="PUNC">[</span><span class="NUMB">2</span><span class="PUNC">*</span><span class="NAME">M</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">G</span><span class="PUNC">=</span><span class="NAME">e</span><span class="PUNC">[</span><span class="NUMB">2</span><span class="PUNC">*</span><span class="NAME">M</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">p</span><span class="PUNC">-</span><span class="PUNC">=</span><span class="NAME">l</span><span class="PUNC">,</span><span class="NAME">l</span><span class="PUNC">=</span><span class="NAME">r</span><span class="PUNC">-</span><span class="NAME">l</span><span class="PUNC">,</span><span class="NAME">t</span><span class="PUNC">-</span><span class="PUNC">=</span><span class="NAME">m</span><span class="PUNC">,</span><span class="NAME">m</span><span class="PUNC">=</span><span class="NAME">s</span><span class="PUNC">-</span><span class="NAME">m</span><span class="PUNC">,</span><span class="NAME">q</span><span class="PUNC">-</span><span class="PUNC">=</span><span class="NAME">n</span><span class="PUNC">,</span><span class="NAME">n</span><span class="PUNC">=</span><span class="NAME">v</span><span class="PUNC">-</span><span class="NAME">n</span><span class="PUNC">,</span><span class="NAME">F</span><span class="PUNC">-</span><span class="PUNC">=</span><span class="NAME">z</span><span class="PUNC">,</span><span class="NAME">z</span><span class="PUNC">=</span><span class="NAME">I</span><span class="PUNC">-</span><span class="NAME">z</span><span class="PUNC">,</span><span class="NAME">H</span><span class="PUNC">-</span><span class="PUNC">=</span><span class="NAME">C</span><span class="PUNC">,</span><span class="NAME">C</span><span class="PUNC">=</span><span class="NAME">G</span><span class="PUNC">-</span><span class="NAME">C</span><span class="PUNC">,</span><span class="NAME">G</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">/</span><span class="PUNC">(</span><span class="NAME">F</span><span class="PUNC">*</span><span class="NAME">C</span><span class="PUNC">-</span><span class="NAME">z</span><span class="PUNC">*</span><span class="NAME">H</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">f.set</span><span class="PUNC">(</span><span class="PUNC">(</span><span class="NAME">C</span><span class="PUNC">*</span><span class="NAME">p</span><span class="PUNC">-</span><span class="NAME">H</span><span class="PUNC">*</span><span class="NAME">l</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">G</span><span class="PUNC">,</span><span class="PUNC">(</span><span class="NAME">C</span><span class="PUNC">*</span><span class="NAME">t</span><span class="PUNC">-</span><span class="NAME">H</span><span class="PUNC">*</span><span class="NAME">m</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">G</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>201</span> </span><span class="PUNC">(</span><span class="NAME">C</span><span class="PUNC">*</span><span class="NAME">q</span><span class="PUNC">-</span><span class="NAME">H</span><span class="PUNC">*</span><span class="NAME">n</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">G</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">j.set</span><span class="PUNC">(</span><span class="PUNC">(</span><span class="NAME">F</span><span class="PUNC">*</span><span class="NAME">l</span><span class="PUNC">-</span><span class="NAME">z</span><span class="PUNC">*</span><span class="NAME">p</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">G</span><span class="PUNC">,</span><span class="PUNC">(</span><span class="NAME">F</span><span class="PUNC">*</span><span class="NAME">m</span><span class="PUNC">-</span><span class="NAME">z</span><span class="PUNC">*</span><span class="NAME">t</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">G</span><span class="PUNC">,</span><span class="PUNC">(</span><span class="NAME">F</span><span class="PUNC">*</span><span class="NAME">n</span><span class="PUNC">-</span><span class="NAME">z</span><span class="PUNC">*</span><span class="NAME">q</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">G</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">[</span><span class="NAME">N</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">add</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">[</span><span class="NAME">y</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">add</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">[</span><span class="NAME">M</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">add</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">[</span><span class="NAME">N</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">add</span><span class="PUNC">(</span><span class="NAME">j</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">[</span><span class="NAME">y</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">add</span><span class="PUNC">(</span><span class="NAME">j</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">[</span><span class="NAME">M</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">add</span><span class="PUNC">(</span><span class="NAME">j</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">L</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">,</span><span class="NAME">pa</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">,</span><span class="NAME">Pa</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">,</span><span class="NAME">Ua</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">,</span><span class="NAME">O</span><span class="PUNC">,</span><span class="NAME">ka</span><span class="PUNC">,</span><span class="NAME">Fa</span><span class="PUNC">;</span><span class="NAME">B</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">J</span><span class="PUNC">=</span><span class="NAME">w.length</span><span class="PUNC">;</span><span class="NAME">B</span><span class="PUNC">&lt;</span><span class="NAME">J</span><span class="PUNC">;</span><span class="PUNC">++</span><span class="NAME">B</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">K</span><span class="PUNC">=</span><span class="NAME">w</span><span class="PUNC">[</span><span class="NAME">B</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">start</span><span class="PUNC">;</span><span class="NAME">N</span><span class="PUNC">=</span><span class="NAME">w</span><span class="PUNC">[</span><span class="NAME">B</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">count</span><span class="PUNC">;</span><span class="NAME">Z</span><span class="PUNC">=</span><span class="NAME">w</span><span class="PUNC">[</span><span class="NAME">B</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">index</span><span class="PUNC">;</span><span class="NAME">A</span><span class="PUNC">=</span><span class="NAME">K</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">K</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">N</span><span class="PUNC">;</span><span class="NAME">A</span><span class="PUNC">&lt;</span><span class="NAME">K</span><span class="PUNC">;</span><span class="NAME">A</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NUMB">3</span><span class="PUNC">)</span><span class="NAME">N</span><span class="PUNC">=</span><span class="NAME">Z</span><span class="PUNC">+</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NAME">A</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">y</span><span class="PUNC">=</span><span class="NAME">Z</span><span class="PUNC">+</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NAME">A</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">M</span><span class="PUNC">=</span><span class="NAME">Z</span><span class="PUNC">+</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NAME">A</span><span class="PUNC">+</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">(</span><span class="NAME">N</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">(</span><span class="NAME">y</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">(</span><span class="NAME">M</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="NAME">this.tangentsNeedUpdate</span><span class="PUNC">=</span><span class="NAME">this.hasTangents</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">dispose</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.dispatchEvent</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">type</span><span class="PUNC">:</span><span class="STRN">"dispose"</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.EventDispatcher.prototype.apply</span><span class="PUNC">(</span><span class="NAME">THREE.BufferGeometry.prototype</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">THREE.Camera</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">THREE.Object3D.call</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.matrixWorldInverse</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Matrix4</span><span class="PUNC">;</span><span class="NAME">this.projectionMatrix</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Matrix4</span><span class="PUNC">;</span><span class="NAME">this.projectionMatrixInverse</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Matrix4</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.Camera.prototype</span><span class="PUNC">=</span><span class="NAME">Object.create</span><span class="PUNC">(</span><span class="NAME">THREE.Object3D.prototype</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">THREE.Camera.prototype.lookAt</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Matrix4</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">a.lookAt</span><span class="PUNC">(</span><span class="NAME">this.position</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">this.up</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.quaternion.setFromRotationMatrix</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">THREE.OrthographicCamera</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">THREE.Camera.call</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.left</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">this.right</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">;</span><span class="NAME">this.top</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">;</span><span class="NAME">this.bottom</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">;</span><span class="NAME">this.near</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">e</span><span class="PUNC">?</span><span class="NAME">e</span><span class="PUNC">:</span><span class="NUMB">0.1</span><span class="PUNC">;</span><span class="NAME">this.far</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">f</span><span class="PUNC">?</span><span class="NAME">f</span><span class="PUNC">:</span><span class="NUMB">2</span><span class="NAME">E3</span><span class="PUNC">;</span><span class="NAME">this.updateProjectionMatrix</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.OrthographicCamera.prototype</span><span class="PUNC">=</span><span class="NAME">Object.create</span><span class="PUNC">(</span><span class="NAME">THREE.Camera.prototype</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">THREE.OrthographicCamera.prototype.updateProjectionMatrix</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.projectionMatrix.makeOrthographic</span><span class="PUNC">(</span><span class="NAME">this.left</span><span class="PUNC">,</span><span class="NAME">this.right</span><span class="PUNC">,</span><span class="NAME">this.top</span><span class="PUNC">,</span><span class="NAME">this.bottom</span><span class="PUNC">,</span><span class="NAME">this.near</span><span class="PUNC">,</span><span class="NAME">this.far</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.PerspectiveCamera</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">THREE.Camera.call</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.fov</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">a</span><span class="PUNC">?</span><span class="NAME">a</span><span class="PUNC">:</span><span class="NUMB">50</span><span class="PUNC">;</span><span class="NAME">this.aspect</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">b</span><span class="PUNC">?</span><span class="NAME">b</span><span class="PUNC">:</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">this.near</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">c</span><span class="PUNC">?</span><span class="NAME">c</span><span class="PUNC">:</span><span class="NUMB">0.1</span><span class="PUNC">;</span><span class="NAME">this.far</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">d</span><span class="PUNC">?</span><span class="NAME">d</span><span class="PUNC">:</span><span class="NUMB">2</span><span class="NAME">E3</span><span class="PUNC">;</span><span class="NAME">this.updateProjectionMatrix</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.PerspectiveCamera.prototype</span><span class="PUNC">=</span><span class="NAME">Object.create</span><span class="PUNC">(</span><span class="NAME">THREE.Camera.prototype</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">THREE.PerspectiveCamera.prototype.setLens</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">===</span><span class="NAME">b</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NUMB">24</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.fov</span><span class="PUNC">=</span><span class="NUMB">2</span><span class="PUNC">*</span><span class="NAME">THREE.Math.radToDeg</span><span class="PUNC">(</span><span class="NAME">Math.atan</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">/</span><span class="PUNC">(</span><span class="NUMB">2</span><span class="PUNC">*</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.updateProjectionMatrix</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>202</span> </span><span class="NAME">THREE.PerspectiveCamera.prototype.setViewOffset</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.fullWidth</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">this.fullHeight</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">;</span><span class="NAME">this.x</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">;</span><span class="NAME">this.y</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">;</span><span class="NAME">this.width</span><span class="PUNC">=</span><span class="NAME">e</span><span class="PUNC">;</span><span class="NAME">this.height</span><span class="PUNC">=</span><span class="NAME">f</span><span class="PUNC">;</span><span class="NAME">this.updateProjectionMatrix</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>203</span> </span><span class="NAME">THREE.PerspectiveCamera.prototype.updateProjectionMatrix</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.fullWidth</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">this.fullWidth</span><span class="PUNC">/</span><span class="NAME">this.fullHeight</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">Math.tan</span><span class="PUNC">(</span><span class="NAME">THREE.Math.degToRad</span><span class="PUNC">(</span><span class="NUMB">0.5</span><span class="PUNC">*</span><span class="NAME">this.fov</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">this.near</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">*</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">Math.abs</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">*</span><span class="NAME">b</span><span class="PUNC">-</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">Math.abs</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">-</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.projectionMatrix.makeFrustum</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">+</span><span class="NAME">this.x</span><span class="PUNC">*</span><span class="NAME">a</span><span class="PUNC">/</span><span class="NAME">this.fullWidth</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">+</span><span class="PUNC">(</span><span class="NAME">this.x</span><span class="PUNC">+</span><span class="NAME">this.width</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">a</span><span class="PUNC">/</span><span class="NAME">this.fullWidth</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">-</span><span class="PUNC">(</span><span class="NAME">this.y</span><span class="PUNC">+</span><span class="NAME">this.height</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">c</span><span class="PUNC">/</span><span class="NAME">this.fullHeight</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">-</span><span class="NAME">this.y</span><span class="PUNC">*</span><span class="NAME">c</span><span class="PUNC">/</span><span class="NAME">this.fullHeight</span><span class="PUNC">,</span><span class="NAME">this.near</span><span class="PUNC">,</span><span class="NAME">this.far</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="NAME">this.projectionMatrix.makePerspective</span><span class="PUNC">(</span><span class="NAME">this.fov</span><span class="PUNC">,</span><span class="NAME">this.aspect</span><span class="PUNC">,</span><span class="NAME">this.near</span><span class="PUNC">,</span><span class="NAME">this.far</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.Light</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">THREE.Object3D.call</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.color</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Color</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.Light.prototype</span><span class="PUNC">=</span><span class="NAME">Object.create</span><span class="PUNC">(</span><span class="NAME">THREE.Object3D.prototype</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">THREE.Light.prototype.clone</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">===</span><span class="NAME">a</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Light</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">THREE.Object3D.prototype.clone.call</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a.color.copy</span><span class="PUNC">(</span><span class="NAME">this.color</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.AmbientLight</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">THREE.Light.call</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.AmbientLight.prototype</span><span class="PUNC">=</span><span class="NAME">Object.create</span><span class="PUNC">(</span><span class="NAME">THREE.Light.prototype</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">THREE.AmbientLight.prototype.clone</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.AmbientLight</span><span class="PUNC">;</span><span class="NAME">THREE.Light.prototype.clone.call</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.AreaLight</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">THREE.Light.call</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.normal</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.right</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">(</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.intensity</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">b</span><span class="PUNC">?</span><span class="NAME">b</span><span class="PUNC">:</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">this.height</span><span class="PUNC">=</span><span class="NAME">this.width</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">this.constantAttenuation</span><span class="PUNC">=</span><span class="NUMB">1.5</span><span class="PUNC">;</span><span class="NAME">this.linearAttenuation</span><span class="PUNC">=</span><span class="NUMB">0.5</span><span class="PUNC">;</span><span class="NAME">this.quadraticAttenuation</span><span class="PUNC">=</span><span class="NUMB">0.1</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.AreaLight.prototype</span><span class="PUNC">=</span><span class="NAME">Object.create</span><span class="PUNC">(</span><span class="NAME">THREE.Light.prototype</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">THREE.DirectionalLight</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">THREE.Light.call</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.position.set</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.target</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Object3D</span><span class="PUNC">;</span><span class="NAME">this.intensity</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">b</span><span class="PUNC">?</span><span class="NAME">b</span><span class="PUNC">:</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">this.onlyShadow</span><span class="PUNC">=</span><span class="NAME">this.castShadow</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">this.shadowCameraNear</span><span class="PUNC">=</span><span class="NUMB">50</span><span class="PUNC">;</span><span class="NAME">this.shadowCameraFar</span><span class="PUNC">=</span><span class="NUMB">5</span><span class="NAME">E3</span><span class="PUNC">;</span><span class="NAME">this.shadowCameraLeft</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="NUMB">500</span><span class="PUNC">;</span><span class="NAME">this.shadowCameraTop</span><span class="PUNC">=</span><span class="NAME">this.shadowCameraRight</span><span class="PUNC">=</span><span class="NUMB">500</span><span class="PUNC">;</span><span class="NAME">this.shadowCameraBottom</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="NUMB">500</span><span class="PUNC">;</span><span class="NAME">this.shadowCameraVisible</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">this.shadowBias</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">this.shadowDarkness</span><span class="PUNC">=</span><span class="NUMB">0.5</span><span class="PUNC">;</span><span class="NAME">this.shadowMapHeight</span><span class="PUNC">=</span><span class="NAME">this.shadowMapWidth</span><span class="PUNC">=</span><span class="NUMB">512</span><span class="PUNC">;</span><span class="NAME">this.shadowCascade</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">this.shadowCascadeOffset</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>204</span> </span><span class="NUMB">0</span><span class="PUNC">,</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="NAME">E3</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.shadowCascadeCount</span><span class="PUNC">=</span><span class="NUMB">2</span><span class="PUNC">;</span><span class="NAME">this.shadowCascadeBias</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">this.shadowCascadeWidth</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="NUMB">512</span><span class="PUNC">,</span><span class="NUMB">512</span><span class="PUNC">,</span><span class="NUMB">512</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">this.shadowCascadeHeight</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="NUMB">512</span><span class="PUNC">,</span><span class="NUMB">512</span><span class="PUNC">,</span><span class="NUMB">512</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">this.shadowCascadeNearZ</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NUMB">0.99</span><span class="PUNC">,</span><span class="NUMB">0.998</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">this.shadowCascadeFarZ</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="NUMB">0.99</span><span class="PUNC">,</span><span class="NUMB">0.998</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">this.shadowCascadeArray</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">this.shadowMatrix</span><span class="PUNC">=</span><span class="NAME">this.shadowCamera</span><span class="PUNC">=</span><span class="NAME">this.shadowMapSize</span><span class="PUNC">=</span><span class="NAME">this.shadowMap</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.DirectionalLight.prototype</span><span class="PUNC">=</span><span class="NAME">Object.create</span><span class="PUNC">(</span><span class="NAME">THREE.Light.prototype</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>205</span> </span><span class="NAME">THREE.DirectionalLight.prototype.clone</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.DirectionalLight</span><span class="PUNC">;</span><span class="NAME">THREE.Light.prototype.clone.call</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a.target</span><span class="PUNC">=</span><span class="NAME">this.target.clone</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a.intensity</span><span class="PUNC">=</span><span class="NAME">this.intensity</span><span class="PUNC">;</span><span class="NAME">a.castShadow</span><span class="PUNC">=</span><span class="NAME">this.castShadow</span><span class="PUNC">;</span><span class="NAME">a.onlyShadow</span><span class="PUNC">=</span><span class="NAME">this.onlyShadow</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.HemisphereLight</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">THREE.Light.call</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.position.set</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">100</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.groundColor</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Color</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.intensity</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">c</span><span class="PUNC">?</span><span class="NAME">c</span><span class="PUNC">:</span><span class="NUMB">1</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.HemisphereLight.prototype</span><span class="PUNC">=</span><span class="NAME">Object.create</span><span class="PUNC">(</span><span class="NAME">THREE.Light.prototype</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">THREE.HemisphereLight.prototype.clone</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.PointLight</span><span class="PUNC">;</span><span class="NAME">THREE.Light.prototype.clone.call</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a.groundColor.copy</span><span class="PUNC">(</span><span class="NAME">this.groundColor</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a.intensity</span><span class="PUNC">=</span><span class="NAME">this.intensity</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.PointLight</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">THREE.Light.call</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.intensity</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">b</span><span class="PUNC">?</span><span class="NAME">b</span><span class="PUNC">:</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">this.distance</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">c</span><span class="PUNC">?</span><span class="NAME">c</span><span class="PUNC">:</span><span class="NUMB">0</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.PointLight.prototype</span><span class="PUNC">=</span><span class="NAME">Object.create</span><span class="PUNC">(</span><span class="NAME">THREE.Light.prototype</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">THREE.PointLight.prototype.clone</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.PointLight</span><span class="PUNC">;</span><span class="NAME">THREE.Light.prototype.clone.call</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a.intensity</span><span class="PUNC">=</span><span class="NAME">this.intensity</span><span class="PUNC">;</span><span class="NAME">a.distance</span><span class="PUNC">=</span><span class="NAME">this.distance</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.SpotLight</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">THREE.Light.call</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.position.set</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.target</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Object3D</span><span class="PUNC">;</span><span class="NAME">this.intensity</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">b</span><span class="PUNC">?</span><span class="NAME">b</span><span class="PUNC">:</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">this.distance</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">c</span><span class="PUNC">?</span><span class="NAME">c</span><span class="PUNC">:</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">this.angle</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">d</span><span class="PUNC">?</span><span class="NAME">d</span><span class="PUNC">:</span><span class="NAME">Math.PI</span><span class="PUNC">/</span><span class="NUMB">3</span><span class="PUNC">;</span><span class="NAME">this.exponent</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">e</span><span class="PUNC">?</span><span class="NAME">e</span><span class="PUNC">:</span><span class="NUMB">10</span><span class="PUNC">;</span><span class="NAME">this.onlyShadow</span><span class="PUNC">=</span><span class="NAME">this.castShadow</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">this.shadowCameraNear</span><span class="PUNC">=</span><span class="NUMB">50</span><span class="PUNC">;</span><span class="NAME">this.shadowCameraFar</span><span class="PUNC">=</span><span class="NUMB">5</span><span class="NAME">E3</span><span class="PUNC">;</span><span class="NAME">this.shadowCameraFov</span><span class="PUNC">=</span><span class="NUMB">50</span><span class="PUNC">;</span><span class="NAME">this.shadowCameraVisible</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">this.shadowBias</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">this.shadowDarkness</span><span class="PUNC">=</span><span class="NUMB">0.5</span><span class="PUNC">;</span><span class="NAME">this.shadowMapHeight</span><span class="PUNC">=</span><span class="NAME">this.shadowMapWidth</span><span class="PUNC">=</span><span class="NUMB">512</span><span class="PUNC">;</span><span class="NAME">this.shadowMatrix</span><span class="PUNC">=</span><span class="NAME">this.shadowCamera</span><span class="PUNC">=</span><span class="NAME">this.shadowMapSize</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>206</span> </span><span class="NAME">this.shadowMap</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.SpotLight.prototype</span><span class="PUNC">=</span><span class="NAME">Object.create</span><span class="PUNC">(</span><span class="NAME">THREE.Light.prototype</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">THREE.SpotLight.prototype.clone</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.SpotLight</span><span class="PUNC">;</span><span class="NAME">THREE.Light.prototype.clone.call</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a.target</span><span class="PUNC">=</span><span class="NAME">this.target.clone</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a.intensity</span><span class="PUNC">=</span><span class="NAME">this.intensity</span><span class="PUNC">;</span><span class="NAME">a.distance</span><span class="PUNC">=</span><span class="NAME">this.distance</span><span class="PUNC">;</span><span class="NAME">a.angle</span><span class="PUNC">=</span><span class="NAME">this.angle</span><span class="PUNC">;</span><span class="NAME">a.exponent</span><span class="PUNC">=</span><span class="NAME">this.exponent</span><span class="PUNC">;</span><span class="NAME">a.castShadow</span><span class="PUNC">=</span><span class="NAME">this.castShadow</span><span class="PUNC">;</span><span class="NAME">a.onlyShadow</span><span class="PUNC">=</span><span class="NAME">this.onlyShadow</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.Loader</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.statusDomElement</span><span class="PUNC">=</span><span class="PUNC">(</span><span class="NAME">this.showStatus</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">?</span><span class="NAME">THREE.Loader.prototype.addStatusElement</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">;</span><span class="NAME">this.onLoadStart</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">this.onLoadProgress</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">this.onLoadComplete</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>207</span> </span><span class="NAME">THREE.Loader.prototype</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="NAME">constructor</span><span class="PUNC">:</span><span class="NAME">THREE.Loader</span><span class="PUNC">,</span><span class="NAME">crossOrigin</span><span class="PUNC">:</span><span class="STRN">"anonymous"</span><span class="PUNC">,</span><span class="NAME">addStatusElement</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">document.createElement</span><span class="PUNC">(</span><span class="STRN">"div"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a.style.position</span><span class="PUNC">=</span><span class="STRN">"absolute"</span><span class="PUNC">;</span><span class="NAME">a.style.right</span><span class="PUNC">=</span><span class="STRN">"0px"</span><span class="PUNC">;</span><span class="NAME">a.style.top</span><span class="PUNC">=</span><span class="STRN">"0px"</span><span class="PUNC">;</span><span class="NAME">a.style.fontSize</span><span class="PUNC">=</span><span class="STRN">"0.8em"</span><span class="PUNC">;</span><span class="NAME">a.style.textAlign</span><span class="PUNC">=</span><span class="STRN">"left"</span><span class="PUNC">;</span><span class="NAME">a.style.background</span><span class="PUNC">=</span><span class="STRN">"rgba(0,0,0,0.25)"</span><span class="PUNC">;</span><span class="NAME">a.style.color</span><span class="PUNC">=</span><span class="STRN">"#fff"</span><span class="PUNC">;</span><span class="NAME">a.style.width</span><span class="PUNC">=</span><span class="STRN">"120px"</span><span class="PUNC">;</span><span class="NAME">a.style.padding</span><span class="PUNC">=</span><span class="STRN">"0.5em 0.5em 0.5em 0.5em"</span><span class="PUNC">;</span><span class="NAME">a.style.zIndex</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="NAME">E3</span><span class="PUNC">;</span><span class="NAME">a.innerHTML</span><span class="PUNC">=</span><span class="STRN">"Loading ..."</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">updateProgress</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="STRN">"Loaded "</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">a.total</span><span class="PUNC">?</span><span class="NAME">b</span><span class="PUNC">+</span><span class="PUNC">(</span><span class="PUNC">(</span><span class="NUMB">100</span><span class="PUNC">*</span><span class="NAME">a.loaded</span><span class="PUNC">/</span><span class="WHIT">
<span class='line'>208</span> </span><span class="NAME">a.total</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">toFixed</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="STRN">"%"</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">b</span><span class="PUNC">+</span><span class="PUNC">(</span><span class="PUNC">(</span><span class="NAME">a.loaded</span><span class="PUNC">/</span><span class="NUMB">1</span><span class="NAME">E3</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">toFixed</span><span class="PUNC">(</span><span class="NUMB">2</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="STRN">" KB"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.statusDomElement.innerHTML</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">extractUrlBase</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">a.split</span><span class="PUNC">(</span><span class="STRN">"/"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a.pop</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="PUNC">(</span><span class="NUMB">1</span><span class="PUNC">></span><span class="NAME">a.length</span><span class="PUNC">?</span><span class="STRN">"."</span><span class="PUNC">:</span><span class="NAME">a.join</span><span class="PUNC">(</span><span class="STRN">"/"</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="STRN">"/"</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">initMaterials</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">&lt;</span><span class="NAME">a.length</span><span class="PUNC">;</span><span class="PUNC">++</span><span class="NAME">d</span><span class="PUNC">)</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NAME">d</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">THREE.Loader.prototype.createMaterial</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NAME">d</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">needsTangents</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">a.length</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">&lt;</span><span class="NAME">c</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">]</span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">THREE.ShaderMaterial</span><span class="PUNC">)</span><span class="KEYW">return</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">createMaterial</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">Math.log</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">/</span><span class="NAME">Math.LN2</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">Math.floor</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">==</span><span class="WHIT">
<span class='line'>209</span> </span><span class="NAME">a</span><span class="PUNC">}</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">Math.log</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">/</span><span class="NAME">Math.LN2</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">Math.pow</span><span class="PUNC">(</span><span class="NUMB">2</span><span class="PUNC">,</span><span class="NAME">Math.round</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">e</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">,</span><span class="NAME">j</span><span class="PUNC">,</span><span class="NAME">r</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">s</span><span class="PUNC">=</span><span class="REGX">/\.dds$/i</span><span class="PUNC">.</span><span class="NAME">test</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">v</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">+</span><span class="STRN">"/"</span><span class="PUNC">+</span><span class="NAME">f</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">s</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">z</span><span class="PUNC">=</span><span class="NAME">THREE.ImageUtils.loadCompressedTexture</span><span class="PUNC">(</span><span class="NAME">v</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NAME">e</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">z</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="NAME">z</span><span class="PUNC">=</span><span class="NAME">document.createElement</span><span class="PUNC">(</span><span class="STRN">"canvas"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NAME">e</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Texture</span><span class="PUNC">(</span><span class="NAME">z</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NAME">e</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">sourceFile</span><span class="PUNC">=</span><span class="NAME">f</span><span class="PUNC">;</span><span class="NAME">g</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NAME">e</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">repeat.set</span><span class="PUNC">(</span><span class="NAME">g</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">!==</span><span class="NAME">g</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NAME">e</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">wrapS</span><span class="PUNC">=</span><span class="NAME">THREE.RepeatWrapping</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">!==</span><span class="NAME">g</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NAME">e</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">wrapT</span><span class="PUNC">=</span><span class="NAME">THREE.RepeatWrapping</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">i</span><span class="PUNC">&&</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NAME">e</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">offset.set</span><span class="PUNC">(</span><span class="NAME">i</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">j</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="NAME">repeat</span><span class="PUNC">:</span><span class="NAME">THREE.RepeatWrapping</span><span class="PUNC">,</span><span class="NAME">mirror</span><span class="PUNC">:</span><span class="NAME">THREE.MirroredRepeatWrapping</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="WHIT">
<span class='line'>210</span> </span><span class="NAME">f</span><span class="PUNC">[</span><span class="NAME">j</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NAME">e</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">wrapS</span><span class="PUNC">=</span><span class="NAME">f</span><span class="PUNC">[</span><span class="NAME">j</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">f</span><span class="PUNC">[</span><span class="NAME">j</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NAME">e</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">wrapT</span><span class="PUNC">=</span><span class="NAME">f</span><span class="PUNC">[</span><span class="NAME">j</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">r</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NAME">e</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">anisotropy</span><span class="PUNC">=</span><span class="NAME">r</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">s</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">C</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NAME">e</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Image</span><span class="PUNC">;</span><span class="NAME">a.onload</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">c</span><span class="PUNC">(</span><span class="NAME">this.width</span><span class="PUNC">)</span><span class="PUNC">||</span><span class="PUNC">!</span><span class="NAME">c</span><span class="PUNC">(</span><span class="NAME">this.height</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">(</span><span class="NAME">this.width</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">(</span><span class="NAME">this.height</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">C.image.width</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">C.image.height</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">;</span><span class="NAME">C.image.getContext</span><span class="PUNC">(</span><span class="STRN">"2d"</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">drawImage</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="NAME">C.image</span><span class="PUNC">=</span><span class="KEYW">this</span><span class="PUNC">;</span><span class="NAME">C.needsUpdate</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">a.crossOrigin</span><span class="PUNC">=</span><span class="NAME">h.crossOrigin</span><span class="PUNC">;</span><span class="NAME">a.src</span><span class="PUNC">=</span><span class="NAME">v</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">f</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="PUNC">(</span><span class="NUMB">255</span><span class="PUNC">*</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">&lt;&lt;</span><span class="NUMB">16</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="PUNC">(</span><span class="NUMB">255</span><span class="PUNC">*</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">&lt;&lt;</span><span class="NUMB">8</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="NUMB">255</span><span class="PUNC">*</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">}</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">h</span><span class="PUNC">=</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">=</span><span class="STRN">"MeshLambertMaterial"</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="NAME">color</span><span class="PUNC">:</span><span class="NUMB">15658734</span><span class="PUNC">,</span><span class="NAME">opacity</span><span class="PUNC">:</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">map</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>211</span> </span><span class="NAME">lightMap</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">normalMap</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">bumpMap</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">wireframe</span><span class="PUNC">:</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">a.shading</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">j</span><span class="PUNC">=</span><span class="NAME">a.shading.toLowerCase</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="STRN">"phong"</span><span class="PUNC">===</span><span class="NAME">j</span><span class="PUNC">?</span><span class="NAME">g</span><span class="PUNC">=</span><span class="STRN">"MeshPhongMaterial"</span><span class="PUNC">:</span><span class="STRN">"basic"</span><span class="PUNC">===</span><span class="NAME">j</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">g</span><span class="PUNC">=</span><span class="STRN">"MeshBasicMaterial"</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">a.blending</span><span class="PUNC">&&</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">THREE</span><span class="PUNC">[</span><span class="NAME">a.blending</span><span class="PUNC">]</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">i.blending</span><span class="PUNC">=</span><span class="NAME">THREE</span><span class="PUNC">[</span><span class="NAME">a.blending</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">a.transparent</span><span class="PUNC">||</span><span class="NUMB">1</span><span class="PUNC">></span><span class="NAME">a.opacity</span><span class="PUNC">)</span><span class="NAME">i.transparent</span><span class="PUNC">=</span><span class="NAME">a.transparent</span><span class="PUNC">;</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">a.depthTest</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">i.depthTest</span><span class="PUNC">=</span><span class="NAME">a.depthTest</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">a.depthWrite</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">i.depthWrite</span><span class="PUNC">=</span><span class="NAME">a.depthWrite</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">a.visible</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">i.visible</span><span class="PUNC">=</span><span class="NAME">a.visible</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">a.flipSided</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">i.side</span><span class="PUNC">=</span><span class="NAME">THREE.BackSide</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>212</span> </span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">a.doubleSided</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">i.side</span><span class="PUNC">=</span><span class="NAME">THREE.DoubleSide</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">a.wireframe</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">i.wireframe</span><span class="PUNC">=</span><span class="NAME">a.wireframe</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">a.vertexColors</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="STRN">"face"</span><span class="PUNC">===</span><span class="NAME">a.vertexColors</span><span class="PUNC">?</span><span class="NAME">i.vertexColors</span><span class="PUNC">=</span><span class="NAME">THREE.FaceColors</span><span class="PUNC">:</span><span class="NAME">a.vertexColors</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">i.vertexColors</span><span class="PUNC">=</span><span class="NAME">THREE.VertexColors</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a.colorDiffuse</span><span class="PUNC">?</span><span class="NAME">i.color</span><span class="PUNC">=</span><span class="NAME">f</span><span class="PUNC">(</span><span class="NAME">a.colorDiffuse</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">a.DbgColor</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">i.color</span><span class="PUNC">=</span><span class="NAME">a.DbgColor</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a.colorSpecular</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">i.specular</span><span class="PUNC">=</span><span class="NAME">f</span><span class="PUNC">(</span><span class="NAME">a.colorSpecular</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a.colorAmbient</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">i.ambient</span><span class="PUNC">=</span><span class="NAME">f</span><span class="PUNC">(</span><span class="NAME">a.colorAmbient</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a.transparency</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">i.opacity</span><span class="PUNC">=</span><span class="NAME">a.transparency</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a.specularCoef</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">i.shininess</span><span class="PUNC">=</span><span class="NAME">a.specularCoef</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a.mapDiffuse</span><span class="PUNC">&&</span><span class="WHIT">
<span class='line'>213</span> </span><span class="NAME">b</span><span class="PUNC">&&</span><span class="NAME">e</span><span class="PUNC">(</span><span class="NAME">i</span><span class="PUNC">,</span><span class="STRN">"map"</span><span class="PUNC">,</span><span class="NAME">a.mapDiffuse</span><span class="PUNC">,</span><span class="NAME">a.mapDiffuseRepeat</span><span class="PUNC">,</span><span class="NAME">a.mapDiffuseOffset</span><span class="PUNC">,</span><span class="NAME">a.mapDiffuseWrap</span><span class="PUNC">,</span><span class="NAME">a.mapDiffuseAnisotropy</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a.mapLight</span><span class="PUNC">&&</span><span class="NAME">b</span><span class="PUNC">&&</span><span class="NAME">e</span><span class="PUNC">(</span><span class="NAME">i</span><span class="PUNC">,</span><span class="STRN">"lightMap"</span><span class="PUNC">,</span><span class="NAME">a.mapLight</span><span class="PUNC">,</span><span class="NAME">a.mapLightRepeat</span><span class="PUNC">,</span><span class="NAME">a.mapLightOffset</span><span class="PUNC">,</span><span class="NAME">a.mapLightWrap</span><span class="PUNC">,</span><span class="NAME">a.mapLightAnisotropy</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a.mapBump</span><span class="PUNC">&&</span><span class="NAME">b</span><span class="PUNC">&&</span><span class="NAME">e</span><span class="PUNC">(</span><span class="NAME">i</span><span class="PUNC">,</span><span class="STRN">"bumpMap"</span><span class="PUNC">,</span><span class="NAME">a.mapBump</span><span class="PUNC">,</span><span class="NAME">a.mapBumpRepeat</span><span class="PUNC">,</span><span class="NAME">a.mapBumpOffset</span><span class="PUNC">,</span><span class="NAME">a.mapBumpWrap</span><span class="PUNC">,</span><span class="NAME">a.mapBumpAnisotropy</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a.mapNormal</span><span class="PUNC">&&</span><span class="NAME">b</span><span class="PUNC">&&</span><span class="NAME">e</span><span class="PUNC">(</span><span class="NAME">i</span><span class="PUNC">,</span><span class="STRN">"normalMap"</span><span class="PUNC">,</span><span class="NAME">a.mapNormal</span><span class="PUNC">,</span><span class="NAME">a.mapNormalRepeat</span><span class="PUNC">,</span><span class="NAME">a.mapNormalOffset</span><span class="PUNC">,</span><span class="NAME">a.mapNormalWrap</span><span class="PUNC">,</span><span class="NAME">a.mapNormalAnisotropy</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a.mapSpecular</span><span class="PUNC">&&</span><span class="NAME">b</span><span class="PUNC">&&</span><span class="NAME">e</span><span class="PUNC">(</span><span class="NAME">i</span><span class="PUNC">,</span><span class="STRN">"specularMap"</span><span class="PUNC">,</span><span class="NAME">a.mapSpecular</span><span class="PUNC">,</span><span class="NAME">a.mapSpecularRepeat</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>214</span> </span><span class="NAME">a.mapSpecularOffset</span><span class="PUNC">,</span><span class="NAME">a.mapSpecularWrap</span><span class="PUNC">,</span><span class="NAME">a.mapSpecularAnisotropy</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a.mapBumpScale</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">i.bumpScale</span><span class="PUNC">=</span><span class="NAME">a.mapBumpScale</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a.mapNormal</span><span class="PUNC">?</span><span class="PUNC">(</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">THREE.ShaderLib.normalmap</span><span class="PUNC">,</span><span class="NAME">j</span><span class="PUNC">=</span><span class="NAME">THREE.UniformsUtils.clone</span><span class="PUNC">(</span><span class="NAME">g.uniforms</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">j.tNormal.value</span><span class="PUNC">=</span><span class="NAME">i.normalMap</span><span class="PUNC">,</span><span class="NAME">a.mapNormalFactor</span><span class="PUNC">&&</span><span class="NAME">j.uNormalScale.value.set</span><span class="PUNC">(</span><span class="NAME">a.mapNormalFactor</span><span class="PUNC">,</span><span class="NAME">a.mapNormalFactor</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">i.map</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">j.tDiffuse.value</span><span class="PUNC">=</span><span class="NAME">i.map</span><span class="PUNC">,</span><span class="NAME">j.enableDiffuse.value</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">i.specularMap</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">j.tSpecular.value</span><span class="PUNC">=</span><span class="NAME">i.specularMap</span><span class="PUNC">,</span><span class="NAME">j.enableSpecular.value</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">i.lightMap</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">j.tAO.value</span><span class="PUNC">=</span><span class="NAME">i.lightMap</span><span class="PUNC">,</span><span class="NAME">j.enableAO.value</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">j.uDiffuseColor.value.setHex</span><span class="PUNC">(</span><span class="NAME">i.color</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>215</span> </span><span class="NAME">j.uSpecularColor.value.setHex</span><span class="PUNC">(</span><span class="NAME">i.specular</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">j.uAmbientColor.value.setHex</span><span class="PUNC">(</span><span class="NAME">i.ambient</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">j.uShininess.value</span><span class="PUNC">=</span><span class="NAME">i.shininess</span><span class="PUNC">,</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">i.opacity</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">j.uOpacity.value</span><span class="PUNC">=</span><span class="NAME">i.opacity</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.ShaderMaterial</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">fragmentShader</span><span class="PUNC">:</span><span class="NAME">g.fragmentShader</span><span class="PUNC">,</span><span class="NAME">vertexShader</span><span class="PUNC">:</span><span class="NAME">g.vertexShader</span><span class="PUNC">,</span><span class="NAME">uniforms</span><span class="PUNC">:</span><span class="NAME">j</span><span class="PUNC">,</span><span class="NAME">lights</span><span class="PUNC">:</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">fog</span><span class="PUNC">:</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">i.transparent</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">g.transparent</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">g</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE</span><span class="PUNC">[</span><span class="NAME">g</span><span class="PUNC">]</span><span class="PUNC">(</span><span class="NAME">i</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">a.DbgName</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">g.name</span><span class="PUNC">=</span><span class="NAME">a.DbgName</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">g</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.XHRLoader</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.manager</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">a</span><span class="PUNC">?</span><span class="NAME">a</span><span class="PUNC">:</span><span class="NAME">THREE.DefaultLoadingManager</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>216</span> </span><span class="NAME">THREE.XHRLoader.prototype</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="NAME">constructor</span><span class="PUNC">:</span><span class="NAME">THREE.XHRLoader</span><span class="PUNC">,</span><span class="NAME">load</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">e</span><span class="PUNC">=</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">XMLHttpRequest</span><span class="PUNC">;</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">b</span><span class="PUNC">&&</span><span class="NAME">f.addEventListener</span><span class="PUNC">(</span><span class="STRN">"load"</span><span class="PUNC">,</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">e.manager.itemEnd</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">(</span><span class="NAME">c.target.responseText</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">c</span><span class="PUNC">&&</span><span class="NAME">f.addEventListener</span><span class="PUNC">(</span><span class="STRN">"progress"</span><span class="PUNC">,</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">c</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">d</span><span class="PUNC">&&</span><span class="NAME">f.addEventListener</span><span class="PUNC">(</span><span class="STRN">"error"</span><span class="PUNC">,</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">d</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">this.crossOrigin</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">f.crossOrigin</span><span class="PUNC">=</span><span class="NAME">this.crossOrigin</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">f.open</span><span class="PUNC">(</span><span class="STRN">"GET"</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">,</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">f.send</span><span class="PUNC">(</span><span class="KEYW">null</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">e.manager.itemStart</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">setCrossOrigin</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.crossOrigin</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.ImageLoader</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.manager</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">a</span><span class="PUNC">?</span><span class="NAME">a</span><span class="PUNC">:</span><span class="NAME">THREE.DefaultLoadingManager</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>217</span> </span><span class="NAME">THREE.ImageLoader.prototype</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="NAME">constructor</span><span class="PUNC">:</span><span class="NAME">THREE.ImageLoader</span><span class="PUNC">,</span><span class="NAME">load</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">e</span><span class="PUNC">=</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">document.createElement</span><span class="PUNC">(</span><span class="STRN">"img"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">b</span><span class="PUNC">&&</span><span class="NAME">f.addEventListener</span><span class="PUNC">(</span><span class="STRN">"load"</span><span class="PUNC">,</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">e.manager.itemEnd</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">c</span><span class="PUNC">&&</span><span class="NAME">f.addEventListener</span><span class="PUNC">(</span><span class="STRN">"progress"</span><span class="PUNC">,</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">c</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">d</span><span class="PUNC">&&</span><span class="NAME">f.addEventListener</span><span class="PUNC">(</span><span class="STRN">"error"</span><span class="PUNC">,</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">d</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">this.crossOrigin</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">f.crossOrigin</span><span class="PUNC">=</span><span class="NAME">this.crossOrigin</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">f.src</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">e.manager.itemStart</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">setCrossOrigin</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.crossOrigin</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.JSONLoader</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">THREE.Loader.call</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.withCredentials</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.JSONLoader.prototype</span><span class="PUNC">=</span><span class="NAME">Object.create</span><span class="PUNC">(</span><span class="NAME">THREE.Loader.prototype</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">THREE.JSONLoader.prototype.load</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">&&</span><span class="STRN">"string"</span><span class="PUNC">===</span><span class="KEYW">typeof</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">?</span><span class="NAME">c</span><span class="PUNC">:</span><span class="NAME">this.extractUrlBase</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.onLoadStart</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.loadAjaxJSON</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>218</span> </span><span class="NAME">THREE.JSONLoader.prototype.loadAjaxJSON</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">f</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">XMLHttpRequest</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">f.onreadystatechange</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">f.readyState</span><span class="PUNC">===</span><span class="NAME">f.DONE</span><span class="PUNC">)</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NUMB">200</span><span class="PUNC">===</span><span class="NAME">f.status</span><span class="PUNC">||</span><span class="NUMB">0</span><span class="PUNC">===</span><span class="NAME">f.status</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">f.responseText</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">JSON.parse</span><span class="PUNC">(</span><span class="NAME">f.responseText</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">a.parse</span><span class="PUNC">(</span><span class="NAME">g</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">(</span><span class="NAME">g.geometry</span><span class="PUNC">,</span><span class="NAME">g.materials</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="NAME">console.warn</span><span class="PUNC">(</span><span class="STRN">"THREE.JSONLoader: ["</span><span class="PUNC">+</span><span class="NAME">b</span><span class="PUNC">+</span><span class="STRN">"] seems to be unreachable or file there is empty"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a.onLoadComplete</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="NAME">console.error</span><span class="PUNC">(</span><span class="STRN">"THREE.JSONLoader: Couldn't load ["</span><span class="PUNC">+</span><span class="NAME">b</span><span class="PUNC">+</span><span class="STRN">"] ["</span><span class="PUNC">+</span><span class="NAME">f.status</span><span class="PUNC">+</span><span class="STRN">"]"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="NAME">f.readyState</span><span class="PUNC">===</span><span class="NAME">f.LOADING</span><span class="PUNC">?</span><span class="NAME">e</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">===</span><span class="NAME">h</span><span class="PUNC">&&</span><span class="WHIT">
<span class='line'>219</span> </span><span class="PUNC">(</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">f.getResponseHeader</span><span class="PUNC">(</span><span class="STRN">"Content-Length"</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">total</span><span class="PUNC">:</span><span class="NAME">h</span><span class="PUNC">,</span><span class="NAME">loaded</span><span class="PUNC">:</span><span class="NAME">f.responseText.length</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">f.readyState</span><span class="PUNC">===</span><span class="NAME">f.HEADERS_RECEIVED</span><span class="PUNC">&&</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">e</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">f.getResponseHeader</span><span class="PUNC">(</span><span class="STRN">"Content-Length"</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">f.open</span><span class="PUNC">(</span><span class="STRN">"GET"</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">f.withCredentials</span><span class="PUNC">=</span><span class="NAME">this.withCredentials</span><span class="PUNC">;</span><span class="NAME">f.send</span><span class="PUNC">(</span><span class="KEYW">null</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>220</span> </span><span class="NAME">THREE.JSONLoader.prototype.parse</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Geometry</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">a.scale</span><span class="PUNC">?</span><span class="NUMB">1</span><span class="PUNC">/</span><span class="NAME">a.scale</span><span class="PUNC">:</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">,</span><span class="NAME">j</span><span class="PUNC">,</span><span class="NAME">l</span><span class="PUNC">,</span><span class="NAME">m</span><span class="PUNC">,</span><span class="NAME">n</span><span class="PUNC">,</span><span class="NAME">p</span><span class="PUNC">,</span><span class="NAME">t</span><span class="PUNC">,</span><span class="NAME">q</span><span class="PUNC">,</span><span class="NAME">r</span><span class="PUNC">,</span><span class="NAME">s</span><span class="PUNC">,</span><span class="NAME">v</span><span class="PUNC">,</span><span class="NAME">z</span><span class="PUNC">=</span><span class="NAME">a.faces</span><span class="PUNC">;</span><span class="NAME">p</span><span class="PUNC">=</span><span class="NAME">a.vertices</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">C</span><span class="PUNC">=</span><span class="NAME">a.normals</span><span class="PUNC">,</span><span class="NAME">F</span><span class="PUNC">=</span><span class="NAME">a.colors</span><span class="PUNC">,</span><span class="NAME">H</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">a.uvs</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">&lt;</span><span class="NAME">a.uvs.length</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">a.uvs</span><span class="PUNC">[</span><span class="NAME">e</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">length</span><span class="PUNC">&&</span><span class="NAME">H</span><span class="PUNC">++</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">&lt;</span><span class="NAME">H</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">c.faceUvs</span><span class="PUNC">[</span><span class="NAME">e</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">c.faceVertexUvs</span><span class="PUNC">[</span><span class="NAME">e</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">}</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">i</span><span class="PUNC">=</span><span class="NAME">p.length</span><span class="PUNC">;</span><span class="NAME">g</span><span class="PUNC">&lt;</span><span class="NAME">i</span><span class="PUNC">;</span><span class="PUNC">)</span><span class="NAME">j</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">,</span><span class="NAME">j.x</span><span class="PUNC">=</span><span class="NAME">p</span><span class="PUNC">[</span><span class="NAME">g</span><span class="PUNC">++</span><span class="PUNC">]</span><span class="PUNC">*</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">j.y</span><span class="PUNC">=</span><span class="NAME">p</span><span class="PUNC">[</span><span class="NAME">g</span><span class="PUNC">++</span><span class="PUNC">]</span><span class="PUNC">*</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">j.z</span><span class="PUNC">=</span><span class="NAME">p</span><span class="PUNC">[</span><span class="NAME">g</span><span class="PUNC">++</span><span class="PUNC">]</span><span class="PUNC">*</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">c.vertices.push</span><span class="PUNC">(</span><span class="NAME">j</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">i</span><span class="PUNC">=</span><span class="NAME">z.length</span><span class="PUNC">;</span><span class="NAME">g</span><span class="PUNC">&lt;</span><span class="NAME">i</span><span class="PUNC">;</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">p</span><span class="PUNC">=</span><span class="NAME">z</span><span class="PUNC">[</span><span class="NAME">g</span><span class="PUNC">++</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">j</span><span class="PUNC">=</span><span class="NAME">p</span><span class="PUNC">&</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">p</span><span class="PUNC">&</span><span class="NUMB">2</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">p</span><span class="PUNC">&</span><span class="NUMB">4</span><span class="PUNC">;</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">p</span><span class="PUNC">&</span><span class="NUMB">8</span><span class="PUNC">;</span><span class="NAME">m</span><span class="PUNC">=</span><span class="NAME">p</span><span class="PUNC">&</span><span class="NUMB">16</span><span class="PUNC">;</span><span class="NAME">l</span><span class="PUNC">=</span><span class="NAME">p</span><span class="PUNC">&</span><span class="NUMB">32</span><span class="PUNC">;</span><span class="NAME">t</span><span class="PUNC">=</span><span class="NAME">p</span><span class="PUNC">&</span><span class="NUMB">64</span><span class="PUNC">;</span><span class="NAME">p</span><span class="PUNC">&</span><span class="PUNC">=</span><span class="NUMB">128</span><span class="PUNC">;</span><span class="NAME">j</span><span class="PUNC">?</span><span class="PUNC">(</span><span class="NAME">q</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>221</span> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Face4</span><span class="PUNC">,</span><span class="NAME">q.a</span><span class="PUNC">=</span><span class="NAME">z</span><span class="PUNC">[</span><span class="NAME">g</span><span class="PUNC">++</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">q.b</span><span class="PUNC">=</span><span class="NAME">z</span><span class="PUNC">[</span><span class="NAME">g</span><span class="PUNC">++</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">q.c</span><span class="PUNC">=</span><span class="NAME">z</span><span class="PUNC">[</span><span class="NAME">g</span><span class="PUNC">++</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">q.d</span><span class="PUNC">=</span><span class="NAME">z</span><span class="PUNC">[</span><span class="NAME">g</span><span class="PUNC">++</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">j</span><span class="PUNC">=</span><span class="NUMB">4</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="PUNC">(</span><span class="NAME">q</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Face3</span><span class="PUNC">,</span><span class="NAME">q.a</span><span class="PUNC">=</span><span class="NAME">z</span><span class="PUNC">[</span><span class="NAME">g</span><span class="PUNC">++</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">q.b</span><span class="PUNC">=</span><span class="NAME">z</span><span class="PUNC">[</span><span class="NAME">g</span><span class="PUNC">++</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">q.c</span><span class="PUNC">=</span><span class="NAME">z</span><span class="PUNC">[</span><span class="NAME">g</span><span class="PUNC">++</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">j</span><span class="PUNC">=</span><span class="NUMB">3</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">h</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">z</span><span class="PUNC">[</span><span class="NAME">g</span><span class="PUNC">++</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">q.materialIndex</span><span class="PUNC">=</span><span class="NAME">h</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">c.faces.length</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">)</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">&lt;</span><span class="NAME">H</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">r</span><span class="PUNC">=</span><span class="NAME">a.uvs</span><span class="PUNC">[</span><span class="NAME">e</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">n</span><span class="PUNC">=</span><span class="NAME">z</span><span class="PUNC">[</span><span class="NAME">g</span><span class="PUNC">++</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">v</span><span class="PUNC">=</span><span class="NAME">r</span><span class="PUNC">[</span><span class="NUMB">2</span><span class="PUNC">*</span><span class="NAME">n</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">n</span><span class="PUNC">=</span><span class="NAME">r</span><span class="PUNC">[</span><span class="NUMB">2</span><span class="PUNC">*</span><span class="NAME">n</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">c.faceUvs</span><span class="PUNC">[</span><span class="NAME">e</span><span class="PUNC">]</span><span class="PUNC">[</span><span class="NAME">h</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector2</span><span class="PUNC">(</span><span class="NAME">v</span><span class="PUNC">,</span><span class="NAME">n</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">)</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">&lt;</span><span class="NAME">H</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">r</span><span class="PUNC">=</span><span class="NAME">a.uvs</span><span class="PUNC">[</span><span class="NAME">e</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">s</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">f</span><span class="PUNC">&lt;</span><span class="NAME">j</span><span class="PUNC">;</span><span class="NAME">f</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">n</span><span class="PUNC">=</span><span class="NAME">z</span><span class="PUNC">[</span><span class="NAME">g</span><span class="PUNC">++</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">v</span><span class="PUNC">=</span><span class="NAME">r</span><span class="PUNC">[</span><span class="NUMB">2</span><span class="PUNC">*</span><span class="NAME">n</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">n</span><span class="PUNC">=</span><span class="NAME">r</span><span class="PUNC">[</span><span class="NUMB">2</span><span class="PUNC">*</span><span class="NAME">n</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">s</span><span class="PUNC">[</span><span class="NAME">f</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector2</span><span class="PUNC">(</span><span class="NAME">v</span><span class="PUNC">,</span><span class="NAME">n</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">c.faceVertexUvs</span><span class="PUNC">[</span><span class="NAME">e</span><span class="PUNC">]</span><span class="PUNC">[</span><span class="NAME">h</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">s</span><span class="PUNC">}</span><span class="NAME">m</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">m</span><span class="PUNC">=</span><span class="NUMB">3</span><span class="PUNC">*</span><span class="NAME">z</span><span class="PUNC">[</span><span class="NAME">g</span><span class="PUNC">++</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">,</span><span class="NAME">f.x</span><span class="PUNC">=</span><span class="NAME">C</span><span class="PUNC">[</span><span class="NAME">m</span><span class="PUNC">++</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">f.y</span><span class="PUNC">=</span><span class="NAME">C</span><span class="PUNC">[</span><span class="NAME">m</span><span class="PUNC">++</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">f.z</span><span class="PUNC">=</span><span class="NAME">C</span><span class="PUNC">[</span><span class="NAME">m</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">q.normal</span><span class="PUNC">=</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">l</span><span class="PUNC">)</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">&lt;</span><span class="NAME">j</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">m</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>222</span> </span><span class="NUMB">3</span><span class="PUNC">*</span><span class="NAME">z</span><span class="PUNC">[</span><span class="NAME">g</span><span class="PUNC">++</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">,</span><span class="NAME">f.x</span><span class="PUNC">=</span><span class="NAME">C</span><span class="PUNC">[</span><span class="NAME">m</span><span class="PUNC">++</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">f.y</span><span class="PUNC">=</span><span class="NAME">C</span><span class="PUNC">[</span><span class="NAME">m</span><span class="PUNC">++</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">f.z</span><span class="PUNC">=</span><span class="NAME">C</span><span class="PUNC">[</span><span class="NAME">m</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">q.vertexNormals.push</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">t</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">l</span><span class="PUNC">=</span><span class="NAME">z</span><span class="PUNC">[</span><span class="NAME">g</span><span class="PUNC">++</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">l</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Color</span><span class="PUNC">(</span><span class="NAME">F</span><span class="PUNC">[</span><span class="NAME">l</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">q.color</span><span class="PUNC">=</span><span class="NAME">l</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">p</span><span class="PUNC">)</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">&lt;</span><span class="NAME">j</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">l</span><span class="PUNC">=</span><span class="NAME">z</span><span class="PUNC">[</span><span class="NAME">g</span><span class="PUNC">++</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">l</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Color</span><span class="PUNC">(</span><span class="NAME">F</span><span class="PUNC">[</span><span class="NAME">l</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">q.vertexColors.push</span><span class="PUNC">(</span><span class="NAME">l</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">c.faces.push</span><span class="PUNC">(</span><span class="NAME">q</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">a.skinWeights</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">i</span><span class="PUNC">=</span><span class="NAME">a.skinWeights.length</span><span class="PUNC">;</span><span class="NAME">g</span><span class="PUNC">&lt;</span><span class="NAME">i</span><span class="PUNC">;</span><span class="NAME">g</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NUMB">2</span><span class="PUNC">)</span><span class="NAME">z</span><span class="PUNC">=</span><span class="NAME">a.skinWeights</span><span class="PUNC">[</span><span class="NAME">g</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">C</span><span class="PUNC">=</span><span class="NAME">a.skinWeights</span><span class="PUNC">[</span><span class="NAME">g</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">c.skinWeights.push</span><span class="PUNC">(</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector4</span><span class="PUNC">(</span><span class="NAME">z</span><span class="PUNC">,</span><span class="NAME">C</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">a.skinIndices</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">i</span><span class="PUNC">=</span><span class="NAME">a.skinIndices.length</span><span class="PUNC">;</span><span class="NAME">g</span><span class="PUNC">&lt;</span><span class="NAME">i</span><span class="PUNC">;</span><span class="NAME">g</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NUMB">2</span><span class="PUNC">)</span><span class="NAME">z</span><span class="PUNC">=</span><span class="NAME">a.skinIndices</span><span class="PUNC">[</span><span class="NAME">g</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">C</span><span class="PUNC">=</span><span class="NAME">a.skinIndices</span><span class="PUNC">[</span><span class="NAME">g</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">c.skinIndices.push</span><span class="PUNC">(</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector4</span><span class="PUNC">(</span><span class="NAME">z</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>223</span> </span><span class="NAME">C</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="NAME">c.bones</span><span class="PUNC">=</span><span class="NAME">a.bones</span><span class="PUNC">;</span><span class="NAME">c.animation</span><span class="PUNC">=</span><span class="NAME">a.animation</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">a.morphTargets</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">i</span><span class="PUNC">=</span><span class="NAME">a.morphTargets.length</span><span class="PUNC">;</span><span class="NAME">g</span><span class="PUNC">&lt;</span><span class="NAME">i</span><span class="PUNC">;</span><span class="NAME">g</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">c.morphTargets</span><span class="PUNC">[</span><span class="NAME">g</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">c.morphTargets</span><span class="PUNC">[</span><span class="NAME">g</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">name</span><span class="PUNC">=</span><span class="NAME">a.morphTargets</span><span class="PUNC">[</span><span class="NAME">g</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">name</span><span class="PUNC">;</span><span class="NAME">c.morphTargets</span><span class="PUNC">[</span><span class="NAME">g</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">vertices</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">F</span><span class="PUNC">=</span><span class="NAME">c.morphTargets</span><span class="PUNC">[</span><span class="NAME">g</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">vertices</span><span class="PUNC">;</span><span class="NAME">H</span><span class="PUNC">=</span><span class="NAME">a.morphTargets</span><span class="PUNC">[</span><span class="NAME">g</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">vertices</span><span class="PUNC">;</span><span class="NAME">z</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">C</span><span class="PUNC">=</span><span class="NAME">H.length</span><span class="PUNC">;</span><span class="NAME">z</span><span class="PUNC">&lt;</span><span class="NAME">C</span><span class="PUNC">;</span><span class="NAME">z</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NUMB">3</span><span class="PUNC">)</span><span class="NAME">p</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">,</span><span class="NAME">p.x</span><span class="PUNC">=</span><span class="NAME">H</span><span class="PUNC">[</span><span class="NAME">z</span><span class="PUNC">]</span><span class="PUNC">*</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">p.y</span><span class="PUNC">=</span><span class="NAME">H</span><span class="PUNC">[</span><span class="NAME">z</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">*</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">p.z</span><span class="PUNC">=</span><span class="NAME">H</span><span class="PUNC">[</span><span class="NAME">z</span><span class="PUNC">+</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">*</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">F.push</span><span class="PUNC">(</span><span class="NAME">p</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">a.morphColors</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">i</span><span class="PUNC">=</span><span class="NAME">a.morphColors.length</span><span class="PUNC">;</span><span class="NAME">g</span><span class="PUNC">&lt;</span><span class="NAME">i</span><span class="PUNC">;</span><span class="NAME">g</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">c.morphColors</span><span class="PUNC">[</span><span class="NAME">g</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">c.morphColors</span><span class="PUNC">[</span><span class="NAME">g</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">name</span><span class="PUNC">=</span><span class="NAME">a.morphColors</span><span class="PUNC">[</span><span class="NAME">g</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">name</span><span class="PUNC">;</span><span class="NAME">c.morphColors</span><span class="PUNC">[</span><span class="NAME">g</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">colors</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>224</span> </span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">C</span><span class="PUNC">=</span><span class="NAME">c.morphColors</span><span class="PUNC">[</span><span class="NAME">g</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">colors</span><span class="PUNC">;</span><span class="NAME">F</span><span class="PUNC">=</span><span class="NAME">a.morphColors</span><span class="PUNC">[</span><span class="NAME">g</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">colors</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">z</span><span class="PUNC">=</span><span class="NAME">F.length</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">&lt;</span><span class="NAME">z</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NUMB">3</span><span class="PUNC">)</span><span class="NAME">H</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Color</span><span class="PUNC">(</span><span class="NUMB">16755200</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">H.setRGB</span><span class="PUNC">(</span><span class="NAME">F</span><span class="PUNC">[</span><span class="NAME">d</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">F</span><span class="PUNC">[</span><span class="NAME">d</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">F</span><span class="PUNC">[</span><span class="NAME">d</span><span class="PUNC">+</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">C.push</span><span class="PUNC">(</span><span class="NAME">H</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="NAME">c.computeCentroids</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">c.computeFaceNormals</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">c.computeBoundingSphere</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">===</span><span class="NAME">a.materials</span><span class="PUNC">)</span><span class="KEYW">return</span><span class="PUNC">{</span><span class="NAME">geometry</span><span class="PUNC">:</span><span class="NAME">c</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">this.initMaterials</span><span class="PUNC">(</span><span class="NAME">a.materials</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.needsTangents</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="NAME">c.computeTangents</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="PUNC">{</span><span class="NAME">geometry</span><span class="PUNC">:</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">materials</span><span class="PUNC">:</span><span class="NAME">d</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.LoadingManager</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">=</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">this.onLoad</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">this.onProgress</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">;</span><span class="NAME">this.onError</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">;</span><span class="NAME">this.itemStart</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">f</span><span class="PUNC">++</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">this.itemEnd</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">e</span><span class="PUNC">++</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">d.onProgress</span><span class="PUNC">)</span><span class="NAME">d.onProgress</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">===</span><span class="NAME">f</span><span class="PUNC">&&</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">d.onLoad</span><span class="PUNC">)</span><span class="NAME">d.onLoad</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.DefaultLoadingManager</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.LoadingManager</span><span class="PUNC">;</span><span class="NAME">THREE.GeometryLoader</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.manager</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">a</span><span class="PUNC">?</span><span class="NAME">a</span><span class="PUNC">:</span><span class="NAME">THREE.DefaultLoadingManager</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.GeometryLoader.prototype</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="NAME">constructor</span><span class="PUNC">:</span><span class="NAME">THREE.GeometryLoader</span><span class="PUNC">,</span><span class="NAME">load</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.XHRLoader</span><span class="PUNC">;</span><span class="NAME">d.setCrossOrigin</span><span class="PUNC">(</span><span class="NAME">this.crossOrigin</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">d.load</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">b</span><span class="PUNC">(</span><span class="NAME">c.parse</span><span class="PUNC">(</span><span class="NAME">JSON.parse</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">setCrossOrigin</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.crossOrigin</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">parse</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.MaterialLoader</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.manager</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">a</span><span class="PUNC">?</span><span class="NAME">a</span><span class="PUNC">:</span><span class="NAME">THREE.DefaultLoadingManager</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>225</span> </span><span class="NAME">THREE.MaterialLoader.prototype</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="NAME">constructor</span><span class="PUNC">:</span><span class="NAME">THREE.MaterialLoader</span><span class="PUNC">,</span><span class="NAME">load</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.XHRLoader</span><span class="PUNC">;</span><span class="NAME">d.setCrossOrigin</span><span class="PUNC">(</span><span class="NAME">this.crossOrigin</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">d.load</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">b</span><span class="PUNC">(</span><span class="NAME">c.parse</span><span class="PUNC">(</span><span class="NAME">JSON.parse</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">setCrossOrigin</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.crossOrigin</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">parse</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">;</span><span class="KEYW">switch</span><span class="PUNC">(</span><span class="NAME">a.type</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"MeshBasicMaterial"</span><span class="PUNC">:</span><span class="NAME">b</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.MeshBasicMaterial</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">color</span><span class="PUNC">:</span><span class="NAME">a.color</span><span class="PUNC">,</span><span class="NAME">opacity</span><span class="PUNC">:</span><span class="NAME">a.opacity</span><span class="PUNC">,</span><span class="NAME">transparent</span><span class="PUNC">:</span><span class="NAME">a.transparent</span><span class="PUNC">,</span><span class="NAME">wireframe</span><span class="PUNC">:</span><span class="NAME">a.wireframe</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">break</span><span class="PUNC">;</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"MeshLambertMaterial"</span><span class="PUNC">:</span><span class="NAME">b</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.MeshLambertMaterial</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">color</span><span class="PUNC">:</span><span class="NAME">a.color</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>226</span> </span><span class="NAME">ambient</span><span class="PUNC">:</span><span class="NAME">a.ambient</span><span class="PUNC">,</span><span class="NAME">emissive</span><span class="PUNC">:</span><span class="NAME">a.emissive</span><span class="PUNC">,</span><span class="NAME">opacity</span><span class="PUNC">:</span><span class="NAME">a.opacity</span><span class="PUNC">,</span><span class="NAME">transparent</span><span class="PUNC">:</span><span class="NAME">a.transparent</span><span class="PUNC">,</span><span class="NAME">wireframe</span><span class="PUNC">:</span><span class="NAME">a.wireframe</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">break</span><span class="PUNC">;</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"MeshPhongMaterial"</span><span class="PUNC">:</span><span class="NAME">b</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.MeshPhongMaterial</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">color</span><span class="PUNC">:</span><span class="NAME">a.color</span><span class="PUNC">,</span><span class="NAME">ambient</span><span class="PUNC">:</span><span class="NAME">a.ambient</span><span class="PUNC">,</span><span class="NAME">emissive</span><span class="PUNC">:</span><span class="NAME">a.emissive</span><span class="PUNC">,</span><span class="NAME">specular</span><span class="PUNC">:</span><span class="NAME">a.specular</span><span class="PUNC">,</span><span class="NAME">shininess</span><span class="PUNC">:</span><span class="NAME">a.shininess</span><span class="PUNC">,</span><span class="NAME">opacity</span><span class="PUNC">:</span><span class="NAME">a.opacity</span><span class="PUNC">,</span><span class="NAME">transparent</span><span class="PUNC">:</span><span class="NAME">a.transparent</span><span class="PUNC">,</span><span class="NAME">wireframe</span><span class="PUNC">:</span><span class="NAME">a.wireframe</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">break</span><span class="PUNC">;</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"MeshNormalMaterial"</span><span class="PUNC">:</span><span class="NAME">b</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.MeshNormalMaterial</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">opacity</span><span class="PUNC">:</span><span class="NAME">a.opacity</span><span class="PUNC">,</span><span class="NAME">transparent</span><span class="PUNC">:</span><span class="NAME">a.transparent</span><span class="PUNC">,</span><span class="NAME">wireframe</span><span class="PUNC">:</span><span class="NAME">a.wireframe</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">break</span><span class="PUNC">;</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"MeshDepthMaterial"</span><span class="PUNC">:</span><span class="NAME">b</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.MeshDepthMaterial</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">opacity</span><span class="PUNC">:</span><span class="NAME">a.opacity</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>227</span> </span><span class="NAME">transparent</span><span class="PUNC">:</span><span class="NAME">a.transparent</span><span class="PUNC">,</span><span class="NAME">wireframe</span><span class="PUNC">:</span><span class="NAME">a.wireframe</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">a.vertexColors</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">b.vertexColors</span><span class="PUNC">=</span><span class="NAME">a.vertexColors</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.ObjectLoader</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.manager</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">a</span><span class="PUNC">?</span><span class="NAME">a</span><span class="PUNC">:</span><span class="NAME">THREE.DefaultLoadingManager</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>228</span> </span><span class="NAME">THREE.ObjectLoader.prototype</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="NAME">constructor</span><span class="PUNC">:</span><span class="NAME">THREE.ObjectLoader</span><span class="PUNC">,</span><span class="NAME">load</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.XHRLoader</span><span class="PUNC">(</span><span class="NAME">c.manager</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">d.setCrossOrigin</span><span class="PUNC">(</span><span class="NAME">this.crossOrigin</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">d.load</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">b</span><span class="PUNC">(</span><span class="NAME">c.parse</span><span class="PUNC">(</span><span class="NAME">JSON.parse</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">setCrossOrigin</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.crossOrigin</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">parse</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.parseGeometries</span><span class="PUNC">(</span><span class="NAME">a.geometries</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.parseMaterials</span><span class="PUNC">(</span><span class="NAME">a.materials</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.parseObject</span><span class="PUNC">(</span><span class="NAME">a.object</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">parseGeometries</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">a</span><span class="PUNC">)</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.JSONLoader</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">a.length</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">&lt;</span><span class="NAME">e</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">f</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>229</span> </span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NAME">d</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="KEYW">switch</span><span class="PUNC">(</span><span class="NAME">h.type</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"PlaneGeometry"</span><span class="PUNC">:</span><span class="NAME">f</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.PlaneGeometry</span><span class="PUNC">(</span><span class="NAME">h.width</span><span class="PUNC">,</span><span class="NAME">h.height</span><span class="PUNC">,</span><span class="NAME">h.widthSegments</span><span class="PUNC">,</span><span class="NAME">h.heightSegments</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">break</span><span class="PUNC">;</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"CubeGeometry"</span><span class="PUNC">:</span><span class="NAME">f</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.CubeGeometry</span><span class="PUNC">(</span><span class="NAME">h.width</span><span class="PUNC">,</span><span class="NAME">h.height</span><span class="PUNC">,</span><span class="NAME">h.depth</span><span class="PUNC">,</span><span class="NAME">h.widthSegments</span><span class="PUNC">,</span><span class="NAME">h.heightSegments</span><span class="PUNC">,</span><span class="NAME">h.depthSegments</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">break</span><span class="PUNC">;</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"CylinderGeometry"</span><span class="PUNC">:</span><span class="NAME">f</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.CylinderGeometry</span><span class="PUNC">(</span><span class="NAME">h.radiusTop</span><span class="PUNC">,</span><span class="NAME">h.radiusBottom</span><span class="PUNC">,</span><span class="NAME">h.height</span><span class="PUNC">,</span><span class="NAME">h.radiusSegments</span><span class="PUNC">,</span><span class="NAME">h.heightSegments</span><span class="PUNC">,</span><span class="NAME">h.openEnded</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">break</span><span class="PUNC">;</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"SphereGeometry"</span><span class="PUNC">:</span><span class="NAME">f</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.SphereGeometry</span><span class="PUNC">(</span><span class="NAME">h.radius</span><span class="PUNC">,</span><span class="NAME">h.widthSegments</span><span class="PUNC">,</span><span class="NAME">h.heightSegments</span><span class="PUNC">,</span><span class="NAME">h.phiStart</span><span class="PUNC">,</span><span class="NAME">h.phiLength</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>230</span> </span><span class="NAME">h.thetaStart</span><span class="PUNC">,</span><span class="NAME">h.thetaLength</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">break</span><span class="PUNC">;</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"IcosahedronGeometry"</span><span class="PUNC">:</span><span class="NAME">f</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.IcosahedronGeometry</span><span class="PUNC">(</span><span class="NAME">h.radius</span><span class="PUNC">,</span><span class="NAME">h.detail</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">break</span><span class="PUNC">;</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"TorusGeometry"</span><span class="PUNC">:</span><span class="NAME">f</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.TorusGeometry</span><span class="PUNC">(</span><span class="NAME">h.radius</span><span class="PUNC">,</span><span class="NAME">h.tube</span><span class="PUNC">,</span><span class="NAME">h.radialSegments</span><span class="PUNC">,</span><span class="NAME">h.tubularSegments</span><span class="PUNC">,</span><span class="NAME">h.arc</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">break</span><span class="PUNC">;</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"TorusKnotGeometry"</span><span class="PUNC">:</span><span class="NAME">f</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.TorusKnotGeometry</span><span class="PUNC">(</span><span class="NAME">h.radius</span><span class="PUNC">,</span><span class="NAME">h.tube</span><span class="PUNC">,</span><span class="NAME">h.radialSegments</span><span class="PUNC">,</span><span class="NAME">h.tubularSegments</span><span class="PUNC">,</span><span class="NAME">h.p</span><span class="PUNC">,</span><span class="NAME">h.q</span><span class="PUNC">,</span><span class="NAME">h.heightScale</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">break</span><span class="PUNC">;</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"Geometry"</span><span class="PUNC">:</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">c.parse</span><span class="PUNC">(</span><span class="NAME">h.data</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">geometry</span><span class="PUNC">}</span><span class="NAME">f.uuid</span><span class="PUNC">=</span><span class="NAME">h.uuid</span><span class="PUNC">;</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">h.name</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">f.name</span><span class="PUNC">=</span><span class="NAME">h.name</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NAME">h.uuid</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">f</span><span class="PUNC">}</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">parseMaterials</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>231</span> </span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">a</span><span class="PUNC">)</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.MaterialLoader</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">a.length</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">&lt;</span><span class="NAME">e</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NAME">d</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">c.parse</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">h.uuid</span><span class="PUNC">=</span><span class="NAME">f.uuid</span><span class="PUNC">;</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">f.name</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">h.name</span><span class="PUNC">=</span><span class="NAME">f.name</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NAME">f.uuid</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">h</span><span class="PUNC">}</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">parseObject</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Matrix4</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">e</span><span class="PUNC">;</span><span class="KEYW">switch</span><span class="PUNC">(</span><span class="NAME">b.type</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"Scene"</span><span class="PUNC">:</span><span class="NAME">e</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Scene</span><span class="PUNC">;</span><span class="KEYW">break</span><span class="PUNC">;</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"PerspectiveCamera"</span><span class="PUNC">:</span><span class="NAME">e</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.PerspectiveCamera</span><span class="PUNC">(</span><span class="NAME">b.fov</span><span class="PUNC">,</span><span class="NAME">b.aspect</span><span class="PUNC">,</span><span class="NAME">b.near</span><span class="PUNC">,</span><span class="NAME">b.far</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">break</span><span class="PUNC">;</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"OrthographicCamera"</span><span class="PUNC">:</span><span class="NAME">e</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.OrthographicCamera</span><span class="PUNC">(</span><span class="NAME">b.left</span><span class="PUNC">,</span><span class="NAME">b.right</span><span class="PUNC">,</span><span class="NAME">b.top</span><span class="PUNC">,</span><span class="NAME">b.bottom</span><span class="PUNC">,</span><span class="NAME">b.near</span><span class="PUNC">,</span><span class="NAME">b.far</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">break</span><span class="PUNC">;</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"AmbientLight"</span><span class="PUNC">:</span><span class="NAME">e</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>232</span> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.AmbientLight</span><span class="PUNC">(</span><span class="NAME">b.color</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">break</span><span class="PUNC">;</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"DirectionalLight"</span><span class="PUNC">:</span><span class="NAME">e</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.DirectionalLight</span><span class="PUNC">(</span><span class="NAME">b.color</span><span class="PUNC">,</span><span class="NAME">b.intensity</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">break</span><span class="PUNC">;</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"PointLight"</span><span class="PUNC">:</span><span class="NAME">e</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.PointLight</span><span class="PUNC">(</span><span class="NAME">b.color</span><span class="PUNC">,</span><span class="NAME">b.intensity</span><span class="PUNC">,</span><span class="NAME">b.distance</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">break</span><span class="PUNC">;</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"SpotLight"</span><span class="PUNC">:</span><span class="NAME">e</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.SpotLight</span><span class="PUNC">(</span><span class="NAME">b.color</span><span class="PUNC">,</span><span class="NAME">b.intensity</span><span class="PUNC">,</span><span class="NAME">b.distance</span><span class="PUNC">,</span><span class="NAME">b.angle</span><span class="PUNC">,</span><span class="NAME">b.exponent</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">break</span><span class="PUNC">;</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"HemisphereLight"</span><span class="PUNC">:</span><span class="NAME">e</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.HemisphereLight</span><span class="PUNC">(</span><span class="NAME">b.color</span><span class="PUNC">,</span><span class="NAME">b.groundColor</span><span class="PUNC">,</span><span class="NAME">b.intensity</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">break</span><span class="PUNC">;</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"Mesh"</span><span class="PUNC">:</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NAME">b.geometry</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">[</span><span class="NAME">b.material</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">===</span><span class="NAME">e</span><span class="PUNC">&&</span><span class="NAME">console.error</span><span class="PUNC">(</span><span class="STRN">"THREE.ObjectLoader: Undefined geometry "</span><span class="PUNC">+</span><span class="WHIT">
<span class='line'>233</span> </span><span class="NAME">b.geometry</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">===</span><span class="NAME">f</span><span class="PUNC">&&</span><span class="NAME">console.error</span><span class="PUNC">(</span><span class="STRN">"THREE.ObjectLoader: Undefined material "</span><span class="PUNC">+</span><span class="NAME">b.material</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Mesh</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">break</span><span class="PUNC">;</span><span class="KEYW">default</span><span class="PUNC">:</span><span class="NAME">e</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Object3D</span><span class="PUNC">}</span><span class="NAME">e.uuid</span><span class="PUNC">=</span><span class="NAME">b.uuid</span><span class="PUNC">;</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">b.name</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">e.name</span><span class="PUNC">=</span><span class="NAME">b.name</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">b.matrix</span><span class="PUNC">?</span><span class="PUNC">(</span><span class="NAME">a.fromArray</span><span class="PUNC">(</span><span class="NAME">b.matrix</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">a.decompose</span><span class="PUNC">(</span><span class="NAME">e.position</span><span class="PUNC">,</span><span class="NAME">e.quaternion</span><span class="PUNC">,</span><span class="NAME">e.scale</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="PUNC">(</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">b.position</span><span class="PUNC">&&</span><span class="NAME">e.position.fromArray</span><span class="PUNC">(</span><span class="NAME">b.position</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">b.rotation</span><span class="PUNC">&&</span><span class="NAME">e.rotation.fromArray</span><span class="PUNC">(</span><span class="NAME">b.rotation</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">b.scale</span><span class="PUNC">&&</span><span class="NAME">e.scale.fromArray</span><span class="PUNC">(</span><span class="NAME">b.scale</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">b.visible</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">e.visible</span><span class="PUNC">=</span><span class="NAME">b.visible</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">b.userData</span><span class="PUNC">&&</span><span class="WHIT">
<span class='line'>234</span> </span><span class="PUNC">(</span><span class="NAME">e.userData</span><span class="PUNC">=</span><span class="NAME">b.userData</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">b.children</span><span class="PUNC">)</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">h</span><span class="WHIT"> </span><span class="KEYW">in</span><span class="WHIT"> </span><span class="NAME">b.children</span><span class="PUNC">)</span><span class="NAME">e.add</span><span class="PUNC">(</span><span class="NAME">this.parseObject</span><span class="PUNC">(</span><span class="NAME">b.children</span><span class="PUNC">[</span><span class="NAME">h</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">e</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.SceneLoader</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.onLoadStart</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">this.onLoadProgress</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">this.onLoadComplete</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">this.callbackSync</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">this.callbackProgress</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">this.geometryHandlers</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">this.hierarchyHandlers</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">this.addGeometryHandler</span><span class="PUNC">(</span><span class="STRN">"ascii"</span><span class="PUNC">,</span><span class="NAME">THREE.JSONLoader</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>235</span> </span><span class="NAME">THREE.SceneLoader.prototype</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="NAME">constructor</span><span class="PUNC">:</span><span class="NAME">THREE.SceneLoader</span><span class="PUNC">,</span><span class="NAME">load</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.XHRLoader</span><span class="PUNC">(</span><span class="NAME">c.manager</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">d.setCrossOrigin</span><span class="PUNC">(</span><span class="NAME">this.crossOrigin</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">d.load</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">c.parse</span><span class="PUNC">(</span><span class="NAME">JSON.parse</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">setCrossOrigin</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.crossOrigin</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">addGeometryHandler</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.geometryHandlers</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="NAME">loaderClass</span><span class="PUNC">:</span><span class="NAME">b</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">addHierarchyHandler</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.hierarchyHandlers</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="NAME">loaderClass</span><span class="PUNC">:</span><span class="NAME">b</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">parse</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="STRN">"relativeToHTML"</span><span class="PUNC">==</span><span class="NAME">b</span><span class="PUNC">?</span><span class="NAME">a</span><span class="PUNC">:</span><span class="NAME">n</span><span class="PUNC">+</span><span class="STRN">"/"</span><span class="PUNC">+</span><span class="NAME">a</span><span class="PUNC">}</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">e</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">f</span><span class="PUNC">(</span><span class="NAME">A.scene</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>236</span> </span><span class="NAME">B.objects</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">f</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">,</span><span class="NAME">j</span><span class="PUNC">,</span><span class="NAME">l</span><span class="PUNC">,</span><span class="NAME">n</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">n</span><span class="WHIT"> </span><span class="KEYW">in</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">r</span><span class="PUNC">=</span><span class="NAME">A.objects</span><span class="PUNC">[</span><span class="NAME">n</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">s</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NAME">n</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">===</span><span class="NAME">r</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">s.type</span><span class="PUNC">&&</span><span class="NAME">s.type</span><span class="WHIT"> </span><span class="KEYW">in</span><span class="WHIT"> </span><span class="NAME">m.hierarchyHandlers</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">===</span><span class="NAME">s.loading</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">e</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="NAME">type</span><span class="PUNC">:</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">url</span><span class="PUNC">:</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">material</span><span class="PUNC">:</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">position</span><span class="PUNC">:</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">rotation</span><span class="PUNC">:</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">scale</span><span class="PUNC">:</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">visible</span><span class="PUNC">:</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">children</span><span class="PUNC">:</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">userData</span><span class="PUNC">:</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">skin</span><span class="PUNC">:</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">morph</span><span class="PUNC">:</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">mirroredLoop</span><span class="PUNC">:</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">duration</span><span class="PUNC">:</span><span class="NUMB">1</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">h</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">y</span><span class="WHIT"> </span><span class="KEYW">in</span><span class="WHIT"> </span><span class="NAME">s</span><span class="PUNC">)</span><span class="NAME">y</span><span class="WHIT"> </span><span class="KEYW">in</span><span class="WHIT"> </span><span class="NAME">e</span><span class="PUNC">||</span><span class="PUNC">(</span><span class="NAME">h</span><span class="PUNC">[</span><span class="NAME">y</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">s</span><span class="PUNC">[</span><span class="NAME">y</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">t</span><span class="PUNC">=</span><span class="NAME">A.materials</span><span class="PUNC">[</span><span class="NAME">s.material</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">s.loading</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">m.hierarchyHandlers</span><span class="PUNC">[</span><span class="NAME">s.type</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">loaderObject</span><span class="PUNC">;</span><span class="NAME">e.options</span><span class="PUNC">?</span><span class="NAME">e.load</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">(</span><span class="NAME">s.url</span><span class="PUNC">,</span><span class="NAME">B.urlBaseType</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">(</span><span class="NAME">n</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">t</span><span class="PUNC">,</span><span class="NAME">s</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">e.load</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">(</span><span class="NAME">s.url</span><span class="PUNC">,</span><span class="NAME">B.urlBaseType</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">(</span><span class="NAME">n</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>237</span> </span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">t</span><span class="PUNC">,</span><span class="NAME">s</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">s.geometry</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">p</span><span class="PUNC">=</span><span class="NAME">A.geometries</span><span class="PUNC">[</span><span class="NAME">s.geometry</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">r</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">t</span><span class="PUNC">=</span><span class="NAME">A.materials</span><span class="PUNC">[</span><span class="NAME">s.material</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">r</span><span class="PUNC">=</span><span class="NAME">t</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">THREE.ShaderMaterial</span><span class="PUNC">;</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">s.position</span><span class="PUNC">;</span><span class="NAME">i</span><span class="PUNC">=</span><span class="NAME">s.rotation</span><span class="PUNC">;</span><span class="NAME">j</span><span class="PUNC">=</span><span class="NAME">s.scale</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">s.matrix</span><span class="PUNC">;</span><span class="NAME">l</span><span class="PUNC">=</span><span class="NAME">s.quaternion</span><span class="PUNC">;</span><span class="NAME">s.material</span><span class="PUNC">||</span><span class="PUNC">(</span><span class="NAME">t</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.MeshFaceMaterial</span><span class="PUNC">(</span><span class="NAME">A.face_materials</span><span class="PUNC">[</span><span class="NAME">s.geometry</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">t</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">THREE.MeshFaceMaterial</span><span class="PUNC">&&</span><span class="NUMB">0</span><span class="PUNC">===</span><span class="NAME">t.materials.length</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">t</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.MeshFaceMaterial</span><span class="PUNC">(</span><span class="NAME">A.face_materials</span><span class="PUNC">[</span><span class="NAME">s.geometry</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">t</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">THREE.MeshFaceMaterial</span><span class="PUNC">)</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">&lt;</span><span class="NAME">t.materials.length</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">r</span><span class="PUNC">=</span><span class="NAME">r</span><span class="PUNC">||</span><span class="NAME">t.materials</span><span class="PUNC">[</span><span class="NAME">e</span><span class="PUNC">]</span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">THREE.ShaderMaterial</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>238</span> </span><span class="NAME">r</span><span class="PUNC">&&</span><span class="NAME">p.computeTangents</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">s.skin</span><span class="PUNC">?</span><span class="NAME">r</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.SkinnedMesh</span><span class="PUNC">(</span><span class="NAME">p</span><span class="PUNC">,</span><span class="NAME">t</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">s.morph</span><span class="PUNC">?</span><span class="PUNC">(</span><span class="NAME">r</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.MorphAnimMesh</span><span class="PUNC">(</span><span class="NAME">p</span><span class="PUNC">,</span><span class="NAME">t</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">s.duration</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">r.duration</span><span class="PUNC">=</span><span class="NAME">s.duration</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">s.time</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">r.time</span><span class="PUNC">=</span><span class="NAME">s.time</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">s.mirroredLoop</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">r.mirroredLoop</span><span class="PUNC">=</span><span class="NAME">s.mirroredLoop</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">t.morphNormals</span><span class="PUNC">&&</span><span class="NAME">p.computeMorphNormals</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">r</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Mesh</span><span class="PUNC">(</span><span class="NAME">p</span><span class="PUNC">,</span><span class="NAME">t</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">r.name</span><span class="PUNC">=</span><span class="NAME">n</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">?</span><span class="PUNC">(</span><span class="NAME">r.matrixAutoUpdate</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">r.matrix.set</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NUMB">3</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NUMB">4</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NUMB">5</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NUMB">6</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NUMB">7</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NUMB">8</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NUMB">9</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NUMB">10</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NUMB">11</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NUMB">12</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NUMB">13</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NUMB">14</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NUMB">15</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="PUNC">(</span><span class="NAME">r.position.fromArray</span><span class="PUNC">(</span><span class="NAME">h</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">l</span><span class="PUNC">?</span><span class="NAME">r.quaternion.fromArray</span><span class="PUNC">(</span><span class="NAME">l</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">r.rotation.fromArray</span><span class="PUNC">(</span><span class="NAME">i</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>239</span> </span><span class="NAME">r.scale.fromArray</span><span class="PUNC">(</span><span class="NAME">j</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">r.visible</span><span class="PUNC">=</span><span class="NAME">s.visible</span><span class="PUNC">;</span><span class="NAME">r.castShadow</span><span class="PUNC">=</span><span class="NAME">s.castShadow</span><span class="PUNC">;</span><span class="NAME">r.receiveShadow</span><span class="PUNC">=</span><span class="NAME">s.receiveShadow</span><span class="PUNC">;</span><span class="NAME">a.add</span><span class="PUNC">(</span><span class="NAME">r</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">A.objects</span><span class="PUNC">[</span><span class="NAME">n</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">r</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="STRN">"DirectionalLight"</span><span class="PUNC">===</span><span class="NAME">s.type</span><span class="PUNC">||</span><span class="STRN">"PointLight"</span><span class="PUNC">===</span><span class="NAME">s.type</span><span class="PUNC">||</span><span class="STRN">"AmbientLight"</span><span class="PUNC">===</span><span class="NAME">s.type</span><span class="PUNC">?</span><span class="PUNC">(</span><span class="NAME">z</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">s.color</span><span class="PUNC">?</span><span class="NAME">s.color</span><span class="PUNC">:</span><span class="NUMB">16777215</span><span class="PUNC">,</span><span class="NAME">C</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">s.intensity</span><span class="PUNC">?</span><span class="NAME">s.intensity</span><span class="PUNC">:</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="STRN">"DirectionalLight"</span><span class="PUNC">===</span><span class="NAME">s.type</span><span class="PUNC">?</span><span class="PUNC">(</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">s.direction</span><span class="PUNC">,</span><span class="NAME">v</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.DirectionalLight</span><span class="PUNC">(</span><span class="NAME">z</span><span class="PUNC">,</span><span class="NAME">C</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">v.position.fromArray</span><span class="PUNC">(</span><span class="NAME">h</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">s.target</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">K.push</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">object</span><span class="PUNC">:</span><span class="NAME">v</span><span class="PUNC">,</span><span class="NAME">targetName</span><span class="PUNC">:</span><span class="NAME">s.target</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">v.target</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="STRN">"PointLight"</span><span class="PUNC">===</span><span class="NAME">s.type</span><span class="PUNC">?</span><span class="PUNC">(</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">s.position</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">s.distance</span><span class="PUNC">,</span><span class="NAME">v</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.PointLight</span><span class="PUNC">(</span><span class="NAME">z</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>240</span> </span><span class="NAME">C</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">v.position.fromArray</span><span class="PUNC">(</span><span class="NAME">h</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="STRN">"AmbientLight"</span><span class="PUNC">===</span><span class="NAME">s.type</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">v</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.AmbientLight</span><span class="PUNC">(</span><span class="NAME">z</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">a.add</span><span class="PUNC">(</span><span class="NAME">v</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">v.name</span><span class="PUNC">=</span><span class="NAME">n</span><span class="PUNC">,</span><span class="NAME">A.lights</span><span class="PUNC">[</span><span class="NAME">n</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">v</span><span class="PUNC">,</span><span class="NAME">A.objects</span><span class="PUNC">[</span><span class="NAME">n</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">v</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="STRN">"PerspectiveCamera"</span><span class="PUNC">===</span><span class="NAME">s.type</span><span class="PUNC">||</span><span class="STRN">"OrthographicCamera"</span><span class="PUNC">===</span><span class="NAME">s.type</span><span class="PUNC">?</span><span class="PUNC">(</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">s.position</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">=</span><span class="NAME">s.rotation</span><span class="PUNC">,</span><span class="NAME">l</span><span class="PUNC">=</span><span class="NAME">s.quaternion</span><span class="PUNC">,</span><span class="STRN">"PerspectiveCamera"</span><span class="PUNC">===</span><span class="NAME">s.type</span><span class="PUNC">?</span><span class="NAME">q</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.PerspectiveCamera</span><span class="PUNC">(</span><span class="NAME">s.fov</span><span class="PUNC">,</span><span class="NAME">s.aspect</span><span class="PUNC">,</span><span class="NAME">s.near</span><span class="PUNC">,</span><span class="NAME">s.far</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="STRN">"OrthographicCamera"</span><span class="PUNC">===</span><span class="NAME">s.type</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">q</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.OrthographicCamera</span><span class="PUNC">(</span><span class="NAME">s.left</span><span class="PUNC">,</span><span class="NAME">s.right</span><span class="PUNC">,</span><span class="NAME">s.top</span><span class="PUNC">,</span><span class="NAME">s.bottom</span><span class="PUNC">,</span><span class="NAME">s.near</span><span class="PUNC">,</span><span class="NAME">s.far</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">q.name</span><span class="PUNC">=</span><span class="NAME">n</span><span class="PUNC">,</span><span class="NAME">q.position.fromArray</span><span class="PUNC">(</span><span class="NAME">h</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">l</span><span class="PUNC">?</span><span class="NAME">q.quaternion.fromArray</span><span class="PUNC">(</span><span class="NAME">l</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="WHIT">
<span class='line'>241</span> </span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">i</span><span class="PUNC">&&</span><span class="NAME">q.rotation.fromArray</span><span class="PUNC">(</span><span class="NAME">i</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">a.add</span><span class="PUNC">(</span><span class="NAME">q</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">A.cameras</span><span class="PUNC">[</span><span class="NAME">n</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">q</span><span class="PUNC">,</span><span class="NAME">A.objects</span><span class="PUNC">[</span><span class="NAME">n</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">q</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="PUNC">(</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">s.position</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">=</span><span class="NAME">s.rotation</span><span class="PUNC">,</span><span class="NAME">j</span><span class="PUNC">=</span><span class="NAME">s.scale</span><span class="PUNC">,</span><span class="NAME">l</span><span class="PUNC">=</span><span class="NAME">s.quaternion</span><span class="PUNC">,</span><span class="NAME">r</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Object3D</span><span class="PUNC">,</span><span class="NAME">r.name</span><span class="PUNC">=</span><span class="NAME">n</span><span class="PUNC">,</span><span class="NAME">r.position.fromArray</span><span class="PUNC">(</span><span class="NAME">h</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">l</span><span class="PUNC">?</span><span class="NAME">r.quaternion.fromArray</span><span class="PUNC">(</span><span class="NAME">l</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">r.rotation.fromArray</span><span class="PUNC">(</span><span class="NAME">i</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">r.scale.fromArray</span><span class="PUNC">(</span><span class="NAME">j</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">r.visible</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">s.visible</span><span class="PUNC">?</span><span class="NAME">s.visible</span><span class="PUNC">:</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">a.add</span><span class="PUNC">(</span><span class="NAME">r</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">A.objects</span><span class="PUNC">[</span><span class="NAME">n</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">r</span><span class="PUNC">,</span><span class="NAME">A.empties</span><span class="PUNC">[</span><span class="NAME">n</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">r</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">r</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">s.userData</span><span class="PUNC">)</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">F</span><span class="WHIT"> </span><span class="KEYW">in</span><span class="WHIT"> </span><span class="NAME">s.userData</span><span class="PUNC">)</span><span class="NAME">r.userData</span><span class="PUNC">[</span><span class="NAME">F</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">s.userData</span><span class="PUNC">[</span><span class="NAME">F</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">s.groups</span><span class="PUNC">)</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">&lt;</span><span class="NAME">s.groups.length</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">s.groups</span><span class="PUNC">[</span><span class="NAME">e</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">===</span><span class="NAME">A.groups</span><span class="PUNC">[</span><span class="NAME">h</span><span class="PUNC">]</span><span class="PUNC">&&</span><span class="WHIT">
<span class='line'>242</span> </span><span class="PUNC">(</span><span class="NAME">A.groups</span><span class="PUNC">[</span><span class="NAME">h</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">A.groups</span><span class="PUNC">[</span><span class="NAME">h</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">push</span><span class="PUNC">(</span><span class="NAME">n</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">r</span><span class="PUNC">&&</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">s.children</span><span class="PUNC">&&</span><span class="NAME">f</span><span class="PUNC">(</span><span class="NAME">r</span><span class="PUNC">,</span><span class="NAME">s.children</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">h</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">b.name</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">A.geometries</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">;</span><span class="NAME">A.face_materials</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">F</span><span class="PUNC">-</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">m.onLoadComplete</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">j</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">g</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">f.content</span><span class="PUNC">?</span><span class="NAME">f.content</span><span class="PUNC">:</span><span class="NAME">f.dae</span><span class="PUNC">?</span><span class="NAME">f.scene</span><span class="PUNC">:</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">d.rotation</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">d.quaternion</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">=</span><span class="NAME">d.scale</span><span class="PUNC">;</span><span class="NAME">f.position.fromArray</span><span class="PUNC">(</span><span class="NAME">d.position</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">g</span><span class="PUNC">?</span><span class="NAME">f.quaternion.fromArray</span><span class="PUNC">(</span><span class="NAME">g</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">f.rotation.fromArray</span><span class="PUNC">(</span><span class="NAME">h</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">f.scale.fromArray</span><span class="PUNC">(</span><span class="NAME">i</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">&&</span><span class="NAME">f.traverse</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">a.material</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">l</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">d.visible</span><span class="PUNC">?</span><span class="NAME">d.visible</span><span class="PUNC">:</span><span class="WHIT">
<span class='line'>243</span> </span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">f.traverse</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">a.visible</span><span class="PUNC">=</span><span class="NAME">l</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b.add</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">f.name</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">A.objects</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">f</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">F</span><span class="PUNC">-</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">m.onLoadComplete</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">j</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">b.name</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">A.geometries</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">;</span><span class="NAME">A.face_materials</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">j</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">m.callbackProgress</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">totalModels</span><span class="PUNC">:</span><span class="NAME">I</span><span class="PUNC">,</span><span class="NAME">totalTextures</span><span class="PUNC">:</span><span class="NAME">G</span><span class="PUNC">,</span><span class="NAME">loadedModels</span><span class="PUNC">:</span><span class="NAME">I</span><span class="PUNC">-</span><span class="NAME">F</span><span class="PUNC">,</span><span class="NAME">loadedTextures</span><span class="PUNC">:</span><span class="NAME">G</span><span class="PUNC">-</span><span class="NAME">H</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">A</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">m.onLoadProgress</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">===</span><span class="NAME">F</span><span class="PUNC">&&</span><span class="NUMB">0</span><span class="PUNC">===</span><span class="NAME">H</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">&lt;</span><span class="NAME">K.length</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">K</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">A.objects</span><span class="PUNC">[</span><span class="NAME">c.targetName</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">?</span><span class="NAME">c.object.target</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">:</span><span class="PUNC">(</span><span class="NAME">c.object.target</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Object3D</span><span class="PUNC">,</span><span class="NAME">A.scene.add</span><span class="PUNC">(</span><span class="NAME">c.object.target</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">c.object.target.userData.targetInverse</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>244</span> </span><span class="NAME">c.object</span><span class="PUNC">}</span><span class="NAME">b</span><span class="PUNC">(</span><span class="NAME">A</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">l</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">b</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">a.children</span><span class="PUNC">)</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="WHIT"> </span><span class="KEYW">in</span><span class="WHIT"> </span><span class="NAME">a.children</span><span class="PUNC">)</span><span class="NAME">l</span><span class="PUNC">(</span><span class="NAME">a.children</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">m</span><span class="PUNC">=</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">n</span><span class="PUNC">=</span><span class="NAME">THREE.Loader.prototype.extractUrlBase</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">p</span><span class="PUNC">,</span><span class="NAME">t</span><span class="PUNC">,</span><span class="NAME">q</span><span class="PUNC">,</span><span class="NAME">r</span><span class="PUNC">,</span><span class="NAME">s</span><span class="PUNC">,</span><span class="NAME">v</span><span class="PUNC">,</span><span class="NAME">z</span><span class="PUNC">,</span><span class="NAME">C</span><span class="PUNC">,</span><span class="NAME">F</span><span class="PUNC">,</span><span class="NAME">H</span><span class="PUNC">,</span><span class="NAME">I</span><span class="PUNC">,</span><span class="NAME">G</span><span class="PUNC">,</span><span class="NAME">A</span><span class="PUNC">,</span><span class="NAME">K</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">B</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">J</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">J</span><span class="WHIT"> </span><span class="KEYW">in</span><span class="WHIT"> </span><span class="NAME">this.geometryHandlers</span><span class="PUNC">)</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">this.geometryHandlers</span><span class="PUNC">[</span><span class="NAME">J</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">loaderClass</span><span class="PUNC">,</span><span class="NAME">this.geometryHandlers</span><span class="PUNC">[</span><span class="NAME">J</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">loaderObject</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">J</span><span class="WHIT"> </span><span class="KEYW">in</span><span class="WHIT"> </span><span class="NAME">this.hierarchyHandlers</span><span class="PUNC">)</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">this.hierarchyHandlers</span><span class="PUNC">[</span><span class="NAME">J</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">loaderClass</span><span class="PUNC">,</span><span class="NAME">this.hierarchyHandlers</span><span class="PUNC">[</span><span class="NAME">J</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">loaderObject</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">H</span><span class="PUNC">=</span><span class="NAME">F</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">A</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="NAME">scene</span><span class="PUNC">:</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Scene</span><span class="PUNC">,</span><span class="NAME">geometries</span><span class="PUNC">:</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">face_materials</span><span class="PUNC">:</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">materials</span><span class="PUNC">:</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">textures</span><span class="PUNC">:</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>245</span> </span><span class="NAME">objects</span><span class="PUNC">:</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">cameras</span><span class="PUNC">:</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">lights</span><span class="PUNC">:</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">fogs</span><span class="PUNC">:</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">empties</span><span class="PUNC">:</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">groups</span><span class="PUNC">:</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">B.transform</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">J</span><span class="PUNC">=</span><span class="NAME">B.transform.position</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">B.transform.rotation</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">B.transform.scale</span><span class="PUNC">,</span><span class="NAME">J</span><span class="PUNC">&&</span><span class="NAME">A.scene.position.fromArray</span><span class="PUNC">(</span><span class="NAME">J</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">&&</span><span class="NAME">A.scene.rotation.fromArray</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">&&</span><span class="NAME">A.scene.scale.fromArray</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">J</span><span class="PUNC">||</span><span class="NAME">a</span><span class="PUNC">||</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="NAME">A.scene.updateMatrix</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">A.scene.updateMatrixWorld</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">J</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">H</span><span class="PUNC">-</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">j</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">m.onLoadComplete</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">N</span><span class="WHIT"> </span><span class="KEYW">in</span><span class="WHIT"> </span><span class="NAME">B.fogs</span><span class="PUNC">)</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">B.fogs</span><span class="PUNC">[</span><span class="NAME">N</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="STRN">"linear"</span><span class="PUNC">===</span><span class="NAME">a.type</span><span class="PUNC">?</span><span class="NAME">r</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Fog</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">a.near</span><span class="PUNC">,</span><span class="NAME">a.far</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="STRN">"exp2"</span><span class="PUNC">===</span><span class="NAME">a.type</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">r</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.FogExp2</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">a.density</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">a.color</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>246</span> </span><span class="NAME">r.color.setRGB</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">A.fogs</span><span class="PUNC">[</span><span class="NAME">N</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">r</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">y</span><span class="WHIT"> </span><span class="KEYW">in</span><span class="WHIT"> </span><span class="NAME">B.geometries</span><span class="PUNC">)</span><span class="NAME">r</span><span class="PUNC">=</span><span class="NAME">B.geometries</span><span class="PUNC">[</span><span class="NAME">y</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">r.type</span><span class="WHIT"> </span><span class="KEYW">in</span><span class="WHIT"> </span><span class="NAME">this.geometryHandlers</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">F</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">m.onLoadStart</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">M</span><span class="WHIT"> </span><span class="KEYW">in</span><span class="WHIT"> </span><span class="NAME">B.objects</span><span class="PUNC">)</span><span class="NAME">l</span><span class="PUNC">(</span><span class="NAME">B.objects</span><span class="PUNC">[</span><span class="NAME">M</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">a.type</span><span class="PUNC">&&</span><span class="NAME">a.type</span><span class="WHIT"> </span><span class="KEYW">in</span><span class="WHIT"> </span><span class="NAME">m.hierarchyHandlers</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">F</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">m.onLoadStart</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">I</span><span class="PUNC">=</span><span class="NAME">F</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">y</span><span class="WHIT"> </span><span class="KEYW">in</span><span class="WHIT"> </span><span class="NAME">B.geometries</span><span class="PUNC">)</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">r</span><span class="PUNC">=</span><span class="NAME">B.geometries</span><span class="PUNC">[</span><span class="NAME">y</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="STRN">"cube"</span><span class="PUNC">===</span><span class="NAME">r.type</span><span class="PUNC">)</span><span class="NAME">p</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.CubeGeometry</span><span class="PUNC">(</span><span class="NAME">r.width</span><span class="PUNC">,</span><span class="NAME">r.height</span><span class="PUNC">,</span><span class="NAME">r.depth</span><span class="PUNC">,</span><span class="NAME">r.widthSegments</span><span class="PUNC">,</span><span class="NAME">r.heightSegments</span><span class="PUNC">,</span><span class="NAME">r.depthSegments</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">p.name</span><span class="PUNC">=</span><span class="NAME">y</span><span class="PUNC">,</span><span class="NAME">A.geometries</span><span class="PUNC">[</span><span class="NAME">y</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">p</span><span class="PUNC">;</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="STRN">"plane"</span><span class="PUNC">===</span><span class="NAME">r.type</span><span class="PUNC">)</span><span class="NAME">p</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.PlaneGeometry</span><span class="PUNC">(</span><span class="NAME">r.width</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>247</span> </span><span class="NAME">r.height</span><span class="PUNC">,</span><span class="NAME">r.widthSegments</span><span class="PUNC">,</span><span class="NAME">r.heightSegments</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">p.name</span><span class="PUNC">=</span><span class="NAME">y</span><span class="PUNC">,</span><span class="NAME">A.geometries</span><span class="PUNC">[</span><span class="NAME">y</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">p</span><span class="PUNC">;</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="STRN">"sphere"</span><span class="PUNC">===</span><span class="NAME">r.type</span><span class="PUNC">)</span><span class="NAME">p</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.SphereGeometry</span><span class="PUNC">(</span><span class="NAME">r.radius</span><span class="PUNC">,</span><span class="NAME">r.widthSegments</span><span class="PUNC">,</span><span class="NAME">r.heightSegments</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">p.name</span><span class="PUNC">=</span><span class="NAME">y</span><span class="PUNC">,</span><span class="NAME">A.geometries</span><span class="PUNC">[</span><span class="NAME">y</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">p</span><span class="PUNC">;</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="STRN">"cylinder"</span><span class="PUNC">===</span><span class="NAME">r.type</span><span class="PUNC">)</span><span class="NAME">p</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.CylinderGeometry</span><span class="PUNC">(</span><span class="NAME">r.topRad</span><span class="PUNC">,</span><span class="NAME">r.botRad</span><span class="PUNC">,</span><span class="NAME">r.height</span><span class="PUNC">,</span><span class="NAME">r.radSegs</span><span class="PUNC">,</span><span class="NAME">r.heightSegs</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">p.name</span><span class="PUNC">=</span><span class="NAME">y</span><span class="PUNC">,</span><span class="NAME">A.geometries</span><span class="PUNC">[</span><span class="NAME">y</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">p</span><span class="PUNC">;</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="STRN">"torus"</span><span class="PUNC">===</span><span class="NAME">r.type</span><span class="PUNC">)</span><span class="NAME">p</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.TorusGeometry</span><span class="PUNC">(</span><span class="NAME">r.radius</span><span class="PUNC">,</span><span class="NAME">r.tube</span><span class="PUNC">,</span><span class="NAME">r.segmentsR</span><span class="PUNC">,</span><span class="NAME">r.segmentsT</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">p.name</span><span class="PUNC">=</span><span class="NAME">y</span><span class="PUNC">,</span><span class="NAME">A.geometries</span><span class="PUNC">[</span><span class="NAME">y</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">p</span><span class="PUNC">;</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="STRN">"icosahedron"</span><span class="PUNC">===</span><span class="NAME">r.type</span><span class="PUNC">)</span><span class="NAME">p</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.IcosahedronGeometry</span><span class="PUNC">(</span><span class="NAME">r.radius</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>248</span> </span><span class="NAME">r.subdivisions</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">p.name</span><span class="PUNC">=</span><span class="NAME">y</span><span class="PUNC">,</span><span class="NAME">A.geometries</span><span class="PUNC">[</span><span class="NAME">y</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">p</span><span class="PUNC">;</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">r.type</span><span class="WHIT"> </span><span class="KEYW">in</span><span class="WHIT"> </span><span class="NAME">this.geometryHandlers</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">M</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">s</span><span class="WHIT"> </span><span class="KEYW">in</span><span class="WHIT"> </span><span class="NAME">r</span><span class="PUNC">)</span><span class="STRN">"type"</span><span class="PUNC">!==</span><span class="NAME">s</span><span class="PUNC">&&</span><span class="STRN">"url"</span><span class="PUNC">!==</span><span class="NAME">s</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">M</span><span class="PUNC">[</span><span class="NAME">s</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">r</span><span class="PUNC">[</span><span class="NAME">s</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.geometryHandlers</span><span class="PUNC">[</span><span class="NAME">r.type</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">loaderObject.load</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">(</span><span class="NAME">r.url</span><span class="PUNC">,</span><span class="NAME">B.urlBaseType</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">(</span><span class="NAME">y</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">M</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="STRN">"embedded"</span><span class="PUNC">===</span><span class="NAME">r.type</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">M</span><span class="PUNC">=</span><span class="NAME">B.embeds</span><span class="PUNC">[</span><span class="NAME">r.id</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">M.metadata</span><span class="PUNC">=</span><span class="NAME">B.metadata</span><span class="PUNC">,</span><span class="NAME">M</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">M</span><span class="PUNC">=</span><span class="NAME">this.geometryHandlers.ascii.loaderObject.parse</span><span class="PUNC">(</span><span class="NAME">M</span><span class="PUNC">,</span><span class="STRN">""</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">(</span><span class="NAME">y</span><span class="PUNC">)</span><span class="PUNC">(</span><span class="NAME">M.geometry</span><span class="PUNC">,</span><span class="NAME">M.materials</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">w</span><span class="WHIT"> </span><span class="KEYW">in</span><span class="WHIT"> </span><span class="NAME">B.textures</span><span class="PUNC">)</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">y</span><span class="PUNC">=</span><span class="NAME">B.textures</span><span class="PUNC">[</span><span class="NAME">w</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">y.url</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">Array</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">H</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">y.url.length</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">s</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">s</span><span class="PUNC">&lt;</span><span class="NAME">y.url.length</span><span class="PUNC">;</span><span class="NAME">s</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">m.onLoadStart</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="NAME">H</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>249</span> </span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">m.onLoadStart</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">G</span><span class="PUNC">=</span><span class="NAME">H</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">w</span><span class="WHIT"> </span><span class="KEYW">in</span><span class="WHIT"> </span><span class="NAME">B.textures</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">y</span><span class="PUNC">=</span><span class="NAME">B.textures</span><span class="PUNC">[</span><span class="NAME">w</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">y.mapping</span><span class="PUNC">&&</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">THREE</span><span class="PUNC">[</span><span class="NAME">y.mapping</span><span class="PUNC">]</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">y.mapping</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE</span><span class="PUNC">[</span><span class="NAME">y.mapping</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">y.url</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">Array</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">M</span><span class="PUNC">=</span><span class="NAME">y.url.length</span><span class="PUNC">;</span><span class="NAME">r</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">s</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">s</span><span class="PUNC">&lt;</span><span class="NAME">M</span><span class="PUNC">;</span><span class="NAME">s</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">r</span><span class="PUNC">[</span><span class="NAME">s</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">(</span><span class="NAME">y.url</span><span class="PUNC">[</span><span class="NAME">s</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">B.urlBaseType</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">s</span><span class="PUNC">=</span><span class="PUNC">(</span><span class="NAME">s</span><span class="PUNC">=</span><span class="REGX">/\.dds$/i</span><span class="PUNC">.</span><span class="NAME">test</span><span class="PUNC">(</span><span class="NAME">r</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">?</span><span class="NAME">THREE.ImageUtils.loadCompressedTextureCube</span><span class="PUNC">(</span><span class="NAME">r</span><span class="PUNC">,</span><span class="NAME">y.mapping</span><span class="PUNC">,</span><span class="NAME">J</span><span class="PUNC">(</span><span class="NAME">M</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">THREE.ImageUtils.loadTextureCube</span><span class="PUNC">(</span><span class="NAME">r</span><span class="PUNC">,</span><span class="NAME">y.mapping</span><span class="PUNC">,</span><span class="NAME">J</span><span class="PUNC">(</span><span class="NAME">M</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="NAME">s</span><span class="PUNC">=</span><span class="REGX">/\.dds$/i</span><span class="PUNC">.</span><span class="NAME">test</span><span class="PUNC">(</span><span class="NAME">y.url</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">M</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">(</span><span class="NAME">y.url</span><span class="PUNC">,</span><span class="NAME">B.urlBaseType</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">r</span><span class="PUNC">=</span><span class="NAME">J</span><span class="PUNC">(</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">s</span><span class="PUNC">=</span><span class="NAME">s</span><span class="PUNC">?</span><span class="NAME">THREE.ImageUtils.loadCompressedTexture</span><span class="PUNC">(</span><span class="NAME">M</span><span class="PUNC">,</span><span class="NAME">y.mapping</span><span class="PUNC">,</span><span class="NAME">r</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">THREE.ImageUtils.loadTexture</span><span class="PUNC">(</span><span class="NAME">M</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>250</span> </span><span class="NAME">y.mapping</span><span class="PUNC">,</span><span class="NAME">r</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">THREE</span><span class="PUNC">[</span><span class="NAME">y.minFilter</span><span class="PUNC">]</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">s.minFilter</span><span class="PUNC">=</span><span class="NAME">THREE</span><span class="PUNC">[</span><span class="NAME">y.minFilter</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">THREE</span><span class="PUNC">[</span><span class="NAME">y.magFilter</span><span class="PUNC">]</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">s.magFilter</span><span class="PUNC">=</span><span class="NAME">THREE</span><span class="PUNC">[</span><span class="NAME">y.magFilter</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">y.anisotropy</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">s.anisotropy</span><span class="PUNC">=</span><span class="NAME">y.anisotropy</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">y.repeat</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">s.repeat.set</span><span class="PUNC">(</span><span class="NAME">y.repeat</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">y.repeat</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">!==</span><span class="NAME">y.repeat</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">s.wrapS</span><span class="PUNC">=</span><span class="NAME">THREE.RepeatWrapping</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">!==</span><span class="NAME">y.repeat</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">s.wrapT</span><span class="PUNC">=</span><span class="NAME">THREE.RepeatWrapping</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">y.offset</span><span class="PUNC">&&</span><span class="NAME">s.offset.set</span><span class="PUNC">(</span><span class="NAME">y.offset</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">y.offset</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">y.wrap</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">M</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="NAME">repeat</span><span class="PUNC">:</span><span class="NAME">THREE.RepeatWrapping</span><span class="PUNC">,</span><span class="NAME">mirror</span><span class="PUNC">:</span><span class="NAME">THREE.MirroredRepeatWrapping</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">M</span><span class="PUNC">[</span><span class="NAME">y.wrap</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">s.wrapS</span><span class="PUNC">=</span><span class="NAME">M</span><span class="PUNC">[</span><span class="NAME">y.wrap</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="WHIT">
<span class='line'>251</span> </span><span class="NAME">M</span><span class="PUNC">[</span><span class="NAME">y.wrap</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">s.wrapT</span><span class="PUNC">=</span><span class="NAME">M</span><span class="PUNC">[</span><span class="NAME">y.wrap</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">A.textures</span><span class="PUNC">[</span><span class="NAME">w</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">s</span><span class="PUNC">}</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">Z</span><span class="PUNC">,</span><span class="NAME">L</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">Z</span><span class="WHIT"> </span><span class="KEYW">in</span><span class="WHIT"> </span><span class="NAME">B.materials</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">w</span><span class="PUNC">=</span><span class="NAME">B.materials</span><span class="PUNC">[</span><span class="NAME">Z</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">L</span><span class="WHIT"> </span><span class="KEYW">in</span><span class="WHIT"> </span><span class="NAME">w.parameters</span><span class="PUNC">)</span><span class="STRN">"envMap"</span><span class="PUNC">===</span><span class="NAME">L</span><span class="PUNC">||</span><span class="STRN">"map"</span><span class="PUNC">===</span><span class="NAME">L</span><span class="PUNC">||</span><span class="STRN">"lightMap"</span><span class="PUNC">===</span><span class="NAME">L</span><span class="PUNC">||</span><span class="STRN">"bumpMap"</span><span class="PUNC">===</span><span class="NAME">L</span><span class="PUNC">?</span><span class="NAME">w.parameters</span><span class="PUNC">[</span><span class="NAME">L</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">A.textures</span><span class="PUNC">[</span><span class="NAME">w.parameters</span><span class="PUNC">[</span><span class="NAME">L</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">:</span><span class="STRN">"shading"</span><span class="PUNC">===</span><span class="NAME">L</span><span class="PUNC">?</span><span class="NAME">w.parameters</span><span class="PUNC">[</span><span class="NAME">L</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="STRN">"flat"</span><span class="PUNC">===</span><span class="NAME">w.parameters</span><span class="PUNC">[</span><span class="NAME">L</span><span class="PUNC">]</span><span class="PUNC">?</span><span class="NAME">THREE.FlatShading</span><span class="PUNC">:</span><span class="NAME">THREE.SmoothShading</span><span class="PUNC">:</span><span class="STRN">"side"</span><span class="PUNC">===</span><span class="NAME">L</span><span class="PUNC">?</span><span class="NAME">w.parameters</span><span class="PUNC">[</span><span class="NAME">L</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="STRN">"double"</span><span class="PUNC">==</span><span class="NAME">w.parameters</span><span class="PUNC">[</span><span class="NAME">L</span><span class="PUNC">]</span><span class="PUNC">?</span><span class="NAME">THREE.DoubleSide</span><span class="PUNC">:</span><span class="STRN">"back"</span><span class="PUNC">==</span><span class="NAME">w.parameters</span><span class="PUNC">[</span><span class="NAME">L</span><span class="PUNC">]</span><span class="PUNC">?</span><span class="NAME">THREE.BackSide</span><span class="PUNC">:</span><span class="NAME">THREE.FrontSide</span><span class="PUNC">:</span><span class="STRN">"blending"</span><span class="PUNC">===</span><span class="NAME">L</span><span class="PUNC">?</span><span class="NAME">w.parameters</span><span class="PUNC">[</span><span class="NAME">L</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">w.parameters</span><span class="PUNC">[</span><span class="NAME">L</span><span class="PUNC">]</span><span class="KEYW">in</span><span class="WHIT"> </span><span class="NAME">THREE</span><span class="PUNC">?</span><span class="NAME">THREE</span><span class="PUNC">[</span><span class="NAME">w.parameters</span><span class="PUNC">[</span><span class="NAME">L</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">:</span><span class="WHIT">
<span class='line'>252</span> </span><span class="NAME">THREE.NormalBlending</span><span class="PUNC">:</span><span class="STRN">"combine"</span><span class="PUNC">===</span><span class="NAME">L</span><span class="PUNC">?</span><span class="NAME">w.parameters</span><span class="PUNC">[</span><span class="NAME">L</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">w.parameters</span><span class="PUNC">[</span><span class="NAME">L</span><span class="PUNC">]</span><span class="KEYW">in</span><span class="WHIT"> </span><span class="NAME">THREE</span><span class="PUNC">?</span><span class="NAME">THREE</span><span class="PUNC">[</span><span class="NAME">w.parameters</span><span class="PUNC">[</span><span class="NAME">L</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">:</span><span class="NAME">THREE.MultiplyOperation</span><span class="PUNC">:</span><span class="STRN">"vertexColors"</span><span class="PUNC">===</span><span class="NAME">L</span><span class="PUNC">?</span><span class="STRN">"face"</span><span class="PUNC">==</span><span class="NAME">w.parameters</span><span class="PUNC">[</span><span class="NAME">L</span><span class="PUNC">]</span><span class="PUNC">?</span><span class="NAME">w.parameters</span><span class="PUNC">[</span><span class="NAME">L</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">THREE.FaceColors</span><span class="PUNC">:</span><span class="NAME">w.parameters</span><span class="PUNC">[</span><span class="NAME">L</span><span class="PUNC">]</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">w.parameters</span><span class="PUNC">[</span><span class="NAME">L</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">THREE.VertexColors</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="STRN">"wrapRGB"</span><span class="PUNC">===</span><span class="NAME">L</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">J</span><span class="PUNC">=</span><span class="NAME">w.parameters</span><span class="PUNC">[</span><span class="NAME">L</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">w.parameters</span><span class="PUNC">[</span><span class="NAME">L</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">(</span><span class="NAME">J</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">J</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">J</span><span class="PUNC">[</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">w.parameters.opacity</span><span class="PUNC">&&</span><span class="NUMB">1</span><span class="PUNC">></span><span class="NAME">w.parameters.opacity</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">w.parameters.transparent</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">w.parameters.normalMap</span><span class="PUNC">?</span><span class="PUNC">(</span><span class="NAME">J</span><span class="PUNC">=</span><span class="NAME">THREE.ShaderLib.normalmap</span><span class="PUNC">,</span><span class="NAME">y</span><span class="PUNC">=</span><span class="NAME">THREE.UniformsUtils.clone</span><span class="PUNC">(</span><span class="NAME">J.uniforms</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>253</span> </span><span class="NAME">s</span><span class="PUNC">=</span><span class="NAME">w.parameters.color</span><span class="PUNC">,</span><span class="NAME">M</span><span class="PUNC">=</span><span class="NAME">w.parameters.specular</span><span class="PUNC">,</span><span class="NAME">r</span><span class="PUNC">=</span><span class="NAME">w.parameters.ambient</span><span class="PUNC">,</span><span class="NAME">N</span><span class="PUNC">=</span><span class="NAME">w.parameters.shininess</span><span class="PUNC">,</span><span class="NAME">y.tNormal.value</span><span class="PUNC">=</span><span class="NAME">A.textures</span><span class="PUNC">[</span><span class="NAME">w.parameters.normalMap</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">w.parameters.normalScale</span><span class="PUNC">&&</span><span class="NAME">y.uNormalScale.value.set</span><span class="PUNC">(</span><span class="NAME">w.parameters.normalScale</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">w.parameters.normalScale</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">w.parameters.map</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">y.tDiffuse.value</span><span class="PUNC">=</span><span class="NAME">w.parameters.map</span><span class="PUNC">,</span><span class="NAME">y.enableDiffuse.value</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">w.parameters.envMap</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">y.tCube.value</span><span class="PUNC">=</span><span class="NAME">w.parameters.envMap</span><span class="PUNC">,</span><span class="NAME">y.enableReflection.value</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">y.uReflectivity.value</span><span class="PUNC">=</span><span class="NAME">w.parameters.reflectivity</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">w.parameters.lightMap</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">y.tAO.value</span><span class="PUNC">=</span><span class="NAME">w.parameters.lightMap</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>254</span> </span><span class="NAME">y.enableAO.value</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">w.parameters.specularMap</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">y.tSpecular.value</span><span class="PUNC">=</span><span class="NAME">A.textures</span><span class="PUNC">[</span><span class="NAME">w.parameters.specularMap</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">y.enableSpecular.value</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">w.parameters.displacementMap</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">y.tDisplacement.value</span><span class="PUNC">=</span><span class="NAME">A.textures</span><span class="PUNC">[</span><span class="NAME">w.parameters.displacementMap</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">y.enableDisplacement.value</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">y.uDisplacementBias.value</span><span class="PUNC">=</span><span class="NAME">w.parameters.displacementBias</span><span class="PUNC">,</span><span class="NAME">y.uDisplacementScale.value</span><span class="PUNC">=</span><span class="NAME">w.parameters.displacementScale</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">y.uDiffuseColor.value.setHex</span><span class="PUNC">(</span><span class="NAME">s</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">y.uSpecularColor.value.setHex</span><span class="PUNC">(</span><span class="NAME">M</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">y.uAmbientColor.value.setHex</span><span class="PUNC">(</span><span class="NAME">r</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">y.uShininess.value</span><span class="PUNC">=</span><span class="NAME">N</span><span class="PUNC">,</span><span class="NAME">w.parameters.opacity</span><span class="PUNC">&&</span><span class="WHIT">
<span class='line'>255</span> </span><span class="PUNC">(</span><span class="NAME">y.uOpacity.value</span><span class="PUNC">=</span><span class="NAME">w.parameters.opacity</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">t</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.ShaderMaterial</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">fragmentShader</span><span class="PUNC">:</span><span class="NAME">J.fragmentShader</span><span class="PUNC">,</span><span class="NAME">vertexShader</span><span class="PUNC">:</span><span class="NAME">J.vertexShader</span><span class="PUNC">,</span><span class="NAME">uniforms</span><span class="PUNC">:</span><span class="NAME">y</span><span class="PUNC">,</span><span class="NAME">lights</span><span class="PUNC">:</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">fog</span><span class="PUNC">:</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">t</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE</span><span class="PUNC">[</span><span class="NAME">w.type</span><span class="PUNC">]</span><span class="PUNC">(</span><span class="NAME">w.parameters</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">t.name</span><span class="PUNC">=</span><span class="NAME">Z</span><span class="PUNC">;</span><span class="NAME">A.materials</span><span class="PUNC">[</span><span class="NAME">Z</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">t</span><span class="PUNC">}</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">Z</span><span class="WHIT"> </span><span class="KEYW">in</span><span class="WHIT"> </span><span class="NAME">B.materials</span><span class="PUNC">)</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">w</span><span class="PUNC">=</span><span class="NAME">B.materials</span><span class="PUNC">[</span><span class="NAME">Z</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">w.parameters.materials</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">L</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">s</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">s</span><span class="PUNC">&lt;</span><span class="NAME">w.parameters.materials.length</span><span class="PUNC">;</span><span class="NAME">s</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">L.push</span><span class="PUNC">(</span><span class="NAME">A.materials</span><span class="PUNC">[</span><span class="NAME">w.parameters.materials</span><span class="PUNC">[</span><span class="NAME">s</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">A.materials</span><span class="PUNC">[</span><span class="NAME">Z</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">materials</span><span class="PUNC">=</span><span class="NAME">L</span><span class="PUNC">}</span><span class="NAME">e</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">A.cameras</span><span class="PUNC">&&</span><span class="NAME">B.defaults.camera</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">A.currentCamera</span><span class="PUNC">=</span><span class="NAME">A.cameras</span><span class="PUNC">[</span><span class="NAME">B.defaults.camera</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">A.fogs</span><span class="PUNC">&&</span><span class="NAME">B.defaults.fog</span><span class="PUNC">&&</span><span class="WHIT">
<span class='line'>256</span> </span><span class="PUNC">(</span><span class="NAME">A.scene.fog</span><span class="PUNC">=</span><span class="NAME">A.fogs</span><span class="PUNC">[</span><span class="NAME">B.defaults.fog</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">m.callbackSync</span><span class="PUNC">(</span><span class="NAME">A</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">j</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.TextureLoader</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.manager</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">a</span><span class="PUNC">?</span><span class="NAME">a</span><span class="PUNC">:</span><span class="NAME">THREE.DefaultLoadingManager</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.TextureLoader.prototype</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="NAME">constructor</span><span class="PUNC">:</span><span class="NAME">THREE.TextureLoader</span><span class="PUNC">,</span><span class="NAME">load</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.ImageLoader</span><span class="PUNC">(</span><span class="NAME">this.manager</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">c.setCrossOrigin</span><span class="PUNC">(</span><span class="NAME">this.crossOrigin</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">c.load</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">a</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Texture</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a.needsUpdate</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">b</span><span class="PUNC">&&</span><span class="NAME">b</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">setCrossOrigin</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.crossOrigin</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.Material</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.id</span><span class="PUNC">=</span><span class="NAME">THREE.MaterialIdCount</span><span class="PUNC">++</span><span class="PUNC">;</span><span class="NAME">this.uuid</span><span class="PUNC">=</span><span class="NAME">THREE.Math.generateUUID</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.name</span><span class="PUNC">=</span><span class="STRN">""</span><span class="PUNC">;</span><span class="NAME">this.side</span><span class="PUNC">=</span><span class="NAME">THREE.FrontSide</span><span class="PUNC">;</span><span class="NAME">this.opacity</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">this.transparent</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">this.blending</span><span class="PUNC">=</span><span class="NAME">THREE.NormalBlending</span><span class="PUNC">;</span><span class="NAME">this.blendSrc</span><span class="PUNC">=</span><span class="NAME">THREE.SrcAlphaFactor</span><span class="PUNC">;</span><span class="NAME">this.blendDst</span><span class="PUNC">=</span><span class="NAME">THREE.OneMinusSrcAlphaFactor</span><span class="PUNC">;</span><span class="NAME">this.blendEquation</span><span class="PUNC">=</span><span class="NAME">THREE.AddEquation</span><span class="PUNC">;</span><span class="NAME">this.depthWrite</span><span class="PUNC">=</span><span class="NAME">this.depthTest</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">this.polygonOffset</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">this.overdraw</span><span class="PUNC">=</span><span class="NAME">this.alphaTest</span><span class="PUNC">=</span><span class="NAME">this.polygonOffsetUnits</span><span class="PUNC">=</span><span class="NAME">this.polygonOffsetFactor</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">this.needsUpdate</span><span class="PUNC">=</span><span class="NAME">this.visible</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>257</span> </span><span class="NAME">THREE.Material.prototype</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="NAME">constructor</span><span class="PUNC">:</span><span class="NAME">THREE.Material</span><span class="PUNC">,</span><span class="NAME">setValues</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">a</span><span class="PUNC">)</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="WHIT"> </span><span class="KEYW">in</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">===</span><span class="NAME">c</span><span class="PUNC">)</span><span class="NAME">console.warn</span><span class="PUNC">(</span><span class="STRN">"THREE.Material: '"</span><span class="PUNC">+</span><span class="NAME">b</span><span class="PUNC">+</span><span class="STRN">"' parameter is undefined."</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">b</span><span class="WHIT"> </span><span class="KEYW">in</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">=</span><span class="KEYW">this</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">d</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">THREE.Color</span><span class="PUNC">?</span><span class="NAME">d.set</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">d</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">&&</span><span class="NAME">c</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">?</span><span class="NAME">d.copy</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="KEYW">this</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="STRN">"overdraw"</span><span class="PUNC">==</span><span class="NAME">b</span><span class="PUNC">?</span><span class="NAME">Number</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">c</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">clone</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">===</span><span class="NAME">a</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Material</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a.name</span><span class="PUNC">=</span><span class="NAME">this.name</span><span class="PUNC">;</span><span class="NAME">a.side</span><span class="PUNC">=</span><span class="NAME">this.side</span><span class="PUNC">;</span><span class="NAME">a.opacity</span><span class="PUNC">=</span><span class="NAME">this.opacity</span><span class="PUNC">;</span><span class="NAME">a.transparent</span><span class="PUNC">=</span><span class="NAME">this.transparent</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>258</span> </span><span class="NAME">a.blending</span><span class="PUNC">=</span><span class="NAME">this.blending</span><span class="PUNC">;</span><span class="NAME">a.blendSrc</span><span class="PUNC">=</span><span class="NAME">this.blendSrc</span><span class="PUNC">;</span><span class="NAME">a.blendDst</span><span class="PUNC">=</span><span class="NAME">this.blendDst</span><span class="PUNC">;</span><span class="NAME">a.blendEquation</span><span class="PUNC">=</span><span class="NAME">this.blendEquation</span><span class="PUNC">;</span><span class="NAME">a.depthTest</span><span class="PUNC">=</span><span class="NAME">this.depthTest</span><span class="PUNC">;</span><span class="NAME">a.depthWrite</span><span class="PUNC">=</span><span class="NAME">this.depthWrite</span><span class="PUNC">;</span><span class="NAME">a.polygonOffset</span><span class="PUNC">=</span><span class="NAME">this.polygonOffset</span><span class="PUNC">;</span><span class="NAME">a.polygonOffsetFactor</span><span class="PUNC">=</span><span class="NAME">this.polygonOffsetFactor</span><span class="PUNC">;</span><span class="NAME">a.polygonOffsetUnits</span><span class="PUNC">=</span><span class="NAME">this.polygonOffsetUnits</span><span class="PUNC">;</span><span class="NAME">a.alphaTest</span><span class="PUNC">=</span><span class="NAME">this.alphaTest</span><span class="PUNC">;</span><span class="NAME">a.overdraw</span><span class="PUNC">=</span><span class="NAME">this.overdraw</span><span class="PUNC">;</span><span class="NAME">a.visible</span><span class="PUNC">=</span><span class="NAME">this.visible</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">dispose</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.dispatchEvent</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">type</span><span class="PUNC">:</span><span class="STRN">"dispose"</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.EventDispatcher.prototype.apply</span><span class="PUNC">(</span><span class="NAME">THREE.Material.prototype</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>259</span> </span><span class="NAME">THREE.MaterialIdCount</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">THREE.LineBasicMaterial</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">THREE.Material.call</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.color</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Color</span><span class="PUNC">(</span><span class="NUMB">16777215</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.linewidth</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">this.linejoin</span><span class="PUNC">=</span><span class="NAME">this.linecap</span><span class="PUNC">=</span><span class="STRN">"round"</span><span class="PUNC">;</span><span class="NAME">this.vertexColors</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">this.fog</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">this.setValues</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.LineBasicMaterial.prototype</span><span class="PUNC">=</span><span class="NAME">Object.create</span><span class="PUNC">(</span><span class="NAME">THREE.Material.prototype</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>260</span> </span><span class="NAME">THREE.LineBasicMaterial.prototype.clone</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.LineBasicMaterial</span><span class="PUNC">;</span><span class="NAME">THREE.Material.prototype.clone.call</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a.color.copy</span><span class="PUNC">(</span><span class="NAME">this.color</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a.linewidth</span><span class="PUNC">=</span><span class="NAME">this.linewidth</span><span class="PUNC">;</span><span class="NAME">a.linecap</span><span class="PUNC">=</span><span class="NAME">this.linecap</span><span class="PUNC">;</span><span class="NAME">a.linejoin</span><span class="PUNC">=</span><span class="NAME">this.linejoin</span><span class="PUNC">;</span><span class="NAME">a.vertexColors</span><span class="PUNC">=</span><span class="NAME">this.vertexColors</span><span class="PUNC">;</span><span class="NAME">a.fog</span><span class="PUNC">=</span><span class="NAME">this.fog</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.LineDashedMaterial</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">THREE.Material.call</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.color</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Color</span><span class="PUNC">(</span><span class="NUMB">16777215</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.scale</span><span class="PUNC">=</span><span class="NAME">this.linewidth</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">this.dashSize</span><span class="PUNC">=</span><span class="NUMB">3</span><span class="PUNC">;</span><span class="NAME">this.gapSize</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">this.vertexColors</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">this.fog</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">this.setValues</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.LineDashedMaterial.prototype</span><span class="PUNC">=</span><span class="NAME">Object.create</span><span class="PUNC">(</span><span class="NAME">THREE.Material.prototype</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>261</span> </span><span class="NAME">THREE.LineDashedMaterial.prototype.clone</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.LineDashedMaterial</span><span class="PUNC">;</span><span class="NAME">THREE.Material.prototype.clone.call</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a.color.copy</span><span class="PUNC">(</span><span class="NAME">this.color</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a.linewidth</span><span class="PUNC">=</span><span class="NAME">this.linewidth</span><span class="PUNC">;</span><span class="NAME">a.scale</span><span class="PUNC">=</span><span class="NAME">this.scale</span><span class="PUNC">;</span><span class="NAME">a.dashSize</span><span class="PUNC">=</span><span class="NAME">this.dashSize</span><span class="PUNC">;</span><span class="NAME">a.gapSize</span><span class="PUNC">=</span><span class="NAME">this.gapSize</span><span class="PUNC">;</span><span class="NAME">a.vertexColors</span><span class="PUNC">=</span><span class="NAME">this.vertexColors</span><span class="PUNC">;</span><span class="NAME">a.fog</span><span class="PUNC">=</span><span class="NAME">this.fog</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.MeshBasicMaterial</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">THREE.Material.call</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.color</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Color</span><span class="PUNC">(</span><span class="NUMB">16777215</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.envMap</span><span class="PUNC">=</span><span class="NAME">this.specularMap</span><span class="PUNC">=</span><span class="NAME">this.lightMap</span><span class="PUNC">=</span><span class="NAME">this.map</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">;</span><span class="NAME">this.combine</span><span class="PUNC">=</span><span class="NAME">THREE.MultiplyOperation</span><span class="PUNC">;</span><span class="NAME">this.reflectivity</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">this.refractionRatio</span><span class="PUNC">=</span><span class="NUMB">0.98</span><span class="PUNC">;</span><span class="NAME">this.fog</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">this.shading</span><span class="PUNC">=</span><span class="NAME">THREE.SmoothShading</span><span class="PUNC">;</span><span class="NAME">this.wireframe</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">this.wireframeLinewidth</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">this.wireframeLinejoin</span><span class="PUNC">=</span><span class="NAME">this.wireframeLinecap</span><span class="PUNC">=</span><span class="STRN">"round"</span><span class="PUNC">;</span><span class="NAME">this.vertexColors</span><span class="PUNC">=</span><span class="NAME">THREE.NoColors</span><span class="PUNC">;</span><span class="NAME">this.morphTargets</span><span class="PUNC">=</span><span class="NAME">this.skinning</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">this.setValues</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>262</span> </span><span class="NAME">THREE.MeshBasicMaterial.prototype</span><span class="PUNC">=</span><span class="NAME">Object.create</span><span class="PUNC">(</span><span class="NAME">THREE.Material.prototype</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>263</span> </span><span class="NAME">THREE.MeshBasicMaterial.prototype.clone</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.MeshBasicMaterial</span><span class="PUNC">;</span><span class="NAME">THREE.Material.prototype.clone.call</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a.color.copy</span><span class="PUNC">(</span><span class="NAME">this.color</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a.map</span><span class="PUNC">=</span><span class="NAME">this.map</span><span class="PUNC">;</span><span class="NAME">a.lightMap</span><span class="PUNC">=</span><span class="NAME">this.lightMap</span><span class="PUNC">;</span><span class="NAME">a.specularMap</span><span class="PUNC">=</span><span class="NAME">this.specularMap</span><span class="PUNC">;</span><span class="NAME">a.envMap</span><span class="PUNC">=</span><span class="NAME">this.envMap</span><span class="PUNC">;</span><span class="NAME">a.combine</span><span class="PUNC">=</span><span class="NAME">this.combine</span><span class="PUNC">;</span><span class="NAME">a.reflectivity</span><span class="PUNC">=</span><span class="NAME">this.reflectivity</span><span class="PUNC">;</span><span class="NAME">a.refractionRatio</span><span class="PUNC">=</span><span class="NAME">this.refractionRatio</span><span class="PUNC">;</span><span class="NAME">a.fog</span><span class="PUNC">=</span><span class="NAME">this.fog</span><span class="PUNC">;</span><span class="NAME">a.shading</span><span class="PUNC">=</span><span class="NAME">this.shading</span><span class="PUNC">;</span><span class="NAME">a.wireframe</span><span class="PUNC">=</span><span class="NAME">this.wireframe</span><span class="PUNC">;</span><span class="NAME">a.wireframeLinewidth</span><span class="PUNC">=</span><span class="NAME">this.wireframeLinewidth</span><span class="PUNC">;</span><span class="NAME">a.wireframeLinecap</span><span class="PUNC">=</span><span class="NAME">this.wireframeLinecap</span><span class="PUNC">;</span><span class="NAME">a.wireframeLinejoin</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>264</span> </span><span class="NAME">this.wireframeLinejoin</span><span class="PUNC">;</span><span class="NAME">a.vertexColors</span><span class="PUNC">=</span><span class="NAME">this.vertexColors</span><span class="PUNC">;</span><span class="NAME">a.skinning</span><span class="PUNC">=</span><span class="NAME">this.skinning</span><span class="PUNC">;</span><span class="NAME">a.morphTargets</span><span class="PUNC">=</span><span class="NAME">this.morphTargets</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.MeshLambertMaterial</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">THREE.Material.call</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.color</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Color</span><span class="PUNC">(</span><span class="NUMB">16777215</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.ambient</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Color</span><span class="PUNC">(</span><span class="NUMB">16777215</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.emissive</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Color</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.wrapAround</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">this.wrapRGB</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">(</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.envMap</span><span class="PUNC">=</span><span class="NAME">this.specularMap</span><span class="PUNC">=</span><span class="NAME">this.lightMap</span><span class="PUNC">=</span><span class="NAME">this.map</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">;</span><span class="NAME">this.combine</span><span class="PUNC">=</span><span class="NAME">THREE.MultiplyOperation</span><span class="PUNC">;</span><span class="NAME">this.reflectivity</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">this.refractionRatio</span><span class="PUNC">=</span><span class="NUMB">0.98</span><span class="PUNC">;</span><span class="NAME">this.fog</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">this.shading</span><span class="PUNC">=</span><span class="NAME">THREE.SmoothShading</span><span class="PUNC">;</span><span class="NAME">this.wireframe</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">this.wireframeLinewidth</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">this.wireframeLinejoin</span><span class="PUNC">=</span><span class="NAME">this.wireframeLinecap</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>265</span> </span><span class="STRN">"round"</span><span class="PUNC">;</span><span class="NAME">this.vertexColors</span><span class="PUNC">=</span><span class="NAME">THREE.NoColors</span><span class="PUNC">;</span><span class="NAME">this.morphNormals</span><span class="PUNC">=</span><span class="NAME">this.morphTargets</span><span class="PUNC">=</span><span class="NAME">this.skinning</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">this.setValues</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.MeshLambertMaterial.prototype</span><span class="PUNC">=</span><span class="NAME">Object.create</span><span class="PUNC">(</span><span class="NAME">THREE.Material.prototype</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>266</span> </span><span class="NAME">THREE.MeshLambertMaterial.prototype.clone</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.MeshLambertMaterial</span><span class="PUNC">;</span><span class="NAME">THREE.Material.prototype.clone.call</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a.color.copy</span><span class="PUNC">(</span><span class="NAME">this.color</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a.ambient.copy</span><span class="PUNC">(</span><span class="NAME">this.ambient</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a.emissive.copy</span><span class="PUNC">(</span><span class="NAME">this.emissive</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a.wrapAround</span><span class="PUNC">=</span><span class="NAME">this.wrapAround</span><span class="PUNC">;</span><span class="NAME">a.wrapRGB.copy</span><span class="PUNC">(</span><span class="NAME">this.wrapRGB</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a.map</span><span class="PUNC">=</span><span class="NAME">this.map</span><span class="PUNC">;</span><span class="NAME">a.lightMap</span><span class="PUNC">=</span><span class="NAME">this.lightMap</span><span class="PUNC">;</span><span class="NAME">a.specularMap</span><span class="PUNC">=</span><span class="NAME">this.specularMap</span><span class="PUNC">;</span><span class="NAME">a.envMap</span><span class="PUNC">=</span><span class="NAME">this.envMap</span><span class="PUNC">;</span><span class="NAME">a.combine</span><span class="PUNC">=</span><span class="NAME">this.combine</span><span class="PUNC">;</span><span class="NAME">a.reflectivity</span><span class="PUNC">=</span><span class="NAME">this.reflectivity</span><span class="PUNC">;</span><span class="NAME">a.refractionRatio</span><span class="PUNC">=</span><span class="NAME">this.refractionRatio</span><span class="PUNC">;</span><span class="NAME">a.fog</span><span class="PUNC">=</span><span class="NAME">this.fog</span><span class="PUNC">;</span><span class="NAME">a.shading</span><span class="PUNC">=</span><span class="NAME">this.shading</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>267</span> </span><span class="NAME">a.wireframe</span><span class="PUNC">=</span><span class="NAME">this.wireframe</span><span class="PUNC">;</span><span class="NAME">a.wireframeLinewidth</span><span class="PUNC">=</span><span class="NAME">this.wireframeLinewidth</span><span class="PUNC">;</span><span class="NAME">a.wireframeLinecap</span><span class="PUNC">=</span><span class="NAME">this.wireframeLinecap</span><span class="PUNC">;</span><span class="NAME">a.wireframeLinejoin</span><span class="PUNC">=</span><span class="NAME">this.wireframeLinejoin</span><span class="PUNC">;</span><span class="NAME">a.vertexColors</span><span class="PUNC">=</span><span class="NAME">this.vertexColors</span><span class="PUNC">;</span><span class="NAME">a.skinning</span><span class="PUNC">=</span><span class="NAME">this.skinning</span><span class="PUNC">;</span><span class="NAME">a.morphTargets</span><span class="PUNC">=</span><span class="NAME">this.morphTargets</span><span class="PUNC">;</span><span class="NAME">a.morphNormals</span><span class="PUNC">=</span><span class="NAME">this.morphNormals</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.MeshPhongMaterial</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">THREE.Material.call</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.color</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Color</span><span class="PUNC">(</span><span class="NUMB">16777215</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.ambient</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Color</span><span class="PUNC">(</span><span class="NUMB">16777215</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.emissive</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Color</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.specular</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Color</span><span class="PUNC">(</span><span class="NUMB">1118481</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.shininess</span><span class="PUNC">=</span><span class="NUMB">30</span><span class="PUNC">;</span><span class="NAME">this.metal</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">this.perPixel</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">this.wrapAround</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">this.wrapRGB</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">(</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.bumpMap</span><span class="PUNC">=</span><span class="NAME">this.lightMap</span><span class="PUNC">=</span><span class="NAME">this.map</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">;</span><span class="NAME">this.bumpScale</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">this.normalMap</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">;</span><span class="NAME">this.normalScale</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector2</span><span class="PUNC">(</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.envMap</span><span class="PUNC">=</span><span class="NAME">this.specularMap</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">;</span><span class="NAME">this.combine</span><span class="PUNC">=</span><span class="NAME">THREE.MultiplyOperation</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>268</span> </span><span class="NAME">this.reflectivity</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">this.refractionRatio</span><span class="PUNC">=</span><span class="NUMB">0.98</span><span class="PUNC">;</span><span class="NAME">this.fog</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">this.shading</span><span class="PUNC">=</span><span class="NAME">THREE.SmoothShading</span><span class="PUNC">;</span><span class="NAME">this.wireframe</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">this.wireframeLinewidth</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">this.wireframeLinejoin</span><span class="PUNC">=</span><span class="NAME">this.wireframeLinecap</span><span class="PUNC">=</span><span class="STRN">"round"</span><span class="PUNC">;</span><span class="NAME">this.vertexColors</span><span class="PUNC">=</span><span class="NAME">THREE.NoColors</span><span class="PUNC">;</span><span class="NAME">this.morphNormals</span><span class="PUNC">=</span><span class="NAME">this.morphTargets</span><span class="PUNC">=</span><span class="NAME">this.skinning</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">this.setValues</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.MeshPhongMaterial.prototype</span><span class="PUNC">=</span><span class="NAME">Object.create</span><span class="PUNC">(</span><span class="NAME">THREE.Material.prototype</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>269</span> </span><span class="NAME">THREE.MeshPhongMaterial.prototype.clone</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.MeshPhongMaterial</span><span class="PUNC">;</span><span class="NAME">THREE.Material.prototype.clone.call</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a.color.copy</span><span class="PUNC">(</span><span class="NAME">this.color</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a.ambient.copy</span><span class="PUNC">(</span><span class="NAME">this.ambient</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a.emissive.copy</span><span class="PUNC">(</span><span class="NAME">this.emissive</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a.specular.copy</span><span class="PUNC">(</span><span class="NAME">this.specular</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a.shininess</span><span class="PUNC">=</span><span class="NAME">this.shininess</span><span class="PUNC">;</span><span class="NAME">a.metal</span><span class="PUNC">=</span><span class="NAME">this.metal</span><span class="PUNC">;</span><span class="NAME">a.perPixel</span><span class="PUNC">=</span><span class="NAME">this.perPixel</span><span class="PUNC">;</span><span class="NAME">a.wrapAround</span><span class="PUNC">=</span><span class="NAME">this.wrapAround</span><span class="PUNC">;</span><span class="NAME">a.wrapRGB.copy</span><span class="PUNC">(</span><span class="NAME">this.wrapRGB</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a.map</span><span class="PUNC">=</span><span class="NAME">this.map</span><span class="PUNC">;</span><span class="NAME">a.lightMap</span><span class="PUNC">=</span><span class="NAME">this.lightMap</span><span class="PUNC">;</span><span class="NAME">a.bumpMap</span><span class="PUNC">=</span><span class="NAME">this.bumpMap</span><span class="PUNC">;</span><span class="NAME">a.bumpScale</span><span class="PUNC">=</span><span class="NAME">this.bumpScale</span><span class="PUNC">;</span><span class="NAME">a.normalMap</span><span class="PUNC">=</span><span class="NAME">this.normalMap</span><span class="PUNC">;</span><span class="NAME">a.normalScale.copy</span><span class="PUNC">(</span><span class="NAME">this.normalScale</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>270</span> </span><span class="NAME">a.specularMap</span><span class="PUNC">=</span><span class="NAME">this.specularMap</span><span class="PUNC">;</span><span class="NAME">a.envMap</span><span class="PUNC">=</span><span class="NAME">this.envMap</span><span class="PUNC">;</span><span class="NAME">a.combine</span><span class="PUNC">=</span><span class="NAME">this.combine</span><span class="PUNC">;</span><span class="NAME">a.reflectivity</span><span class="PUNC">=</span><span class="NAME">this.reflectivity</span><span class="PUNC">;</span><span class="NAME">a.refractionRatio</span><span class="PUNC">=</span><span class="NAME">this.refractionRatio</span><span class="PUNC">;</span><span class="NAME">a.fog</span><span class="PUNC">=</span><span class="NAME">this.fog</span><span class="PUNC">;</span><span class="NAME">a.shading</span><span class="PUNC">=</span><span class="NAME">this.shading</span><span class="PUNC">;</span><span class="NAME">a.wireframe</span><span class="PUNC">=</span><span class="NAME">this.wireframe</span><span class="PUNC">;</span><span class="NAME">a.wireframeLinewidth</span><span class="PUNC">=</span><span class="NAME">this.wireframeLinewidth</span><span class="PUNC">;</span><span class="NAME">a.wireframeLinecap</span><span class="PUNC">=</span><span class="NAME">this.wireframeLinecap</span><span class="PUNC">;</span><span class="NAME">a.wireframeLinejoin</span><span class="PUNC">=</span><span class="NAME">this.wireframeLinejoin</span><span class="PUNC">;</span><span class="NAME">a.vertexColors</span><span class="PUNC">=</span><span class="NAME">this.vertexColors</span><span class="PUNC">;</span><span class="NAME">a.skinning</span><span class="PUNC">=</span><span class="NAME">this.skinning</span><span class="PUNC">;</span><span class="NAME">a.morphTargets</span><span class="PUNC">=</span><span class="NAME">this.morphTargets</span><span class="PUNC">;</span><span class="NAME">a.morphNormals</span><span class="PUNC">=</span><span class="NAME">this.morphNormals</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.MeshDepthMaterial</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">THREE.Material.call</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.wireframe</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">this.wireframeLinewidth</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">this.setValues</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.MeshDepthMaterial.prototype</span><span class="PUNC">=</span><span class="NAME">Object.create</span><span class="PUNC">(</span><span class="NAME">THREE.Material.prototype</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">THREE.MeshDepthMaterial.prototype.clone</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.MeshDepthMaterial</span><span class="PUNC">;</span><span class="NAME">THREE.Material.prototype.clone.call</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a.wireframe</span><span class="PUNC">=</span><span class="NAME">this.wireframe</span><span class="PUNC">;</span><span class="NAME">a.wireframeLinewidth</span><span class="PUNC">=</span><span class="NAME">this.wireframeLinewidth</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.MeshNormalMaterial</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">THREE.Material.call</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.shading</span><span class="PUNC">=</span><span class="NAME">THREE.FlatShading</span><span class="PUNC">;</span><span class="NAME">this.wireframe</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">this.wireframeLinewidth</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">this.morphTargets</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">this.setValues</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.MeshNormalMaterial.prototype</span><span class="PUNC">=</span><span class="NAME">Object.create</span><span class="PUNC">(</span><span class="NAME">THREE.Material.prototype</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">THREE.MeshNormalMaterial.prototype.clone</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.MeshNormalMaterial</span><span class="PUNC">;</span><span class="NAME">THREE.Material.prototype.clone.call</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a.shading</span><span class="PUNC">=</span><span class="NAME">this.shading</span><span class="PUNC">;</span><span class="NAME">a.wireframe</span><span class="PUNC">=</span><span class="NAME">this.wireframe</span><span class="PUNC">;</span><span class="NAME">a.wireframeLinewidth</span><span class="PUNC">=</span><span class="NAME">this.wireframeLinewidth</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.MeshFaceMaterial</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.materials</span><span class="PUNC">=</span><span class="NAME">a</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">Array</span><span class="PUNC">?</span><span class="NAME">a</span><span class="PUNC">:</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.MeshFaceMaterial.prototype.clone</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.MeshFaceMaterial</span><span class="PUNC">(</span><span class="NAME">this.materials.slice</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.ParticleBasicMaterial</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">THREE.Material.call</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.color</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Color</span><span class="PUNC">(</span><span class="NUMB">16777215</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.map</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">;</span><span class="NAME">this.size</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">this.sizeAttenuation</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">this.vertexColors</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">this.fog</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">this.setValues</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.ParticleBasicMaterial.prototype</span><span class="PUNC">=</span><span class="NAME">Object.create</span><span class="PUNC">(</span><span class="NAME">THREE.Material.prototype</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>271</span> </span><span class="NAME">THREE.ParticleBasicMaterial.prototype.clone</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.ParticleBasicMaterial</span><span class="PUNC">;</span><span class="NAME">THREE.Material.prototype.clone.call</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a.color.copy</span><span class="PUNC">(</span><span class="NAME">this.color</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a.map</span><span class="PUNC">=</span><span class="NAME">this.map</span><span class="PUNC">;</span><span class="NAME">a.size</span><span class="PUNC">=</span><span class="NAME">this.size</span><span class="PUNC">;</span><span class="NAME">a.sizeAttenuation</span><span class="PUNC">=</span><span class="NAME">this.sizeAttenuation</span><span class="PUNC">;</span><span class="NAME">a.vertexColors</span><span class="PUNC">=</span><span class="NAME">this.vertexColors</span><span class="PUNC">;</span><span class="NAME">a.fog</span><span class="PUNC">=</span><span class="NAME">this.fog</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.ParticleCanvasMaterial</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">THREE.Material.call</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.color</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Color</span><span class="PUNC">(</span><span class="NUMB">16777215</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.program</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">this.setValues</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.ParticleCanvasMaterial.prototype</span><span class="PUNC">=</span><span class="NAME">Object.create</span><span class="PUNC">(</span><span class="NAME">THREE.Material.prototype</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">THREE.ParticleCanvasMaterial.prototype.clone</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.ParticleCanvasMaterial</span><span class="PUNC">;</span><span class="NAME">THREE.Material.prototype.clone.call</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a.color.copy</span><span class="PUNC">(</span><span class="NAME">this.color</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a.program</span><span class="PUNC">=</span><span class="NAME">this.program</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.ShaderMaterial</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">THREE.Material.call</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.vertexShader</span><span class="PUNC">=</span><span class="NAME">this.fragmentShader</span><span class="PUNC">=</span><span class="STRN">"void main() {}"</span><span class="PUNC">;</span><span class="NAME">this.uniforms</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">this.defines</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">this.attributes</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">;</span><span class="NAME">this.shading</span><span class="PUNC">=</span><span class="NAME">THREE.SmoothShading</span><span class="PUNC">;</span><span class="NAME">this.linewidth</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">this.wireframe</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">this.wireframeLinewidth</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">this.lights</span><span class="PUNC">=</span><span class="NAME">this.fog</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">this.vertexColors</span><span class="PUNC">=</span><span class="NAME">THREE.NoColors</span><span class="PUNC">;</span><span class="NAME">this.morphNormals</span><span class="PUNC">=</span><span class="NAME">this.morphTargets</span><span class="PUNC">=</span><span class="NAME">this.skinning</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">this.setValues</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.ShaderMaterial.prototype</span><span class="PUNC">=</span><span class="NAME">Object.create</span><span class="PUNC">(</span><span class="NAME">THREE.Material.prototype</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>272</span> </span><span class="NAME">THREE.ShaderMaterial.prototype.clone</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.ShaderMaterial</span><span class="PUNC">;</span><span class="NAME">THREE.Material.prototype.clone.call</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a.fragmentShader</span><span class="PUNC">=</span><span class="NAME">this.fragmentShader</span><span class="PUNC">;</span><span class="NAME">a.vertexShader</span><span class="PUNC">=</span><span class="NAME">this.vertexShader</span><span class="PUNC">;</span><span class="NAME">a.uniforms</span><span class="PUNC">=</span><span class="NAME">THREE.UniformsUtils.clone</span><span class="PUNC">(</span><span class="NAME">this.uniforms</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a.attributes</span><span class="PUNC">=</span><span class="NAME">this.attributes</span><span class="PUNC">;</span><span class="NAME">a.defines</span><span class="PUNC">=</span><span class="NAME">this.defines</span><span class="PUNC">;</span><span class="NAME">a.shading</span><span class="PUNC">=</span><span class="NAME">this.shading</span><span class="PUNC">;</span><span class="NAME">a.wireframe</span><span class="PUNC">=</span><span class="NAME">this.wireframe</span><span class="PUNC">;</span><span class="NAME">a.wireframeLinewidth</span><span class="PUNC">=</span><span class="NAME">this.wireframeLinewidth</span><span class="PUNC">;</span><span class="NAME">a.fog</span><span class="PUNC">=</span><span class="NAME">this.fog</span><span class="PUNC">;</span><span class="NAME">a.lights</span><span class="PUNC">=</span><span class="NAME">this.lights</span><span class="PUNC">;</span><span class="NAME">a.vertexColors</span><span class="PUNC">=</span><span class="NAME">this.vertexColors</span><span class="PUNC">;</span><span class="NAME">a.skinning</span><span class="PUNC">=</span><span class="NAME">this.skinning</span><span class="PUNC">;</span><span class="NAME">a.morphTargets</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>273</span> </span><span class="NAME">this.morphTargets</span><span class="PUNC">;</span><span class="NAME">a.morphNormals</span><span class="PUNC">=</span><span class="NAME">this.morphNormals</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.SpriteMaterial</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">THREE.Material.call</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.color</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Color</span><span class="PUNC">(</span><span class="NUMB">16777215</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.map</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Texture</span><span class="PUNC">;</span><span class="NAME">this.useScreenCoordinates</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">this.depthTest</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NAME">this.useScreenCoordinates</span><span class="PUNC">;</span><span class="NAME">this.sizeAttenuation</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NAME">this.useScreenCoordinates</span><span class="PUNC">;</span><span class="NAME">this.scaleByViewport</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NAME">this.sizeAttenuation</span><span class="PUNC">;</span><span class="NAME">this.alignment</span><span class="PUNC">=</span><span class="NAME">THREE.SpriteAlignment.center.clone</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.fog</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">this.uvOffset</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector2</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.uvScale</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector2</span><span class="PUNC">(</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.setValues</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">||</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">===</span><span class="NAME">a.depthTest</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">this.depthTest</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NAME">this.useScreenCoordinates</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>274</span> </span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">===</span><span class="NAME">a.sizeAttenuation</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">this.sizeAttenuation</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NAME">this.useScreenCoordinates</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">===</span><span class="NAME">a.scaleByViewport</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">this.scaleByViewport</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NAME">this.sizeAttenuation</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.SpriteMaterial.prototype</span><span class="PUNC">=</span><span class="NAME">Object.create</span><span class="PUNC">(</span><span class="NAME">THREE.Material.prototype</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>275</span> </span><span class="NAME">THREE.SpriteMaterial.prototype.clone</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.SpriteMaterial</span><span class="PUNC">;</span><span class="NAME">THREE.Material.prototype.clone.call</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a.color.copy</span><span class="PUNC">(</span><span class="NAME">this.color</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a.map</span><span class="PUNC">=</span><span class="NAME">this.map</span><span class="PUNC">;</span><span class="NAME">a.useScreenCoordinates</span><span class="PUNC">=</span><span class="NAME">this.useScreenCoordinates</span><span class="PUNC">;</span><span class="NAME">a.sizeAttenuation</span><span class="PUNC">=</span><span class="NAME">this.sizeAttenuation</span><span class="PUNC">;</span><span class="NAME">a.scaleByViewport</span><span class="PUNC">=</span><span class="NAME">this.scaleByViewport</span><span class="PUNC">;</span><span class="NAME">a.alignment.copy</span><span class="PUNC">(</span><span class="NAME">this.alignment</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a.uvOffset.copy</span><span class="PUNC">(</span><span class="NAME">this.uvOffset</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a.uvScale.copy</span><span class="PUNC">(</span><span class="NAME">this.uvScale</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a.fog</span><span class="PUNC">=</span><span class="NAME">this.fog</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.SpriteAlignment</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.SpriteAlignment.topLeft</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector2</span><span class="PUNC">(</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>276</span> </span><span class="NAME">THREE.SpriteAlignment.topCenter</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector2</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">THREE.SpriteAlignment.topRight</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector2</span><span class="PUNC">(</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">THREE.SpriteAlignment.centerLeft</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector2</span><span class="PUNC">(</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">THREE.SpriteAlignment.center</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector2</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">THREE.SpriteAlignment.centerRight</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector2</span><span class="PUNC">(</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">THREE.SpriteAlignment.bottomLeft</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector2</span><span class="PUNC">(</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">THREE.SpriteAlignment.bottomCenter</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector2</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">THREE.SpriteAlignment.bottomRight</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector2</span><span class="PUNC">(</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">THREE.Texture</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.id</span><span class="PUNC">=</span><span class="NAME">THREE.TextureIdCount</span><span class="PUNC">++</span><span class="PUNC">;</span><span class="NAME">this.uuid</span><span class="PUNC">=</span><span class="NAME">THREE.Math.generateUUID</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.name</span><span class="PUNC">=</span><span class="STRN">""</span><span class="PUNC">;</span><span class="NAME">this.image</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">this.mipmaps</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">this.mapping</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">b</span><span class="PUNC">?</span><span class="NAME">b</span><span class="PUNC">:</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.UVMapping</span><span class="PUNC">;</span><span class="NAME">this.wrapS</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">c</span><span class="PUNC">?</span><span class="NAME">c</span><span class="PUNC">:</span><span class="NAME">THREE.ClampToEdgeWrapping</span><span class="PUNC">;</span><span class="NAME">this.wrapT</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">d</span><span class="PUNC">?</span><span class="NAME">d</span><span class="PUNC">:</span><span class="NAME">THREE.ClampToEdgeWrapping</span><span class="PUNC">;</span><span class="NAME">this.magFilter</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">e</span><span class="PUNC">?</span><span class="NAME">e</span><span class="PUNC">:</span><span class="NAME">THREE.LinearFilter</span><span class="PUNC">;</span><span class="NAME">this.minFilter</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">f</span><span class="PUNC">?</span><span class="NAME">f</span><span class="PUNC">:</span><span class="NAME">THREE.LinearMipMapLinearFilter</span><span class="PUNC">;</span><span class="NAME">this.anisotropy</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">i</span><span class="PUNC">?</span><span class="NAME">i</span><span class="PUNC">:</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">this.format</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">h</span><span class="PUNC">?</span><span class="NAME">h</span><span class="PUNC">:</span><span class="NAME">THREE.RGBAFormat</span><span class="PUNC">;</span><span class="NAME">this.type</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">g</span><span class="PUNC">?</span><span class="NAME">g</span><span class="PUNC">:</span><span class="NAME">THREE.UnsignedByteType</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>277</span> </span><span class="NAME">this.offset</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector2</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.repeat</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector2</span><span class="PUNC">(</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.generateMipmaps</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">this.premultiplyAlpha</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">this.flipY</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">this.unpackAlignment</span><span class="PUNC">=</span><span class="NUMB">4</span><span class="PUNC">;</span><span class="NAME">this.needsUpdate</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">this.onUpdate</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>278</span> </span><span class="NAME">THREE.Texture.prototype</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="NAME">constructor</span><span class="PUNC">:</span><span class="NAME">THREE.Texture</span><span class="PUNC">,</span><span class="NAME">clone</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">===</span><span class="NAME">a</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Texture</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a.image</span><span class="PUNC">=</span><span class="NAME">this.image</span><span class="PUNC">;</span><span class="NAME">a.mipmaps</span><span class="PUNC">=</span><span class="NAME">this.mipmaps.slice</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a.mapping</span><span class="PUNC">=</span><span class="NAME">this.mapping</span><span class="PUNC">;</span><span class="NAME">a.wrapS</span><span class="PUNC">=</span><span class="NAME">this.wrapS</span><span class="PUNC">;</span><span class="NAME">a.wrapT</span><span class="PUNC">=</span><span class="NAME">this.wrapT</span><span class="PUNC">;</span><span class="NAME">a.magFilter</span><span class="PUNC">=</span><span class="NAME">this.magFilter</span><span class="PUNC">;</span><span class="NAME">a.minFilter</span><span class="PUNC">=</span><span class="NAME">this.minFilter</span><span class="PUNC">;</span><span class="NAME">a.anisotropy</span><span class="PUNC">=</span><span class="NAME">this.anisotropy</span><span class="PUNC">;</span><span class="NAME">a.format</span><span class="PUNC">=</span><span class="NAME">this.format</span><span class="PUNC">;</span><span class="NAME">a.type</span><span class="PUNC">=</span><span class="NAME">this.type</span><span class="PUNC">;</span><span class="NAME">a.offset.copy</span><span class="PUNC">(</span><span class="NAME">this.offset</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a.repeat.copy</span><span class="PUNC">(</span><span class="NAME">this.repeat</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a.generateMipmaps</span><span class="PUNC">=</span><span class="NAME">this.generateMipmaps</span><span class="PUNC">;</span><span class="NAME">a.premultiplyAlpha</span><span class="PUNC">=</span><span class="NAME">this.premultiplyAlpha</span><span class="PUNC">;</span><span class="NAME">a.flipY</span><span class="PUNC">=</span><span class="NAME">this.flipY</span><span class="PUNC">;</span><span class="NAME">a.unpackAlignment</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>279</span> </span><span class="NAME">this.unpackAlignment</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">dispose</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.dispatchEvent</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">type</span><span class="PUNC">:</span><span class="STRN">"dispose"</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.EventDispatcher.prototype.apply</span><span class="PUNC">(</span><span class="NAME">THREE.Texture.prototype</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">THREE.TextureIdCount</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">THREE.CompressedTexture</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">,</span><span class="NAME">j</span><span class="PUNC">,</span><span class="NAME">l</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">THREE.Texture.call</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">,</span><span class="NAME">j</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">l</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.image</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="NAME">width</span><span class="PUNC">:</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">height</span><span class="PUNC">:</span><span class="NAME">c</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">this.mipmaps</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">this.generateMipmaps</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.CompressedTexture.prototype</span><span class="PUNC">=</span><span class="NAME">Object.create</span><span class="PUNC">(</span><span class="NAME">THREE.Texture.prototype</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">THREE.CompressedTexture.prototype.clone</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.CompressedTexture</span><span class="PUNC">;</span><span class="NAME">THREE.Texture.prototype.clone.call</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.DataTexture</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">,</span><span class="NAME">j</span><span class="PUNC">,</span><span class="NAME">l</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">THREE.Texture.call</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">,</span><span class="NAME">j</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">l</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.image</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="NAME">data</span><span class="PUNC">:</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">width</span><span class="PUNC">:</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">height</span><span class="PUNC">:</span><span class="NAME">c</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.DataTexture.prototype</span><span class="PUNC">=</span><span class="NAME">Object.create</span><span class="PUNC">(</span><span class="NAME">THREE.Texture.prototype</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">THREE.DataTexture.prototype.clone</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.DataTexture</span><span class="PUNC">;</span><span class="NAME">THREE.Texture.prototype.clone.call</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.Particle</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">THREE.Object3D.call</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.material</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.Particle.prototype</span><span class="PUNC">=</span><span class="NAME">Object.create</span><span class="PUNC">(</span><span class="NAME">THREE.Object3D.prototype</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">THREE.Particle.prototype.clone</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">===</span><span class="NAME">a</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Particle</span><span class="PUNC">(</span><span class="NAME">this.material</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">THREE.Object3D.prototype.clone.call</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.ParticleSystem</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">THREE.Object3D.call</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.geometry</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">a</span><span class="PUNC">?</span><span class="NAME">a</span><span class="PUNC">:</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Geometry</span><span class="PUNC">;</span><span class="NAME">this.material</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">b</span><span class="PUNC">?</span><span class="NAME">b</span><span class="PUNC">:</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.ParticleBasicMaterial</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">color</span><span class="PUNC">:</span><span class="NUMB">16777215</span><span class="PUNC">*</span><span class="NAME">Math.random</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.frustumCulled</span><span class="PUNC">=</span><span class="NAME">this.sortParticles</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.ParticleSystem.prototype</span><span class="PUNC">=</span><span class="NAME">Object.create</span><span class="PUNC">(</span><span class="NAME">THREE.Object3D.prototype</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>280</span> </span><span class="NAME">THREE.ParticleSystem.prototype.clone</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">===</span><span class="NAME">a</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.ParticleSystem</span><span class="PUNC">(</span><span class="NAME">this.geometry</span><span class="PUNC">,</span><span class="NAME">this.material</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a.sortParticles</span><span class="PUNC">=</span><span class="NAME">this.sortParticles</span><span class="PUNC">;</span><span class="NAME">THREE.Object3D.prototype.clone.call</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.Line</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">THREE.Object3D.call</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.geometry</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">a</span><span class="PUNC">?</span><span class="NAME">a</span><span class="PUNC">:</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Geometry</span><span class="PUNC">;</span><span class="NAME">this.material</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">b</span><span class="PUNC">?</span><span class="NAME">b</span><span class="PUNC">:</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.LineBasicMaterial</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">color</span><span class="PUNC">:</span><span class="NUMB">16777215</span><span class="PUNC">*</span><span class="NAME">Math.random</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.type</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">c</span><span class="PUNC">?</span><span class="NAME">c</span><span class="PUNC">:</span><span class="NAME">THREE.LineStrip</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.LineStrip</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">THREE.LinePieces</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">THREE.Line.prototype</span><span class="PUNC">=</span><span class="NAME">Object.create</span><span class="PUNC">(</span><span class="NAME">THREE.Object3D.prototype</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">THREE.Line.prototype.clone</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">===</span><span class="NAME">a</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Line</span><span class="PUNC">(</span><span class="NAME">this.geometry</span><span class="PUNC">,</span><span class="NAME">this.material</span><span class="PUNC">,</span><span class="NAME">this.type</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">THREE.Object3D.prototype.clone.call</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.Mesh</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">THREE.Object3D.call</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.geometry</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">a</span><span class="PUNC">?</span><span class="NAME">a</span><span class="PUNC">:</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Geometry</span><span class="PUNC">;</span><span class="NAME">this.material</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">b</span><span class="PUNC">?</span><span class="NAME">b</span><span class="PUNC">:</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.MeshBasicMaterial</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">color</span><span class="PUNC">:</span><span class="NUMB">16777215</span><span class="PUNC">*</span><span class="NAME">Math.random</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.updateMorphTargets</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.Mesh.prototype</span><span class="PUNC">=</span><span class="NAME">Object.create</span><span class="PUNC">(</span><span class="NAME">THREE.Object3D.prototype</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>281</span> </span><span class="NAME">THREE.Mesh.prototype.updateMorphTargets</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">&lt;</span><span class="NAME">this.geometry.morphTargets.length</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.morphTargetBase</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">this.morphTargetForcedOrder</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">this.morphTargetInfluences</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">this.morphTargetDictionary</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.geometry.morphTargets.length</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">&lt;</span><span class="NAME">b</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">this.morphTargetInfluences.push</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this.morphTargetDictionary</span><span class="PUNC">[</span><span class="NAME">this.geometry.morphTargets</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">name</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>282</span> </span><span class="NAME">THREE.Mesh.prototype.getMorphTargetIndexByName</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">this.morphTargetDictionary</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.morphTargetDictionary</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">console.log</span><span class="PUNC">(</span><span class="STRN">"THREE.Mesh.getMorphTargetIndexByName: morph target "</span><span class="PUNC">+</span><span class="NAME">a</span><span class="PUNC">+</span><span class="STRN">" does not exist. Returning 0."</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.Mesh.prototype.clone</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">===</span><span class="NAME">a</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Mesh</span><span class="PUNC">(</span><span class="NAME">this.geometry</span><span class="PUNC">,</span><span class="NAME">this.material</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">THREE.Object3D.prototype.clone.call</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.Bone</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">THREE.Object3D.call</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.skin</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">this.skinMatrix</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Matrix4</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.Bone.prototype</span><span class="PUNC">=</span><span class="NAME">Object.create</span><span class="PUNC">(</span><span class="NAME">THREE.Object3D.prototype</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">THREE.Bone.prototype.update</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.matrixAutoUpdate</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">|</span><span class="PUNC">=</span><span class="NAME">this.updateMatrix</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">||</span><span class="NAME">this.matrixWorldNeedsUpdate</span><span class="PUNC">)</span><span class="NAME">a</span><span class="PUNC">?</span><span class="NAME">this.skinMatrix.multiplyMatrices</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">this.matrix</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">this.skinMatrix.copy</span><span class="PUNC">(</span><span class="NAME">this.matrix</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this.matrixWorldNeedsUpdate</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">this.children.length</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">&lt;</span><span class="NAME">d</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">this.children</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">update</span><span class="PUNC">(</span><span class="NAME">this.skinMatrix</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.SkinnedMesh</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">THREE.Mesh.call</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.useVertexTexture</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">c</span><span class="PUNC">?</span><span class="NAME">c</span><span class="PUNC">:</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">this.identityMatrix</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Matrix4</span><span class="PUNC">;</span><span class="NAME">this.bones</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">this.boneMatrices</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.geometry</span><span class="PUNC">&&</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">this.geometry.bones</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">&lt;</span><span class="NAME">this.geometry.bones.length</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.geometry.bones</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">c.pos</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">c.rotq</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">c.scl</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.addBone</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">b.name</span><span class="PUNC">=</span><span class="NAME">c.name</span><span class="PUNC">,</span><span class="NAME">b.position.set</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">[</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">b.quaternion.set</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">[</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">[</span><span class="NUMB">3</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">f</span><span class="PUNC">?</span><span class="NAME">b.scale.set</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">[</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">b.scale.set</span><span class="PUNC">(</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">&lt;</span><span class="NAME">this.bones.length</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">c</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>283</span> </span><span class="NAME">this.geometry.bones</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.bones</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">===</span><span class="NAME">c.parent</span><span class="PUNC">?</span><span class="NAME">this.add</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">this.bones</span><span class="PUNC">[</span><span class="NAME">c.parent</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">add</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">this.bones.length</span><span class="PUNC">;</span><span class="NAME">this.useVertexTexture</span><span class="PUNC">?</span><span class="PUNC">(</span><span class="NAME">this.boneTextureHeight</span><span class="PUNC">=</span><span class="NAME">this.boneTextureWidth</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NUMB">256</span><span class="PUNC">&lt;</span><span class="NAME">a</span><span class="PUNC">?</span><span class="NUMB">64</span><span class="PUNC">:</span><span class="NUMB">64</span><span class="PUNC">&lt;</span><span class="NAME">a</span><span class="PUNC">?</span><span class="NUMB">32</span><span class="PUNC">:</span><span class="NUMB">16</span><span class="PUNC">&lt;</span><span class="NAME">a</span><span class="PUNC">?</span><span class="NUMB">16</span><span class="PUNC">:</span><span class="NUMB">8</span><span class="PUNC">,</span><span class="NAME">this.boneMatrices</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Float32Array</span><span class="PUNC">(</span><span class="NUMB">4</span><span class="PUNC">*</span><span class="NAME">this.boneTextureWidth</span><span class="PUNC">*</span><span class="NAME">this.boneTextureHeight</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this.boneTexture</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.DataTexture</span><span class="PUNC">(</span><span class="NAME">this.boneMatrices</span><span class="PUNC">,</span><span class="NAME">this.boneTextureWidth</span><span class="PUNC">,</span><span class="NAME">this.boneTextureHeight</span><span class="PUNC">,</span><span class="NAME">THREE.RGBAFormat</span><span class="PUNC">,</span><span class="NAME">THREE.FloatType</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this.boneTexture.minFilter</span><span class="PUNC">=</span><span class="NAME">THREE.NearestFilter</span><span class="PUNC">,</span><span class="NAME">this.boneTexture.magFilter</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>284</span> </span><span class="NAME">THREE.NearestFilter</span><span class="PUNC">,</span><span class="NAME">this.boneTexture.generateMipmaps</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">this.boneTexture.flipY</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">this.boneMatrices</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Float32Array</span><span class="PUNC">(</span><span class="NUMB">16</span><span class="PUNC">*</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.pose</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.SkinnedMesh.prototype</span><span class="PUNC">=</span><span class="NAME">Object.create</span><span class="PUNC">(</span><span class="NAME">THREE.Mesh.prototype</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">THREE.SkinnedMesh.prototype.addBone</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">===</span><span class="NAME">a</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Bone</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.bones.push</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>285</span> </span><span class="NAME">THREE.SkinnedMesh.prototype.updateMatrixWorld</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Matrix4</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.matrixAutoUpdate</span><span class="PUNC">&&</span><span class="NAME">this.updateMatrix</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.matrixWorldNeedsUpdate</span><span class="PUNC">||</span><span class="NAME">b</span><span class="PUNC">)</span><span class="NAME">this.parent</span><span class="PUNC">?</span><span class="NAME">this.matrixWorld.multiplyMatrices</span><span class="PUNC">(</span><span class="NAME">this.parent.matrixWorld</span><span class="PUNC">,</span><span class="NAME">this.matrix</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">this.matrixWorld.copy</span><span class="PUNC">(</span><span class="NAME">this.matrix</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this.matrixWorldNeedsUpdate</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.children.length</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">&lt;</span><span class="NAME">c</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">this.children</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">d</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">THREE.Bone</span><span class="PUNC">?</span><span class="NAME">d.update</span><span class="PUNC">(</span><span class="NAME">this.identityMatrix</span><span class="PUNC">,</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">d.updateMatrixWorld</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">==</span><span class="NAME">this.boneInverses</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.boneInverses</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>286</span> </span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.bones.length</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">&lt;</span><span class="NAME">c</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">d</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Matrix4</span><span class="PUNC">,</span><span class="NAME">d.getInverse</span><span class="PUNC">(</span><span class="NAME">this.bones</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">skinMatrix</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this.boneInverses.push</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.bones.length</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">&lt;</span><span class="NAME">c</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">a.multiplyMatrices</span><span class="PUNC">(</span><span class="NAME">this.bones</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">skinMatrix</span><span class="PUNC">,</span><span class="NAME">this.boneInverses</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">a.flattenToArrayOffset</span><span class="PUNC">(</span><span class="NAME">this.boneMatrices</span><span class="PUNC">,</span><span class="NUMB">16</span><span class="PUNC">*</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.useVertexTexture</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">this.boneTexture.needsUpdate</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">THREE.SkinnedMesh.prototype.pose</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.updateMatrixWorld</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.normalizeSkinWeights</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>287</span> </span><span class="NAME">THREE.SkinnedMesh.prototype.normalizeSkinWeights</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.geometry</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">THREE.Geometry</span><span class="PUNC">)</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">&lt;</span><span class="NAME">this.geometry.skinIndices.length</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.geometry.skinWeights</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">/</span><span class="NAME">b.lengthManhattan</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">Infinity</span><span class="PUNC">!==</span><span class="NAME">c</span><span class="PUNC">?</span><span class="NAME">b.multiplyScalar</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">b.set</span><span class="PUNC">(</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.SkinnedMesh.prototype.clone</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">===</span><span class="NAME">a</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.SkinnedMesh</span><span class="PUNC">(</span><span class="NAME">this.geometry</span><span class="PUNC">,</span><span class="NAME">this.material</span><span class="PUNC">,</span><span class="NAME">this.useVertexTexture</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">THREE.Mesh.prototype.clone.call</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.MorphAnimMesh</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">THREE.Mesh.call</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.duration</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="NAME">E3</span><span class="PUNC">;</span><span class="NAME">this.mirroredLoop</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">this.currentKeyframe</span><span class="PUNC">=</span><span class="NAME">this.lastKeyframe</span><span class="PUNC">=</span><span class="NAME">this.time</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">this.direction</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">this.directionBackwards</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">this.setFrameRange</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">this.geometry.morphTargets.length</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.MorphAnimMesh.prototype</span><span class="PUNC">=</span><span class="NAME">Object.create</span><span class="PUNC">(</span><span class="NAME">THREE.Mesh.prototype</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">THREE.MorphAnimMesh.prototype.setFrameRange</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.startKeyframe</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">this.endKeyframe</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">;</span><span class="NAME">this.length</span><span class="PUNC">=</span><span class="NAME">this.endKeyframe</span><span class="PUNC">-</span><span class="NAME">this.startKeyframe</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>288</span> </span><span class="NAME">THREE.MorphAnimMesh.prototype.setDirectionForward</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.direction</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">this.directionBackwards</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.MorphAnimMesh.prototype.setDirectionBackward</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.direction</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">this.directionBackwards</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>289</span> </span><span class="NAME">THREE.MorphAnimMesh.prototype.parseAnimations</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">this.geometry</span><span class="PUNC">;</span><span class="NAME">a.animations</span><span class="PUNC">||</span><span class="PUNC">(</span><span class="NAME">a.animations</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">a.animations</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="REGX">/([a-z]+)(\d+)/</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">a.morphTargets.length</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">&lt;</span><span class="NAME">f</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">a.morphTargets</span><span class="PUNC">[</span><span class="NAME">e</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">name.match</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">h</span><span class="PUNC">&&</span><span class="NUMB">1</span><span class="PUNC">&lt;</span><span class="NAME">h.length</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">h</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NAME">h</span><span class="PUNC">]</span><span class="PUNC">||</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NAME">h</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="NAME">start</span><span class="PUNC">:</span><span class="NAME">Infinity</span><span class="PUNC">,</span><span class="NAME">end</span><span class="PUNC">:</span><span class="PUNC">-</span><span class="NAME">Infinity</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NAME">h</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">&lt;</span><span class="NAME">g.start</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">g.start</span><span class="PUNC">=</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">></span><span class="NAME">g.end</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">g.end</span><span class="PUNC">=</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">||</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">h</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="NAME">a.firstAnimation</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>290</span> </span><span class="NAME">THREE.MorphAnimMesh.prototype.setAnimationLabel</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.geometry.animations</span><span class="PUNC">||</span><span class="PUNC">(</span><span class="NAME">this.geometry.animations</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.geometry.animations</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="NAME">start</span><span class="PUNC">:</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">end</span><span class="PUNC">:</span><span class="NAME">c</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.MorphAnimMesh.prototype.playAnimation</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.geometry.animations</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">?</span><span class="PUNC">(</span><span class="NAME">this.setFrameRange</span><span class="PUNC">(</span><span class="NAME">c.start</span><span class="PUNC">,</span><span class="NAME">c.end</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this.duration</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="NAME">E3</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="PUNC">(</span><span class="NAME">c.end</span><span class="PUNC">-</span><span class="NAME">c.start</span><span class="PUNC">)</span><span class="PUNC">/</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this.time</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">console.warn</span><span class="PUNC">(</span><span class="STRN">"animation["</span><span class="PUNC">+</span><span class="NAME">a</span><span class="PUNC">+</span><span class="STRN">"] undefined"</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>291</span> </span><span class="NAME">THREE.MorphAnimMesh.prototype.updateAnimation</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.duration</span><span class="PUNC">/</span><span class="NAME">this.length</span><span class="PUNC">;</span><span class="NAME">this.time</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">this.direction</span><span class="PUNC">*</span><span class="NAME">a</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.mirroredLoop</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.time</span><span class="PUNC">></span><span class="NAME">this.duration</span><span class="PUNC">||</span><span class="NUMB">0</span><span class="PUNC">></span><span class="NAME">this.time</span><span class="PUNC">)</span><span class="NAME">this.direction</span><span class="PUNC">*</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">this.time</span><span class="PUNC">></span><span class="NAME">this.duration</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">this.time</span><span class="PUNC">=</span><span class="NAME">this.duration</span><span class="PUNC">,</span><span class="NAME">this.directionBackwards</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">></span><span class="NAME">this.time</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">this.time</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">this.directionBackwards</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="NAME">this.time</span><span class="PUNC">%</span><span class="PUNC">=</span><span class="NAME">this.duration</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">></span><span class="NAME">this.time</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">this.time</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">this.duration</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">this.startKeyframe</span><span class="PUNC">+</span><span class="NAME">THREE.Math.clamp</span><span class="PUNC">(</span><span class="NAME">Math.floor</span><span class="PUNC">(</span><span class="NAME">this.time</span><span class="PUNC">/</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">this.length</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">!==</span><span class="NAME">this.currentKeyframe</span><span class="PUNC">&&</span><span class="WHIT">
<span class='line'>292</span> </span><span class="PUNC">(</span><span class="NAME">this.morphTargetInfluences</span><span class="PUNC">[</span><span class="NAME">this.lastKeyframe</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">this.morphTargetInfluences</span><span class="PUNC">[</span><span class="NAME">this.currentKeyframe</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">this.morphTargetInfluences</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">this.lastKeyframe</span><span class="PUNC">=</span><span class="NAME">this.currentKeyframe</span><span class="PUNC">,</span><span class="NAME">this.currentKeyframe</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.time</span><span class="PUNC">%</span><span class="NAME">b</span><span class="PUNC">/</span><span class="NAME">b</span><span class="PUNC">;</span><span class="NAME">this.directionBackwards</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">-</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.morphTargetInfluences</span><span class="PUNC">[</span><span class="NAME">this.currentKeyframe</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">;</span><span class="NAME">this.morphTargetInfluences</span><span class="PUNC">[</span><span class="NAME">this.lastKeyframe</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">-</span><span class="NAME">b</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>293</span> </span><span class="NAME">THREE.MorphAnimMesh.prototype.clone</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">===</span><span class="NAME">a</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.MorphAnimMesh</span><span class="PUNC">(</span><span class="NAME">this.geometry</span><span class="PUNC">,</span><span class="NAME">this.material</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a.duration</span><span class="PUNC">=</span><span class="NAME">this.duration</span><span class="PUNC">;</span><span class="NAME">a.mirroredLoop</span><span class="PUNC">=</span><span class="NAME">this.mirroredLoop</span><span class="PUNC">;</span><span class="NAME">a.time</span><span class="PUNC">=</span><span class="NAME">this.time</span><span class="PUNC">;</span><span class="NAME">a.lastKeyframe</span><span class="PUNC">=</span><span class="NAME">this.lastKeyframe</span><span class="PUNC">;</span><span class="NAME">a.currentKeyframe</span><span class="PUNC">=</span><span class="NAME">this.currentKeyframe</span><span class="PUNC">;</span><span class="NAME">a.direction</span><span class="PUNC">=</span><span class="NAME">this.direction</span><span class="PUNC">;</span><span class="NAME">a.directionBackwards</span><span class="PUNC">=</span><span class="NAME">this.directionBackwards</span><span class="PUNC">;</span><span class="NAME">THREE.Mesh.prototype.clone.call</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.Ribbon</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">THREE.Object3D.call</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.geometry</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">this.material</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.Ribbon.prototype</span><span class="PUNC">=</span><span class="NAME">Object.create</span><span class="PUNC">(</span><span class="NAME">THREE.Object3D.prototype</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">THREE.Ribbon.prototype.clone</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">===</span><span class="NAME">a</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Ribbon</span><span class="PUNC">(</span><span class="NAME">this.geometry</span><span class="PUNC">,</span><span class="NAME">this.material</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">THREE.Object3D.prototype.clone.call</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.LOD</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">THREE.Object3D.call</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.objects</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.LOD.prototype</span><span class="PUNC">=</span><span class="NAME">Object.create</span><span class="PUNC">(</span><span class="NAME">THREE.Object3D.prototype</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">THREE.LOD.prototype.addLevel</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">===</span><span class="NAME">b</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">Math.abs</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">&lt;</span><span class="NAME">this.objects.length</span><span class="PUNC">&&</span><span class="PUNC">!</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">&lt;</span><span class="NAME">this.objects</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">distance</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.objects.splice</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="PUNC">{</span><span class="NAME">distance</span><span class="PUNC">:</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">object</span><span class="PUNC">:</span><span class="NAME">a</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.add</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.LOD.prototype.getObjectForDistance</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.objects.length</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">&lt;</span><span class="NAME">c</span><span class="PUNC">&&</span><span class="PUNC">!</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">&lt;</span><span class="NAME">this.objects</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">distance</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.objects</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">object</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>294</span> </span><span class="NAME">THREE.LOD.prototype.update</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NUMB">1</span><span class="PUNC">&lt;</span><span class="NAME">this.objects.length</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">a.getPositionFromMatrix</span><span class="PUNC">(</span><span class="NAME">c.matrixWorld</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b.getPositionFromMatrix</span><span class="PUNC">(</span><span class="NAME">this.matrixWorld</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">a.distanceTo</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.objects</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">object.visible</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">this.objects.length</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">&lt;</span><span class="NAME">e</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">>=</span><span class="NAME">this.objects</span><span class="PUNC">[</span><span class="NAME">d</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">distance</span><span class="PUNC">)</span><span class="NAME">this.objects</span><span class="PUNC">[</span><span class="NAME">d</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">object.visible</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">this.objects</span><span class="PUNC">[</span><span class="NAME">d</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">object.visible</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">break</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">&lt;</span><span class="NAME">e</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">this.objects</span><span class="PUNC">[</span><span class="NAME">d</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">object.visible</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">THREE.LOD.prototype.clone</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.Sprite</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">THREE.Object3D.call</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.material</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">a</span><span class="PUNC">?</span><span class="NAME">a</span><span class="PUNC">:</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.SpriteMaterial</span><span class="PUNC">;</span><span class="NAME">this.rotation3d</span><span class="PUNC">=</span><span class="NAME">this.rotation</span><span class="PUNC">;</span><span class="NAME">this.rotation</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.Sprite.prototype</span><span class="PUNC">=</span><span class="NAME">Object.create</span><span class="PUNC">(</span><span class="NAME">THREE.Object3D.prototype</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">THREE.Sprite.prototype.updateMatrix</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.rotation3d.set</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">this.rotation</span><span class="PUNC">,</span><span class="NAME">this.rotation3d.order</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.quaternion.setFromEuler</span><span class="PUNC">(</span><span class="NAME">this.rotation3d</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.matrix.compose</span><span class="PUNC">(</span><span class="NAME">this.position</span><span class="PUNC">,</span><span class="NAME">this.quaternion</span><span class="PUNC">,</span><span class="NAME">this.scale</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.matrixWorldNeedsUpdate</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>295</span> </span><span class="NAME">THREE.Sprite.prototype.clone</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">===</span><span class="NAME">a</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Sprite</span><span class="PUNC">(</span><span class="NAME">this.material</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">THREE.Object3D.prototype.clone.call</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.Scene</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">THREE.Object3D.call</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.overrideMaterial</span><span class="PUNC">=</span><span class="NAME">this.fog</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">;</span><span class="NAME">this.autoUpdate</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">this.matrixAutoUpdate</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">this.__objects</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">this.__lights</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">this.__objectsAdded</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">this.__objectsRemoved</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.Scene.prototype</span><span class="PUNC">=</span><span class="NAME">Object.create</span><span class="PUNC">(</span><span class="NAME">THREE.Object3D.prototype</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>296</span> </span><span class="NAME">THREE.Scene.prototype.__addObject</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">a</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">THREE.Light</span><span class="PUNC">)</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">===</span><span class="NAME">this.__lights.indexOf</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="NAME">this.__lights.push</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">a.target</span><span class="PUNC">&&</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">===</span><span class="NAME">a.target.parent</span><span class="PUNC">&&</span><span class="NAME">this.add</span><span class="PUNC">(</span><span class="NAME">a.target</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="PUNC">(</span><span class="NAME">a</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">THREE.Camera</span><span class="PUNC">||</span><span class="NAME">a</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">THREE.Bone</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">===</span><span class="NAME">this.__objects.indexOf</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.__objects.push</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.__objectsAdded.push</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.__objectsRemoved.indexOf</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">!==</span><span class="NAME">b</span><span class="PUNC">&&</span><span class="NAME">this.__objectsRemoved.splice</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">&lt;</span><span class="NAME">a.children.length</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">this.__addObject</span><span class="PUNC">(</span><span class="NAME">a.children</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>297</span> </span><span class="NAME">THREE.Scene.prototype.__removeObject</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">a</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">THREE.Light</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.__lights.indexOf</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">!==</span><span class="NAME">b</span><span class="PUNC">&&</span><span class="NAME">this.__lights.splice</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="NAME">a</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">THREE.Camera</span><span class="PUNC">||</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.__objects.indexOf</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">!==</span><span class="NAME">b</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">this.__objects.splice</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this.__objectsRemoved.push</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.__objectsAdded.indexOf</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">!==</span><span class="NAME">b</span><span class="PUNC">&&</span><span class="NAME">this.__objectsAdded.splice</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">&lt;</span><span class="NAME">a.children.length</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">this.__removeObject</span><span class="PUNC">(</span><span class="NAME">a.children</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>298</span> </span><span class="NAME">THREE.Scene.prototype.clone</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">===</span><span class="NAME">a</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Scene</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">THREE.Object3D.prototype.clone.call</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">null</span><span class="PUNC">!==</span><span class="NAME">this.fog</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">a.fog</span><span class="PUNC">=</span><span class="NAME">this.fog.clone</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">null</span><span class="PUNC">!==</span><span class="NAME">this.overrideMaterial</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">a.overrideMaterial</span><span class="PUNC">=</span><span class="NAME">this.overrideMaterial.clone</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a.autoUpdate</span><span class="PUNC">=</span><span class="NAME">this.autoUpdate</span><span class="PUNC">;</span><span class="NAME">a.matrixAutoUpdate</span><span class="PUNC">=</span><span class="NAME">this.matrixAutoUpdate</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.Fog</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.name</span><span class="PUNC">=</span><span class="STRN">""</span><span class="PUNC">;</span><span class="NAME">this.color</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Color</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.near</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">b</span><span class="PUNC">?</span><span class="NAME">b</span><span class="PUNC">:</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">this.far</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">c</span><span class="PUNC">?</span><span class="NAME">c</span><span class="PUNC">:</span><span class="NUMB">1</span><span class="NAME">E3</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.Fog.prototype.clone</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Fog</span><span class="PUNC">(</span><span class="NAME">this.color.getHex</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this.near</span><span class="PUNC">,</span><span class="NAME">this.far</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.FogExp2</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.name</span><span class="PUNC">=</span><span class="STRN">""</span><span class="PUNC">;</span><span class="NAME">this.color</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Color</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.density</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">b</span><span class="PUNC">?</span><span class="NAME">b</span><span class="PUNC">:</span><span class="NUMB">2.5</span><span class="NAME">E</span><span class="PUNC">-</span><span class="NUMB">4</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.FogExp2.prototype.clone</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.FogExp2</span><span class="PUNC">(</span><span class="NAME">this.color.getHex</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this.density</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.CanvasRenderer</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">I.length</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">&lt;</span><span class="NAME">e</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">I</span><span class="PUNC">[</span><span class="NAME">d</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">Xb.copy</span><span class="PUNC">(</span><span class="NAME">f.color</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">f</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">THREE.DirectionalLight</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">Wa.getPositionFromMatrix</span><span class="PUNC">(</span><span class="NAME">f.matrixWorld</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">normalize</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">b.dot</span><span class="PUNC">(</span><span class="NAME">h</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NUMB">0</span><span class="PUNC">>=</span><span class="NAME">g</span><span class="PUNC">||</span><span class="PUNC">(</span><span class="NAME">g</span><span class="PUNC">*</span><span class="PUNC">=</span><span class="NAME">f.intensity</span><span class="PUNC">,</span><span class="NAME">c.add</span><span class="PUNC">(</span><span class="NAME">Xb.multiplyScalar</span><span class="PUNC">(</span><span class="NAME">g</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="NAME">f</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">THREE.PointLight</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">Wa.getPositionFromMatrix</span><span class="PUNC">(</span><span class="NAME">f.matrixWorld</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">b.dot</span><span class="PUNC">(</span><span class="NAME">Wa.subVectors</span><span class="PUNC">(</span><span class="NAME">h</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">normalize</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">>=</span><span class="NAME">g</span><span class="PUNC">||</span><span class="PUNC">(</span><span class="NAME">g</span><span class="PUNC">*</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">==</span><span class="NAME">f.distance</span><span class="PUNC">?</span><span class="NUMB">1</span><span class="PUNC">:</span><span class="NUMB">1</span><span class="PUNC">-</span><span class="NAME">Math.min</span><span class="PUNC">(</span><span class="NAME">a.distanceTo</span><span class="PUNC">(</span><span class="NAME">h</span><span class="PUNC">)</span><span class="PUNC">/</span><span class="NAME">f.distance</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">!=</span><span class="NAME">g</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">g</span><span class="PUNC">*</span><span class="PUNC">=</span><span class="NAME">f.intensity</span><span class="PUNC">,</span><span class="NAME">c.add</span><span class="PUNC">(</span><span class="NAME">Xb.multiplyScalar</span><span class="PUNC">(</span><span class="NAME">g</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>299</span> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">l</span><span class="PUNC">,</span><span class="NAME">p</span><span class="PUNC">,</span><span class="NAME">r</span><span class="PUNC">,</span><span class="NAME">U</span><span class="PUNC">,</span><span class="NAME">q</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">C.info.render.vertices</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NUMB">3</span><span class="PUNC">;</span><span class="NAME">C.info.render.faces</span><span class="PUNC">++</span><span class="PUNC">;</span><span class="NAME">m</span><span class="PUNC">(</span><span class="NAME">q.opacity</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">n</span><span class="PUNC">(</span><span class="NAME">q.blending</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">ya</span><span class="PUNC">=</span><span class="NAME">a.positionScreen.x</span><span class="PUNC">;</span><span class="NAME">Ha</span><span class="PUNC">=</span><span class="NAME">a.positionScreen.y</span><span class="PUNC">;</span><span class="NAME">fa</span><span class="PUNC">=</span><span class="NAME">c.positionScreen.x</span><span class="PUNC">;</span><span class="NAME">da</span><span class="PUNC">=</span><span class="NAME">c.positionScreen.y</span><span class="PUNC">;</span><span class="NAME">T</span><span class="PUNC">=</span><span class="NAME">e.positionScreen.x</span><span class="PUNC">;</span><span class="NAME">aa</span><span class="PUNC">=</span><span class="NAME">e.positionScreen.y</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">(</span><span class="NAME">ya</span><span class="PUNC">,</span><span class="NAME">Ha</span><span class="PUNC">,</span><span class="NAME">fa</span><span class="PUNC">,</span><span class="NAME">da</span><span class="PUNC">,</span><span class="NAME">T</span><span class="PUNC">,</span><span class="NAME">aa</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="PUNC">(</span><span class="NAME">q</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">THREE.MeshLambertMaterial</span><span class="PUNC">||</span><span class="NAME">q</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">THREE.MeshPhongMaterial</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="KEYW">null</span><span class="PUNC">===</span><span class="NAME">q.map</span><span class="PUNC">?</span><span class="PUNC">(</span><span class="NAME">Qa.copy</span><span class="PUNC">(</span><span class="NAME">q.color</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">Xa.copy</span><span class="PUNC">(</span><span class="NAME">q.emissive</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">q.vertexColors</span><span class="PUNC">===</span><span class="NAME">THREE.FaceColors</span><span class="PUNC">&&</span><span class="NAME">Qa.multiply</span><span class="PUNC">(</span><span class="NAME">U.color</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">===</span><span class="NAME">q.wireframe</span><span class="PUNC">&&</span><span class="NAME">q.shading</span><span class="PUNC">==</span><span class="NAME">THREE.SmoothShading</span><span class="PUNC">&&</span><span class="NUMB">3</span><span class="PUNC">==</span><span class="NAME">U.vertexNormalsLength</span><span class="PUNC">?</span><span class="WHIT">
<span class='line'>300</span> </span><span class="PUNC">(</span><span class="NAME">ra.copy</span><span class="PUNC">(</span><span class="NAME">ib</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">ja.copy</span><span class="PUNC">(</span><span class="NAME">ib</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">ua.copy</span><span class="PUNC">(</span><span class="NAME">ib</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">(</span><span class="NAME">U.v1.positionWorld</span><span class="PUNC">,</span><span class="NAME">U.vertexNormalsModel</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">ra</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">(</span><span class="NAME">U.v2.positionWorld</span><span class="PUNC">,</span><span class="NAME">U.vertexNormalsModel</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">ja</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">(</span><span class="NAME">U.v3.positionWorld</span><span class="PUNC">,</span><span class="NAME">U.vertexNormalsModel</span><span class="PUNC">[</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">ua</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">ra.multiply</span><span class="PUNC">(</span><span class="NAME">Qa</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">add</span><span class="PUNC">(</span><span class="NAME">Xa</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">ja.multiply</span><span class="PUNC">(</span><span class="NAME">Qa</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">add</span><span class="PUNC">(</span><span class="NAME">Xa</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">ua.multiply</span><span class="PUNC">(</span><span class="NAME">Qa</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">add</span><span class="PUNC">(</span><span class="NAME">Xa</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">Ra.addColors</span><span class="PUNC">(</span><span class="NAME">ja</span><span class="PUNC">,</span><span class="NAME">ua</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">multiplyScalar</span><span class="PUNC">(</span><span class="NUMB">0.5</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">lb</span><span class="PUNC">=</span><span class="NAME">j</span><span class="PUNC">(</span><span class="NAME">ra</span><span class="PUNC">,</span><span class="NAME">ja</span><span class="PUNC">,</span><span class="NAME">ua</span><span class="PUNC">,</span><span class="NAME">Ra</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">(</span><span class="NAME">ya</span><span class="PUNC">,</span><span class="NAME">Ha</span><span class="PUNC">,</span><span class="NAME">fa</span><span class="PUNC">,</span><span class="NAME">da</span><span class="PUNC">,</span><span class="NAME">T</span><span class="PUNC">,</span><span class="NAME">aa</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">lb</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="PUNC">(</span><span class="NAME">ia.copy</span><span class="PUNC">(</span><span class="NAME">ib</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">(</span><span class="NAME">U.centroidModel</span><span class="PUNC">,</span><span class="NAME">U.normalModel</span><span class="PUNC">,</span><span class="NAME">ia</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">ia.multiply</span><span class="PUNC">(</span><span class="NAME">Qa</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">add</span><span class="PUNC">(</span><span class="NAME">Xa</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">===</span><span class="NAME">q.wireframe</span><span class="PUNC">?</span><span class="NAME">f</span><span class="PUNC">(</span><span class="NAME">ia</span><span class="PUNC">,</span><span class="NAME">q.wireframeLinewidth</span><span class="PUNC">,</span><span class="NAME">q.wireframeLinecap</span><span class="PUNC">,</span><span class="NAME">q.wireframeLinejoin</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="WHIT">
<span class='line'>301</span> </span><span class="NAME">h</span><span class="PUNC">(</span><span class="NAME">ia</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">q</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">THREE.MeshBasicMaterial</span><span class="PUNC">||</span><span class="NAME">q</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">THREE.MeshLambertMaterial</span><span class="PUNC">||</span><span class="NAME">q</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">THREE.MeshPhongMaterial</span><span class="PUNC">?</span><span class="KEYW">null</span><span class="PUNC">!==</span><span class="NAME">q.map</span><span class="PUNC">?</span><span class="NAME">q.map.mapping</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">THREE.UVMapping</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">Ga</span><span class="PUNC">=</span><span class="NAME">U.uvs</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">(</span><span class="NAME">ya</span><span class="PUNC">,</span><span class="NAME">Ha</span><span class="PUNC">,</span><span class="NAME">fa</span><span class="PUNC">,</span><span class="NAME">da</span><span class="PUNC">,</span><span class="NAME">T</span><span class="PUNC">,</span><span class="NAME">aa</span><span class="PUNC">,</span><span class="NAME">Ga</span><span class="PUNC">[</span><span class="NAME">l</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">x</span><span class="PUNC">,</span><span class="NAME">Ga</span><span class="PUNC">[</span><span class="NAME">l</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">y</span><span class="PUNC">,</span><span class="NAME">Ga</span><span class="PUNC">[</span><span class="NAME">p</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">x</span><span class="PUNC">,</span><span class="NAME">Ga</span><span class="PUNC">[</span><span class="NAME">p</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">y</span><span class="PUNC">,</span><span class="NAME">Ga</span><span class="PUNC">[</span><span class="NAME">r</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">x</span><span class="PUNC">,</span><span class="NAME">Ga</span><span class="PUNC">[</span><span class="NAME">r</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">y</span><span class="PUNC">,</span><span class="NAME">q.map</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">!==</span><span class="NAME">q.envMap</span><span class="PUNC">?</span><span class="NAME">q.envMap.mapping</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">THREE.SphericalReflectionMapping</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">Wa.copy</span><span class="PUNC">(</span><span class="NAME">U.vertexNormalsModelView</span><span class="PUNC">[</span><span class="NAME">l</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">Ca</span><span class="PUNC">=</span><span class="NUMB">0.5</span><span class="PUNC">*</span><span class="NAME">Wa.x</span><span class="PUNC">+</span><span class="NUMB">0.5</span><span class="PUNC">,</span><span class="NAME">yb</span><span class="PUNC">=</span><span class="NUMB">0.5</span><span class="PUNC">*</span><span class="NAME">Wa.y</span><span class="PUNC">+</span><span class="NUMB">0.5</span><span class="PUNC">,</span><span class="NAME">Wa.copy</span><span class="PUNC">(</span><span class="NAME">U.vertexNormalsModelView</span><span class="PUNC">[</span><span class="NAME">p</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">Ib</span><span class="PUNC">=</span><span class="NUMB">0.5</span><span class="PUNC">*</span><span class="NAME">Wa.x</span><span class="PUNC">+</span><span class="NUMB">0.5</span><span class="PUNC">,</span><span class="NAME">k</span><span class="PUNC">=</span><span class="NUMB">0.5</span><span class="PUNC">*</span><span class="NAME">Wa.y</span><span class="PUNC">+</span><span class="NUMB">0.5</span><span class="PUNC">,</span><span class="NAME">Wa.copy</span><span class="PUNC">(</span><span class="NAME">U.vertexNormalsModelView</span><span class="PUNC">[</span><span class="NAME">r</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>302</span> </span><span class="NAME">Rb</span><span class="PUNC">=</span><span class="NUMB">0.5</span><span class="PUNC">*</span><span class="NAME">Wa.x</span><span class="PUNC">+</span><span class="NUMB">0.5</span><span class="PUNC">,</span><span class="NAME">Yb</span><span class="PUNC">=</span><span class="NUMB">0.5</span><span class="PUNC">*</span><span class="NAME">Wa.y</span><span class="PUNC">+</span><span class="NUMB">0.5</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">(</span><span class="NAME">ya</span><span class="PUNC">,</span><span class="NAME">Ha</span><span class="PUNC">,</span><span class="NAME">fa</span><span class="PUNC">,</span><span class="NAME">da</span><span class="PUNC">,</span><span class="NAME">T</span><span class="PUNC">,</span><span class="NAME">aa</span><span class="PUNC">,</span><span class="NAME">Ca</span><span class="PUNC">,</span><span class="NAME">yb</span><span class="PUNC">,</span><span class="NAME">Ib</span><span class="PUNC">,</span><span class="NAME">k</span><span class="PUNC">,</span><span class="NAME">Rb</span><span class="PUNC">,</span><span class="NAME">Yb</span><span class="PUNC">,</span><span class="NAME">q.envMap</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="PUNC">(</span><span class="NAME">ia.copy</span><span class="PUNC">(</span><span class="NAME">q.color</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">q.vertexColors</span><span class="PUNC">===</span><span class="NAME">THREE.FaceColors</span><span class="PUNC">&&</span><span class="NAME">ia.multiply</span><span class="PUNC">(</span><span class="NAME">U.color</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">===</span><span class="NAME">q.wireframe</span><span class="PUNC">?</span><span class="NAME">f</span><span class="PUNC">(</span><span class="NAME">ia</span><span class="PUNC">,</span><span class="NAME">q.wireframeLinewidth</span><span class="PUNC">,</span><span class="NAME">q.wireframeLinecap</span><span class="PUNC">,</span><span class="NAME">q.wireframeLinejoin</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">h</span><span class="PUNC">(</span><span class="NAME">ia</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">q</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">THREE.MeshDepthMaterial</span><span class="PUNC">?</span><span class="PUNC">(</span><span class="NAME">Sa</span><span class="PUNC">=</span><span class="NAME">D.near</span><span class="PUNC">,</span><span class="NAME">xb</span><span class="PUNC">=</span><span class="NAME">D.far</span><span class="PUNC">,</span><span class="NAME">ra.r</span><span class="PUNC">=</span><span class="NAME">ra.g</span><span class="PUNC">=</span><span class="NAME">ra.b</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">-</span><span class="NAME">z</span><span class="PUNC">(</span><span class="NAME">a.positionScreen.z</span><span class="PUNC">*</span><span class="NAME">a.positionScreen.w</span><span class="PUNC">,</span><span class="NAME">Sa</span><span class="PUNC">,</span><span class="NAME">xb</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">ja.r</span><span class="PUNC">=</span><span class="NAME">ja.g</span><span class="PUNC">=</span><span class="NAME">ja.b</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">-</span><span class="NAME">z</span><span class="PUNC">(</span><span class="NAME">c.positionScreen.z</span><span class="PUNC">*</span><span class="NAME">c.positionScreen.w</span><span class="PUNC">,</span><span class="NAME">Sa</span><span class="PUNC">,</span><span class="NAME">xb</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">ua.r</span><span class="PUNC">=</span><span class="NAME">ua.g</span><span class="PUNC">=</span><span class="NAME">ua.b</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">-</span><span class="NAME">z</span><span class="PUNC">(</span><span class="NAME">e.positionScreen.z</span><span class="PUNC">*</span><span class="NAME">e.positionScreen.w</span><span class="PUNC">,</span><span class="NAME">Sa</span><span class="PUNC">,</span><span class="NAME">xb</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">Ra.addColors</span><span class="PUNC">(</span><span class="NAME">ja</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>303</span> </span><span class="NAME">ua</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">multiplyScalar</span><span class="PUNC">(</span><span class="NUMB">0.5</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">lb</span><span class="PUNC">=</span><span class="NAME">j</span><span class="PUNC">(</span><span class="NAME">ra</span><span class="PUNC">,</span><span class="NAME">ja</span><span class="PUNC">,</span><span class="NAME">ua</span><span class="PUNC">,</span><span class="NAME">Ra</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">(</span><span class="NAME">ya</span><span class="PUNC">,</span><span class="NAME">Ha</span><span class="PUNC">,</span><span class="NAME">fa</span><span class="PUNC">,</span><span class="NAME">da</span><span class="PUNC">,</span><span class="NAME">T</span><span class="PUNC">,</span><span class="NAME">aa</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">lb</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">q</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">THREE.MeshNormalMaterial</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">q.shading</span><span class="PUNC">==</span><span class="NAME">THREE.FlatShading</span><span class="PUNC">?</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">U.normalModelView</span><span class="PUNC">,</span><span class="NAME">ia.setRGB</span><span class="PUNC">(</span><span class="NAME">a.x</span><span class="PUNC">,</span><span class="NAME">a.y</span><span class="PUNC">,</span><span class="NAME">a.z</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">multiplyScalar</span><span class="PUNC">(</span><span class="NUMB">0.5</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">addScalar</span><span class="PUNC">(</span><span class="NUMB">0.5</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">===</span><span class="NAME">q.wireframe</span><span class="PUNC">?</span><span class="NAME">f</span><span class="PUNC">(</span><span class="NAME">ia</span><span class="PUNC">,</span><span class="NAME">q.wireframeLinewidth</span><span class="PUNC">,</span><span class="NAME">q.wireframeLinecap</span><span class="PUNC">,</span><span class="NAME">q.wireframeLinejoin</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">h</span><span class="PUNC">(</span><span class="NAME">ia</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">q.shading</span><span class="PUNC">==</span><span class="NAME">THREE.SmoothShading</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">U.vertexNormalsModelView</span><span class="PUNC">[</span><span class="NAME">l</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">ra.setRGB</span><span class="PUNC">(</span><span class="NAME">a.x</span><span class="PUNC">,</span><span class="NAME">a.y</span><span class="PUNC">,</span><span class="NAME">a.z</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">multiplyScalar</span><span class="PUNC">(</span><span class="NUMB">0.5</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">addScalar</span><span class="PUNC">(</span><span class="NUMB">0.5</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">U.vertexNormalsModelView</span><span class="PUNC">[</span><span class="NAME">p</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">ja.setRGB</span><span class="PUNC">(</span><span class="NAME">a.x</span><span class="PUNC">,</span><span class="NAME">a.y</span><span class="PUNC">,</span><span class="NAME">a.z</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">multiplyScalar</span><span class="PUNC">(</span><span class="NUMB">0.5</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">addScalar</span><span class="PUNC">(</span><span class="NUMB">0.5</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>304</span> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">U.vertexNormalsModelView</span><span class="PUNC">[</span><span class="NAME">r</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">ua.setRGB</span><span class="PUNC">(</span><span class="NAME">a.x</span><span class="PUNC">,</span><span class="NAME">a.y</span><span class="PUNC">,</span><span class="NAME">a.z</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">multiplyScalar</span><span class="PUNC">(</span><span class="NUMB">0.5</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">addScalar</span><span class="PUNC">(</span><span class="NUMB">0.5</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">Ra.addColors</span><span class="PUNC">(</span><span class="NAME">ja</span><span class="PUNC">,</span><span class="NAME">ua</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">multiplyScalar</span><span class="PUNC">(</span><span class="NUMB">0.5</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">lb</span><span class="PUNC">=</span><span class="NAME">j</span><span class="PUNC">(</span><span class="NAME">ra</span><span class="PUNC">,</span><span class="NAME">ja</span><span class="PUNC">,</span><span class="NAME">ua</span><span class="PUNC">,</span><span class="NAME">Ra</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">(</span><span class="NAME">ya</span><span class="PUNC">,</span><span class="NAME">Ha</span><span class="PUNC">,</span><span class="NAME">fa</span><span class="PUNC">,</span><span class="NAME">da</span><span class="PUNC">,</span><span class="NAME">T</span><span class="PUNC">,</span><span class="NAME">aa</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">lb</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">y.beginPath</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">y.moveTo</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">y.lineTo</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">y.lineTo</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">y.closePath</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">e</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">y.beginPath</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">y.moveTo</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">y.lineTo</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">y.lineTo</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">y.lineTo</span><span class="PUNC">(</span><span class="NAME">h</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">y.closePath</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">f</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">p</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">t</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">q</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">r</span><span class="PUNC">(</span><span class="NAME">a.getStyle</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">y.stroke</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">va.expandByScalar</span><span class="PUNC">(</span><span class="NUMB">2</span><span class="PUNC">*</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">h</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">s</span><span class="PUNC">(</span><span class="NAME">a.getStyle</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>305</span> </span><span class="NAME">y.fill</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">g</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">,</span><span class="NAME">k</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">,</span><span class="NAME">j</span><span class="PUNC">,</span><span class="NAME">m</span><span class="PUNC">,</span><span class="NAME">l</span><span class="PUNC">,</span><span class="NAME">n</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="PUNC">(</span><span class="NAME">n</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">THREE.DataTexture</span><span class="PUNC">||</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">===</span><span class="NAME">n.image</span><span class="PUNC">||</span><span class="NUMB">0</span><span class="PUNC">==</span><span class="NAME">n.image.width</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">===</span><span class="NAME">n.needsUpdate</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">p</span><span class="PUNC">=</span><span class="NAME">n.wrapS</span><span class="PUNC">==</span><span class="NAME">THREE.RepeatWrapping</span><span class="PUNC">,</span><span class="NAME">q</span><span class="PUNC">=</span><span class="NAME">n.wrapT</span><span class="PUNC">==</span><span class="NAME">THREE.RepeatWrapping</span><span class="PUNC">;</span><span class="NAME">Jb</span><span class="PUNC">[</span><span class="NAME">n.id</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">y.createPattern</span><span class="PUNC">(</span><span class="NAME">n.image</span><span class="PUNC">,</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">===</span><span class="NAME">p</span><span class="PUNC">&&</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">===</span><span class="NAME">q</span><span class="PUNC">?</span><span class="STRN">"repeat"</span><span class="PUNC">:</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">===</span><span class="NAME">p</span><span class="PUNC">&&</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">===</span><span class="NAME">q</span><span class="PUNC">?</span><span class="STRN">"repeat-x"</span><span class="PUNC">:</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">===</span><span class="NAME">p</span><span class="PUNC">&&</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">===</span><span class="NAME">q</span><span class="PUNC">?</span><span class="STRN">"repeat-y"</span><span class="PUNC">:</span><span class="STRN">"no-repeat"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">n.needsUpdate</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">}</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">===</span><span class="NAME">Jb</span><span class="PUNC">[</span><span class="NAME">n.id</span><span class="PUNC">]</span><span class="PUNC">?</span><span class="NAME">s</span><span class="PUNC">(</span><span class="STRN">"rgba(0,0,0,1)"</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">s</span><span class="PUNC">(</span><span class="NAME">Jb</span><span class="PUNC">[</span><span class="NAME">n.id</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">p</span><span class="PUNC">=</span><span class="NAME">n.offset.x</span><span class="PUNC">/</span><span class="NAME">n.repeat.x</span><span class="PUNC">,</span><span class="NAME">q</span><span class="PUNC">=</span><span class="NAME">n.offset.y</span><span class="PUNC">/</span><span class="NAME">n.repeat.y</span><span class="PUNC">,</span><span class="NAME">r</span><span class="PUNC">=</span><span class="NAME">n.image.width</span><span class="PUNC">*</span><span class="NAME">n.repeat.x</span><span class="PUNC">,</span><span class="NAME">t</span><span class="PUNC">=</span><span class="NAME">n.image.height</span><span class="PUNC">*</span><span class="NAME">n.repeat.y</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>306</span> </span><span class="NAME">g</span><span class="PUNC">=</span><span class="PUNC">(</span><span class="NAME">g</span><span class="PUNC">+</span><span class="NAME">p</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">r</span><span class="PUNC">,</span><span class="NAME">k</span><span class="PUNC">=</span><span class="PUNC">(</span><span class="NUMB">1</span><span class="PUNC">-</span><span class="NAME">k</span><span class="PUNC">+</span><span class="NAME">q</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">t</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">-</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">-</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">e</span><span class="PUNC">-</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">f</span><span class="PUNC">-</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">=</span><span class="PUNC">(</span><span class="NAME">i</span><span class="PUNC">+</span><span class="NAME">p</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">r</span><span class="PUNC">-</span><span class="NAME">g</span><span class="PUNC">,</span><span class="NAME">j</span><span class="PUNC">=</span><span class="PUNC">(</span><span class="NUMB">1</span><span class="PUNC">-</span><span class="NAME">j</span><span class="PUNC">+</span><span class="NAME">q</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">t</span><span class="PUNC">-</span><span class="NAME">k</span><span class="PUNC">,</span><span class="NAME">m</span><span class="PUNC">=</span><span class="PUNC">(</span><span class="NAME">m</span><span class="PUNC">+</span><span class="NAME">p</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">r</span><span class="PUNC">-</span><span class="NAME">g</span><span class="PUNC">,</span><span class="NAME">l</span><span class="PUNC">=</span><span class="PUNC">(</span><span class="NUMB">1</span><span class="PUNC">-</span><span class="NAME">l</span><span class="PUNC">+</span><span class="NAME">q</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">t</span><span class="PUNC">-</span><span class="NAME">k</span><span class="PUNC">,</span><span class="NAME">p</span><span class="PUNC">=</span><span class="NAME">i</span><span class="PUNC">*</span><span class="NAME">l</span><span class="PUNC">-</span><span class="NAME">m</span><span class="PUNC">*</span><span class="NAME">j</span><span class="PUNC">;</span><span class="NUMB">0</span><span class="PUNC">===</span><span class="NAME">p</span><span class="PUNC">?</span><span class="PUNC">(</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">===</span><span class="NAME">Ab</span><span class="PUNC">[</span><span class="NAME">n.id</span><span class="PUNC">]</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">document.createElement</span><span class="PUNC">(</span><span class="STRN">"canvas"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">b.width</span><span class="PUNC">=</span><span class="NAME">n.image.width</span><span class="PUNC">,</span><span class="NAME">b.height</span><span class="PUNC">=</span><span class="NAME">n.image.height</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">b.getContext</span><span class="PUNC">(</span><span class="STRN">"2d"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">b.drawImage</span><span class="PUNC">(</span><span class="NAME">n.image</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">Ab</span><span class="PUNC">[</span><span class="NAME">n.id</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">b.getImageData</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">n.image.width</span><span class="PUNC">,</span><span class="NAME">n.image.height</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">data</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">Ab</span><span class="PUNC">[</span><span class="NAME">n.id</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NUMB">4</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">Math.floor</span><span class="PUNC">(</span><span class="NAME">g</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="NAME">Math.floor</span><span class="PUNC">(</span><span class="NAME">k</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">n.image.width</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">ia.setRGB</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NAME">g</span><span class="PUNC">]</span><span class="PUNC">/</span><span class="NUMB">255</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NAME">g</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">/</span><span class="NUMB">255</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NAME">g</span><span class="PUNC">+</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">/</span><span class="NUMB">255</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">(</span><span class="NAME">ia</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="PUNC">(</span><span class="NAME">p</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">/</span><span class="NAME">p</span><span class="PUNC">,</span><span class="NAME">n</span><span class="PUNC">=</span><span class="PUNC">(</span><span class="NAME">l</span><span class="PUNC">*</span><span class="NAME">c</span><span class="PUNC">-</span><span class="NAME">j</span><span class="PUNC">*</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">p</span><span class="PUNC">,</span><span class="NAME">j</span><span class="PUNC">=</span><span class="PUNC">(</span><span class="NAME">l</span><span class="PUNC">*</span><span class="NAME">d</span><span class="PUNC">-</span><span class="NAME">j</span><span class="PUNC">*</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">p</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="PUNC">(</span><span class="NAME">i</span><span class="PUNC">*</span><span class="NAME">e</span><span class="PUNC">-</span><span class="NAME">m</span><span class="PUNC">*</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">p</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="PUNC">(</span><span class="NAME">i</span><span class="PUNC">*</span><span class="NAME">f</span><span class="PUNC">-</span><span class="NAME">m</span><span class="PUNC">*</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">p</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">-</span><span class="WHIT">
<span class='line'>307</span> </span><span class="NAME">n</span><span class="PUNC">*</span><span class="NAME">g</span><span class="PUNC">-</span><span class="NAME">c</span><span class="PUNC">*</span><span class="NAME">k</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">-</span><span class="NAME">j</span><span class="PUNC">*</span><span class="NAME">g</span><span class="PUNC">-</span><span class="NAME">d</span><span class="PUNC">*</span><span class="NAME">k</span><span class="PUNC">,</span><span class="NAME">y.save</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">y.transform</span><span class="PUNC">(</span><span class="NAME">n</span><span class="PUNC">,</span><span class="NAME">j</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">y.fill</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">y.restore</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">,</span><span class="NAME">k</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">,</span><span class="NAME">j</span><span class="PUNC">,</span><span class="NAME">m</span><span class="PUNC">,</span><span class="NAME">l</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">n</span><span class="PUNC">,</span><span class="NAME">p</span><span class="PUNC">;</span><span class="NAME">n</span><span class="PUNC">=</span><span class="NAME">l.width</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">p</span><span class="PUNC">=</span><span class="NAME">l.height</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">h</span><span class="PUNC">*</span><span class="PUNC">=</span><span class="NAME">n</span><span class="PUNC">;</span><span class="NAME">g</span><span class="PUNC">*</span><span class="PUNC">=</span><span class="NAME">p</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">-</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">-</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">-</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">f</span><span class="PUNC">-</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">;</span><span class="NAME">k</span><span class="PUNC">=</span><span class="NAME">k</span><span class="PUNC">*</span><span class="NAME">n</span><span class="PUNC">-</span><span class="NAME">h</span><span class="PUNC">;</span><span class="NAME">i</span><span class="PUNC">=</span><span class="NAME">i</span><span class="PUNC">*</span><span class="NAME">p</span><span class="PUNC">-</span><span class="NAME">g</span><span class="PUNC">;</span><span class="NAME">j</span><span class="PUNC">=</span><span class="NAME">j</span><span class="PUNC">*</span><span class="NAME">n</span><span class="PUNC">-</span><span class="NAME">h</span><span class="PUNC">;</span><span class="NAME">m</span><span class="PUNC">=</span><span class="NAME">m</span><span class="PUNC">*</span><span class="NAME">p</span><span class="PUNC">-</span><span class="NAME">g</span><span class="PUNC">;</span><span class="NAME">p</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">/</span><span class="PUNC">(</span><span class="NAME">k</span><span class="PUNC">*</span><span class="NAME">m</span><span class="PUNC">-</span><span class="NAME">j</span><span class="PUNC">*</span><span class="NAME">i</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">n</span><span class="PUNC">=</span><span class="PUNC">(</span><span class="NAME">m</span><span class="PUNC">*</span><span class="NAME">c</span><span class="PUNC">-</span><span class="NAME">i</span><span class="PUNC">*</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">p</span><span class="PUNC">;</span><span class="NAME">i</span><span class="PUNC">=</span><span class="PUNC">(</span><span class="NAME">m</span><span class="PUNC">*</span><span class="NAME">d</span><span class="PUNC">-</span><span class="NAME">i</span><span class="PUNC">*</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">p</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">=</span><span class="PUNC">(</span><span class="NAME">k</span><span class="PUNC">*</span><span class="NAME">e</span><span class="PUNC">-</span><span class="NAME">j</span><span class="PUNC">*</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">p</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">=</span><span class="PUNC">(</span><span class="NAME">k</span><span class="PUNC">*</span><span class="NAME">f</span><span class="PUNC">-</span><span class="NAME">j</span><span class="PUNC">*</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">p</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">-</span><span class="NAME">n</span><span class="PUNC">*</span><span class="NAME">h</span><span class="PUNC">-</span><span class="NAME">c</span><span class="PUNC">*</span><span class="NAME">g</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">-</span><span class="NAME">i</span><span class="PUNC">*</span><span class="NAME">h</span><span class="PUNC">-</span><span class="NAME">d</span><span class="PUNC">*</span><span class="NAME">g</span><span class="PUNC">;</span><span class="NAME">y.save</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">y.transform</span><span class="PUNC">(</span><span class="NAME">n</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">y.clip</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">y.drawImage</span><span class="PUNC">(</span><span class="NAME">l</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">y.restore</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">j</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">Ka</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NUMB">255</span><span class="PUNC">*</span><span class="NAME">a.r</span><span class="PUNC">|</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">Ka</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NUMB">255</span><span class="PUNC">*</span><span class="NAME">a.g</span><span class="PUNC">|</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">Ka</span><span class="PUNC">[</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NUMB">255</span><span class="PUNC">*</span><span class="NAME">a.b</span><span class="PUNC">|</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">Ka</span><span class="PUNC">[</span><span class="NUMB">4</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NUMB">255</span><span class="PUNC">*</span><span class="NAME">b.r</span><span class="PUNC">|</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">Ka</span><span class="PUNC">[</span><span class="NUMB">5</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NUMB">255</span><span class="PUNC">*</span><span class="NAME">b.g</span><span class="PUNC">|</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">Ka</span><span class="PUNC">[</span><span class="NUMB">6</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NUMB">255</span><span class="PUNC">*</span><span class="NAME">b.b</span><span class="PUNC">|</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">Ka</span><span class="PUNC">[</span><span class="NUMB">8</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NUMB">255</span><span class="PUNC">*</span><span class="WHIT">
<span class='line'>308</span> </span><span class="NAME">c.r</span><span class="PUNC">|</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">Ka</span><span class="PUNC">[</span><span class="NUMB">9</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NUMB">255</span><span class="PUNC">*</span><span class="NAME">c.g</span><span class="PUNC">|</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">Ka</span><span class="PUNC">[</span><span class="NUMB">10</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NUMB">255</span><span class="PUNC">*</span><span class="NAME">c.b</span><span class="PUNC">|</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">Ka</span><span class="PUNC">[</span><span class="NUMB">12</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NUMB">255</span><span class="PUNC">*</span><span class="NAME">d.r</span><span class="PUNC">|</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">Ka</span><span class="PUNC">[</span><span class="NUMB">13</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NUMB">255</span><span class="PUNC">*</span><span class="NAME">d.g</span><span class="PUNC">|</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">Ka</span><span class="PUNC">[</span><span class="NUMB">14</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NUMB">255</span><span class="PUNC">*</span><span class="NAME">d.b</span><span class="PUNC">|</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">Bb.putImageData</span><span class="PUNC">(</span><span class="NAME">Kb</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">Lb.drawImage</span><span class="PUNC">(</span><span class="NAME">Gb</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">Sb</span><span class="PUNC">}</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">l</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">b.x</span><span class="PUNC">-</span><span class="NAME">a.x</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">b.y</span><span class="PUNC">-</span><span class="NAME">a.y</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">*</span><span class="NAME">d</span><span class="PUNC">+</span><span class="NAME">e</span><span class="PUNC">*</span><span class="NAME">e</span><span class="PUNC">;</span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">f</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">/</span><span class="PUNC">=</span><span class="NAME">Math.sqrt</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">*</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">*</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">b.x</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">b.y</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">a.x</span><span class="PUNC">-</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">a.y</span><span class="PUNC">-</span><span class="PUNC">=</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">m</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">Z</span><span class="PUNC">!==</span><span class="NAME">a</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">Z</span><span class="PUNC">=</span><span class="NAME">y.globalAlpha</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">n</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">L</span><span class="PUNC">!==</span><span class="NAME">a</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">===</span><span class="NAME">THREE.NormalBlending</span><span class="PUNC">?</span><span class="NAME">y.globalCompositeOperation</span><span class="PUNC">=</span><span class="STRN">"source-over"</span><span class="PUNC">:</span><span class="NAME">a</span><span class="PUNC">===</span><span class="NAME">THREE.AdditiveBlending</span><span class="PUNC">?</span><span class="NAME">y.globalCompositeOperation</span><span class="PUNC">=</span><span class="STRN">"lighter"</span><span class="PUNC">:</span><span class="NAME">a</span><span class="PUNC">===</span><span class="NAME">THREE.SubtractiveBlending</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">y.globalCompositeOperation</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>309</span> </span><span class="STRN">"darker"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">L</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">p</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">Ua</span><span class="PUNC">!==</span><span class="NAME">a</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">Ua</span><span class="PUNC">=</span><span class="NAME">y.lineWidth</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">t</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">O</span><span class="PUNC">!==</span><span class="NAME">a</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">O</span><span class="PUNC">=</span><span class="NAME">y.lineCap</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">q</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">ka</span><span class="PUNC">!==</span><span class="NAME">a</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">ka</span><span class="PUNC">=</span><span class="NAME">y.lineJoin</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">r</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">pa</span><span class="PUNC">!==</span><span class="NAME">a</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">pa</span><span class="PUNC">=</span><span class="NAME">y.strokeStyle</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">s</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">Pa</span><span class="PUNC">!==</span><span class="NAME">a</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">Pa</span><span class="PUNC">=</span><span class="NAME">y.fillStyle</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">v</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">Fa</span><span class="PUNC">!==</span><span class="NAME">a</span><span class="PUNC">||</span><span class="NAME">wa</span><span class="PUNC">!==</span><span class="NAME">b</span><span class="PUNC">)</span><span class="NAME">y.setLineDash</span><span class="PUNC">(</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">Fa</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">wa</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">}</span><span class="NAME">console.log</span><span class="PUNC">(</span><span class="STRN">"THREE.CanvasRenderer"</span><span class="PUNC">,</span><span class="NAME">THREE.REVISION</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">z</span><span class="PUNC">=</span><span class="NAME">THREE.Math.smoothstep</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">||</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">C</span><span class="PUNC">=</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">F</span><span class="PUNC">,</span><span class="NAME">H</span><span class="PUNC">,</span><span class="NAME">I</span><span class="PUNC">,</span><span class="NAME">G</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Projector</span><span class="PUNC">,</span><span class="NAME">A</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">a.canvas</span><span class="PUNC">?</span><span class="NAME">a.canvas</span><span class="PUNC">:</span><span class="NAME">document.createElement</span><span class="PUNC">(</span><span class="STRN">"canvas"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">K</span><span class="PUNC">,</span><span class="NAME">B</span><span class="PUNC">,</span><span class="NAME">J</span><span class="PUNC">,</span><span class="NAME">N</span><span class="PUNC">,</span><span class="NAME">y</span><span class="PUNC">=</span><span class="NAME">A.getContext</span><span class="PUNC">(</span><span class="STRN">"2d"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">M</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Color</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>310</span> </span><span class="NAME">w</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">Z</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">L</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">pa</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">Pa</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">Ua</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">O</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">ka</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">Fa</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">wa</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">D</span><span class="PUNC">,</span><span class="NAME">V</span><span class="PUNC">,</span><span class="NAME">ea</span><span class="PUNC">,</span><span class="NAME">qa</span><span class="PUNC">,</span><span class="NAME">eb</span><span class="PUNC">,</span><span class="NAME">pb</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.RenderableVertex</span><span class="PUNC">,</span><span class="NAME">ub</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.RenderableVertex</span><span class="PUNC">,</span><span class="NAME">ya</span><span class="PUNC">,</span><span class="NAME">Ha</span><span class="PUNC">,</span><span class="NAME">fa</span><span class="PUNC">,</span><span class="NAME">da</span><span class="PUNC">,</span><span class="NAME">T</span><span class="PUNC">,</span><span class="NAME">aa</span><span class="PUNC">,</span><span class="NAME">na</span><span class="PUNC">,</span><span class="NAME">ha</span><span class="PUNC">,</span><span class="NAME">X</span><span class="PUNC">,</span><span class="NAME">xa</span><span class="PUNC">,</span><span class="NAME">ab</span><span class="PUNC">,</span><span class="NAME">la</span><span class="PUNC">,</span><span class="NAME">ia</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Color</span><span class="PUNC">,</span><span class="NAME">ra</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Color</span><span class="PUNC">,</span><span class="NAME">ja</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Color</span><span class="PUNC">,</span><span class="NAME">ua</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Color</span><span class="PUNC">,</span><span class="NAME">Ra</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Color</span><span class="PUNC">,</span><span class="NAME">Qa</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Color</span><span class="PUNC">,</span><span class="NAME">Xa</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Color</span><span class="PUNC">,</span><span class="NAME">Xb</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Color</span><span class="PUNC">,</span><span class="NAME">Jb</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">Ab</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">Sa</span><span class="PUNC">,</span><span class="NAME">xb</span><span class="PUNC">,</span><span class="NAME">lb</span><span class="PUNC">,</span><span class="NAME">Ga</span><span class="PUNC">,</span><span class="NAME">Ca</span><span class="PUNC">,</span><span class="NAME">yb</span><span class="PUNC">,</span><span class="NAME">Ib</span><span class="PUNC">,</span><span class="NAME">k</span><span class="PUNC">,</span><span class="NAME">Rb</span><span class="PUNC">,</span><span class="NAME">Yb</span><span class="PUNC">,</span><span class="NAME">fb</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Box2</span><span class="PUNC">,</span><span class="NAME">oa</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Box2</span><span class="PUNC">,</span><span class="NAME">va</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Box2</span><span class="PUNC">,</span><span class="NAME">ib</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Color</span><span class="PUNC">,</span><span class="NAME">Tb</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Color</span><span class="PUNC">,</span><span class="NAME">Ub</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Color</span><span class="PUNC">,</span><span class="NAME">Wa</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">,</span><span class="NAME">Gb</span><span class="PUNC">,</span><span class="NAME">Bb</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>311</span> </span><span class="NAME">Kb</span><span class="PUNC">,</span><span class="NAME">Ka</span><span class="PUNC">,</span><span class="NAME">Sb</span><span class="PUNC">,</span><span class="NAME">Lb</span><span class="PUNC">,</span><span class="NAME">Hb</span><span class="PUNC">=</span><span class="NUMB">16</span><span class="PUNC">;</span><span class="NAME">Gb</span><span class="PUNC">=</span><span class="NAME">document.createElement</span><span class="PUNC">(</span><span class="STRN">"canvas"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">Gb.width</span><span class="PUNC">=</span><span class="NAME">Gb.height</span><span class="PUNC">=</span><span class="NUMB">2</span><span class="PUNC">;</span><span class="NAME">Bb</span><span class="PUNC">=</span><span class="NAME">Gb.getContext</span><span class="PUNC">(</span><span class="STRN">"2d"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">Bb.fillStyle</span><span class="PUNC">=</span><span class="STRN">"rgba(0,0,0,1)"</span><span class="PUNC">;</span><span class="NAME">Bb.fillRect</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">2</span><span class="PUNC">,</span><span class="NUMB">2</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">Kb</span><span class="PUNC">=</span><span class="NAME">Bb.getImageData</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">2</span><span class="PUNC">,</span><span class="NUMB">2</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">Ka</span><span class="PUNC">=</span><span class="NAME">Kb.data</span><span class="PUNC">;</span><span class="NAME">Sb</span><span class="PUNC">=</span><span class="NAME">document.createElement</span><span class="PUNC">(</span><span class="STRN">"canvas"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">Sb.width</span><span class="PUNC">=</span><span class="NAME">Sb.height</span><span class="PUNC">=</span><span class="NAME">Hb</span><span class="PUNC">;</span><span class="NAME">Lb</span><span class="PUNC">=</span><span class="NAME">Sb.getContext</span><span class="PUNC">(</span><span class="STRN">"2d"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">Lb.translate</span><span class="PUNC">(</span><span class="PUNC">-</span><span class="NAME">Hb</span><span class="PUNC">/</span><span class="NUMB">2</span><span class="PUNC">,</span><span class="PUNC">-</span><span class="NAME">Hb</span><span class="PUNC">/</span><span class="NUMB">2</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">Lb.scale</span><span class="PUNC">(</span><span class="NAME">Hb</span><span class="PUNC">,</span><span class="NAME">Hb</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">Hb</span><span class="PUNC">--</span><span class="PUNC">;</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">===</span><span class="NAME">y.setLineDash</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">y.setLineDash</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">y.mozDash</span><span class="PUNC">?</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">y.mozDash</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">!==</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">?</span><span class="NAME">a</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">}</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.domElement</span><span class="PUNC">=</span><span class="NAME">A</span><span class="PUNC">;</span><span class="NAME">this.devicePixelRatio</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">a.devicePixelRatio</span><span class="PUNC">?</span><span class="NAME">a.devicePixelRatio</span><span class="PUNC">:</span><span class="WHIT">
<span class='line'>312</span> </span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">window.devicePixelRatio</span><span class="PUNC">?</span><span class="NAME">window.devicePixelRatio</span><span class="PUNC">:</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">this.sortElements</span><span class="PUNC">=</span><span class="NAME">this.sortObjects</span><span class="PUNC">=</span><span class="NAME">this.autoClear</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">this.info</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="NAME">render</span><span class="PUNC">:</span><span class="PUNC">{</span><span class="NAME">vertices</span><span class="PUNC">:</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">faces</span><span class="PUNC">:</span><span class="NUMB">0</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">this.supportsVertexTextures</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">this.setFaceCulling</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">this.setSize</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">K</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">*</span><span class="NAME">this.devicePixelRatio</span><span class="PUNC">;</span><span class="NAME">B</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">*</span><span class="NAME">this.devicePixelRatio</span><span class="PUNC">;</span><span class="NAME">J</span><span class="PUNC">=</span><span class="NAME">Math.floor</span><span class="PUNC">(</span><span class="NAME">K</span><span class="PUNC">/</span><span class="NUMB">2</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">N</span><span class="PUNC">=</span><span class="NAME">Math.floor</span><span class="PUNC">(</span><span class="NAME">B</span><span class="PUNC">/</span><span class="NUMB">2</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">A.width</span><span class="PUNC">=</span><span class="NAME">K</span><span class="PUNC">;</span><span class="NAME">A.height</span><span class="PUNC">=</span><span class="NAME">B</span><span class="PUNC">;</span><span class="NUMB">1</span><span class="PUNC">!==</span><span class="NAME">this.devicePixelRatio</span><span class="PUNC">&&</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">!==</span><span class="NAME">c</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">A.style.width</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">+</span><span class="STRN">"px"</span><span class="PUNC">,</span><span class="NAME">A.style.height</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">+</span><span class="STRN">"px"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">fb.set</span><span class="PUNC">(</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector2</span><span class="PUNC">(</span><span class="PUNC">-</span><span class="NAME">J</span><span class="PUNC">,</span><span class="PUNC">-</span><span class="NAME">N</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector2</span><span class="PUNC">(</span><span class="NAME">J</span><span class="PUNC">,</span><span class="NAME">N</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">oa.set</span><span class="PUNC">(</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector2</span><span class="PUNC">(</span><span class="PUNC">-</span><span class="NAME">J</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>313</span> </span><span class="PUNC">-</span><span class="NAME">N</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector2</span><span class="PUNC">(</span><span class="NAME">J</span><span class="PUNC">,</span><span class="NAME">N</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">Z</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">L</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">ka</span><span class="PUNC">=</span><span class="NAME">O</span><span class="PUNC">=</span><span class="NAME">Ua</span><span class="PUNC">=</span><span class="NAME">Pa</span><span class="PUNC">=</span><span class="NAME">pa</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">this.setClearColor</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">M.set</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">w</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">b</span><span class="PUNC">?</span><span class="NAME">b</span><span class="PUNC">:</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">oa.set</span><span class="PUNC">(</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector2</span><span class="PUNC">(</span><span class="PUNC">-</span><span class="NAME">J</span><span class="PUNC">,</span><span class="PUNC">-</span><span class="NAME">N</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector2</span><span class="PUNC">(</span><span class="NAME">J</span><span class="PUNC">,</span><span class="NAME">N</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">this.setClearColorHex</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">console.warn</span><span class="PUNC">(</span><span class="STRN">"DEPRECATED: .setClearColorHex() is being removed. Use .setClearColor() instead."</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.setClearColor</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">this.getMaxAnisotropy</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">this.clear</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">y.setTransform</span><span class="PUNC">(</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">J</span><span class="PUNC">,</span><span class="NAME">N</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">===</span><span class="NAME">oa.empty</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">oa.intersect</span><span class="PUNC">(</span><span class="NAME">fb</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">oa.expandByScalar</span><span class="PUNC">(</span><span class="NUMB">2</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">></span><span class="NAME">w</span><span class="PUNC">&&</span><span class="NAME">y.clearRect</span><span class="PUNC">(</span><span class="NAME">oa.min.x</span><span class="PUNC">|</span><span class="WHIT">
<span class='line'>314</span> </span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">oa.min.y</span><span class="PUNC">|</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">oa.max.x</span><span class="PUNC">-</span><span class="NAME">oa.min.x</span><span class="PUNC">|</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">oa.max.y</span><span class="PUNC">-</span><span class="NAME">oa.min.y</span><span class="PUNC">|</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">&lt;</span><span class="NAME">w</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">n</span><span class="PUNC">(</span><span class="NAME">THREE.NormalBlending</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">m</span><span class="PUNC">(</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">s</span><span class="PUNC">(</span><span class="STRN">"rgba("</span><span class="PUNC">+</span><span class="NAME">Math.floor</span><span class="PUNC">(</span><span class="NUMB">255</span><span class="PUNC">*</span><span class="NAME">M.r</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="STRN">","</span><span class="PUNC">+</span><span class="NAME">Math.floor</span><span class="PUNC">(</span><span class="NUMB">255</span><span class="PUNC">*</span><span class="NAME">M.g</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="STRN">","</span><span class="PUNC">+</span><span class="NAME">Math.floor</span><span class="PUNC">(</span><span class="NUMB">255</span><span class="PUNC">*</span><span class="NAME">M.b</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="STRN">","</span><span class="PUNC">+</span><span class="NAME">w</span><span class="PUNC">+</span><span class="STRN">")"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">y.fillRect</span><span class="PUNC">(</span><span class="NAME">oa.min.x</span><span class="PUNC">|</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">oa.min.y</span><span class="PUNC">|</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">oa.max.x</span><span class="PUNC">-</span><span class="NAME">oa.min.x</span><span class="PUNC">|</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">oa.max.y</span><span class="PUNC">-</span><span class="NAME">oa.min.y</span><span class="PUNC">|</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">oa.makeEmpty</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">this.render</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">===</span><span class="NAME">g</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">THREE.Camera</span><span class="PUNC">)</span><span class="NAME">console.error</span><span class="PUNC">(</span><span class="STRN">"THREE.CanvasRenderer.render: camera is not an instance of THREE.Camera."</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">else</span><span class="PUNC">{</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">===</span><span class="NAME">this.autoClear</span><span class="PUNC">&&</span><span class="NAME">this.clear</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">y.setTransform</span><span class="PUNC">(</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">J</span><span class="PUNC">,</span><span class="NAME">N</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">C.info.render.vertices</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>315</span> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">C.info.render.faces</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">F</span><span class="PUNC">=</span><span class="NAME">G.projectScene</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">,</span><span class="NAME">this.sortObjects</span><span class="PUNC">,</span><span class="NAME">this.sortElements</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">H</span><span class="PUNC">=</span><span class="NAME">F.elements</span><span class="PUNC">;</span><span class="NAME">I</span><span class="PUNC">=</span><span class="NAME">F.lights</span><span class="PUNC">;</span><span class="NAME">D</span><span class="PUNC">=</span><span class="NAME">g</span><span class="PUNC">;</span><span class="NAME">ib.setRGB</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">Tb.setRGB</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">Ub.setRGB</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">k</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">A</span><span class="PUNC">=</span><span class="NAME">I.length</span><span class="PUNC">;</span><span class="NAME">k</span><span class="PUNC">&lt;</span><span class="NAME">A</span><span class="PUNC">;</span><span class="NAME">k</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">w</span><span class="PUNC">=</span><span class="NAME">I</span><span class="PUNC">[</span><span class="NAME">k</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">B</span><span class="PUNC">=</span><span class="NAME">w.color</span><span class="PUNC">;</span><span class="NAME">w</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">THREE.AmbientLight</span><span class="PUNC">?</span><span class="NAME">ib.add</span><span class="PUNC">(</span><span class="NAME">B</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">w</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">THREE.DirectionalLight</span><span class="PUNC">?</span><span class="NAME">Tb.add</span><span class="PUNC">(</span><span class="NAME">B</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">w</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">THREE.PointLight</span><span class="PUNC">&&</span><span class="NAME">Ub.add</span><span class="PUNC">(</span><span class="NAME">B</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="NAME">k</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">A</span><span class="PUNC">=</span><span class="NAME">H.length</span><span class="PUNC">;</span><span class="NAME">k</span><span class="PUNC">&lt;</span><span class="NAME">A</span><span class="PUNC">;</span><span class="NAME">k</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">U</span><span class="PUNC">=</span><span class="NAME">H</span><span class="PUNC">[</span><span class="NAME">k</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">w</span><span class="PUNC">=</span><span class="NAME">U.material</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="PUNC">(</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">===</span><span class="NAME">w</span><span class="PUNC">||</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">===</span><span class="NAME">w.visible</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">va.makeEmpty</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">U</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">THREE.RenderableParticle</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">V</span><span class="PUNC">=</span><span class="NAME">U</span><span class="PUNC">;</span><span class="NAME">V.x</span><span class="PUNC">*</span><span class="PUNC">=</span><span class="NAME">J</span><span class="PUNC">;</span><span class="NAME">V.y</span><span class="PUNC">*</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>316</span> </span><span class="NAME">N</span><span class="PUNC">;</span><span class="NAME">B</span><span class="PUNC">=</span><span class="NAME">V</span><span class="PUNC">;</span><span class="NAME">m</span><span class="PUNC">(</span><span class="NAME">w.opacity</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">n</span><span class="PUNC">(</span><span class="NAME">w.blending</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">mb</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">nb</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">vb</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">zb</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">Zb</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">Jc</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">Kc</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">w</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">THREE.ParticleBasicMaterial</span><span class="PUNC">?</span><span class="KEYW">null</span><span class="PUNC">===</span><span class="NAME">w.map</span><span class="PUNC">?</span><span class="PUNC">(</span><span class="NAME">vb</span><span class="PUNC">=</span><span class="NAME">U.object.scale.x</span><span class="PUNC">,</span><span class="NAME">zb</span><span class="PUNC">=</span><span class="NAME">U.object.scale.y</span><span class="PUNC">,</span><span class="NAME">vb</span><span class="PUNC">*</span><span class="PUNC">=</span><span class="NAME">U.scale.x</span><span class="PUNC">*</span><span class="NAME">J</span><span class="PUNC">,</span><span class="NAME">zb</span><span class="PUNC">*</span><span class="PUNC">=</span><span class="NAME">U.scale.y</span><span class="PUNC">*</span><span class="NAME">N</span><span class="PUNC">,</span><span class="NAME">va.min.set</span><span class="PUNC">(</span><span class="NAME">B.x</span><span class="PUNC">-</span><span class="NAME">vb</span><span class="PUNC">,</span><span class="NAME">B.y</span><span class="PUNC">-</span><span class="NAME">zb</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">va.max.set</span><span class="PUNC">(</span><span class="NAME">B.x</span><span class="PUNC">+</span><span class="NAME">vb</span><span class="PUNC">,</span><span class="NAME">B.y</span><span class="PUNC">+</span><span class="NAME">zb</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">===</span><span class="NAME">fb.isIntersectionBox</span><span class="PUNC">(</span><span class="NAME">va</span><span class="PUNC">)</span><span class="PUNC">?</span><span class="NAME">va.makeEmpty</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="PUNC">(</span><span class="NAME">s</span><span class="PUNC">(</span><span class="NAME">w.color.getStyle</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">y.save</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">y.translate</span><span class="PUNC">(</span><span class="NAME">B.x</span><span class="PUNC">,</span><span class="NAME">B.y</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">y.rotate</span><span class="PUNC">(</span><span class="PUNC">-</span><span class="NAME">U.rotation</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">y.scale</span><span class="PUNC">(</span><span class="NAME">vb</span><span class="PUNC">,</span><span class="NAME">zb</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">y.fillRect</span><span class="PUNC">(</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NUMB">2</span><span class="PUNC">,</span><span class="NUMB">2</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">y.restore</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="PUNC">(</span><span class="NAME">Zb</span><span class="PUNC">=</span><span class="NAME">w.map.image</span><span class="PUNC">,</span><span class="NAME">Jc</span><span class="PUNC">=</span><span class="NAME">Zb.width</span><span class="PUNC">>></span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">Kc</span><span class="PUNC">=</span><span class="NAME">Zb.height</span><span class="PUNC">>></span><span class="WHIT">
<span class='line'>317</span> </span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">vb</span><span class="PUNC">=</span><span class="NAME">U.scale.x</span><span class="PUNC">*</span><span class="NAME">J</span><span class="PUNC">,</span><span class="NAME">zb</span><span class="PUNC">=</span><span class="NAME">U.scale.y</span><span class="PUNC">*</span><span class="NAME">N</span><span class="PUNC">,</span><span class="NAME">mb</span><span class="PUNC">=</span><span class="NAME">vb</span><span class="PUNC">*</span><span class="NAME">Jc</span><span class="PUNC">,</span><span class="NAME">nb</span><span class="PUNC">=</span><span class="NAME">zb</span><span class="PUNC">*</span><span class="NAME">Kc</span><span class="PUNC">,</span><span class="NAME">va.min.set</span><span class="PUNC">(</span><span class="NAME">B.x</span><span class="PUNC">-</span><span class="NAME">mb</span><span class="PUNC">,</span><span class="NAME">B.y</span><span class="PUNC">-</span><span class="NAME">nb</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">va.max.set</span><span class="PUNC">(</span><span class="NAME">B.x</span><span class="PUNC">+</span><span class="NAME">mb</span><span class="PUNC">,</span><span class="NAME">B.y</span><span class="PUNC">+</span><span class="NAME">nb</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">===</span><span class="NAME">fb.isIntersectionBox</span><span class="PUNC">(</span><span class="NAME">va</span><span class="PUNC">)</span><span class="PUNC">?</span><span class="NAME">va.makeEmpty</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="PUNC">(</span><span class="NAME">y.save</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">y.translate</span><span class="PUNC">(</span><span class="NAME">B.x</span><span class="PUNC">,</span><span class="NAME">B.y</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">y.rotate</span><span class="PUNC">(</span><span class="PUNC">-</span><span class="NAME">U.rotation</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">y.scale</span><span class="PUNC">(</span><span class="NAME">vb</span><span class="PUNC">,</span><span class="PUNC">-</span><span class="NAME">zb</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">y.translate</span><span class="PUNC">(</span><span class="PUNC">-</span><span class="NAME">Jc</span><span class="PUNC">,</span><span class="PUNC">-</span><span class="NAME">Kc</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">y.drawImage</span><span class="PUNC">(</span><span class="NAME">Zb</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">y.restore</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">w</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">THREE.ParticleCanvasMaterial</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">mb</span><span class="PUNC">=</span><span class="NAME">U.scale.x</span><span class="PUNC">*</span><span class="NAME">J</span><span class="PUNC">,</span><span class="NAME">nb</span><span class="PUNC">=</span><span class="NAME">U.scale.y</span><span class="PUNC">*</span><span class="NAME">N</span><span class="PUNC">,</span><span class="NAME">va.min.set</span><span class="PUNC">(</span><span class="NAME">B.x</span><span class="PUNC">-</span><span class="NAME">mb</span><span class="PUNC">,</span><span class="NAME">B.y</span><span class="PUNC">-</span><span class="NAME">nb</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">va.max.set</span><span class="PUNC">(</span><span class="NAME">B.x</span><span class="PUNC">+</span><span class="NAME">mb</span><span class="PUNC">,</span><span class="NAME">B.y</span><span class="PUNC">+</span><span class="NAME">nb</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">===</span><span class="NAME">fb.isIntersectionBox</span><span class="PUNC">(</span><span class="NAME">va</span><span class="PUNC">)</span><span class="PUNC">?</span><span class="NAME">va.makeEmpty</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="PUNC">(</span><span class="NAME">r</span><span class="PUNC">(</span><span class="NAME">w.color.getStyle</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">s</span><span class="PUNC">(</span><span class="NAME">w.color.getStyle</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">y.save</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">y.translate</span><span class="PUNC">(</span><span class="NAME">B.x</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>318</span> </span><span class="NAME">B.y</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">y.rotate</span><span class="PUNC">(</span><span class="PUNC">-</span><span class="NAME">U.rotation</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">y.scale</span><span class="PUNC">(</span><span class="NAME">mb</span><span class="PUNC">,</span><span class="NAME">nb</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">w.program</span><span class="PUNC">(</span><span class="NAME">y</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">y.restore</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">U</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">THREE.RenderableLine</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">V</span><span class="PUNC">=</span><span class="NAME">U.v1</span><span class="PUNC">,</span><span class="NAME">ea</span><span class="PUNC">=</span><span class="NAME">U.v2</span><span class="PUNC">,</span><span class="NAME">V.positionScreen.x</span><span class="PUNC">*</span><span class="PUNC">=</span><span class="NAME">J</span><span class="PUNC">,</span><span class="NAME">V.positionScreen.y</span><span class="PUNC">*</span><span class="PUNC">=</span><span class="NAME">N</span><span class="PUNC">,</span><span class="NAME">ea.positionScreen.x</span><span class="PUNC">*</span><span class="PUNC">=</span><span class="NAME">J</span><span class="PUNC">,</span><span class="NAME">ea.positionScreen.y</span><span class="PUNC">*</span><span class="PUNC">=</span><span class="NAME">N</span><span class="PUNC">,</span><span class="NAME">va.setFromPoints</span><span class="PUNC">(</span><span class="PUNC">[</span><span class="NAME">V.positionScreen</span><span class="PUNC">,</span><span class="NAME">ea.positionScreen</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">===</span><span class="NAME">fb.isIntersectionBox</span><span class="PUNC">(</span><span class="NAME">va</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">B</span><span class="PUNC">=</span><span class="NAME">V</span><span class="PUNC">,</span><span class="NAME">mb</span><span class="PUNC">=</span><span class="NAME">ea</span><span class="PUNC">,</span><span class="NAME">m</span><span class="PUNC">(</span><span class="NAME">w.opacity</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">n</span><span class="PUNC">(</span><span class="NAME">w.blending</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">y.beginPath</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">y.moveTo</span><span class="PUNC">(</span><span class="NAME">B.positionScreen.x</span><span class="PUNC">,</span><span class="NAME">B.positionScreen.y</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">y.lineTo</span><span class="PUNC">(</span><span class="NAME">mb.positionScreen.x</span><span class="PUNC">,</span><span class="NAME">mb.positionScreen.y</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">w</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">THREE.LineBasicMaterial</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">p</span><span class="PUNC">(</span><span class="NAME">w.linewidth</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>319</span> </span><span class="NAME">t</span><span class="PUNC">(</span><span class="NAME">w.linecap</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">q</span><span class="PUNC">(</span><span class="NAME">w.linejoin</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">w.vertexColors</span><span class="PUNC">!==</span><span class="NAME">THREE.VertexColors</span><span class="PUNC">)</span><span class="NAME">r</span><span class="PUNC">(</span><span class="NAME">w.color.getStyle</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">nb</span><span class="PUNC">=</span><span class="NAME">U.vertexColors</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">getStyle</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">U</span><span class="PUNC">=</span><span class="NAME">U.vertexColors</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">getStyle</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">nb</span><span class="PUNC">===</span><span class="NAME">U</span><span class="PUNC">)</span><span class="NAME">r</span><span class="PUNC">(</span><span class="NAME">nb</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">else</span><span class="PUNC">{</span><span class="KEYW">try</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">wc</span><span class="PUNC">=</span><span class="NAME">y.createLinearGradient</span><span class="PUNC">(</span><span class="NAME">B.positionScreen.x</span><span class="PUNC">,</span><span class="NAME">B.positionScreen.y</span><span class="PUNC">,</span><span class="NAME">mb.positionScreen.x</span><span class="PUNC">,</span><span class="NAME">mb.positionScreen.y</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">wc.addColorStop</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">nb</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">wc.addColorStop</span><span class="PUNC">(</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">U</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">catch</span><span class="PUNC">(</span><span class="NAME">fd</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">wc</span><span class="PUNC">=</span><span class="NAME">nb</span><span class="PUNC">}</span><span class="NAME">r</span><span class="PUNC">(</span><span class="NAME">wc</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="NAME">y.stroke</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">va.expandByScalar</span><span class="PUNC">(</span><span class="NUMB">2</span><span class="PUNC">*</span><span class="NAME">w.linewidth</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="NAME">w</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">THREE.LineDashedMaterial</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">p</span><span class="PUNC">(</span><span class="NAME">w.linewidth</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">t</span><span class="PUNC">(</span><span class="NAME">w.linecap</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">q</span><span class="PUNC">(</span><span class="NAME">w.linejoin</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">r</span><span class="PUNC">(</span><span class="NAME">w.color.getStyle</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>320</span> </span><span class="NAME">v</span><span class="PUNC">(</span><span class="NAME">w.dashSize</span><span class="PUNC">,</span><span class="NAME">w.gapSize</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">y.stroke</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">va.expandByScalar</span><span class="PUNC">(</span><span class="NUMB">2</span><span class="PUNC">*</span><span class="NAME">w.linewidth</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">v</span><span class="PUNC">(</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="KEYW">null</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">U</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">THREE.RenderableFace3</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">V</span><span class="PUNC">=</span><span class="NAME">U.v1</span><span class="PUNC">;</span><span class="NAME">ea</span><span class="PUNC">=</span><span class="NAME">U.v2</span><span class="PUNC">;</span><span class="NAME">qa</span><span class="PUNC">=</span><span class="NAME">U.v3</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">></span><span class="NAME">V.positionScreen.z</span><span class="PUNC">||</span><span class="NUMB">1</span><span class="PUNC">&lt;</span><span class="NAME">V.positionScreen.z</span><span class="PUNC">)</span><span class="KEYW">continue</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">></span><span class="NAME">ea.positionScreen.z</span><span class="PUNC">||</span><span class="NUMB">1</span><span class="PUNC">&lt;</span><span class="NAME">ea.positionScreen.z</span><span class="PUNC">)</span><span class="KEYW">continue</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">></span><span class="NAME">qa.positionScreen.z</span><span class="PUNC">||</span><span class="NUMB">1</span><span class="PUNC">&lt;</span><span class="NAME">qa.positionScreen.z</span><span class="PUNC">)</span><span class="KEYW">continue</span><span class="PUNC">;</span><span class="NAME">V.positionScreen.x</span><span class="PUNC">*</span><span class="PUNC">=</span><span class="NAME">J</span><span class="PUNC">;</span><span class="NAME">V.positionScreen.y</span><span class="PUNC">*</span><span class="PUNC">=</span><span class="NAME">N</span><span class="PUNC">;</span><span class="NAME">ea.positionScreen.x</span><span class="PUNC">*</span><span class="PUNC">=</span><span class="NAME">J</span><span class="PUNC">;</span><span class="NAME">ea.positionScreen.y</span><span class="PUNC">*</span><span class="PUNC">=</span><span class="NAME">N</span><span class="PUNC">;</span><span class="NAME">qa.positionScreen.x</span><span class="PUNC">*</span><span class="PUNC">=</span><span class="NAME">J</span><span class="PUNC">;</span><span class="NAME">qa.positionScreen.y</span><span class="PUNC">*</span><span class="PUNC">=</span><span class="NAME">N</span><span class="PUNC">;</span><span class="NUMB">0</span><span class="PUNC">&lt;</span><span class="NAME">w.overdraw</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">l</span><span class="PUNC">(</span><span class="NAME">V.positionScreen</span><span class="PUNC">,</span><span class="NAME">ea.positionScreen</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>321</span> </span><span class="NAME">w.overdraw</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">l</span><span class="PUNC">(</span><span class="NAME">ea.positionScreen</span><span class="PUNC">,</span><span class="NAME">qa.positionScreen</span><span class="PUNC">,</span><span class="NAME">w.overdraw</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">l</span><span class="PUNC">(</span><span class="NAME">qa.positionScreen</span><span class="PUNC">,</span><span class="NAME">V.positionScreen</span><span class="PUNC">,</span><span class="NAME">w.overdraw</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">va.setFromPoints</span><span class="PUNC">(</span><span class="PUNC">[</span><span class="NAME">V.positionScreen</span><span class="PUNC">,</span><span class="NAME">ea.positionScreen</span><span class="PUNC">,</span><span class="NAME">qa.positionScreen</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">===</span><span class="NAME">fb.isIntersectionBox</span><span class="PUNC">(</span><span class="NAME">va</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="NAME">c</span><span class="PUNC">(</span><span class="NAME">V</span><span class="PUNC">,</span><span class="NAME">ea</span><span class="PUNC">,</span><span class="NAME">qa</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NUMB">2</span><span class="PUNC">,</span><span class="NAME">U</span><span class="PUNC">,</span><span class="NAME">w</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">U</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">THREE.RenderableFace4</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">V</span><span class="PUNC">=</span><span class="NAME">U.v1</span><span class="PUNC">;</span><span class="NAME">ea</span><span class="PUNC">=</span><span class="NAME">U.v2</span><span class="PUNC">;</span><span class="NAME">qa</span><span class="PUNC">=</span><span class="NAME">U.v3</span><span class="PUNC">;</span><span class="NAME">eb</span><span class="PUNC">=</span><span class="NAME">U.v4</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">></span><span class="NAME">V.positionScreen.z</span><span class="PUNC">||</span><span class="NUMB">1</span><span class="PUNC">&lt;</span><span class="NAME">V.positionScreen.z</span><span class="PUNC">)</span><span class="KEYW">continue</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">></span><span class="NAME">ea.positionScreen.z</span><span class="PUNC">||</span><span class="NUMB">1</span><span class="PUNC">&lt;</span><span class="NAME">ea.positionScreen.z</span><span class="PUNC">)</span><span class="KEYW">continue</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">></span><span class="NAME">qa.positionScreen.z</span><span class="PUNC">||</span><span class="NUMB">1</span><span class="PUNC">&lt;</span><span class="NAME">qa.positionScreen.z</span><span class="PUNC">)</span><span class="KEYW">continue</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">></span><span class="NAME">eb.positionScreen.z</span><span class="PUNC">||</span><span class="WHIT">
<span class='line'>322</span> </span><span class="NUMB">1</span><span class="PUNC">&lt;</span><span class="NAME">eb.positionScreen.z</span><span class="PUNC">)</span><span class="KEYW">continue</span><span class="PUNC">;</span><span class="NAME">V.positionScreen.x</span><span class="PUNC">*</span><span class="PUNC">=</span><span class="NAME">J</span><span class="PUNC">;</span><span class="NAME">V.positionScreen.y</span><span class="PUNC">*</span><span class="PUNC">=</span><span class="NAME">N</span><span class="PUNC">;</span><span class="NAME">ea.positionScreen.x</span><span class="PUNC">*</span><span class="PUNC">=</span><span class="NAME">J</span><span class="PUNC">;</span><span class="NAME">ea.positionScreen.y</span><span class="PUNC">*</span><span class="PUNC">=</span><span class="NAME">N</span><span class="PUNC">;</span><span class="NAME">qa.positionScreen.x</span><span class="PUNC">*</span><span class="PUNC">=</span><span class="NAME">J</span><span class="PUNC">;</span><span class="NAME">qa.positionScreen.y</span><span class="PUNC">*</span><span class="PUNC">=</span><span class="NAME">N</span><span class="PUNC">;</span><span class="NAME">eb.positionScreen.x</span><span class="PUNC">*</span><span class="PUNC">=</span><span class="NAME">J</span><span class="PUNC">;</span><span class="NAME">eb.positionScreen.y</span><span class="PUNC">*</span><span class="PUNC">=</span><span class="NAME">N</span><span class="PUNC">;</span><span class="NAME">pb.positionScreen.copy</span><span class="PUNC">(</span><span class="NAME">ea.positionScreen</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">ub.positionScreen.copy</span><span class="PUNC">(</span><span class="NAME">eb.positionScreen</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NUMB">0</span><span class="PUNC">&lt;</span><span class="NAME">w.overdraw</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">l</span><span class="PUNC">(</span><span class="NAME">V.positionScreen</span><span class="PUNC">,</span><span class="NAME">ea.positionScreen</span><span class="PUNC">,</span><span class="NAME">w.overdraw</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">l</span><span class="PUNC">(</span><span class="NAME">ea.positionScreen</span><span class="PUNC">,</span><span class="NAME">eb.positionScreen</span><span class="PUNC">,</span><span class="NAME">w.overdraw</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">l</span><span class="PUNC">(</span><span class="NAME">eb.positionScreen</span><span class="PUNC">,</span><span class="NAME">V.positionScreen</span><span class="PUNC">,</span><span class="NAME">w.overdraw</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">l</span><span class="PUNC">(</span><span class="NAME">qa.positionScreen</span><span class="PUNC">,</span><span class="NAME">pb.positionScreen</span><span class="PUNC">,</span><span class="NAME">w.overdraw</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>323</span> </span><span class="NAME">l</span><span class="PUNC">(</span><span class="NAME">qa.positionScreen</span><span class="PUNC">,</span><span class="NAME">ub.positionScreen</span><span class="PUNC">,</span><span class="NAME">w.overdraw</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">va.setFromPoints</span><span class="PUNC">(</span><span class="PUNC">[</span><span class="NAME">V.positionScreen</span><span class="PUNC">,</span><span class="NAME">ea.positionScreen</span><span class="PUNC">,</span><span class="NAME">qa.positionScreen</span><span class="PUNC">,</span><span class="NAME">eb.positionScreen</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">===</span><span class="NAME">fb.isIntersectionBox</span><span class="PUNC">(</span><span class="NAME">va</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">B</span><span class="PUNC">=</span><span class="NAME">V</span><span class="PUNC">,</span><span class="NAME">mb</span><span class="PUNC">=</span><span class="NAME">ea</span><span class="PUNC">,</span><span class="NAME">nb</span><span class="PUNC">=</span><span class="NAME">qa</span><span class="PUNC">,</span><span class="NAME">vb</span><span class="PUNC">=</span><span class="NAME">eb</span><span class="PUNC">,</span><span class="NAME">zb</span><span class="PUNC">=</span><span class="NAME">pb</span><span class="PUNC">,</span><span class="NAME">Zb</span><span class="PUNC">=</span><span class="NAME">ub</span><span class="PUNC">,</span><span class="NAME">C.info.render.vertices</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NUMB">4</span><span class="PUNC">,</span><span class="NAME">C.info.render.faces</span><span class="PUNC">++</span><span class="PUNC">,</span><span class="NAME">m</span><span class="PUNC">(</span><span class="NAME">w.opacity</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">n</span><span class="PUNC">(</span><span class="NAME">w.blending</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">w.map</span><span class="PUNC">&&</span><span class="KEYW">null</span><span class="PUNC">!==</span><span class="NAME">w.map</span><span class="PUNC">||</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">w.envMap</span><span class="PUNC">&&</span><span class="KEYW">null</span><span class="PUNC">!==</span><span class="NAME">w.envMap</span><span class="PUNC">?</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">(</span><span class="NAME">B</span><span class="PUNC">,</span><span class="NAME">mb</span><span class="PUNC">,</span><span class="NAME">vb</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NUMB">3</span><span class="PUNC">,</span><span class="NAME">U</span><span class="PUNC">,</span><span class="NAME">w</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">(</span><span class="NAME">zb</span><span class="PUNC">,</span><span class="NAME">nb</span><span class="PUNC">,</span><span class="NAME">Zb</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NUMB">2</span><span class="PUNC">,</span><span class="NUMB">3</span><span class="PUNC">,</span><span class="NAME">U</span><span class="PUNC">,</span><span class="NAME">w</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="PUNC">(</span><span class="NAME">ya</span><span class="PUNC">=</span><span class="NAME">B.positionScreen.x</span><span class="PUNC">,</span><span class="NAME">Ha</span><span class="PUNC">=</span><span class="NAME">B.positionScreen.y</span><span class="PUNC">,</span><span class="NAME">fa</span><span class="PUNC">=</span><span class="NAME">mb.positionScreen.x</span><span class="PUNC">,</span><span class="NAME">da</span><span class="PUNC">=</span><span class="NAME">mb.positionScreen.y</span><span class="PUNC">,</span><span class="NAME">T</span><span class="PUNC">=</span><span class="NAME">nb.positionScreen.x</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>324</span> </span><span class="NAME">aa</span><span class="PUNC">=</span><span class="NAME">nb.positionScreen.y</span><span class="PUNC">,</span><span class="NAME">na</span><span class="PUNC">=</span><span class="NAME">vb.positionScreen.x</span><span class="PUNC">,</span><span class="NAME">ha</span><span class="PUNC">=</span><span class="NAME">vb.positionScreen.y</span><span class="PUNC">,</span><span class="NAME">X</span><span class="PUNC">=</span><span class="NAME">zb.positionScreen.x</span><span class="PUNC">,</span><span class="NAME">xa</span><span class="PUNC">=</span><span class="NAME">zb.positionScreen.y</span><span class="PUNC">,</span><span class="NAME">ab</span><span class="PUNC">=</span><span class="NAME">Zb.positionScreen.x</span><span class="PUNC">,</span><span class="NAME">la</span><span class="PUNC">=</span><span class="NAME">Zb.positionScreen.y</span><span class="PUNC">,</span><span class="NAME">w</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">THREE.MeshLambertMaterial</span><span class="PUNC">||</span><span class="NAME">w</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">THREE.MeshPhongMaterial</span><span class="PUNC">?</span><span class="PUNC">(</span><span class="NAME">Qa.copy</span><span class="PUNC">(</span><span class="NAME">w.color</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">Xa.copy</span><span class="PUNC">(</span><span class="NAME">w.emissive</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">w.vertexColors</span><span class="PUNC">===</span><span class="NAME">THREE.FaceColors</span><span class="PUNC">&&</span><span class="NAME">Qa.multiply</span><span class="PUNC">(</span><span class="NAME">U.color</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">===</span><span class="NAME">w.wireframe</span><span class="PUNC">&&</span><span class="NAME">w.shading</span><span class="PUNC">==</span><span class="NAME">THREE.SmoothShading</span><span class="PUNC">&&</span><span class="NUMB">4</span><span class="PUNC">==</span><span class="NAME">U.vertexNormalsLength</span><span class="PUNC">?</span><span class="PUNC">(</span><span class="NAME">ra.copy</span><span class="PUNC">(</span><span class="NAME">ib</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">ja.copy</span><span class="PUNC">(</span><span class="NAME">ib</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">ua.copy</span><span class="PUNC">(</span><span class="NAME">ib</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">Ra.copy</span><span class="PUNC">(</span><span class="NAME">ib</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">(</span><span class="NAME">U.v1.positionWorld</span><span class="PUNC">,</span><span class="NAME">U.vertexNormalsModel</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">ra</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>325</span> </span><span class="NAME">b</span><span class="PUNC">(</span><span class="NAME">U.v2.positionWorld</span><span class="PUNC">,</span><span class="NAME">U.vertexNormalsModel</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">ja</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">(</span><span class="NAME">U.v4.positionWorld</span><span class="PUNC">,</span><span class="NAME">U.vertexNormalsModel</span><span class="PUNC">[</span><span class="NUMB">3</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">ua</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">(</span><span class="NAME">U.v3.positionWorld</span><span class="PUNC">,</span><span class="NAME">U.vertexNormalsModel</span><span class="PUNC">[</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">Ra</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">ra.multiply</span><span class="PUNC">(</span><span class="NAME">Qa</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">add</span><span class="PUNC">(</span><span class="NAME">Xa</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">ja.multiply</span><span class="PUNC">(</span><span class="NAME">Qa</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">add</span><span class="PUNC">(</span><span class="NAME">Xa</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">ua.multiply</span><span class="PUNC">(</span><span class="NAME">Qa</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">add</span><span class="PUNC">(</span><span class="NAME">Xa</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">Ra.multiply</span><span class="PUNC">(</span><span class="NAME">Qa</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">add</span><span class="PUNC">(</span><span class="NAME">Xa</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">lb</span><span class="PUNC">=</span><span class="NAME">j</span><span class="PUNC">(</span><span class="NAME">ra</span><span class="PUNC">,</span><span class="NAME">ja</span><span class="PUNC">,</span><span class="NAME">ua</span><span class="PUNC">,</span><span class="NAME">Ra</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">(</span><span class="NAME">ya</span><span class="PUNC">,</span><span class="NAME">Ha</span><span class="PUNC">,</span><span class="NAME">fa</span><span class="PUNC">,</span><span class="NAME">da</span><span class="PUNC">,</span><span class="NAME">na</span><span class="PUNC">,</span><span class="NAME">ha</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">(</span><span class="NAME">ya</span><span class="PUNC">,</span><span class="NAME">Ha</span><span class="PUNC">,</span><span class="NAME">fa</span><span class="PUNC">,</span><span class="NAME">da</span><span class="PUNC">,</span><span class="NAME">na</span><span class="PUNC">,</span><span class="NAME">ha</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">lb</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">(</span><span class="NAME">X</span><span class="PUNC">,</span><span class="NAME">xa</span><span class="PUNC">,</span><span class="NAME">T</span><span class="PUNC">,</span><span class="NAME">aa</span><span class="PUNC">,</span><span class="NAME">ab</span><span class="PUNC">,</span><span class="NAME">la</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">(</span><span class="NAME">X</span><span class="PUNC">,</span><span class="NAME">xa</span><span class="PUNC">,</span><span class="NAME">T</span><span class="PUNC">,</span><span class="NAME">aa</span><span class="PUNC">,</span><span class="NAME">ab</span><span class="PUNC">,</span><span class="NAME">la</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">lb</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="PUNC">(</span><span class="NAME">ia.copy</span><span class="PUNC">(</span><span class="NAME">ib</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">(</span><span class="NAME">U.centroidModel</span><span class="PUNC">,</span><span class="NAME">U.normalModel</span><span class="PUNC">,</span><span class="NAME">ia</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">ia.multiply</span><span class="PUNC">(</span><span class="NAME">Qa</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">add</span><span class="PUNC">(</span><span class="NAME">Xa</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">(</span><span class="NAME">ya</span><span class="PUNC">,</span><span class="NAME">Ha</span><span class="PUNC">,</span><span class="NAME">fa</span><span class="PUNC">,</span><span class="NAME">da</span><span class="PUNC">,</span><span class="NAME">T</span><span class="PUNC">,</span><span class="NAME">aa</span><span class="PUNC">,</span><span class="NAME">na</span><span class="PUNC">,</span><span class="NAME">ha</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">===</span><span class="NAME">w.wireframe</span><span class="PUNC">?</span><span class="NAME">f</span><span class="PUNC">(</span><span class="NAME">ia</span><span class="PUNC">,</span><span class="NAME">w.wireframeLinewidth</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>326</span> </span><span class="NAME">w.wireframeLinecap</span><span class="PUNC">,</span><span class="NAME">w.wireframeLinejoin</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">h</span><span class="PUNC">(</span><span class="NAME">ia</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">w</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">THREE.MeshBasicMaterial</span><span class="PUNC">?</span><span class="PUNC">(</span><span class="NAME">ia.copy</span><span class="PUNC">(</span><span class="NAME">w.color</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">w.vertexColors</span><span class="PUNC">===</span><span class="NAME">THREE.FaceColors</span><span class="PUNC">&&</span><span class="NAME">ia.multiply</span><span class="PUNC">(</span><span class="NAME">U.color</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">(</span><span class="NAME">ya</span><span class="PUNC">,</span><span class="NAME">Ha</span><span class="PUNC">,</span><span class="NAME">fa</span><span class="PUNC">,</span><span class="NAME">da</span><span class="PUNC">,</span><span class="NAME">T</span><span class="PUNC">,</span><span class="NAME">aa</span><span class="PUNC">,</span><span class="NAME">na</span><span class="PUNC">,</span><span class="NAME">ha</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">===</span><span class="NAME">w.wireframe</span><span class="PUNC">?</span><span class="NAME">f</span><span class="PUNC">(</span><span class="NAME">ia</span><span class="PUNC">,</span><span class="NAME">w.wireframeLinewidth</span><span class="PUNC">,</span><span class="NAME">w.wireframeLinecap</span><span class="PUNC">,</span><span class="NAME">w.wireframeLinejoin</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">h</span><span class="PUNC">(</span><span class="NAME">ia</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">w</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">THREE.MeshNormalMaterial</span><span class="PUNC">?</span><span class="PUNC">(</span><span class="NAME">B</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">w.shading</span><span class="PUNC">==</span><span class="NAME">THREE.FlatShading</span><span class="PUNC">?</span><span class="PUNC">(</span><span class="NAME">B</span><span class="PUNC">=</span><span class="NAME">U.normalModelView</span><span class="PUNC">,</span><span class="NAME">ia.setRGB</span><span class="PUNC">(</span><span class="NAME">B.x</span><span class="PUNC">,</span><span class="NAME">B.y</span><span class="PUNC">,</span><span class="NAME">B.z</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">multiplyScalar</span><span class="PUNC">(</span><span class="NUMB">0.5</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">addScalar</span><span class="PUNC">(</span><span class="NUMB">0.5</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">(</span><span class="NAME">ya</span><span class="PUNC">,</span><span class="NAME">Ha</span><span class="PUNC">,</span><span class="NAME">fa</span><span class="PUNC">,</span><span class="NAME">da</span><span class="PUNC">,</span><span class="NAME">T</span><span class="PUNC">,</span><span class="NAME">aa</span><span class="PUNC">,</span><span class="NAME">na</span><span class="PUNC">,</span><span class="NAME">ha</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">===</span><span class="NAME">w.wireframe</span><span class="PUNC">?</span><span class="NAME">f</span><span class="PUNC">(</span><span class="NAME">ia</span><span class="PUNC">,</span><span class="NAME">w.wireframeLinewidth</span><span class="PUNC">,</span><span class="NAME">w.wireframeLinecap</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>327</span> </span><span class="NAME">w.wireframeLinejoin</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">h</span><span class="PUNC">(</span><span class="NAME">ia</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">w.shading</span><span class="PUNC">==</span><span class="NAME">THREE.SmoothShading</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">B</span><span class="PUNC">=</span><span class="NAME">U.vertexNormalsModelView</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">ra.setRGB</span><span class="PUNC">(</span><span class="NAME">B.x</span><span class="PUNC">,</span><span class="NAME">B.y</span><span class="PUNC">,</span><span class="NAME">B.z</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">multiplyScalar</span><span class="PUNC">(</span><span class="NUMB">0.5</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">addScalar</span><span class="PUNC">(</span><span class="NUMB">0.5</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">B</span><span class="PUNC">=</span><span class="NAME">U.vertexNormalsModelView</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">ja.setRGB</span><span class="PUNC">(</span><span class="NAME">B.x</span><span class="PUNC">,</span><span class="NAME">B.y</span><span class="PUNC">,</span><span class="NAME">B.z</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">multiplyScalar</span><span class="PUNC">(</span><span class="NUMB">0.5</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">addScalar</span><span class="PUNC">(</span><span class="NUMB">0.5</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">B</span><span class="PUNC">=</span><span class="NAME">U.vertexNormalsModelView</span><span class="PUNC">[</span><span class="NUMB">3</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">ua.setRGB</span><span class="PUNC">(</span><span class="NAME">B.x</span><span class="PUNC">,</span><span class="NAME">B.y</span><span class="PUNC">,</span><span class="NAME">B.z</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">multiplyScalar</span><span class="PUNC">(</span><span class="NUMB">0.5</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">addScalar</span><span class="PUNC">(</span><span class="NUMB">0.5</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">B</span><span class="PUNC">=</span><span class="NAME">U.vertexNormalsModelView</span><span class="PUNC">[</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">Ra.setRGB</span><span class="PUNC">(</span><span class="NAME">B.x</span><span class="PUNC">,</span><span class="NAME">B.y</span><span class="PUNC">,</span><span class="NAME">B.z</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">multiplyScalar</span><span class="PUNC">(</span><span class="NUMB">0.5</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">addScalar</span><span class="PUNC">(</span><span class="NUMB">0.5</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">lb</span><span class="PUNC">=</span><span class="NAME">j</span><span class="PUNC">(</span><span class="NAME">ra</span><span class="PUNC">,</span><span class="NAME">ja</span><span class="PUNC">,</span><span class="NAME">ua</span><span class="PUNC">,</span><span class="NAME">Ra</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">(</span><span class="NAME">ya</span><span class="PUNC">,</span><span class="NAME">Ha</span><span class="PUNC">,</span><span class="NAME">fa</span><span class="PUNC">,</span><span class="NAME">da</span><span class="PUNC">,</span><span class="NAME">na</span><span class="PUNC">,</span><span class="NAME">ha</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">(</span><span class="NAME">ya</span><span class="PUNC">,</span><span class="NAME">Ha</span><span class="PUNC">,</span><span class="NAME">fa</span><span class="PUNC">,</span><span class="NAME">da</span><span class="PUNC">,</span><span class="NAME">na</span><span class="PUNC">,</span><span class="NAME">ha</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">lb</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">(</span><span class="NAME">X</span><span class="PUNC">,</span><span class="NAME">xa</span><span class="PUNC">,</span><span class="NAME">T</span><span class="PUNC">,</span><span class="NAME">aa</span><span class="PUNC">,</span><span class="NAME">ab</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>328</span> </span><span class="NAME">la</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">(</span><span class="NAME">X</span><span class="PUNC">,</span><span class="NAME">xa</span><span class="PUNC">,</span><span class="NAME">T</span><span class="PUNC">,</span><span class="NAME">aa</span><span class="PUNC">,</span><span class="NAME">ab</span><span class="PUNC">,</span><span class="NAME">la</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">lb</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">w</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">THREE.MeshDepthMaterial</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">Sa</span><span class="PUNC">=</span><span class="NAME">D.near</span><span class="PUNC">,</span><span class="NAME">xb</span><span class="PUNC">=</span><span class="NAME">D.far</span><span class="PUNC">,</span><span class="NAME">ra.r</span><span class="PUNC">=</span><span class="NAME">ra.g</span><span class="PUNC">=</span><span class="NAME">ra.b</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">-</span><span class="NAME">z</span><span class="PUNC">(</span><span class="NAME">B.positionScreen.z</span><span class="PUNC">*</span><span class="NAME">B.positionScreen.w</span><span class="PUNC">,</span><span class="NAME">Sa</span><span class="PUNC">,</span><span class="NAME">xb</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">ja.r</span><span class="PUNC">=</span><span class="NAME">ja.g</span><span class="PUNC">=</span><span class="NAME">ja.b</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">-</span><span class="NAME">z</span><span class="PUNC">(</span><span class="NAME">mb.positionScreen.z</span><span class="PUNC">*</span><span class="NAME">mb.positionScreen.w</span><span class="PUNC">,</span><span class="NAME">Sa</span><span class="PUNC">,</span><span class="NAME">xb</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">ua.r</span><span class="PUNC">=</span><span class="NAME">ua.g</span><span class="PUNC">=</span><span class="NAME">ua.b</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">-</span><span class="NAME">z</span><span class="PUNC">(</span><span class="NAME">vb.positionScreen.z</span><span class="PUNC">*</span><span class="NAME">vb.positionScreen.w</span><span class="PUNC">,</span><span class="NAME">Sa</span><span class="PUNC">,</span><span class="NAME">xb</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">Ra.r</span><span class="PUNC">=</span><span class="NAME">Ra.g</span><span class="PUNC">=</span><span class="NAME">Ra.b</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">-</span><span class="NAME">z</span><span class="PUNC">(</span><span class="NAME">nb.positionScreen.z</span><span class="PUNC">*</span><span class="NAME">nb.positionScreen.w</span><span class="PUNC">,</span><span class="NAME">Sa</span><span class="PUNC">,</span><span class="NAME">xb</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">lb</span><span class="PUNC">=</span><span class="NAME">j</span><span class="PUNC">(</span><span class="NAME">ra</span><span class="PUNC">,</span><span class="NAME">ja</span><span class="PUNC">,</span><span class="NAME">ua</span><span class="PUNC">,</span><span class="NAME">Ra</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">(</span><span class="NAME">ya</span><span class="PUNC">,</span><span class="NAME">Ha</span><span class="PUNC">,</span><span class="NAME">fa</span><span class="PUNC">,</span><span class="NAME">da</span><span class="PUNC">,</span><span class="NAME">na</span><span class="PUNC">,</span><span class="NAME">ha</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">(</span><span class="NAME">ya</span><span class="PUNC">,</span><span class="NAME">Ha</span><span class="PUNC">,</span><span class="NAME">fa</span><span class="PUNC">,</span><span class="NAME">da</span><span class="PUNC">,</span><span class="NAME">na</span><span class="PUNC">,</span><span class="NAME">ha</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">lb</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">(</span><span class="NAME">X</span><span class="PUNC">,</span><span class="NAME">xa</span><span class="PUNC">,</span><span class="NAME">T</span><span class="PUNC">,</span><span class="NAME">aa</span><span class="PUNC">,</span><span class="NAME">ab</span><span class="PUNC">,</span><span class="NAME">la</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">(</span><span class="NAME">X</span><span class="PUNC">,</span><span class="NAME">xa</span><span class="PUNC">,</span><span class="NAME">T</span><span class="PUNC">,</span><span class="NAME">aa</span><span class="PUNC">,</span><span class="NAME">ab</span><span class="PUNC">,</span><span class="NAME">la</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">lb</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="NAME">oa.union</span><span class="PUNC">(</span><span class="NAME">va</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="NAME">y.setTransform</span><span class="PUNC">(</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>329</span> </span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.ShaderChunk</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="NAME">fog_pars_fragment</span><span class="PUNC">:</span><span class="STRN">"#ifdef USE_FOG\nuniform vec3 fogColor;\n#ifdef FOG_EXP2\nuniform float fogDensity;\n#else\nuniform float fogNear;\nuniform float fogFar;\n#endif\n#endif"</span><span class="PUNC">,</span><span class="NAME">fog_fragment</span><span class="PUNC">:</span><span class="STRN">"#ifdef USE_FOG\nfloat depth = gl_FragCoord.z / gl_FragCoord.w;\n#ifdef FOG_EXP2\nconst float LOG2 = 1.442695;\nfloat fogFactor = exp2( - fogDensity * fogDensity * depth * depth * LOG2 );\nfogFactor = 1.0 - clamp( fogFactor, 0.0, 1.0 );\n#else\nfloat fogFactor = smoothstep( fogNear, fogFar, depth );\n#endif\ngl_FragColor = mix( gl_FragColor, vec4( fogColor, gl_FragColor.w ), fogFactor );\n#endif"</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>330</span> </span><span class="NAME">envmap_pars_fragment</span><span class="PUNC">:</span><span class="STRN">"#ifdef USE_ENVMAP\nuniform float reflectivity;\nuniform samplerCube envMap;\nuniform float flipEnvMap;\nuniform int combine;\n#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP )\nuniform bool useRefract;\nuniform float refractionRatio;\n#else\nvarying vec3 vReflect;\n#endif\n#endif"</span><span class="PUNC">,</span><span class="NAME">envmap_fragment</span><span class="PUNC">:</span><span class="STRN">"#ifdef USE_ENVMAP\nvec3 reflectVec;\n#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP )\nvec3 cameraToVertex = normalize( vWorldPosition - cameraPosition );\nif ( useRefract ) {\nreflectVec = refract( cameraToVertex, normal, refractionRatio );\n} else { \nreflectVec = reflect( cameraToVertex, normal );\n}\n#else\nreflectVec = vReflect;\n#endif\n#ifdef DOUBLE_SIDED\nfloat flipNormal = ( -1.0 + 2.0 * float( gl_FrontFacing ) );\nvec4 cubeColor = textureCube( envMap, flipNormal * vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n#else\nvec4 cubeColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n#endif\n#ifdef GAMMA_INPUT\ncubeColor.xyz *= cubeColor.xyz;\n#endif\nif ( combine == 1 ) {\ngl_FragColor.xyz = mix( gl_FragColor.xyz, cubeColor.xyz, specularStrength * reflectivity );\n} else if ( combine == 2 ) {\ngl_FragColor.xyz += cubeColor.xyz * specularStrength * reflectivity;\n} else {\ngl_FragColor.xyz = mix( gl_FragColor.xyz, gl_FragColor.xyz * cubeColor.xyz, specularStrength * reflectivity );\n}\n#endif"</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>331</span> </span><span class="NAME">envmap_pars_vertex</span><span class="PUNC">:</span><span class="STRN">"#if defined( USE_ENVMAP ) && ! defined( USE_BUMPMAP ) && ! defined( USE_NORMALMAP )\nvarying vec3 vReflect;\nuniform float refractionRatio;\nuniform bool useRefract;\n#endif"</span><span class="PUNC">,</span><span class="NAME">worldpos_vertex</span><span class="PUNC">:</span><span class="STRN">"#if defined( USE_ENVMAP ) || defined( PHONG ) || defined( LAMBERT ) || defined ( USE_SHADOWMAP )\n#ifdef USE_SKINNING\nvec4 worldPosition = modelMatrix * skinned;\n#endif\n#if defined( USE_MORPHTARGETS ) && ! defined( USE_SKINNING )\nvec4 worldPosition = modelMatrix * vec4( morphed, 1.0 );\n#endif\n#if ! defined( USE_MORPHTARGETS ) && ! defined( USE_SKINNING )\nvec4 worldPosition = modelMatrix * vec4( position, 1.0 );\n#endif\n#endif"</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>332</span> </span><span class="NAME">envmap_vertex</span><span class="PUNC">:</span><span class="STRN">"#if defined( USE_ENVMAP ) && ! defined( USE_BUMPMAP ) && ! defined( USE_NORMALMAP )\nvec3 worldNormal = mat3( modelMatrix[ 0 ].xyz, modelMatrix[ 1 ].xyz, modelMatrix[ 2 ].xyz ) * objectNormal;\nworldNormal = normalize( worldNormal );\nvec3 cameraToVertex = normalize( worldPosition.xyz - cameraPosition );\nif ( useRefract ) {\nvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n} else {\nvReflect = reflect( cameraToVertex, worldNormal );\n}\n#endif"</span><span class="PUNC">,</span><span class="NAME">map_particle_pars_fragment</span><span class="PUNC">:</span><span class="STRN">"#ifdef USE_MAP\nuniform sampler2D map;\n#endif"</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>333</span> </span><span class="NAME">map_particle_fragment</span><span class="PUNC">:</span><span class="STRN">"#ifdef USE_MAP\ngl_FragColor = gl_FragColor * texture2D( map, vec2( gl_PointCoord.x, 1.0 - gl_PointCoord.y ) );\n#endif"</span><span class="PUNC">,</span><span class="NAME">map_pars_vertex</span><span class="PUNC">:</span><span class="STRN">"#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP )\nvarying vec2 vUv;\nuniform vec4 offsetRepeat;\n#endif"</span><span class="PUNC">,</span><span class="NAME">map_pars_fragment</span><span class="PUNC">:</span><span class="STRN">"#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP )\nvarying vec2 vUv;\n#endif\n#ifdef USE_MAP\nuniform sampler2D map;\n#endif"</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>334</span> </span><span class="NAME">map_vertex</span><span class="PUNC">:</span><span class="STRN">"#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP )\nvUv = uv * offsetRepeat.zw + offsetRepeat.xy;\n#endif"</span><span class="PUNC">,</span><span class="NAME">map_fragment</span><span class="PUNC">:</span><span class="STRN">"#ifdef USE_MAP\nvec4 texelColor = texture2D( map, vUv );\n#ifdef GAMMA_INPUT\ntexelColor.xyz *= texelColor.xyz;\n#endif\ngl_FragColor = gl_FragColor * texelColor;\n#endif"</span><span class="PUNC">,</span><span class="NAME">lightmap_pars_fragment</span><span class="PUNC">:</span><span class="STRN">"#ifdef USE_LIGHTMAP\nvarying vec2 vUv2;\nuniform sampler2D lightMap;\n#endif"</span><span class="PUNC">,</span><span class="NAME">lightmap_pars_vertex</span><span class="PUNC">:</span><span class="STRN">"#ifdef USE_LIGHTMAP\nvarying vec2 vUv2;\n#endif"</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>335</span> </span><span class="NAME">lightmap_fragment</span><span class="PUNC">:</span><span class="STRN">"#ifdef USE_LIGHTMAP\ngl_FragColor = gl_FragColor * texture2D( lightMap, vUv2 );\n#endif"</span><span class="PUNC">,</span><span class="NAME">lightmap_vertex</span><span class="PUNC">:</span><span class="STRN">"#ifdef USE_LIGHTMAP\nvUv2 = uv2;\n#endif"</span><span class="PUNC">,</span><span class="NAME">bumpmap_pars_fragment</span><span class="PUNC">:</span><span class="STRN">"#ifdef USE_BUMPMAP\nuniform sampler2D bumpMap;\nuniform float bumpScale;\nvec2 dHdxy_fwd() {\nvec2 dSTdx = dFdx( vUv );\nvec2 dSTdy = dFdy( vUv );\nfloat Hll = bumpScale * texture2D( bumpMap, vUv ).x;\nfloat dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;\nfloat dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;\nreturn vec2( dBx, dBy );\n}\nvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy ) {\nvec3 vSigmaX = dFdx( surf_pos );\nvec3 vSigmaY = dFdy( surf_pos );\nvec3 vN = surf_norm;\nvec3 R1 = cross( vSigmaY, vN );\nvec3 R2 = cross( vN, vSigmaX );\nfloat fDet = dot( vSigmaX, R1 );\nvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\nreturn normalize( abs( fDet ) * surf_norm - vGrad );\n}\n#endif"</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>336</span> </span><span class="NAME">normalmap_pars_fragment</span><span class="PUNC">:</span><span class="STRN">"#ifdef USE_NORMALMAP\nuniform sampler2D normalMap;\nuniform vec2 normalScale;\nvec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm ) {\nvec3 q0 = dFdx( eye_pos.xyz );\nvec3 q1 = dFdy( eye_pos.xyz );\nvec2 st0 = dFdx( vUv.st );\nvec2 st1 = dFdy( vUv.st );\nvec3 S = normalize(  q0 * st1.t - q1 * st0.t );\nvec3 T = normalize( -q0 * st1.s + q1 * st0.s );\nvec3 N = normalize( surf_norm );\nvec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\nmapN.xy = normalScale * mapN.xy;\nmat3 tsn = mat3( S, T, N );\nreturn normalize( tsn * mapN );\n}\n#endif"</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>337</span> </span><span class="NAME">specularmap_pars_fragment</span><span class="PUNC">:</span><span class="STRN">"#ifdef USE_SPECULARMAP\nuniform sampler2D specularMap;\n#endif"</span><span class="PUNC">,</span><span class="NAME">specularmap_fragment</span><span class="PUNC">:</span><span class="STRN">"float specularStrength;\n#ifdef USE_SPECULARMAP\nvec4 texelSpecular = texture2D( specularMap, vUv );\nspecularStrength = texelSpecular.r;\n#else\nspecularStrength = 1.0;\n#endif"</span><span class="PUNC">,</span><span class="NAME">lights_lambert_pars_vertex</span><span class="PUNC">:</span><span class="STRN">"uniform vec3 ambient;\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 ambientLightColor;\n#if MAX_DIR_LIGHTS > 0\nuniform vec3 directionalLightColor[ MAX_DIR_LIGHTS ];\nuniform vec3 directionalLightDirection[ MAX_DIR_LIGHTS ];\n#endif\n#if MAX_HEMI_LIGHTS > 0\nuniform vec3 hemisphereLightSkyColor[ MAX_HEMI_LIGHTS ];\nuniform vec3 hemisphereLightGroundColor[ MAX_HEMI_LIGHTS ];\nuniform vec3 hemisphereLightDirection[ MAX_HEMI_LIGHTS ];\n#endif\n#if MAX_POINT_LIGHTS > 0\nuniform vec3 pointLightColor[ MAX_POINT_LIGHTS ];\nuniform vec3 pointLightPosition[ MAX_POINT_LIGHTS ];\nuniform float pointLightDistance[ MAX_POINT_LIGHTS ];\n#endif\n#if MAX_SPOT_LIGHTS > 0\nuniform vec3 spotLightColor[ MAX_SPOT_LIGHTS ];\nuniform vec3 spotLightPosition[ MAX_SPOT_LIGHTS ];\nuniform vec3 spotLightDirection[ MAX_SPOT_LIGHTS ];\nuniform float spotLightDistance[ MAX_SPOT_LIGHTS ];\nuniform float spotLightAngleCos[ MAX_SPOT_LIGHTS ];\nuniform float spotLightExponent[ MAX_SPOT_LIGHTS ];\n#endif\n#ifdef WRAP_AROUND\nuniform vec3 wrapRGB;\n#endif"</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>338</span> </span><span class="NAME">lights_lambert_vertex</span><span class="PUNC">:</span><span class="STRN">"vLightFront = vec3( 0.0 );\n#ifdef DOUBLE_SIDED\nvLightBack = vec3( 0.0 );\n#endif\ntransformedNormal = normalize( transformedNormal );\n#if MAX_DIR_LIGHTS > 0\nfor( int i = 0; i &lt; MAX_DIR_LIGHTS; i ++ ) {\nvec4 lDirection = viewMatrix * vec4( directionalLightDirection[ i ], 0.0 );\nvec3 dirVector = normalize( lDirection.xyz );\nfloat dotProduct = dot( transformedNormal, dirVector );\nvec3 directionalLightWeighting = vec3( max( dotProduct, 0.0 ) );\n#ifdef DOUBLE_SIDED\nvec3 directionalLightWeightingBack = vec3( max( -dotProduct, 0.0 ) );\n#ifdef WRAP_AROUND\nvec3 directionalLightWeightingHalfBack = vec3( max( -0.5 * dotProduct + 0.5, 0.0 ) );\n#endif\n#endif\n#ifdef WRAP_AROUND\nvec3 directionalLightWeightingHalf = vec3( max( 0.5 * dotProduct + 0.5, 0.0 ) );\ndirectionalLightWeighting = mix( directionalLightWeighting, directionalLightWeightingHalf, wrapRGB );\n#ifdef DOUBLE_SIDED\ndirectionalLightWeightingBack = mix( directionalLightWeightingBack, directionalLightWeightingHalfBack, wrapRGB );\n#endif\n#endif\nvLightFront += directionalLightColor[ i ] * directionalLightWeighting;\n#ifdef DOUBLE_SIDED\nvLightBack += directionalLightColor[ i ] * directionalLightWeightingBack;\n#endif\n}\n#endif\n#if MAX_POINT_LIGHTS > 0\nfor( int i = 0; i &lt; MAX_POINT_LIGHTS; i ++ ) {\nvec4 lPosition = viewMatrix * vec4( pointLightPosition[ i ], 1.0 );\nvec3 lVector = lPosition.xyz - mvPosition.xyz;\nfloat lDistance = 1.0;\nif ( pointLightDistance[ i ] > 0.0 )\nlDistance = 1.0 - min( ( length( lVector ) / pointLightDistance[ i ] ), 1.0 );\nlVector = normalize( lVector );\nfloat dotProduct = dot( transformedNormal, lVector );\nvec3 pointLightWeighting = vec3( max( dotProduct, 0.0 ) );\n#ifdef DOUBLE_SIDED\nvec3 pointLightWeightingBack = vec3( max( -dotProduct, 0.0 ) );\n#ifdef WRAP_AROUND\nvec3 pointLightWeightingHalfBack = vec3( max( -0.5 * dotProduct + 0.5, 0.0 ) );\n#endif\n#endif\n#ifdef WRAP_AROUND\nvec3 pointLightWeightingHalf = vec3( max( 0.5 * dotProduct + 0.5, 0.0 ) );\npointLightWeighting = mix( pointLightWeighting, pointLightWeightingHalf, wrapRGB );\n#ifdef DOUBLE_SIDED\npointLightWeightingBack = mix( pointLightWeightingBack, pointLightWeightingHalfBack, wrapRGB );\n#endif\n#endif\nvLightFront += pointLightColor[ i ] * pointLightWeighting * lDistance;\n#ifdef DOUBLE_SIDED\nvLightBack += pointLightColor[ i ] * pointLightWeightingBack * lDistance;\n#endif\n}\n#endif\n#if MAX_SPOT_LIGHTS > 0\nfor( int i = 0; i &lt; MAX_SPOT_LIGHTS; i ++ ) {\nvec4 lPosition = viewMatrix * vec4( spotLightPosition[ i ], 1.0 );\nvec3 lVector = lPosition.xyz - mvPosition.xyz;\nfloat spotEffect = dot( spotLightDirection[ i ], normalize( spotLightPosition[ i ] - worldPosition.xyz ) );\nif ( spotEffect > spotLightAngleCos[ i ] ) {\nspotEffect = max( pow( spotEffect, spotLightExponent[ i ] ), 0.0 );\nfloat lDistance = 1.0;\nif ( spotLightDistance[ i ] > 0.0 )\nlDistance = 1.0 - min( ( length( lVector ) / spotLightDistance[ i ] ), 1.0 );\nlVector = normalize( lVector );\nfloat dotProduct = dot( transformedNormal, lVector );\nvec3 spotLightWeighting = vec3( max( dotProduct, 0.0 ) );\n#ifdef DOUBLE_SIDED\nvec3 spotLightWeightingBack = vec3( max( -dotProduct, 0.0 ) );\n#ifdef WRAP_AROUND\nvec3 spotLightWeightingHalfBack = vec3( max( -0.5 * dotProduct + 0.5, 0.0 ) );\n#endif\n#endif\n#ifdef WRAP_AROUND\nvec3 spotLightWeightingHalf = vec3( max( 0.5 * dotProduct + 0.5, 0.0 ) );\nspotLightWeighting = mix( spotLightWeighting, spotLightWeightingHalf, wrapRGB );\n#ifdef DOUBLE_SIDED\nspotLightWeightingBack = mix( spotLightWeightingBack, spotLightWeightingHalfBack, wrapRGB );\n#endif\n#endif\nvLightFront += spotLightColor[ i ] * spotLightWeighting * lDistance * spotEffect;\n#ifdef DOUBLE_SIDED\nvLightBack += spotLightColor[ i ] * spotLightWeightingBack * lDistance * spotEffect;\n#endif\n}\n}\n#endif\n#if MAX_HEMI_LIGHTS > 0\nfor( int i = 0; i &lt; MAX_HEMI_LIGHTS; i ++ ) {\nvec4 lDirection = viewMatrix * vec4( hemisphereLightDirection[ i ], 0.0 );\nvec3 lVector = normalize( lDirection.xyz );\nfloat dotProduct = dot( transformedNormal, lVector );\nfloat hemiDiffuseWeight = 0.5 * dotProduct + 0.5;\nfloat hemiDiffuseWeightBack = -0.5 * dotProduct + 0.5;\nvLightFront += mix( hemisphereLightGroundColor[ i ], hemisphereLightSkyColor[ i ], hemiDiffuseWeight );\n#ifdef DOUBLE_SIDED\nvLightBack += mix( hemisphereLightGroundColor[ i ], hemisphereLightSkyColor[ i ], hemiDiffuseWeightBack );\n#endif\n}\n#endif\nvLightFront = vLightFront * diffuse + ambient * ambientLightColor + emissive;\n#ifdef DOUBLE_SIDED\nvLightBack = vLightBack * diffuse + ambient * ambientLightColor + emissive;\n#endif"</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>339</span> </span><span class="NAME">lights_phong_pars_vertex</span><span class="PUNC">:</span><span class="STRN">"#ifndef PHONG_PER_PIXEL\n#if MAX_POINT_LIGHTS > 0\nuniform vec3 pointLightPosition[ MAX_POINT_LIGHTS ];\nuniform float pointLightDistance[ MAX_POINT_LIGHTS ];\nvarying vec4 vPointLight[ MAX_POINT_LIGHTS ];\n#endif\n#if MAX_SPOT_LIGHTS > 0\nuniform vec3 spotLightPosition[ MAX_SPOT_LIGHTS ];\nuniform float spotLightDistance[ MAX_SPOT_LIGHTS ];\nvarying vec4 vSpotLight[ MAX_SPOT_LIGHTS ];\n#endif\n#endif\n#if MAX_SPOT_LIGHTS > 0 || defined( USE_BUMPMAP )\nvarying vec3 vWorldPosition;\n#endif"</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>340</span> </span><span class="NAME">lights_phong_vertex</span><span class="PUNC">:</span><span class="STRN">"#ifndef PHONG_PER_PIXEL\n#if MAX_POINT_LIGHTS > 0\nfor( int i = 0; i &lt; MAX_POINT_LIGHTS; i ++ ) {\nvec4 lPosition = viewMatrix * vec4( pointLightPosition[ i ], 1.0 );\nvec3 lVector = lPosition.xyz - mvPosition.xyz;\nfloat lDistance = 1.0;\nif ( pointLightDistance[ i ] > 0.0 )\nlDistance = 1.0 - min( ( length( lVector ) / pointLightDistance[ i ] ), 1.0 );\nvPointLight[ i ] = vec4( lVector, lDistance );\n}\n#endif\n#if MAX_SPOT_LIGHTS > 0\nfor( int i = 0; i &lt; MAX_SPOT_LIGHTS; i ++ ) {\nvec4 lPosition = viewMatrix * vec4( spotLightPosition[ i ], 1.0 );\nvec3 lVector = lPosition.xyz - mvPosition.xyz;\nfloat lDistance = 1.0;\nif ( spotLightDistance[ i ] > 0.0 )\nlDistance = 1.0 - min( ( length( lVector ) / spotLightDistance[ i ] ), 1.0 );\nvSpotLight[ i ] = vec4( lVector, lDistance );\n}\n#endif\n#endif\n#if MAX_SPOT_LIGHTS > 0 || defined( USE_BUMPMAP )\nvWorldPosition = worldPosition.xyz;\n#endif"</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>341</span> </span><span class="NAME">lights_phong_pars_fragment</span><span class="PUNC">:</span><span class="STRN">"uniform vec3 ambientLightColor;\n#if MAX_DIR_LIGHTS > 0\nuniform vec3 directionalLightColor[ MAX_DIR_LIGHTS ];\nuniform vec3 directionalLightDirection[ MAX_DIR_LIGHTS ];\n#endif\n#if MAX_HEMI_LIGHTS > 0\nuniform vec3 hemisphereLightSkyColor[ MAX_HEMI_LIGHTS ];\nuniform vec3 hemisphereLightGroundColor[ MAX_HEMI_LIGHTS ];\nuniform vec3 hemisphereLightDirection[ MAX_HEMI_LIGHTS ];\n#endif\n#if MAX_POINT_LIGHTS > 0\nuniform vec3 pointLightColor[ MAX_POINT_LIGHTS ];\n#ifdef PHONG_PER_PIXEL\nuniform vec3 pointLightPosition[ MAX_POINT_LIGHTS ];\nuniform float pointLightDistance[ MAX_POINT_LIGHTS ];\n#else\nvarying vec4 vPointLight[ MAX_POINT_LIGHTS ];\n#endif\n#endif\n#if MAX_SPOT_LIGHTS > 0\nuniform vec3 spotLightColor[ MAX_SPOT_LIGHTS ];\nuniform vec3 spotLightPosition[ MAX_SPOT_LIGHTS ];\nuniform vec3 spotLightDirection[ MAX_SPOT_LIGHTS ];\nuniform float spotLightAngleCos[ MAX_SPOT_LIGHTS ];\nuniform float spotLightExponent[ MAX_SPOT_LIGHTS ];\n#ifdef PHONG_PER_PIXEL\nuniform float spotLightDistance[ MAX_SPOT_LIGHTS ];\n#else\nvarying vec4 vSpotLight[ MAX_SPOT_LIGHTS ];\n#endif\n#endif\n#if MAX_SPOT_LIGHTS > 0 || defined( USE_BUMPMAP )\nvarying vec3 vWorldPosition;\n#endif\n#ifdef WRAP_AROUND\nuniform vec3 wrapRGB;\n#endif\nvarying vec3 vViewPosition;\nvarying vec3 vNormal;"</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>342</span> </span><span class="NAME">lights_phong_fragment</span><span class="PUNC">:</span><span class="STRN">"vec3 normal = normalize( vNormal );\nvec3 viewPosition = normalize( vViewPosition );\n#ifdef DOUBLE_SIDED\nnormal = normal * ( -1.0 + 2.0 * float( gl_FrontFacing ) );\n#endif\n#ifdef USE_NORMALMAP\nnormal = perturbNormal2Arb( -vViewPosition, normal );\n#elif defined( USE_BUMPMAP )\nnormal = perturbNormalArb( -vViewPosition, normal, dHdxy_fwd() );\n#endif\n#if MAX_POINT_LIGHTS > 0\nvec3 pointDiffuse  = vec3( 0.0 );\nvec3 pointSpecular = vec3( 0.0 );\nfor ( int i = 0; i &lt; MAX_POINT_LIGHTS; i ++ ) {\n#ifdef PHONG_PER_PIXEL\nvec4 lPosition = viewMatrix * vec4( pointLightPosition[ i ], 1.0 );\nvec3 lVector = lPosition.xyz + vViewPosition.xyz;\nfloat lDistance = 1.0;\nif ( pointLightDistance[ i ] > 0.0 )\nlDistance = 1.0 - min( ( length( lVector ) / pointLightDistance[ i ] ), 1.0 );\nlVector = normalize( lVector );\n#else\nvec3 lVector = normalize( vPointLight[ i ].xyz );\nfloat lDistance = vPointLight[ i ].w;\n#endif\nfloat dotProduct = dot( normal, lVector );\n#ifdef WRAP_AROUND\nfloat pointDiffuseWeightFull = max( dotProduct, 0.0 );\nfloat pointDiffuseWeightHalf = max( 0.5 * dotProduct + 0.5, 0.0 );\nvec3 pointDiffuseWeight = mix( vec3 ( pointDiffuseWeightFull ), vec3( pointDiffuseWeightHalf ), wrapRGB );\n#else\nfloat pointDiffuseWeight = max( dotProduct, 0.0 );\n#endif\npointDiffuse  += diffuse * pointLightColor[ i ] * pointDiffuseWeight * lDistance;\nvec3 pointHalfVector = normalize( lVector + viewPosition );\nfloat pointDotNormalHalf = max( dot( normal, pointHalfVector ), 0.0 );\nfloat pointSpecularWeight = specularStrength * max( pow( pointDotNormalHalf, shininess ), 0.0 );\n#ifdef PHYSICALLY_BASED_SHADING\nfloat specularNormalization = ( shininess + 2.0001 ) / 8.0;\nvec3 schlick = specular + vec3( 1.0 - specular ) * pow( 1.0 - dot( lVector, pointHalfVector ), 5.0 );\npointSpecular += schlick * pointLightColor[ i ] * pointSpecularWeight * pointDiffuseWeight * lDistance * specularNormalization;\n#else\npointSpecular += specular * pointLightColor[ i ] * pointSpecularWeight * pointDiffuseWeight * lDistance;\n#endif\n}\n#endif\n#if MAX_SPOT_LIGHTS > 0\nvec3 spotDiffuse  = vec3( 0.0 );\nvec3 spotSpecular = vec3( 0.0 );\nfor ( int i = 0; i &lt; MAX_SPOT_LIGHTS; i ++ ) {\n#ifdef PHONG_PER_PIXEL\nvec4 lPosition = viewMatrix * vec4( spotLightPosition[ i ], 1.0 );\nvec3 lVector = lPosition.xyz + vViewPosition.xyz;\nfloat lDistance = 1.0;\nif ( spotLightDistance[ i ] > 0.0 )\nlDistance = 1.0 - min( ( length( lVector ) / spotLightDistance[ i ] ), 1.0 );\nlVector = normalize( lVector );\n#else\nvec3 lVector = normalize( vSpotLight[ i ].xyz );\nfloat lDistance = vSpotLight[ i ].w;\n#endif\nfloat spotEffect = dot( spotLightDirection[ i ], normalize( spotLightPosition[ i ] - vWorldPosition ) );\nif ( spotEffect > spotLightAngleCos[ i ] ) {\nspotEffect = max( pow( spotEffect, spotLightExponent[ i ] ), 0.0 );\nfloat dotProduct = dot( normal, lVector );\n#ifdef WRAP_AROUND\nfloat spotDiffuseWeightFull = max( dotProduct, 0.0 );\nfloat spotDiffuseWeightHalf = max( 0.5 * dotProduct + 0.5, 0.0 );\nvec3 spotDiffuseWeight = mix( vec3 ( spotDiffuseWeightFull ), vec3( spotDiffuseWeightHalf ), wrapRGB );\n#else\nfloat spotDiffuseWeight = max( dotProduct, 0.0 );\n#endif\nspotDiffuse += diffuse * spotLightColor[ i ] * spotDiffuseWeight * lDistance * spotEffect;\nvec3 spotHalfVector = normalize( lVector + viewPosition );\nfloat spotDotNormalHalf = max( dot( normal, spotHalfVector ), 0.0 );\nfloat spotSpecularWeight = specularStrength * max( pow( spotDotNormalHalf, shininess ), 0.0 );\n#ifdef PHYSICALLY_BASED_SHADING\nfloat specularNormalization = ( shininess + 2.0001 ) / 8.0;\nvec3 schlick = specular + vec3( 1.0 - specular ) * pow( 1.0 - dot( lVector, spotHalfVector ), 5.0 );\nspotSpecular += schlick * spotLightColor[ i ] * spotSpecularWeight * spotDiffuseWeight * lDistance * specularNormalization * spotEffect;\n#else\nspotSpecular += specular * spotLightColor[ i ] * spotSpecularWeight * spotDiffuseWeight * lDistance * spotEffect;\n#endif\n}\n}\n#endif\n#if MAX_DIR_LIGHTS > 0\nvec3 dirDiffuse  = vec3( 0.0 );\nvec3 dirSpecular = vec3( 0.0 );\nfor( int i = 0; i &lt; MAX_DIR_LIGHTS; i ++ ) {\nvec4 lDirection = viewMatrix * vec4( directionalLightDirection[ i ], 0.0 );\nvec3 dirVector = normalize( lDirection.xyz );\nfloat dotProduct = dot( normal, dirVector );\n#ifdef WRAP_AROUND\nfloat dirDiffuseWeightFull = max( dotProduct, 0.0 );\nfloat dirDiffuseWeightHalf = max( 0.5 * dotProduct + 0.5, 0.0 );\nvec3 dirDiffuseWeight = mix( vec3( dirDiffuseWeightFull ), vec3( dirDiffuseWeightHalf ), wrapRGB );\n#else\nfloat dirDiffuseWeight = max( dotProduct, 0.0 );\n#endif\ndirDiffuse  += diffuse * directionalLightColor[ i ] * dirDiffuseWeight;\nvec3 dirHalfVector = normalize( dirVector + viewPosition );\nfloat dirDotNormalHalf = max( dot( normal, dirHalfVector ), 0.0 );\nfloat dirSpecularWeight = specularStrength * max( pow( dirDotNormalHalf, shininess ), 0.0 );\n#ifdef PHYSICALLY_BASED_SHADING\nfloat specularNormalization = ( shininess + 2.0001 ) / 8.0;\nvec3 schlick = specular + vec3( 1.0 - specular ) * pow( 1.0 - dot( dirVector, dirHalfVector ), 5.0 );\ndirSpecular += schlick * directionalLightColor[ i ] * dirSpecularWeight * dirDiffuseWeight * specularNormalization;\n#else\ndirSpecular += specular * directionalLightColor[ i ] * dirSpecularWeight * dirDiffuseWeight;\n#endif\n}\n#endif\n#if MAX_HEMI_LIGHTS > 0\nvec3 hemiDiffuse  = vec3( 0.0 );\nvec3 hemiSpecular = vec3( 0.0 );\nfor( int i = 0; i &lt; MAX_HEMI_LIGHTS; i ++ ) {\nvec4 lDirection = viewMatrix * vec4( hemisphereLightDirection[ i ], 0.0 );\nvec3 lVector = normalize( lDirection.xyz );\nfloat dotProduct = dot( normal, lVector );\nfloat hemiDiffuseWeight = 0.5 * dotProduct + 0.5;\nvec3 hemiColor = mix( hemisphereLightGroundColor[ i ], hemisphereLightSkyColor[ i ], hemiDiffuseWeight );\nhemiDiffuse += diffuse * hemiColor;\nvec3 hemiHalfVectorSky = normalize( lVector + viewPosition );\nfloat hemiDotNormalHalfSky = 0.5 * dot( normal, hemiHalfVectorSky ) + 0.5;\nfloat hemiSpecularWeightSky = specularStrength * max( pow( hemiDotNormalHalfSky, shininess ), 0.0 );\nvec3 lVectorGround = -lVector;\nvec3 hemiHalfVectorGround = normalize( lVectorGround + viewPosition );\nfloat hemiDotNormalHalfGround = 0.5 * dot( normal, hemiHalfVectorGround ) + 0.5;\nfloat hemiSpecularWeightGround = specularStrength * max( pow( hemiDotNormalHalfGround, shininess ), 0.0 );\n#ifdef PHYSICALLY_BASED_SHADING\nfloat dotProductGround = dot( normal, lVectorGround );\nfloat specularNormalization = ( shininess + 2.0001 ) / 8.0;\nvec3 schlickSky = specular + vec3( 1.0 - specular ) * pow( 1.0 - dot( lVector, hemiHalfVectorSky ), 5.0 );\nvec3 schlickGround = specular + vec3( 1.0 - specular ) * pow( 1.0 - dot( lVectorGround, hemiHalfVectorGround ), 5.0 );\nhemiSpecular += hemiColor * specularNormalization * ( schlickSky * hemiSpecularWeightSky * max( dotProduct, 0.0 ) + schlickGround * hemiSpecularWeightGround * max( dotProductGround, 0.0 ) );\n#else\nhemiSpecular += specular * hemiColor * ( hemiSpecularWeightSky + hemiSpecularWeightGround ) * hemiDiffuseWeight;\n#endif\n}\n#endif\nvec3 totalDiffuse = vec3( 0.0 );\nvec3 totalSpecular = vec3( 0.0 );\n#if MAX_DIR_LIGHTS > 0\ntotalDiffuse += dirDiffuse;\ntotalSpecular += dirSpecular;\n#endif\n#if MAX_HEMI_LIGHTS > 0\ntotalDiffuse += hemiDiffuse;\ntotalSpecular += hemiSpecular;\n#endif\n#if MAX_POINT_LIGHTS > 0\ntotalDiffuse += pointDiffuse;\ntotalSpecular += pointSpecular;\n#endif\n#if MAX_SPOT_LIGHTS > 0\ntotalDiffuse += spotDiffuse;\ntotalSpecular += spotSpecular;\n#endif\n#ifdef METAL\ngl_FragColor.xyz = gl_FragColor.xyz * ( emissive + totalDiffuse + ambientLightColor * ambient + totalSpecular );\n#else\ngl_FragColor.xyz = gl_FragColor.xyz * ( emissive + totalDiffuse + ambientLightColor * ambient ) + totalSpecular;\n#endif"</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>343</span> </span><span class="NAME">color_pars_fragment</span><span class="PUNC">:</span><span class="STRN">"#ifdef USE_COLOR\nvarying vec3 vColor;\n#endif"</span><span class="PUNC">,</span><span class="NAME">color_fragment</span><span class="PUNC">:</span><span class="STRN">"#ifdef USE_COLOR\ngl_FragColor = gl_FragColor * vec4( vColor, opacity );\n#endif"</span><span class="PUNC">,</span><span class="NAME">color_pars_vertex</span><span class="PUNC">:</span><span class="STRN">"#ifdef USE_COLOR\nvarying vec3 vColor;\n#endif"</span><span class="PUNC">,</span><span class="NAME">color_vertex</span><span class="PUNC">:</span><span class="STRN">"#ifdef USE_COLOR\n#ifdef GAMMA_INPUT\nvColor = color * color;\n#else\nvColor = color;\n#endif\n#endif"</span><span class="PUNC">,</span><span class="NAME">skinning_pars_vertex</span><span class="PUNC">:</span><span class="STRN">"#ifdef USE_SKINNING\n#ifdef BONE_TEXTURE\nuniform sampler2D boneTexture;\nmat4 getBoneMatrix( const in float i ) {\nfloat j = i * 4.0;\nfloat x = mod( j, N_BONE_PIXEL_X );\nfloat y = floor( j / N_BONE_PIXEL_X );\nconst float dx = 1.0 / N_BONE_PIXEL_X;\nconst float dy = 1.0 / N_BONE_PIXEL_Y;\ny = dy * ( y + 0.5 );\nvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\nvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\nvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\nvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\nmat4 bone = mat4( v1, v2, v3, v4 );\nreturn bone;\n}\n#else\nuniform mat4 boneGlobalMatrices[ MAX_BONES ];\nmat4 getBoneMatrix( const in float i ) {\nmat4 bone = boneGlobalMatrices[ int(i) ];\nreturn bone;\n}\n#endif\n#endif"</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>344</span> </span><span class="NAME">skinbase_vertex</span><span class="PUNC">:</span><span class="STRN">"#ifdef USE_SKINNING\nmat4 boneMatX = getBoneMatrix( skinIndex.x );\nmat4 boneMatY = getBoneMatrix( skinIndex.y );\n#endif"</span><span class="PUNC">,</span><span class="NAME">skinning_vertex</span><span class="PUNC">:</span><span class="STRN">"#ifdef USE_SKINNING\n#ifdef USE_MORPHTARGETS\nvec4 skinVertex = vec4( morphed, 1.0 );\n#else\nvec4 skinVertex = vec4( position, 1.0 );\n#endif\nvec4 skinned  = boneMatX * skinVertex * skinWeight.x;\nskinned \t  += boneMatY * skinVertex * skinWeight.y;\n#endif"</span><span class="PUNC">,</span><span class="NAME">morphtarget_pars_vertex</span><span class="PUNC">:</span><span class="STRN">"#ifdef USE_MORPHTARGETS\n#ifndef USE_MORPHNORMALS\nuniform float morphTargetInfluences[ 8 ];\n#else\nuniform float morphTargetInfluences[ 4 ];\n#endif\n#endif"</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>345</span> </span><span class="NAME">morphtarget_vertex</span><span class="PUNC">:</span><span class="STRN">"#ifdef USE_MORPHTARGETS\nvec3 morphed = vec3( 0.0 );\nmorphed += ( morphTarget0 - position ) * morphTargetInfluences[ 0 ];\nmorphed += ( morphTarget1 - position ) * morphTargetInfluences[ 1 ];\nmorphed += ( morphTarget2 - position ) * morphTargetInfluences[ 2 ];\nmorphed += ( morphTarget3 - position ) * morphTargetInfluences[ 3 ];\n#ifndef USE_MORPHNORMALS\nmorphed += ( morphTarget4 - position ) * morphTargetInfluences[ 4 ];\nmorphed += ( morphTarget5 - position ) * morphTargetInfluences[ 5 ];\nmorphed += ( morphTarget6 - position ) * morphTargetInfluences[ 6 ];\nmorphed += ( morphTarget7 - position ) * morphTargetInfluences[ 7 ];\n#endif\nmorphed += position;\n#endif"</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>346</span> </span><span class="NAME">default_vertex</span><span class="PUNC">:</span><span class="STRN">"vec4 mvPosition;\n#ifdef USE_SKINNING\nmvPosition = modelViewMatrix * skinned;\n#endif\n#if !defined( USE_SKINNING ) && defined( USE_MORPHTARGETS )\nmvPosition = modelViewMatrix * vec4( morphed, 1.0 );\n#endif\n#if !defined( USE_SKINNING ) && ! defined( USE_MORPHTARGETS )\nmvPosition = modelViewMatrix * vec4( position, 1.0 );\n#endif\ngl_Position = projectionMatrix * mvPosition;"</span><span class="PUNC">,</span><span class="NAME">morphnormal_vertex</span><span class="PUNC">:</span><span class="STRN">"#ifdef USE_MORPHNORMALS\nvec3 morphedNormal = vec3( 0.0 );\nmorphedNormal +=  ( morphNormal0 - normal ) * morphTargetInfluences[ 0 ];\nmorphedNormal +=  ( morphNormal1 - normal ) * morphTargetInfluences[ 1 ];\nmorphedNormal +=  ( morphNormal2 - normal ) * morphTargetInfluences[ 2 ];\nmorphedNormal +=  ( morphNormal3 - normal ) * morphTargetInfluences[ 3 ];\nmorphedNormal += normal;\n#endif"</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>347</span> </span><span class="NAME">skinnormal_vertex</span><span class="PUNC">:</span><span class="STRN">"#ifdef USE_SKINNING\nmat4 skinMatrix = skinWeight.x * boneMatX;\nskinMatrix \t+= skinWeight.y * boneMatY;\n#ifdef USE_MORPHNORMALS\nvec4 skinnedNormal = skinMatrix * vec4( morphedNormal, 0.0 );\n#else\nvec4 skinnedNormal = skinMatrix * vec4( normal, 0.0 );\n#endif\n#endif"</span><span class="PUNC">,</span><span class="NAME">defaultnormal_vertex</span><span class="PUNC">:</span><span class="STRN">"vec3 objectNormal;\n#ifdef USE_SKINNING\nobjectNormal = skinnedNormal.xyz;\n#endif\n#if !defined( USE_SKINNING ) && defined( USE_MORPHNORMALS )\nobjectNormal = morphedNormal;\n#endif\n#if !defined( USE_SKINNING ) && ! defined( USE_MORPHNORMALS )\nobjectNormal = normal;\n#endif\n#ifdef FLIP_SIDED\nobjectNormal = -objectNormal;\n#endif\nvec3 transformedNormal = normalMatrix * objectNormal;"</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>348</span> </span><span class="NAME">shadowmap_pars_fragment</span><span class="PUNC">:</span><span class="STRN">"#ifdef USE_SHADOWMAP\nuniform sampler2D shadowMap[ MAX_SHADOWS ];\nuniform vec2 shadowMapSize[ MAX_SHADOWS ];\nuniform float shadowDarkness[ MAX_SHADOWS ];\nuniform float shadowBias[ MAX_SHADOWS ];\nvarying vec4 vShadowCoord[ MAX_SHADOWS ];\nfloat unpackDepth( const in vec4 rgba_depth ) {\nconst vec4 bit_shift = vec4( 1.0 / ( 256.0 * 256.0 * 256.0 ), 1.0 / ( 256.0 * 256.0 ), 1.0 / 256.0, 1.0 );\nfloat depth = dot( rgba_depth, bit_shift );\nreturn depth;\n}\n#endif"</span><span class="PUNC">,</span><span class="NAME">shadowmap_fragment</span><span class="PUNC">:</span><span class="STRN">"#ifdef USE_SHADOWMAP\n#ifdef SHADOWMAP_DEBUG\nvec3 frustumColors[3];\nfrustumColors[0] = vec3( 1.0, 0.5, 0.0 );\nfrustumColors[1] = vec3( 0.0, 1.0, 0.8 );\nfrustumColors[2] = vec3( 0.0, 0.5, 1.0 );\n#endif\n#ifdef SHADOWMAP_CASCADE\nint inFrustumCount = 0;\n#endif\nfloat fDepth;\nvec3 shadowColor = vec3( 1.0 );\nfor( int i = 0; i &lt; MAX_SHADOWS; i ++ ) {\nvec3 shadowCoord = vShadowCoord[ i ].xyz / vShadowCoord[ i ].w;\nbvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x &lt;= 1.0, shadowCoord.y >= 0.0, shadowCoord.y &lt;= 1.0 );\nbool inFrustum = all( inFrustumVec );\n#ifdef SHADOWMAP_CASCADE\ninFrustumCount += int( inFrustum );\nbvec3 frustumTestVec = bvec3( inFrustum, inFrustumCount == 1, shadowCoord.z &lt;= 1.0 );\n#else\nbvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z &lt;= 1.0 );\n#endif\nbool frustumTest = all( frustumTestVec );\nif ( frustumTest ) {\nshadowCoord.z += shadowBias[ i ];\n#if defined( SHADOWMAP_TYPE_PCF )\nfloat shadow = 0.0;\nconst float shadowDelta = 1.0 / 9.0;\nfloat xPixelOffset = 1.0 / shadowMapSize[ i ].x;\nfloat yPixelOffset = 1.0 / shadowMapSize[ i ].y;\nfloat dx0 = -1.25 * xPixelOffset;\nfloat dy0 = -1.25 * yPixelOffset;\nfloat dx1 = 1.25 * xPixelOffset;\nfloat dy1 = 1.25 * yPixelOffset;\nfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, dy0 ) ) );\nif ( fDepth &lt; shadowCoord.z ) shadow += shadowDelta;\nfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( 0.0, dy0 ) ) );\nif ( fDepth &lt; shadowCoord.z ) shadow += shadowDelta;\nfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, dy0 ) ) );\nif ( fDepth &lt; shadowCoord.z ) shadow += shadowDelta;\nfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, 0.0 ) ) );\nif ( fDepth &lt; shadowCoord.z ) shadow += shadowDelta;\nfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy ) );\nif ( fDepth &lt; shadowCoord.z ) shadow += shadowDelta;\nfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, 0.0 ) ) );\nif ( fDepth &lt; shadowCoord.z ) shadow += shadowDelta;\nfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, dy1 ) ) );\nif ( fDepth &lt; shadowCoord.z ) shadow += shadowDelta;\nfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( 0.0, dy1 ) ) );\nif ( fDepth &lt; shadowCoord.z ) shadow += shadowDelta;\nfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, dy1 ) ) );\nif ( fDepth &lt; shadowCoord.z ) shadow += shadowDelta;\nshadowColor = shadowColor * vec3( ( 1.0 - shadowDarkness[ i ] * shadow ) );\n#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\nfloat shadow = 0.0;\nfloat xPixelOffset = 1.0 / shadowMapSize[ i ].x;\nfloat yPixelOffset = 1.0 / shadowMapSize[ i ].y;\nfloat dx0 = -1.0 * xPixelOffset;\nfloat dy0 = -1.0 * yPixelOffset;\nfloat dx1 = 1.0 * xPixelOffset;\nfloat dy1 = 1.0 * yPixelOffset;\nmat3 shadowKernel;\nmat3 depthKernel;\ndepthKernel[0][0] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, dy0 ) ) );\ndepthKernel[0][1] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, 0.0 ) ) );\ndepthKernel[0][2] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, dy1 ) ) );\ndepthKernel[1][0] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( 0.0, dy0 ) ) );\ndepthKernel[1][1] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy ) );\ndepthKernel[1][2] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( 0.0, dy1 ) ) );\ndepthKernel[2][0] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, dy0 ) ) );\ndepthKernel[2][1] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, 0.0 ) ) );\ndepthKernel[2][2] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, dy1 ) ) );\nvec3 shadowZ = vec3( shadowCoord.z );\nshadowKernel[0] = vec3(lessThan(depthKernel[0], shadowZ ));\nshadowKernel[0] *= vec3(0.25);\nshadowKernel[1] = vec3(lessThan(depthKernel[1], shadowZ ));\nshadowKernel[1] *= vec3(0.25);\nshadowKernel[2] = vec3(lessThan(depthKernel[2], shadowZ ));\nshadowKernel[2] *= vec3(0.25);\nvec2 fractionalCoord = 1.0 - fract( shadowCoord.xy * shadowMapSize[i].xy );\nshadowKernel[0] = mix( shadowKernel[1], shadowKernel[0], fractionalCoord.x );\nshadowKernel[1] = mix( shadowKernel[2], shadowKernel[1], fractionalCoord.x );\nvec4 shadowValues;\nshadowValues.x = mix( shadowKernel[0][1], shadowKernel[0][0], fractionalCoord.y );\nshadowValues.y = mix( shadowKernel[0][2], shadowKernel[0][1], fractionalCoord.y );\nshadowValues.z = mix( shadowKernel[1][1], shadowKernel[1][0], fractionalCoord.y );\nshadowValues.w = mix( shadowKernel[1][2], shadowKernel[1][1], fractionalCoord.y );\nshadow = dot( shadowValues, vec4( 1.0 ) );\nshadowColor = shadowColor * vec3( ( 1.0 - shadowDarkness[ i ] * shadow ) );\n#else\nvec4 rgbaDepth = texture2D( shadowMap[ i ], shadowCoord.xy );\nfloat fDepth = unpackDepth( rgbaDepth );\nif ( fDepth &lt; shadowCoord.z )\nshadowColor = shadowColor * vec3( 1.0 - shadowDarkness[ i ] );\n#endif\n}\n#ifdef SHADOWMAP_DEBUG\n#ifdef SHADOWMAP_CASCADE\nif ( inFrustum && inFrustumCount == 1 ) gl_FragColor.xyz *= frustumColors[ i ];\n#else\nif ( inFrustum ) gl_FragColor.xyz *= frustumColors[ i ];\n#endif\n#endif\n}\n#ifdef GAMMA_OUTPUT\nshadowColor *= shadowColor;\n#endif\ngl_FragColor.xyz = gl_FragColor.xyz * shadowColor;\n#endif"</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>349</span> </span><span class="NAME">shadowmap_pars_vertex</span><span class="PUNC">:</span><span class="STRN">"#ifdef USE_SHADOWMAP\nvarying vec4 vShadowCoord[ MAX_SHADOWS ];\nuniform mat4 shadowMatrix[ MAX_SHADOWS ];\n#endif"</span><span class="PUNC">,</span><span class="NAME">shadowmap_vertex</span><span class="PUNC">:</span><span class="STRN">"#ifdef USE_SHADOWMAP\nfor( int i = 0; i &lt; MAX_SHADOWS; i ++ ) {\nvShadowCoord[ i ] = shadowMatrix[ i ] * worldPosition;\n}\n#endif"</span><span class="PUNC">,</span><span class="NAME">alphatest_fragment</span><span class="PUNC">:</span><span class="STRN">"#ifdef ALPHATEST\nif ( gl_FragColor.a &lt; ALPHATEST ) discard;\n#endif"</span><span class="PUNC">,</span><span class="NAME">linear_to_gamma_fragment</span><span class="PUNC">:</span><span class="STRN">"#ifdef GAMMA_OUTPUT\ngl_FragColor.xyz = sqrt( gl_FragColor.xyz );\n#endif"</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>350</span> </span><span class="NAME">THREE.UniformsUtils</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="NAME">merge</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">&lt;</span><span class="NAME">a.length</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">c</span><span class="WHIT"> </span><span class="KEYW">in</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">this.clone</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">)</span><span class="NAME">e</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">e</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">clone</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">b</span><span class="WHIT"> </span><span class="KEYW">in</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">)</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">c</span><span class="WHIT"> </span><span class="KEYW">in</span><span class="WHIT"> </span><span class="NAME">e</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">]</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">]</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">d</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">THREE.Color</span><span class="PUNC">||</span><span class="NAME">d</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">THREE.Vector2</span><span class="PUNC">||</span><span class="NAME">d</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">||</span><span class="NAME">d</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">THREE.Vector4</span><span class="PUNC">||</span><span class="NAME">d</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">THREE.Matrix4</span><span class="PUNC">||</span><span class="NAME">d</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">THREE.Texture</span><span class="PUNC">?</span><span class="NAME">d.clone</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">d</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">Array</span><span class="PUNC">?</span><span class="NAME">d.slice</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">d</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">e</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>351</span> </span><span class="NAME">THREE.UniformsLib</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="NAME">common</span><span class="PUNC">:</span><span class="PUNC">{</span><span class="NAME">diffuse</span><span class="PUNC">:</span><span class="PUNC">{</span><span class="NAME">type</span><span class="PUNC">:</span><span class="STRN">"c"</span><span class="PUNC">,</span><span class="NAME">value</span><span class="PUNC">:</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Color</span><span class="PUNC">(</span><span class="NUMB">15658734</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">opacity</span><span class="PUNC">:</span><span class="PUNC">{</span><span class="NAME">type</span><span class="PUNC">:</span><span class="STRN">"f"</span><span class="PUNC">,</span><span class="NAME">value</span><span class="PUNC">:</span><span class="NUMB">1</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">map</span><span class="PUNC">:</span><span class="PUNC">{</span><span class="NAME">type</span><span class="PUNC">:</span><span class="STRN">"t"</span><span class="PUNC">,</span><span class="NAME">value</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">offsetRepeat</span><span class="PUNC">:</span><span class="PUNC">{</span><span class="NAME">type</span><span class="PUNC">:</span><span class="STRN">"v4"</span><span class="PUNC">,</span><span class="NAME">value</span><span class="PUNC">:</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector4</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">lightMap</span><span class="PUNC">:</span><span class="PUNC">{</span><span class="NAME">type</span><span class="PUNC">:</span><span class="STRN">"t"</span><span class="PUNC">,</span><span class="NAME">value</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">specularMap</span><span class="PUNC">:</span><span class="PUNC">{</span><span class="NAME">type</span><span class="PUNC">:</span><span class="STRN">"t"</span><span class="PUNC">,</span><span class="NAME">value</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">envMap</span><span class="PUNC">:</span><span class="PUNC">{</span><span class="NAME">type</span><span class="PUNC">:</span><span class="STRN">"t"</span><span class="PUNC">,</span><span class="NAME">value</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">flipEnvMap</span><span class="PUNC">:</span><span class="PUNC">{</span><span class="NAME">type</span><span class="PUNC">:</span><span class="STRN">"f"</span><span class="PUNC">,</span><span class="NAME">value</span><span class="PUNC">:</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">useRefract</span><span class="PUNC">:</span><span class="PUNC">{</span><span class="NAME">type</span><span class="PUNC">:</span><span class="STRN">"i"</span><span class="PUNC">,</span><span class="NAME">value</span><span class="PUNC">:</span><span class="NUMB">0</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">reflectivity</span><span class="PUNC">:</span><span class="PUNC">{</span><span class="NAME">type</span><span class="PUNC">:</span><span class="STRN">"f"</span><span class="PUNC">,</span><span class="NAME">value</span><span class="PUNC">:</span><span class="NUMB">1</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">refractionRatio</span><span class="PUNC">:</span><span class="PUNC">{</span><span class="NAME">type</span><span class="PUNC">:</span><span class="STRN">"f"</span><span class="PUNC">,</span><span class="NAME">value</span><span class="PUNC">:</span><span class="NUMB">0.98</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">combine</span><span class="PUNC">:</span><span class="PUNC">{</span><span class="NAME">type</span><span class="PUNC">:</span><span class="STRN">"i"</span><span class="PUNC">,</span><span class="NAME">value</span><span class="PUNC">:</span><span class="NUMB">0</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">morphTargetInfluences</span><span class="PUNC">:</span><span class="PUNC">{</span><span class="NAME">type</span><span class="PUNC">:</span><span class="STRN">"f"</span><span class="PUNC">,</span><span class="NAME">value</span><span class="PUNC">:</span><span class="NUMB">0</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">bump</span><span class="PUNC">:</span><span class="PUNC">{</span><span class="NAME">bumpMap</span><span class="PUNC">:</span><span class="PUNC">{</span><span class="NAME">type</span><span class="PUNC">:</span><span class="STRN">"t"</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>352</span> </span><span class="NAME">value</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">bumpScale</span><span class="PUNC">:</span><span class="PUNC">{</span><span class="NAME">type</span><span class="PUNC">:</span><span class="STRN">"f"</span><span class="PUNC">,</span><span class="NAME">value</span><span class="PUNC">:</span><span class="NUMB">1</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">normalmap</span><span class="PUNC">:</span><span class="PUNC">{</span><span class="NAME">normalMap</span><span class="PUNC">:</span><span class="PUNC">{</span><span class="NAME">type</span><span class="PUNC">:</span><span class="STRN">"t"</span><span class="PUNC">,</span><span class="NAME">value</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">normalScale</span><span class="PUNC">:</span><span class="PUNC">{</span><span class="NAME">type</span><span class="PUNC">:</span><span class="STRN">"v2"</span><span class="PUNC">,</span><span class="NAME">value</span><span class="PUNC">:</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector2</span><span class="PUNC">(</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">fog</span><span class="PUNC">:</span><span class="PUNC">{</span><span class="NAME">fogDensity</span><span class="PUNC">:</span><span class="PUNC">{</span><span class="NAME">type</span><span class="PUNC">:</span><span class="STRN">"f"</span><span class="PUNC">,</span><span class="NAME">value</span><span class="PUNC">:</span><span class="NUMB">2.5</span><span class="NAME">E</span><span class="PUNC">-</span><span class="NUMB">4</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">fogNear</span><span class="PUNC">:</span><span class="PUNC">{</span><span class="NAME">type</span><span class="PUNC">:</span><span class="STRN">"f"</span><span class="PUNC">,</span><span class="NAME">value</span><span class="PUNC">:</span><span class="NUMB">1</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">fogFar</span><span class="PUNC">:</span><span class="PUNC">{</span><span class="NAME">type</span><span class="PUNC">:</span><span class="STRN">"f"</span><span class="PUNC">,</span><span class="NAME">value</span><span class="PUNC">:</span><span class="NUMB">2</span><span class="NAME">E3</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">fogColor</span><span class="PUNC">:</span><span class="PUNC">{</span><span class="NAME">type</span><span class="PUNC">:</span><span class="STRN">"c"</span><span class="PUNC">,</span><span class="NAME">value</span><span class="PUNC">:</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Color</span><span class="PUNC">(</span><span class="NUMB">16777215</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">lights</span><span class="PUNC">:</span><span class="PUNC">{</span><span class="NAME">ambientLightColor</span><span class="PUNC">:</span><span class="PUNC">{</span><span class="NAME">type</span><span class="PUNC">:</span><span class="STRN">"fv"</span><span class="PUNC">,</span><span class="NAME">value</span><span class="PUNC">:</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">directionalLightDirection</span><span class="PUNC">:</span><span class="PUNC">{</span><span class="NAME">type</span><span class="PUNC">:</span><span class="STRN">"fv"</span><span class="PUNC">,</span><span class="NAME">value</span><span class="PUNC">:</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">directionalLightColor</span><span class="PUNC">:</span><span class="PUNC">{</span><span class="NAME">type</span><span class="PUNC">:</span><span class="STRN">"fv"</span><span class="PUNC">,</span><span class="NAME">value</span><span class="PUNC">:</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">hemisphereLightDirection</span><span class="PUNC">:</span><span class="PUNC">{</span><span class="NAME">type</span><span class="PUNC">:</span><span class="STRN">"fv"</span><span class="PUNC">,</span><span class="NAME">value</span><span class="PUNC">:</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">hemisphereLightSkyColor</span><span class="PUNC">:</span><span class="PUNC">{</span><span class="NAME">type</span><span class="PUNC">:</span><span class="STRN">"fv"</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>353</span> </span><span class="NAME">value</span><span class="PUNC">:</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">hemisphereLightGroundColor</span><span class="PUNC">:</span><span class="PUNC">{</span><span class="NAME">type</span><span class="PUNC">:</span><span class="STRN">"fv"</span><span class="PUNC">,</span><span class="NAME">value</span><span class="PUNC">:</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">pointLightColor</span><span class="PUNC">:</span><span class="PUNC">{</span><span class="NAME">type</span><span class="PUNC">:</span><span class="STRN">"fv"</span><span class="PUNC">,</span><span class="NAME">value</span><span class="PUNC">:</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">pointLightPosition</span><span class="PUNC">:</span><span class="PUNC">{</span><span class="NAME">type</span><span class="PUNC">:</span><span class="STRN">"fv"</span><span class="PUNC">,</span><span class="NAME">value</span><span class="PUNC">:</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">pointLightDistance</span><span class="PUNC">:</span><span class="PUNC">{</span><span class="NAME">type</span><span class="PUNC">:</span><span class="STRN">"fv1"</span><span class="PUNC">,</span><span class="NAME">value</span><span class="PUNC">:</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">spotLightColor</span><span class="PUNC">:</span><span class="PUNC">{</span><span class="NAME">type</span><span class="PUNC">:</span><span class="STRN">"fv"</span><span class="PUNC">,</span><span class="NAME">value</span><span class="PUNC">:</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">spotLightPosition</span><span class="PUNC">:</span><span class="PUNC">{</span><span class="NAME">type</span><span class="PUNC">:</span><span class="STRN">"fv"</span><span class="PUNC">,</span><span class="NAME">value</span><span class="PUNC">:</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">spotLightDirection</span><span class="PUNC">:</span><span class="PUNC">{</span><span class="NAME">type</span><span class="PUNC">:</span><span class="STRN">"fv"</span><span class="PUNC">,</span><span class="NAME">value</span><span class="PUNC">:</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">spotLightDistance</span><span class="PUNC">:</span><span class="PUNC">{</span><span class="NAME">type</span><span class="PUNC">:</span><span class="STRN">"fv1"</span><span class="PUNC">,</span><span class="NAME">value</span><span class="PUNC">:</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">spotLightAngleCos</span><span class="PUNC">:</span><span class="PUNC">{</span><span class="NAME">type</span><span class="PUNC">:</span><span class="STRN">"fv1"</span><span class="PUNC">,</span><span class="NAME">value</span><span class="PUNC">:</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">spotLightExponent</span><span class="PUNC">:</span><span class="PUNC">{</span><span class="NAME">type</span><span class="PUNC">:</span><span class="STRN">"fv1"</span><span class="PUNC">,</span><span class="NAME">value</span><span class="PUNC">:</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">particle</span><span class="PUNC">:</span><span class="PUNC">{</span><span class="NAME">psColor</span><span class="PUNC">:</span><span class="PUNC">{</span><span class="NAME">type</span><span class="PUNC">:</span><span class="STRN">"c"</span><span class="PUNC">,</span><span class="NAME">value</span><span class="PUNC">:</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Color</span><span class="PUNC">(</span><span class="NUMB">15658734</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">opacity</span><span class="PUNC">:</span><span class="PUNC">{</span><span class="NAME">type</span><span class="PUNC">:</span><span class="STRN">"f"</span><span class="PUNC">,</span><span class="NAME">value</span><span class="PUNC">:</span><span class="NUMB">1</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">size</span><span class="PUNC">:</span><span class="PUNC">{</span><span class="NAME">type</span><span class="PUNC">:</span><span class="STRN">"f"</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>354</span> </span><span class="NAME">value</span><span class="PUNC">:</span><span class="NUMB">1</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">scale</span><span class="PUNC">:</span><span class="PUNC">{</span><span class="NAME">type</span><span class="PUNC">:</span><span class="STRN">"f"</span><span class="PUNC">,</span><span class="NAME">value</span><span class="PUNC">:</span><span class="NUMB">1</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">map</span><span class="PUNC">:</span><span class="PUNC">{</span><span class="NAME">type</span><span class="PUNC">:</span><span class="STRN">"t"</span><span class="PUNC">,</span><span class="NAME">value</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">fogDensity</span><span class="PUNC">:</span><span class="PUNC">{</span><span class="NAME">type</span><span class="PUNC">:</span><span class="STRN">"f"</span><span class="PUNC">,</span><span class="NAME">value</span><span class="PUNC">:</span><span class="NUMB">2.5</span><span class="NAME">E</span><span class="PUNC">-</span><span class="NUMB">4</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">fogNear</span><span class="PUNC">:</span><span class="PUNC">{</span><span class="NAME">type</span><span class="PUNC">:</span><span class="STRN">"f"</span><span class="PUNC">,</span><span class="NAME">value</span><span class="PUNC">:</span><span class="NUMB">1</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">fogFar</span><span class="PUNC">:</span><span class="PUNC">{</span><span class="NAME">type</span><span class="PUNC">:</span><span class="STRN">"f"</span><span class="PUNC">,</span><span class="NAME">value</span><span class="PUNC">:</span><span class="NUMB">2</span><span class="NAME">E3</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">fogColor</span><span class="PUNC">:</span><span class="PUNC">{</span><span class="NAME">type</span><span class="PUNC">:</span><span class="STRN">"c"</span><span class="PUNC">,</span><span class="NAME">value</span><span class="PUNC">:</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Color</span><span class="PUNC">(</span><span class="NUMB">16777215</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">shadowmap</span><span class="PUNC">:</span><span class="PUNC">{</span><span class="NAME">shadowMap</span><span class="PUNC">:</span><span class="PUNC">{</span><span class="NAME">type</span><span class="PUNC">:</span><span class="STRN">"tv"</span><span class="PUNC">,</span><span class="NAME">value</span><span class="PUNC">:</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">shadowMapSize</span><span class="PUNC">:</span><span class="PUNC">{</span><span class="NAME">type</span><span class="PUNC">:</span><span class="STRN">"v2v"</span><span class="PUNC">,</span><span class="NAME">value</span><span class="PUNC">:</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">shadowBias</span><span class="PUNC">:</span><span class="PUNC">{</span><span class="NAME">type</span><span class="PUNC">:</span><span class="STRN">"fv1"</span><span class="PUNC">,</span><span class="NAME">value</span><span class="PUNC">:</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">shadowDarkness</span><span class="PUNC">:</span><span class="PUNC">{</span><span class="NAME">type</span><span class="PUNC">:</span><span class="STRN">"fv1"</span><span class="PUNC">,</span><span class="NAME">value</span><span class="PUNC">:</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">shadowMatrix</span><span class="PUNC">:</span><span class="PUNC">{</span><span class="NAME">type</span><span class="PUNC">:</span><span class="STRN">"m4v"</span><span class="PUNC">,</span><span class="NAME">value</span><span class="PUNC">:</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>355</span> </span><span class="NAME">THREE.ShaderLib</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="NAME">basic</span><span class="PUNC">:</span><span class="PUNC">{</span><span class="NAME">uniforms</span><span class="PUNC">:</span><span class="NAME">THREE.UniformsUtils.merge</span><span class="PUNC">(</span><span class="PUNC">[</span><span class="NAME">THREE.UniformsLib.common</span><span class="PUNC">,</span><span class="NAME">THREE.UniformsLib.fog</span><span class="PUNC">,</span><span class="NAME">THREE.UniformsLib.shadowmap</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">vertexShader</span><span class="PUNC">:</span><span class="PUNC">[</span><span class="NAME">THREE.ShaderChunk.map_pars_vertex</span><span class="PUNC">,</span><span class="NAME">THREE.ShaderChunk.lightmap_pars_vertex</span><span class="PUNC">,</span><span class="NAME">THREE.ShaderChunk.envmap_pars_vertex</span><span class="PUNC">,</span><span class="NAME">THREE.ShaderChunk.color_pars_vertex</span><span class="PUNC">,</span><span class="NAME">THREE.ShaderChunk.morphtarget_pars_vertex</span><span class="PUNC">,</span><span class="NAME">THREE.ShaderChunk.skinning_pars_vertex</span><span class="PUNC">,</span><span class="NAME">THREE.ShaderChunk.shadowmap_pars_vertex</span><span class="PUNC">,</span><span class="STRN">"void main() {"</span><span class="PUNC">,</span><span class="NAME">THREE.ShaderChunk.map_vertex</span><span class="PUNC">,</span><span class="NAME">THREE.ShaderChunk.lightmap_vertex</span><span class="PUNC">,</span><span class="NAME">THREE.ShaderChunk.color_vertex</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>356</span> </span><span class="NAME">THREE.ShaderChunk.skinbase_vertex</span><span class="PUNC">,</span><span class="STRN">"#ifdef USE_ENVMAP"</span><span class="PUNC">,</span><span class="NAME">THREE.ShaderChunk.morphnormal_vertex</span><span class="PUNC">,</span><span class="NAME">THREE.ShaderChunk.skinnormal_vertex</span><span class="PUNC">,</span><span class="NAME">THREE.ShaderChunk.defaultnormal_vertex</span><span class="PUNC">,</span><span class="STRN">"#endif"</span><span class="PUNC">,</span><span class="NAME">THREE.ShaderChunk.morphtarget_vertex</span><span class="PUNC">,</span><span class="NAME">THREE.ShaderChunk.skinning_vertex</span><span class="PUNC">,</span><span class="NAME">THREE.ShaderChunk.default_vertex</span><span class="PUNC">,</span><span class="NAME">THREE.ShaderChunk.worldpos_vertex</span><span class="PUNC">,</span><span class="NAME">THREE.ShaderChunk.envmap_vertex</span><span class="PUNC">,</span><span class="NAME">THREE.ShaderChunk.shadowmap_vertex</span><span class="PUNC">,</span><span class="STRN">"}"</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">join</span><span class="PUNC">(</span><span class="STRN">"\n"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">fragmentShader</span><span class="PUNC">:</span><span class="PUNC">[</span><span class="STRN">"uniform vec3 diffuse;\nuniform float opacity;"</span><span class="PUNC">,</span><span class="NAME">THREE.ShaderChunk.color_pars_fragment</span><span class="PUNC">,</span><span class="NAME">THREE.ShaderChunk.map_pars_fragment</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>357</span> </span><span class="NAME">THREE.ShaderChunk.lightmap_pars_fragment</span><span class="PUNC">,</span><span class="NAME">THREE.ShaderChunk.envmap_pars_fragment</span><span class="PUNC">,</span><span class="NAME">THREE.ShaderChunk.fog_pars_fragment</span><span class="PUNC">,</span><span class="NAME">THREE.ShaderChunk.shadowmap_pars_fragment</span><span class="PUNC">,</span><span class="NAME">THREE.ShaderChunk.specularmap_pars_fragment</span><span class="PUNC">,</span><span class="STRN">"void main() {\ngl_FragColor = vec4( diffuse, opacity );"</span><span class="PUNC">,</span><span class="NAME">THREE.ShaderChunk.map_fragment</span><span class="PUNC">,</span><span class="NAME">THREE.ShaderChunk.alphatest_fragment</span><span class="PUNC">,</span><span class="NAME">THREE.ShaderChunk.specularmap_fragment</span><span class="PUNC">,</span><span class="NAME">THREE.ShaderChunk.lightmap_fragment</span><span class="PUNC">,</span><span class="NAME">THREE.ShaderChunk.color_fragment</span><span class="PUNC">,</span><span class="NAME">THREE.ShaderChunk.envmap_fragment</span><span class="PUNC">,</span><span class="NAME">THREE.ShaderChunk.shadowmap_fragment</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>358</span> </span><span class="NAME">THREE.ShaderChunk.linear_to_gamma_fragment</span><span class="PUNC">,</span><span class="NAME">THREE.ShaderChunk.fog_fragment</span><span class="PUNC">,</span><span class="STRN">"}"</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">join</span><span class="PUNC">(</span><span class="STRN">"\n"</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">lambert</span><span class="PUNC">:</span><span class="PUNC">{</span><span class="NAME">uniforms</span><span class="PUNC">:</span><span class="NAME">THREE.UniformsUtils.merge</span><span class="PUNC">(</span><span class="PUNC">[</span><span class="NAME">THREE.UniformsLib.common</span><span class="PUNC">,</span><span class="NAME">THREE.UniformsLib.fog</span><span class="PUNC">,</span><span class="NAME">THREE.UniformsLib.lights</span><span class="PUNC">,</span><span class="NAME">THREE.UniformsLib.shadowmap</span><span class="PUNC">,</span><span class="PUNC">{</span><span class="NAME">ambient</span><span class="PUNC">:</span><span class="PUNC">{</span><span class="NAME">type</span><span class="PUNC">:</span><span class="STRN">"c"</span><span class="PUNC">,</span><span class="NAME">value</span><span class="PUNC">:</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Color</span><span class="PUNC">(</span><span class="NUMB">16777215</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">emissive</span><span class="PUNC">:</span><span class="PUNC">{</span><span class="NAME">type</span><span class="PUNC">:</span><span class="STRN">"c"</span><span class="PUNC">,</span><span class="NAME">value</span><span class="PUNC">:</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Color</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">wrapRGB</span><span class="PUNC">:</span><span class="PUNC">{</span><span class="NAME">type</span><span class="PUNC">:</span><span class="STRN">"v3"</span><span class="PUNC">,</span><span class="NAME">value</span><span class="PUNC">:</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">(</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">vertexShader</span><span class="PUNC">:</span><span class="PUNC">[</span><span class="STRN">"#define LAMBERT\nvarying vec3 vLightFront;\n#ifdef DOUBLE_SIDED\nvarying vec3 vLightBack;\n#endif"</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>359</span> </span><span class="NAME">THREE.ShaderChunk.map_pars_vertex</span><span class="PUNC">,</span><span class="NAME">THREE.ShaderChunk.lightmap_pars_vertex</span><span class="PUNC">,</span><span class="NAME">THREE.ShaderChunk.envmap_pars_vertex</span><span class="PUNC">,</span><span class="NAME">THREE.ShaderChunk.lights_lambert_pars_vertex</span><span class="PUNC">,</span><span class="NAME">THREE.ShaderChunk.color_pars_vertex</span><span class="PUNC">,</span><span class="NAME">THREE.ShaderChunk.morphtarget_pars_vertex</span><span class="PUNC">,</span><span class="NAME">THREE.ShaderChunk.skinning_pars_vertex</span><span class="PUNC">,</span><span class="NAME">THREE.ShaderChunk.shadowmap_pars_vertex</span><span class="PUNC">,</span><span class="STRN">"void main() {"</span><span class="PUNC">,</span><span class="NAME">THREE.ShaderChunk.map_vertex</span><span class="PUNC">,</span><span class="NAME">THREE.ShaderChunk.lightmap_vertex</span><span class="PUNC">,</span><span class="NAME">THREE.ShaderChunk.color_vertex</span><span class="PUNC">,</span><span class="NAME">THREE.ShaderChunk.morphnormal_vertex</span><span class="PUNC">,</span><span class="NAME">THREE.ShaderChunk.skinbase_vertex</span><span class="PUNC">,</span><span class="NAME">THREE.ShaderChunk.skinnormal_vertex</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>360</span> </span><span class="NAME">THREE.ShaderChunk.defaultnormal_vertex</span><span class="PUNC">,</span><span class="NAME">THREE.ShaderChunk.morphtarget_vertex</span><span class="PUNC">,</span><span class="NAME">THREE.ShaderChunk.skinning_vertex</span><span class="PUNC">,</span><span class="NAME">THREE.ShaderChunk.default_vertex</span><span class="PUNC">,</span><span class="NAME">THREE.ShaderChunk.worldpos_vertex</span><span class="PUNC">,</span><span class="NAME">THREE.ShaderChunk.envmap_vertex</span><span class="PUNC">,</span><span class="NAME">THREE.ShaderChunk.lights_lambert_vertex</span><span class="PUNC">,</span><span class="NAME">THREE.ShaderChunk.shadowmap_vertex</span><span class="PUNC">,</span><span class="STRN">"}"</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">join</span><span class="PUNC">(</span><span class="STRN">"\n"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">fragmentShader</span><span class="PUNC">:</span><span class="PUNC">[</span><span class="STRN">"uniform float opacity;\nvarying vec3 vLightFront;\n#ifdef DOUBLE_SIDED\nvarying vec3 vLightBack;\n#endif"</span><span class="PUNC">,</span><span class="NAME">THREE.ShaderChunk.color_pars_fragment</span><span class="PUNC">,</span><span class="NAME">THREE.ShaderChunk.map_pars_fragment</span><span class="PUNC">,</span><span class="NAME">THREE.ShaderChunk.lightmap_pars_fragment</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>361</span> </span><span class="NAME">THREE.ShaderChunk.envmap_pars_fragment</span><span class="PUNC">,</span><span class="NAME">THREE.ShaderChunk.fog_pars_fragment</span><span class="PUNC">,</span><span class="NAME">THREE.ShaderChunk.shadowmap_pars_fragment</span><span class="PUNC">,</span><span class="NAME">THREE.ShaderChunk.specularmap_pars_fragment</span><span class="PUNC">,</span><span class="STRN">"void main() {\ngl_FragColor = vec4( vec3 ( 1.0 ), opacity );"</span><span class="PUNC">,</span><span class="NAME">THREE.ShaderChunk.map_fragment</span><span class="PUNC">,</span><span class="NAME">THREE.ShaderChunk.alphatest_fragment</span><span class="PUNC">,</span><span class="NAME">THREE.ShaderChunk.specularmap_fragment</span><span class="PUNC">,</span><span class="STRN">"#ifdef DOUBLE_SIDED\nif ( gl_FrontFacing )\ngl_FragColor.xyz *= vLightFront;\nelse\ngl_FragColor.xyz *= vLightBack;\n#else\ngl_FragColor.xyz *= vLightFront;\n#endif"</span><span class="PUNC">,</span><span class="NAME">THREE.ShaderChunk.lightmap_fragment</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>362</span> </span><span class="NAME">THREE.ShaderChunk.color_fragment</span><span class="PUNC">,</span><span class="NAME">THREE.ShaderChunk.envmap_fragment</span><span class="PUNC">,</span><span class="NAME">THREE.ShaderChunk.shadowmap_fragment</span><span class="PUNC">,</span><span class="NAME">THREE.ShaderChunk.linear_to_gamma_fragment</span><span class="PUNC">,</span><span class="NAME">THREE.ShaderChunk.fog_fragment</span><span class="PUNC">,</span><span class="STRN">"}"</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">join</span><span class="PUNC">(</span><span class="STRN">"\n"</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">phong</span><span class="PUNC">:</span><span class="PUNC">{</span><span class="NAME">uniforms</span><span class="PUNC">:</span><span class="NAME">THREE.UniformsUtils.merge</span><span class="PUNC">(</span><span class="PUNC">[</span><span class="NAME">THREE.UniformsLib.common</span><span class="PUNC">,</span><span class="NAME">THREE.UniformsLib.bump</span><span class="PUNC">,</span><span class="NAME">THREE.UniformsLib.normalmap</span><span class="PUNC">,</span><span class="NAME">THREE.UniformsLib.fog</span><span class="PUNC">,</span><span class="NAME">THREE.UniformsLib.lights</span><span class="PUNC">,</span><span class="NAME">THREE.UniformsLib.shadowmap</span><span class="PUNC">,</span><span class="PUNC">{</span><span class="NAME">ambient</span><span class="PUNC">:</span><span class="PUNC">{</span><span class="NAME">type</span><span class="PUNC">:</span><span class="STRN">"c"</span><span class="PUNC">,</span><span class="NAME">value</span><span class="PUNC">:</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Color</span><span class="PUNC">(</span><span class="NUMB">16777215</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">emissive</span><span class="PUNC">:</span><span class="PUNC">{</span><span class="NAME">type</span><span class="PUNC">:</span><span class="STRN">"c"</span><span class="PUNC">,</span><span class="NAME">value</span><span class="PUNC">:</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Color</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">specular</span><span class="PUNC">:</span><span class="PUNC">{</span><span class="NAME">type</span><span class="PUNC">:</span><span class="STRN">"c"</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>363</span> </span><span class="NAME">value</span><span class="PUNC">:</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Color</span><span class="PUNC">(</span><span class="NUMB">1118481</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">shininess</span><span class="PUNC">:</span><span class="PUNC">{</span><span class="NAME">type</span><span class="PUNC">:</span><span class="STRN">"f"</span><span class="PUNC">,</span><span class="NAME">value</span><span class="PUNC">:</span><span class="NUMB">30</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">wrapRGB</span><span class="PUNC">:</span><span class="PUNC">{</span><span class="NAME">type</span><span class="PUNC">:</span><span class="STRN">"v3"</span><span class="PUNC">,</span><span class="NAME">value</span><span class="PUNC">:</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">(</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">vertexShader</span><span class="PUNC">:</span><span class="PUNC">[</span><span class="STRN">"#define PHONG\nvarying vec3 vViewPosition;\nvarying vec3 vNormal;"</span><span class="PUNC">,</span><span class="NAME">THREE.ShaderChunk.map_pars_vertex</span><span class="PUNC">,</span><span class="NAME">THREE.ShaderChunk.lightmap_pars_vertex</span><span class="PUNC">,</span><span class="NAME">THREE.ShaderChunk.envmap_pars_vertex</span><span class="PUNC">,</span><span class="NAME">THREE.ShaderChunk.lights_phong_pars_vertex</span><span class="PUNC">,</span><span class="NAME">THREE.ShaderChunk.color_pars_vertex</span><span class="PUNC">,</span><span class="NAME">THREE.ShaderChunk.morphtarget_pars_vertex</span><span class="PUNC">,</span><span class="NAME">THREE.ShaderChunk.skinning_pars_vertex</span><span class="PUNC">,</span><span class="NAME">THREE.ShaderChunk.shadowmap_pars_vertex</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>364</span> </span><span class="STRN">"void main() {"</span><span class="PUNC">,</span><span class="NAME">THREE.ShaderChunk.map_vertex</span><span class="PUNC">,</span><span class="NAME">THREE.ShaderChunk.lightmap_vertex</span><span class="PUNC">,</span><span class="NAME">THREE.ShaderChunk.color_vertex</span><span class="PUNC">,</span><span class="NAME">THREE.ShaderChunk.morphnormal_vertex</span><span class="PUNC">,</span><span class="NAME">THREE.ShaderChunk.skinbase_vertex</span><span class="PUNC">,</span><span class="NAME">THREE.ShaderChunk.skinnormal_vertex</span><span class="PUNC">,</span><span class="NAME">THREE.ShaderChunk.defaultnormal_vertex</span><span class="PUNC">,</span><span class="STRN">"vNormal = normalize( transformedNormal );"</span><span class="PUNC">,</span><span class="NAME">THREE.ShaderChunk.morphtarget_vertex</span><span class="PUNC">,</span><span class="NAME">THREE.ShaderChunk.skinning_vertex</span><span class="PUNC">,</span><span class="NAME">THREE.ShaderChunk.default_vertex</span><span class="PUNC">,</span><span class="STRN">"vViewPosition = -mvPosition.xyz;"</span><span class="PUNC">,</span><span class="NAME">THREE.ShaderChunk.worldpos_vertex</span><span class="PUNC">,</span><span class="NAME">THREE.ShaderChunk.envmap_vertex</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>365</span> </span><span class="NAME">THREE.ShaderChunk.lights_phong_vertex</span><span class="PUNC">,</span><span class="NAME">THREE.ShaderChunk.shadowmap_vertex</span><span class="PUNC">,</span><span class="STRN">"}"</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">join</span><span class="PUNC">(</span><span class="STRN">"\n"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">fragmentShader</span><span class="PUNC">:</span><span class="PUNC">[</span><span class="STRN">"uniform vec3 diffuse;\nuniform float opacity;\nuniform vec3 ambient;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;"</span><span class="PUNC">,</span><span class="NAME">THREE.ShaderChunk.color_pars_fragment</span><span class="PUNC">,</span><span class="NAME">THREE.ShaderChunk.map_pars_fragment</span><span class="PUNC">,</span><span class="NAME">THREE.ShaderChunk.lightmap_pars_fragment</span><span class="PUNC">,</span><span class="NAME">THREE.ShaderChunk.envmap_pars_fragment</span><span class="PUNC">,</span><span class="NAME">THREE.ShaderChunk.fog_pars_fragment</span><span class="PUNC">,</span><span class="NAME">THREE.ShaderChunk.lights_phong_pars_fragment</span><span class="PUNC">,</span><span class="NAME">THREE.ShaderChunk.shadowmap_pars_fragment</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>366</span> </span><span class="NAME">THREE.ShaderChunk.bumpmap_pars_fragment</span><span class="PUNC">,</span><span class="NAME">THREE.ShaderChunk.normalmap_pars_fragment</span><span class="PUNC">,</span><span class="NAME">THREE.ShaderChunk.specularmap_pars_fragment</span><span class="PUNC">,</span><span class="STRN">"void main() {\ngl_FragColor = vec4( vec3 ( 1.0 ), opacity );"</span><span class="PUNC">,</span><span class="NAME">THREE.ShaderChunk.map_fragment</span><span class="PUNC">,</span><span class="NAME">THREE.ShaderChunk.alphatest_fragment</span><span class="PUNC">,</span><span class="NAME">THREE.ShaderChunk.specularmap_fragment</span><span class="PUNC">,</span><span class="NAME">THREE.ShaderChunk.lights_phong_fragment</span><span class="PUNC">,</span><span class="NAME">THREE.ShaderChunk.lightmap_fragment</span><span class="PUNC">,</span><span class="NAME">THREE.ShaderChunk.color_fragment</span><span class="PUNC">,</span><span class="NAME">THREE.ShaderChunk.envmap_fragment</span><span class="PUNC">,</span><span class="NAME">THREE.ShaderChunk.shadowmap_fragment</span><span class="PUNC">,</span><span class="NAME">THREE.ShaderChunk.linear_to_gamma_fragment</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>367</span> </span><span class="NAME">THREE.ShaderChunk.fog_fragment</span><span class="PUNC">,</span><span class="STRN">"}"</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">join</span><span class="PUNC">(</span><span class="STRN">"\n"</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">particle_basic</span><span class="PUNC">:</span><span class="PUNC">{</span><span class="NAME">uniforms</span><span class="PUNC">:</span><span class="NAME">THREE.UniformsUtils.merge</span><span class="PUNC">(</span><span class="PUNC">[</span><span class="NAME">THREE.UniformsLib.particle</span><span class="PUNC">,</span><span class="NAME">THREE.UniformsLib.shadowmap</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">vertexShader</span><span class="PUNC">:</span><span class="PUNC">[</span><span class="STRN">"uniform float size;\nuniform float scale;"</span><span class="PUNC">,</span><span class="NAME">THREE.ShaderChunk.color_pars_vertex</span><span class="PUNC">,</span><span class="NAME">THREE.ShaderChunk.shadowmap_pars_vertex</span><span class="PUNC">,</span><span class="STRN">"void main() {"</span><span class="PUNC">,</span><span class="NAME">THREE.ShaderChunk.color_vertex</span><span class="PUNC">,</span><span class="STRN">"vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );\n#ifdef USE_SIZEATTENUATION\ngl_PointSize = size * ( scale / length( mvPosition.xyz ) );\n#else\ngl_PointSize = size;\n#endif\ngl_Position = projectionMatrix * mvPosition;"</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>368</span> </span><span class="NAME">THREE.ShaderChunk.worldpos_vertex</span><span class="PUNC">,</span><span class="NAME">THREE.ShaderChunk.shadowmap_vertex</span><span class="PUNC">,</span><span class="STRN">"}"</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">join</span><span class="PUNC">(</span><span class="STRN">"\n"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">fragmentShader</span><span class="PUNC">:</span><span class="PUNC">[</span><span class="STRN">"uniform vec3 psColor;\nuniform float opacity;"</span><span class="PUNC">,</span><span class="NAME">THREE.ShaderChunk.color_pars_fragment</span><span class="PUNC">,</span><span class="NAME">THREE.ShaderChunk.map_particle_pars_fragment</span><span class="PUNC">,</span><span class="NAME">THREE.ShaderChunk.fog_pars_fragment</span><span class="PUNC">,</span><span class="NAME">THREE.ShaderChunk.shadowmap_pars_fragment</span><span class="PUNC">,</span><span class="STRN">"void main() {\ngl_FragColor = vec4( psColor, opacity );"</span><span class="PUNC">,</span><span class="NAME">THREE.ShaderChunk.map_particle_fragment</span><span class="PUNC">,</span><span class="NAME">THREE.ShaderChunk.alphatest_fragment</span><span class="PUNC">,</span><span class="NAME">THREE.ShaderChunk.color_fragment</span><span class="PUNC">,</span><span class="NAME">THREE.ShaderChunk.shadowmap_fragment</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>369</span> </span><span class="NAME">THREE.ShaderChunk.fog_fragment</span><span class="PUNC">,</span><span class="STRN">"}"</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">join</span><span class="PUNC">(</span><span class="STRN">"\n"</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">dashed</span><span class="PUNC">:</span><span class="PUNC">{</span><span class="NAME">uniforms</span><span class="PUNC">:</span><span class="NAME">THREE.UniformsUtils.merge</span><span class="PUNC">(</span><span class="PUNC">[</span><span class="NAME">THREE.UniformsLib.common</span><span class="PUNC">,</span><span class="NAME">THREE.UniformsLib.fog</span><span class="PUNC">,</span><span class="PUNC">{</span><span class="NAME">scale</span><span class="PUNC">:</span><span class="PUNC">{</span><span class="NAME">type</span><span class="PUNC">:</span><span class="STRN">"f"</span><span class="PUNC">,</span><span class="NAME">value</span><span class="PUNC">:</span><span class="NUMB">1</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">dashSize</span><span class="PUNC">:</span><span class="PUNC">{</span><span class="NAME">type</span><span class="PUNC">:</span><span class="STRN">"f"</span><span class="PUNC">,</span><span class="NAME">value</span><span class="PUNC">:</span><span class="NUMB">1</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">totalSize</span><span class="PUNC">:</span><span class="PUNC">{</span><span class="NAME">type</span><span class="PUNC">:</span><span class="STRN">"f"</span><span class="PUNC">,</span><span class="NAME">value</span><span class="PUNC">:</span><span class="NUMB">2</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">vertexShader</span><span class="PUNC">:</span><span class="PUNC">[</span><span class="STRN">"uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;"</span><span class="PUNC">,</span><span class="NAME">THREE.ShaderChunk.color_pars_vertex</span><span class="PUNC">,</span><span class="STRN">"void main() {"</span><span class="PUNC">,</span><span class="NAME">THREE.ShaderChunk.color_vertex</span><span class="PUNC">,</span><span class="STRN">"vLineDistance = scale * lineDistance;\nvec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );\ngl_Position = projectionMatrix * mvPosition;\n}"</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">join</span><span class="PUNC">(</span><span class="STRN">"\n"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>370</span> </span><span class="NAME">fragmentShader</span><span class="PUNC">:</span><span class="PUNC">[</span><span class="STRN">"uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;"</span><span class="PUNC">,</span><span class="NAME">THREE.ShaderChunk.color_pars_fragment</span><span class="PUNC">,</span><span class="NAME">THREE.ShaderChunk.fog_pars_fragment</span><span class="PUNC">,</span><span class="STRN">"void main() {\nif ( mod( vLineDistance, totalSize ) > dashSize ) {\ndiscard;\n}\ngl_FragColor = vec4( diffuse, opacity );"</span><span class="PUNC">,</span><span class="NAME">THREE.ShaderChunk.color_fragment</span><span class="PUNC">,</span><span class="NAME">THREE.ShaderChunk.fog_fragment</span><span class="PUNC">,</span><span class="STRN">"}"</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">join</span><span class="PUNC">(</span><span class="STRN">"\n"</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">depth</span><span class="PUNC">:</span><span class="PUNC">{</span><span class="NAME">uniforms</span><span class="PUNC">:</span><span class="PUNC">{</span><span class="NAME">mNear</span><span class="PUNC">:</span><span class="PUNC">{</span><span class="NAME">type</span><span class="PUNC">:</span><span class="STRN">"f"</span><span class="PUNC">,</span><span class="NAME">value</span><span class="PUNC">:</span><span class="NUMB">1</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">mFar</span><span class="PUNC">:</span><span class="PUNC">{</span><span class="NAME">type</span><span class="PUNC">:</span><span class="STRN">"f"</span><span class="PUNC">,</span><span class="NAME">value</span><span class="PUNC">:</span><span class="NUMB">2</span><span class="NAME">E3</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">opacity</span><span class="PUNC">:</span><span class="PUNC">{</span><span class="NAME">type</span><span class="PUNC">:</span><span class="STRN">"f"</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>371</span> </span><span class="NAME">value</span><span class="PUNC">:</span><span class="NUMB">1</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">vertexShader</span><span class="PUNC">:</span><span class="STRN">"void main() {\ngl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}"</span><span class="PUNC">,</span><span class="NAME">fragmentShader</span><span class="PUNC">:</span><span class="STRN">"uniform float mNear;\nuniform float mFar;\nuniform float opacity;\nvoid main() {\nfloat depth = gl_FragCoord.z / gl_FragCoord.w;\nfloat color = 1.0 - smoothstep( mNear, mFar, depth );\ngl_FragColor = vec4( vec3( color ), opacity );\n}"</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">normal</span><span class="PUNC">:</span><span class="PUNC">{</span><span class="NAME">uniforms</span><span class="PUNC">:</span><span class="PUNC">{</span><span class="NAME">opacity</span><span class="PUNC">:</span><span class="PUNC">{</span><span class="NAME">type</span><span class="PUNC">:</span><span class="STRN">"f"</span><span class="PUNC">,</span><span class="NAME">value</span><span class="PUNC">:</span><span class="NUMB">1</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">vertexShader</span><span class="PUNC">:</span><span class="PUNC">[</span><span class="STRN">"varying vec3 vNormal;"</span><span class="PUNC">,</span><span class="NAME">THREE.ShaderChunk.morphtarget_pars_vertex</span><span class="PUNC">,</span><span class="STRN">"void main() {\nvNormal = normalize( normalMatrix * normal );"</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>372</span> </span><span class="NAME">THREE.ShaderChunk.morphtarget_vertex</span><span class="PUNC">,</span><span class="NAME">THREE.ShaderChunk.default_vertex</span><span class="PUNC">,</span><span class="STRN">"}"</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">join</span><span class="PUNC">(</span><span class="STRN">"\n"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">fragmentShader</span><span class="PUNC">:</span><span class="STRN">"uniform float opacity;\nvarying vec3 vNormal;\nvoid main() {\ngl_FragColor = vec4( 0.5 * normalize( vNormal ) + 0.5, opacity );\n}"</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">normalmap</span><span class="PUNC">:</span><span class="PUNC">{</span><span class="NAME">uniforms</span><span class="PUNC">:</span><span class="NAME">THREE.UniformsUtils.merge</span><span class="PUNC">(</span><span class="PUNC">[</span><span class="NAME">THREE.UniformsLib.fog</span><span class="PUNC">,</span><span class="NAME">THREE.UniformsLib.lights</span><span class="PUNC">,</span><span class="NAME">THREE.UniformsLib.shadowmap</span><span class="PUNC">,</span><span class="PUNC">{</span><span class="NAME">enableAO</span><span class="PUNC">:</span><span class="PUNC">{</span><span class="NAME">type</span><span class="PUNC">:</span><span class="STRN">"i"</span><span class="PUNC">,</span><span class="NAME">value</span><span class="PUNC">:</span><span class="NUMB">0</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">enableDiffuse</span><span class="PUNC">:</span><span class="PUNC">{</span><span class="NAME">type</span><span class="PUNC">:</span><span class="STRN">"i"</span><span class="PUNC">,</span><span class="NAME">value</span><span class="PUNC">:</span><span class="NUMB">0</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">enableSpecular</span><span class="PUNC">:</span><span class="PUNC">{</span><span class="NAME">type</span><span class="PUNC">:</span><span class="STRN">"i"</span><span class="PUNC">,</span><span class="NAME">value</span><span class="PUNC">:</span><span class="NUMB">0</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">enableReflection</span><span class="PUNC">:</span><span class="PUNC">{</span><span class="NAME">type</span><span class="PUNC">:</span><span class="STRN">"i"</span><span class="PUNC">,</span><span class="NAME">value</span><span class="PUNC">:</span><span class="NUMB">0</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">enableDisplacement</span><span class="PUNC">:</span><span class="PUNC">{</span><span class="NAME">type</span><span class="PUNC">:</span><span class="STRN">"i"</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>373</span> </span><span class="NAME">value</span><span class="PUNC">:</span><span class="NUMB">0</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">tDisplacement</span><span class="PUNC">:</span><span class="PUNC">{</span><span class="NAME">type</span><span class="PUNC">:</span><span class="STRN">"t"</span><span class="PUNC">,</span><span class="NAME">value</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">tDiffuse</span><span class="PUNC">:</span><span class="PUNC">{</span><span class="NAME">type</span><span class="PUNC">:</span><span class="STRN">"t"</span><span class="PUNC">,</span><span class="NAME">value</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">tCube</span><span class="PUNC">:</span><span class="PUNC">{</span><span class="NAME">type</span><span class="PUNC">:</span><span class="STRN">"t"</span><span class="PUNC">,</span><span class="NAME">value</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">tNormal</span><span class="PUNC">:</span><span class="PUNC">{</span><span class="NAME">type</span><span class="PUNC">:</span><span class="STRN">"t"</span><span class="PUNC">,</span><span class="NAME">value</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">tSpecular</span><span class="PUNC">:</span><span class="PUNC">{</span><span class="NAME">type</span><span class="PUNC">:</span><span class="STRN">"t"</span><span class="PUNC">,</span><span class="NAME">value</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">tAO</span><span class="PUNC">:</span><span class="PUNC">{</span><span class="NAME">type</span><span class="PUNC">:</span><span class="STRN">"t"</span><span class="PUNC">,</span><span class="NAME">value</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">uNormalScale</span><span class="PUNC">:</span><span class="PUNC">{</span><span class="NAME">type</span><span class="PUNC">:</span><span class="STRN">"v2"</span><span class="PUNC">,</span><span class="NAME">value</span><span class="PUNC">:</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector2</span><span class="PUNC">(</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">uDisplacementBias</span><span class="PUNC">:</span><span class="PUNC">{</span><span class="NAME">type</span><span class="PUNC">:</span><span class="STRN">"f"</span><span class="PUNC">,</span><span class="NAME">value</span><span class="PUNC">:</span><span class="NUMB">0</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">uDisplacementScale</span><span class="PUNC">:</span><span class="PUNC">{</span><span class="NAME">type</span><span class="PUNC">:</span><span class="STRN">"f"</span><span class="PUNC">,</span><span class="NAME">value</span><span class="PUNC">:</span><span class="NUMB">1</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">uDiffuseColor</span><span class="PUNC">:</span><span class="PUNC">{</span><span class="NAME">type</span><span class="PUNC">:</span><span class="STRN">"c"</span><span class="PUNC">,</span><span class="NAME">value</span><span class="PUNC">:</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Color</span><span class="PUNC">(</span><span class="NUMB">16777215</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">uSpecularColor</span><span class="PUNC">:</span><span class="PUNC">{</span><span class="NAME">type</span><span class="PUNC">:</span><span class="STRN">"c"</span><span class="PUNC">,</span><span class="NAME">value</span><span class="PUNC">:</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Color</span><span class="PUNC">(</span><span class="NUMB">1118481</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">uAmbientColor</span><span class="PUNC">:</span><span class="PUNC">{</span><span class="NAME">type</span><span class="PUNC">:</span><span class="STRN">"c"</span><span class="PUNC">,</span><span class="NAME">value</span><span class="PUNC">:</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Color</span><span class="PUNC">(</span><span class="NUMB">16777215</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">uShininess</span><span class="PUNC">:</span><span class="PUNC">{</span><span class="NAME">type</span><span class="PUNC">:</span><span class="STRN">"f"</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>374</span> </span><span class="NAME">value</span><span class="PUNC">:</span><span class="NUMB">30</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">uOpacity</span><span class="PUNC">:</span><span class="PUNC">{</span><span class="NAME">type</span><span class="PUNC">:</span><span class="STRN">"f"</span><span class="PUNC">,</span><span class="NAME">value</span><span class="PUNC">:</span><span class="NUMB">1</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">useRefract</span><span class="PUNC">:</span><span class="PUNC">{</span><span class="NAME">type</span><span class="PUNC">:</span><span class="STRN">"i"</span><span class="PUNC">,</span><span class="NAME">value</span><span class="PUNC">:</span><span class="NUMB">0</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">uRefractionRatio</span><span class="PUNC">:</span><span class="PUNC">{</span><span class="NAME">type</span><span class="PUNC">:</span><span class="STRN">"f"</span><span class="PUNC">,</span><span class="NAME">value</span><span class="PUNC">:</span><span class="NUMB">0.98</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">uReflectivity</span><span class="PUNC">:</span><span class="PUNC">{</span><span class="NAME">type</span><span class="PUNC">:</span><span class="STRN">"f"</span><span class="PUNC">,</span><span class="NAME">value</span><span class="PUNC">:</span><span class="NUMB">0.5</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">uOffset</span><span class="PUNC">:</span><span class="PUNC">{</span><span class="NAME">type</span><span class="PUNC">:</span><span class="STRN">"v2"</span><span class="PUNC">,</span><span class="NAME">value</span><span class="PUNC">:</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector2</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">uRepeat</span><span class="PUNC">:</span><span class="PUNC">{</span><span class="NAME">type</span><span class="PUNC">:</span><span class="STRN">"v2"</span><span class="PUNC">,</span><span class="NAME">value</span><span class="PUNC">:</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector2</span><span class="PUNC">(</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">wrapRGB</span><span class="PUNC">:</span><span class="PUNC">{</span><span class="NAME">type</span><span class="PUNC">:</span><span class="STRN">"v3"</span><span class="PUNC">,</span><span class="NAME">value</span><span class="PUNC">:</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">(</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">fragmentShader</span><span class="PUNC">:</span><span class="PUNC">[</span><span class="STRN">"uniform vec3 uAmbientColor;\nuniform vec3 uDiffuseColor;\nuniform vec3 uSpecularColor;\nuniform float uShininess;\nuniform float uOpacity;\nuniform bool enableDiffuse;\nuniform bool enableSpecular;\nuniform bool enableAO;\nuniform bool enableReflection;\nuniform sampler2D tDiffuse;\nuniform sampler2D tNormal;\nuniform sampler2D tSpecular;\nuniform sampler2D tAO;\nuniform samplerCube tCube;\nuniform vec2 uNormalScale;\nuniform bool useRefract;\nuniform float uRefractionRatio;\nuniform float uReflectivity;\nvarying vec3 vTangent;\nvarying vec3 vBinormal;\nvarying vec3 vNormal;\nvarying vec2 vUv;\nuniform vec3 ambientLightColor;\n#if MAX_DIR_LIGHTS > 0\nuniform vec3 directionalLightColor[ MAX_DIR_LIGHTS ];\nuniform vec3 directionalLightDirection[ MAX_DIR_LIGHTS ];\n#endif\n#if MAX_HEMI_LIGHTS > 0\nuniform vec3 hemisphereLightSkyColor[ MAX_HEMI_LIGHTS ];\nuniform vec3 hemisphereLightGroundColor[ MAX_HEMI_LIGHTS ];\nuniform vec3 hemisphereLightDirection[ MAX_HEMI_LIGHTS ];\n#endif\n#if MAX_POINT_LIGHTS > 0\nuniform vec3 pointLightColor[ MAX_POINT_LIGHTS ];\nuniform vec3 pointLightPosition[ MAX_POINT_LIGHTS ];\nuniform float pointLightDistance[ MAX_POINT_LIGHTS ];\n#endif\n#if MAX_SPOT_LIGHTS > 0\nuniform vec3 spotLightColor[ MAX_SPOT_LIGHTS ];\nuniform vec3 spotLightPosition[ MAX_SPOT_LIGHTS ];\nuniform vec3 spotLightDirection[ MAX_SPOT_LIGHTS ];\nuniform float spotLightAngleCos[ MAX_SPOT_LIGHTS ];\nuniform float spotLightExponent[ MAX_SPOT_LIGHTS ];\nuniform float spotLightDistance[ MAX_SPOT_LIGHTS ];\n#endif\n#ifdef WRAP_AROUND\nuniform vec3 wrapRGB;\n#endif\nvarying vec3 vWorldPosition;\nvarying vec3 vViewPosition;"</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>375</span> </span><span class="NAME">THREE.ShaderChunk.shadowmap_pars_fragment</span><span class="PUNC">,</span><span class="NAME">THREE.ShaderChunk.fog_pars_fragment</span><span class="PUNC">,</span><span class="STRN">"void main() {\ngl_FragColor = vec4( vec3( 1.0 ), uOpacity );\nvec3 specularTex = vec3( 1.0 );\nvec3 normalTex = texture2D( tNormal, vUv ).xyz * 2.0 - 1.0;\nnormalTex.xy *= uNormalScale;\nnormalTex = normalize( normalTex );\nif( enableDiffuse ) {\n#ifdef GAMMA_INPUT\nvec4 texelColor = texture2D( tDiffuse, vUv );\ntexelColor.xyz *= texelColor.xyz;\ngl_FragColor = gl_FragColor * texelColor;\n#else\ngl_FragColor = gl_FragColor * texture2D( tDiffuse, vUv );\n#endif\n}\nif( enableAO ) {\n#ifdef GAMMA_INPUT\nvec4 aoColor = texture2D( tAO, vUv );\naoColor.xyz *= aoColor.xyz;\ngl_FragColor.xyz = gl_FragColor.xyz * aoColor.xyz;\n#else\ngl_FragColor.xyz = gl_FragColor.xyz * texture2D( tAO, vUv ).xyz;\n#endif\n}\nif( enableSpecular )\nspecularTex = texture2D( tSpecular, vUv ).xyz;\nmat3 tsb = mat3( normalize( vTangent ), normalize( vBinormal ), normalize( vNormal ) );\nvec3 finalNormal = tsb * normalTex;\n#ifdef FLIP_SIDED\nfinalNormal = -finalNormal;\n#endif\nvec3 normal = normalize( finalNormal );\nvec3 viewPosition = normalize( vViewPosition );\n#if MAX_POINT_LIGHTS > 0\nvec3 pointDiffuse = vec3( 0.0 );\nvec3 pointSpecular = vec3( 0.0 );\nfor ( int i = 0; i &lt; MAX_POINT_LIGHTS; i ++ ) {\nvec4 lPosition = viewMatrix * vec4( pointLightPosition[ i ], 1.0 );\nvec3 pointVector = lPosition.xyz + vViewPosition.xyz;\nfloat pointDistance = 1.0;\nif ( pointLightDistance[ i ] > 0.0 )\npointDistance = 1.0 - min( ( length( pointVector ) / pointLightDistance[ i ] ), 1.0 );\npointVector = normalize( pointVector );\n#ifdef WRAP_AROUND\nfloat pointDiffuseWeightFull = max( dot( normal, pointVector ), 0.0 );\nfloat pointDiffuseWeightHalf = max( 0.5 * dot( normal, pointVector ) + 0.5, 0.0 );\nvec3 pointDiffuseWeight = mix( vec3 ( pointDiffuseWeightFull ), vec3( pointDiffuseWeightHalf ), wrapRGB );\n#else\nfloat pointDiffuseWeight = max( dot( normal, pointVector ), 0.0 );\n#endif\npointDiffuse += pointDistance * pointLightColor[ i ] * uDiffuseColor * pointDiffuseWeight;\nvec3 pointHalfVector = normalize( pointVector + viewPosition );\nfloat pointDotNormalHalf = max( dot( normal, pointHalfVector ), 0.0 );\nfloat pointSpecularWeight = specularTex.r * max( pow( pointDotNormalHalf, uShininess ), 0.0 );\n#ifdef PHYSICALLY_BASED_SHADING\nfloat specularNormalization = ( uShininess + 2.0001 ) / 8.0;\nvec3 schlick = uSpecularColor + vec3( 1.0 - uSpecularColor ) * pow( 1.0 - dot( pointVector, pointHalfVector ), 5.0 );\npointSpecular += schlick * pointLightColor[ i ] * pointSpecularWeight * pointDiffuseWeight * pointDistance * specularNormalization;\n#else\npointSpecular += pointDistance * pointLightColor[ i ] * uSpecularColor * pointSpecularWeight * pointDiffuseWeight;\n#endif\n}\n#endif\n#if MAX_SPOT_LIGHTS > 0\nvec3 spotDiffuse = vec3( 0.0 );\nvec3 spotSpecular = vec3( 0.0 );\nfor ( int i = 0; i &lt; MAX_SPOT_LIGHTS; i ++ ) {\nvec4 lPosition = viewMatrix * vec4( spotLightPosition[ i ], 1.0 );\nvec3 spotVector = lPosition.xyz + vViewPosition.xyz;\nfloat spotDistance = 1.0;\nif ( spotLightDistance[ i ] > 0.0 )\nspotDistance = 1.0 - min( ( length( spotVector ) / spotLightDistance[ i ] ), 1.0 );\nspotVector = normalize( spotVector );\nfloat spotEffect = dot( spotLightDirection[ i ], normalize( spotLightPosition[ i ] - vWorldPosition ) );\nif ( spotEffect > spotLightAngleCos[ i ] ) {\nspotEffect = max( pow( spotEffect, spotLightExponent[ i ] ), 0.0 );\n#ifdef WRAP_AROUND\nfloat spotDiffuseWeightFull = max( dot( normal, spotVector ), 0.0 );\nfloat spotDiffuseWeightHalf = max( 0.5 * dot( normal, spotVector ) + 0.5, 0.0 );\nvec3 spotDiffuseWeight = mix( vec3 ( spotDiffuseWeightFull ), vec3( spotDiffuseWeightHalf ), wrapRGB );\n#else\nfloat spotDiffuseWeight = max( dot( normal, spotVector ), 0.0 );\n#endif\nspotDiffuse += spotDistance * spotLightColor[ i ] * uDiffuseColor * spotDiffuseWeight * spotEffect;\nvec3 spotHalfVector = normalize( spotVector + viewPosition );\nfloat spotDotNormalHalf = max( dot( normal, spotHalfVector ), 0.0 );\nfloat spotSpecularWeight = specularTex.r * max( pow( spotDotNormalHalf, uShininess ), 0.0 );\n#ifdef PHYSICALLY_BASED_SHADING\nfloat specularNormalization = ( uShininess + 2.0001 ) / 8.0;\nvec3 schlick = uSpecularColor + vec3( 1.0 - uSpecularColor ) * pow( 1.0 - dot( spotVector, spotHalfVector ), 5.0 );\nspotSpecular += schlick * spotLightColor[ i ] * spotSpecularWeight * spotDiffuseWeight * spotDistance * specularNormalization * spotEffect;\n#else\nspotSpecular += spotDistance * spotLightColor[ i ] * uSpecularColor * spotSpecularWeight * spotDiffuseWeight * spotEffect;\n#endif\n}\n}\n#endif\n#if MAX_DIR_LIGHTS > 0\nvec3 dirDiffuse = vec3( 0.0 );\nvec3 dirSpecular = vec3( 0.0 );\nfor( int i = 0; i &lt; MAX_DIR_LIGHTS; i++ ) {\nvec4 lDirection = viewMatrix * vec4( directionalLightDirection[ i ], 0.0 );\nvec3 dirVector = normalize( lDirection.xyz );\n#ifdef WRAP_AROUND\nfloat directionalLightWeightingFull = max( dot( normal, dirVector ), 0.0 );\nfloat directionalLightWeightingHalf = max( 0.5 * dot( normal, dirVector ) + 0.5, 0.0 );\nvec3 dirDiffuseWeight = mix( vec3( directionalLightWeightingFull ), vec3( directionalLightWeightingHalf ), wrapRGB );\n#else\nfloat dirDiffuseWeight = max( dot( normal, dirVector ), 0.0 );\n#endif\ndirDiffuse += directionalLightColor[ i ] * uDiffuseColor * dirDiffuseWeight;\nvec3 dirHalfVector = normalize( dirVector + viewPosition );\nfloat dirDotNormalHalf = max( dot( normal, dirHalfVector ), 0.0 );\nfloat dirSpecularWeight = specularTex.r * max( pow( dirDotNormalHalf, uShininess ), 0.0 );\n#ifdef PHYSICALLY_BASED_SHADING\nfloat specularNormalization = ( uShininess + 2.0001 ) / 8.0;\nvec3 schlick = uSpecularColor + vec3( 1.0 - uSpecularColor ) * pow( 1.0 - dot( dirVector, dirHalfVector ), 5.0 );\ndirSpecular += schlick * directionalLightColor[ i ] * dirSpecularWeight * dirDiffuseWeight * specularNormalization;\n#else\ndirSpecular += directionalLightColor[ i ] * uSpecularColor * dirSpecularWeight * dirDiffuseWeight;\n#endif\n}\n#endif\n#if MAX_HEMI_LIGHTS > 0\nvec3 hemiDiffuse  = vec3( 0.0 );\nvec3 hemiSpecular = vec3( 0.0 );\nfor( int i = 0; i &lt; MAX_HEMI_LIGHTS; i ++ ) {\nvec4 lDirection = viewMatrix * vec4( hemisphereLightDirection[ i ], 0.0 );\nvec3 lVector = normalize( lDirection.xyz );\nfloat dotProduct = dot( normal, lVector );\nfloat hemiDiffuseWeight = 0.5 * dotProduct + 0.5;\nvec3 hemiColor = mix( hemisphereLightGroundColor[ i ], hemisphereLightSkyColor[ i ], hemiDiffuseWeight );\nhemiDiffuse += uDiffuseColor * hemiColor;\nvec3 hemiHalfVectorSky = normalize( lVector + viewPosition );\nfloat hemiDotNormalHalfSky = 0.5 * dot( normal, hemiHalfVectorSky ) + 0.5;\nfloat hemiSpecularWeightSky = specularTex.r * max( pow( hemiDotNormalHalfSky, uShininess ), 0.0 );\nvec3 lVectorGround = -lVector;\nvec3 hemiHalfVectorGround = normalize( lVectorGround + viewPosition );\nfloat hemiDotNormalHalfGround = 0.5 * dot( normal, hemiHalfVectorGround ) + 0.5;\nfloat hemiSpecularWeightGround = specularTex.r * max( pow( hemiDotNormalHalfGround, uShininess ), 0.0 );\n#ifdef PHYSICALLY_BASED_SHADING\nfloat dotProductGround = dot( normal, lVectorGround );\nfloat specularNormalization = ( uShininess + 2.0001 ) / 8.0;\nvec3 schlickSky = uSpecularColor + vec3( 1.0 - uSpecularColor ) * pow( 1.0 - dot( lVector, hemiHalfVectorSky ), 5.0 );\nvec3 schlickGround = uSpecularColor + vec3( 1.0 - uSpecularColor ) * pow( 1.0 - dot( lVectorGround, hemiHalfVectorGround ), 5.0 );\nhemiSpecular += hemiColor * specularNormalization * ( schlickSky * hemiSpecularWeightSky * max( dotProduct, 0.0 ) + schlickGround * hemiSpecularWeightGround * max( dotProductGround, 0.0 ) );\n#else\nhemiSpecular += uSpecularColor * hemiColor * ( hemiSpecularWeightSky + hemiSpecularWeightGround ) * hemiDiffuseWeight;\n#endif\n}\n#endif\nvec3 totalDiffuse = vec3( 0.0 );\nvec3 totalSpecular = vec3( 0.0 );\n#if MAX_DIR_LIGHTS > 0\ntotalDiffuse += dirDiffuse;\ntotalSpecular += dirSpecular;\n#endif\n#if MAX_HEMI_LIGHTS > 0\ntotalDiffuse += hemiDiffuse;\ntotalSpecular += hemiSpecular;\n#endif\n#if MAX_POINT_LIGHTS > 0\ntotalDiffuse += pointDiffuse;\ntotalSpecular += pointSpecular;\n#endif\n#if MAX_SPOT_LIGHTS > 0\ntotalDiffuse += spotDiffuse;\ntotalSpecular += spotSpecular;\n#endif\n#ifdef METAL\ngl_FragColor.xyz = gl_FragColor.xyz * ( totalDiffuse + ambientLightColor * uAmbientColor + totalSpecular );\n#else\ngl_FragColor.xyz = gl_FragColor.xyz * ( totalDiffuse + ambientLightColor * uAmbientColor ) + totalSpecular;\n#endif\nif ( enableReflection ) {\nvec3 vReflect;\nvec3 cameraToVertex = normalize( vWorldPosition - cameraPosition );\nif ( useRefract ) {\nvReflect = refract( cameraToVertex, normal, uRefractionRatio );\n} else {\nvReflect = reflect( cameraToVertex, normal );\n}\nvec4 cubeColor = textureCube( tCube, vec3( -vReflect.x, vReflect.yz ) );\n#ifdef GAMMA_INPUT\ncubeColor.xyz *= cubeColor.xyz;\n#endif\ngl_FragColor.xyz = mix( gl_FragColor.xyz, cubeColor.xyz, specularTex.r * uReflectivity );\n}"</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>376</span> </span><span class="NAME">THREE.ShaderChunk.shadowmap_fragment</span><span class="PUNC">,</span><span class="NAME">THREE.ShaderChunk.linear_to_gamma_fragment</span><span class="PUNC">,</span><span class="NAME">THREE.ShaderChunk.fog_fragment</span><span class="PUNC">,</span><span class="STRN">"}"</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">join</span><span class="PUNC">(</span><span class="STRN">"\n"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">vertexShader</span><span class="PUNC">:</span><span class="PUNC">[</span><span class="STRN">"attribute vec4 tangent;\nuniform vec2 uOffset;\nuniform vec2 uRepeat;\nuniform bool enableDisplacement;\n#ifdef VERTEX_TEXTURES\nuniform sampler2D tDisplacement;\nuniform float uDisplacementScale;\nuniform float uDisplacementBias;\n#endif\nvarying vec3 vTangent;\nvarying vec3 vBinormal;\nvarying vec3 vNormal;\nvarying vec2 vUv;\nvarying vec3 vWorldPosition;\nvarying vec3 vViewPosition;"</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>377</span> </span><span class="NAME">THREE.ShaderChunk.skinning_pars_vertex</span><span class="PUNC">,</span><span class="NAME">THREE.ShaderChunk.shadowmap_pars_vertex</span><span class="PUNC">,</span><span class="STRN">"void main() {"</span><span class="PUNC">,</span><span class="NAME">THREE.ShaderChunk.skinbase_vertex</span><span class="PUNC">,</span><span class="NAME">THREE.ShaderChunk.skinnormal_vertex</span><span class="PUNC">,</span><span class="STRN">"#ifdef USE_SKINNING\nvNormal = normalize( normalMatrix * skinnedNormal.xyz );\nvec4 skinnedTangent = skinMatrix * vec4( tangent.xyz, 0.0 );\nvTangent = normalize( normalMatrix * skinnedTangent.xyz );\n#else\nvNormal = normalize( normalMatrix * normal );\nvTangent = normalize( normalMatrix * tangent.xyz );\n#endif\nvBinormal = normalize( cross( vNormal, vTangent ) * tangent.w );\nvUv = uv * uRepeat + uOffset;\nvec3 displacedPosition;\n#ifdef VERTEX_TEXTURES\nif ( enableDisplacement ) {\nvec3 dv = texture2D( tDisplacement, uv ).xyz;\nfloat df = uDisplacementScale * dv.x + uDisplacementBias;\ndisplacedPosition = position + normalize( normal ) * df;\n} else {\n#ifdef USE_SKINNING\nvec4 skinVertex = vec4( position, 1.0 );\nvec4 skinned  = boneMatX * skinVertex * skinWeight.x;\nskinned \t  += boneMatY * skinVertex * skinWeight.y;\ndisplacedPosition  = skinned.xyz;\n#else\ndisplacedPosition = position;\n#endif\n}\n#else\n#ifdef USE_SKINNING\nvec4 skinVertex = vec4( position, 1.0 );\nvec4 skinned  = boneMatX * skinVertex * skinWeight.x;\nskinned \t  += boneMatY * skinVertex * skinWeight.y;\ndisplacedPosition  = skinned.xyz;\n#else\ndisplacedPosition = position;\n#endif\n#endif\nvec4 mvPosition = modelViewMatrix * vec4( displacedPosition, 1.0 );\nvec4 worldPosition = modelMatrix * vec4( displacedPosition, 1.0 );\ngl_Position = projectionMatrix * mvPosition;\nvWorldPosition = worldPosition.xyz;\nvViewPosition = -mvPosition.xyz;\n#ifdef USE_SHADOWMAP\nfor( int i = 0; i &lt; MAX_SHADOWS; i ++ ) {\nvShadowCoord[ i ] = shadowMatrix[ i ] * worldPosition;\n}\n#endif\n}"</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">join</span><span class="PUNC">(</span><span class="STRN">"\n"</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>378</span> </span><span class="NAME">cube</span><span class="PUNC">:</span><span class="PUNC">{</span><span class="NAME">uniforms</span><span class="PUNC">:</span><span class="PUNC">{</span><span class="NAME">tCube</span><span class="PUNC">:</span><span class="PUNC">{</span><span class="NAME">type</span><span class="PUNC">:</span><span class="STRN">"t"</span><span class="PUNC">,</span><span class="NAME">value</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">tFlip</span><span class="PUNC">:</span><span class="PUNC">{</span><span class="NAME">type</span><span class="PUNC">:</span><span class="STRN">"f"</span><span class="PUNC">,</span><span class="NAME">value</span><span class="PUNC">:</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">vertexShader</span><span class="PUNC">:</span><span class="STRN">"varying vec3 vWorldPosition;\nvoid main() {\nvec4 worldPosition = modelMatrix * vec4( position, 1.0 );\nvWorldPosition = worldPosition.xyz;\ngl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}"</span><span class="PUNC">,</span><span class="NAME">fragmentShader</span><span class="PUNC">:</span><span class="STRN">"uniform samplerCube tCube;\nuniform float tFlip;\nvarying vec3 vWorldPosition;\nvoid main() {\ngl_FragColor = textureCube( tCube, vec3( tFlip * vWorldPosition.x, vWorldPosition.yz ) );\n}"</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>379</span> </span><span class="NAME">depthRGBA</span><span class="PUNC">:</span><span class="PUNC">{</span><span class="NAME">uniforms</span><span class="PUNC">:</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">vertexShader</span><span class="PUNC">:</span><span class="PUNC">[</span><span class="NAME">THREE.ShaderChunk.morphtarget_pars_vertex</span><span class="PUNC">,</span><span class="NAME">THREE.ShaderChunk.skinning_pars_vertex</span><span class="PUNC">,</span><span class="STRN">"void main() {"</span><span class="PUNC">,</span><span class="NAME">THREE.ShaderChunk.skinbase_vertex</span><span class="PUNC">,</span><span class="NAME">THREE.ShaderChunk.morphtarget_vertex</span><span class="PUNC">,</span><span class="NAME">THREE.ShaderChunk.skinning_vertex</span><span class="PUNC">,</span><span class="NAME">THREE.ShaderChunk.default_vertex</span><span class="PUNC">,</span><span class="STRN">"}"</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">join</span><span class="PUNC">(</span><span class="STRN">"\n"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">fragmentShader</span><span class="PUNC">:</span><span class="STRN">"vec4 pack_depth( const in float depth ) {\nconst vec4 bit_shift = vec4( 256.0 * 256.0 * 256.0, 256.0 * 256.0, 256.0, 1.0 );\nconst vec4 bit_mask  = vec4( 0.0, 1.0 / 256.0, 1.0 / 256.0, 1.0 / 256.0 );\nvec4 res = fract( depth * bit_shift );\nres -= res.xxyz * bit_mask;\nreturn res;\n}\nvoid main() {\ngl_FragData[ 0 ] = pack_depth( gl_FragCoord.z );\n}"</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.WebGLRenderer</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">a.__webglCustomAttributesList</span><span class="PUNC">)</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="WHIT"> </span><span class="KEYW">in</span><span class="WHIT"> </span><span class="NAME">a.__webglCustomAttributesList</span><span class="PUNC">)</span><span class="NAME">k.deleteBuffer</span><span class="PUNC">(</span><span class="NAME">a.__webglCustomAttributesList</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">buffer</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">a.vertices.length</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">b.material</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">d.attributes</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">===</span><span class="NAME">a.__webglCustomAttributesList</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">a.__webglCustomAttributesList</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">e</span><span class="WHIT"> </span><span class="KEYW">in</span><span class="WHIT"> </span><span class="NAME">d.attributes</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">d.attributes</span><span class="PUNC">[</span><span class="NAME">e</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">f.__webglInitialized</span><span class="PUNC">||</span><span class="NAME">f.createUniqueBuffers</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">f.__webglInitialized</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">h</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="STRN">"v2"</span><span class="PUNC">===</span><span class="NAME">f.type</span><span class="PUNC">?</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NUMB">2</span><span class="PUNC">:</span><span class="STRN">"v3"</span><span class="PUNC">===</span><span class="NAME">f.type</span><span class="PUNC">?</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NUMB">3</span><span class="PUNC">:</span><span class="STRN">"v4"</span><span class="PUNC">===</span><span class="NAME">f.type</span><span class="PUNC">?</span><span class="WHIT">
<span class='line'>380</span> </span><span class="NAME">h</span><span class="PUNC">=</span><span class="NUMB">4</span><span class="PUNC">:</span><span class="STRN">"c"</span><span class="PUNC">===</span><span class="NAME">f.type</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NUMB">3</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">f.size</span><span class="PUNC">=</span><span class="NAME">h</span><span class="PUNC">;</span><span class="NAME">f.array</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Float32Array</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">*</span><span class="NAME">h</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">f.buffer</span><span class="PUNC">=</span><span class="NAME">k.createBuffer</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">f.buffer.belongsToAttribute</span><span class="PUNC">=</span><span class="NAME">e</span><span class="PUNC">;</span><span class="NAME">f.needsUpdate</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">}</span><span class="NAME">a.__webglCustomAttributesList.push</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">b.geometry</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">a.faces3</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">a.faces4</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">=</span><span class="NUMB">3</span><span class="PUNC">*</span><span class="NAME">d.length</span><span class="PUNC">+</span><span class="NUMB">4</span><span class="PUNC">*</span><span class="NAME">g.length</span><span class="PUNC">,</span><span class="NAME">j</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">*</span><span class="NAME">d.length</span><span class="PUNC">+</span><span class="NUMB">2</span><span class="PUNC">*</span><span class="NAME">g.length</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NUMB">3</span><span class="PUNC">*</span><span class="NAME">d.length</span><span class="PUNC">+</span><span class="NUMB">4</span><span class="PUNC">*</span><span class="NAME">g.length</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">e</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">m</span><span class="PUNC">=</span><span class="NAME">h</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">l</span><span class="PUNC">=</span><span class="NAME">f</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">n</span><span class="PUNC">=</span><span class="NAME">d.vertexColors</span><span class="PUNC">?</span><span class="NAME">d.vertexColors</span><span class="PUNC">:</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">a.__vertexArray</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Float32Array</span><span class="PUNC">(</span><span class="NUMB">3</span><span class="PUNC">*</span><span class="NAME">i</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">l</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">a.__normalArray</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Float32Array</span><span class="PUNC">(</span><span class="NUMB">3</span><span class="PUNC">*</span><span class="NAME">i</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">c.hasTangents</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">a.__tangentArray</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Float32Array</span><span class="PUNC">(</span><span class="NUMB">4</span><span class="PUNC">*</span><span class="NAME">i</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">n</span><span class="PUNC">&&</span><span class="WHIT">
<span class='line'>381</span> </span><span class="PUNC">(</span><span class="NAME">a.__colorArray</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Float32Array</span><span class="PUNC">(</span><span class="NUMB">3</span><span class="PUNC">*</span><span class="NAME">i</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">m</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">&lt;</span><span class="NAME">c.faceUvs.length</span><span class="PUNC">||</span><span class="NUMB">0</span><span class="PUNC">&lt;</span><span class="NAME">c.faceVertexUvs.length</span><span class="PUNC">)</span><span class="NAME">a.__uvArray</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Float32Array</span><span class="PUNC">(</span><span class="NUMB">2</span><span class="PUNC">*</span><span class="NAME">i</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NUMB">1</span><span class="PUNC">&lt;</span><span class="NAME">c.faceUvs.length</span><span class="PUNC">||</span><span class="NUMB">1</span><span class="PUNC">&lt;</span><span class="NAME">c.faceVertexUvs.length</span><span class="PUNC">)</span><span class="NAME">a.__uv2Array</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Float32Array</span><span class="PUNC">(</span><span class="NUMB">2</span><span class="PUNC">*</span><span class="NAME">i</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="NAME">b.geometry.skinWeights.length</span><span class="PUNC">&&</span><span class="NAME">b.geometry.skinIndices.length</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">a.__skinIndexArray</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Float32Array</span><span class="PUNC">(</span><span class="NUMB">4</span><span class="PUNC">*</span><span class="NAME">i</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">a.__skinWeightArray</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Float32Array</span><span class="PUNC">(</span><span class="NUMB">4</span><span class="PUNC">*</span><span class="NAME">i</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a.__faceArray</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Uint16Array</span><span class="PUNC">(</span><span class="NUMB">3</span><span class="PUNC">*</span><span class="NAME">j</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a.__lineArray</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Uint16Array</span><span class="PUNC">(</span><span class="NUMB">2</span><span class="PUNC">*</span><span class="NAME">g</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">a.numMorphTargets</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">a.__morphTargetsArrays</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">m</span><span class="PUNC">=</span><span class="NAME">a.numMorphTargets</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">&lt;</span><span class="WHIT">
<span class='line'>382</span> </span><span class="NAME">m</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">a.__morphTargetsArrays.push</span><span class="PUNC">(</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Float32Array</span><span class="PUNC">(</span><span class="NUMB">3</span><span class="PUNC">*</span><span class="NAME">i</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">a.numMorphNormals</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">a.__morphNormalsArrays</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">m</span><span class="PUNC">=</span><span class="NAME">a.numMorphNormals</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">&lt;</span><span class="NAME">m</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">a.__morphNormalsArrays.push</span><span class="PUNC">(</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Float32Array</span><span class="PUNC">(</span><span class="NUMB">3</span><span class="PUNC">*</span><span class="NAME">i</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="NAME">a.__webglFaceCount</span><span class="PUNC">=</span><span class="NUMB">3</span><span class="PUNC">*</span><span class="NAME">j</span><span class="PUNC">;</span><span class="NAME">a.__webglLineCount</span><span class="PUNC">=</span><span class="NUMB">2</span><span class="PUNC">*</span><span class="NAME">g</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">d.attributes</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">===</span><span class="NAME">a.__webglCustomAttributesList</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">a.__webglCustomAttributesList</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">p</span><span class="WHIT"> </span><span class="KEYW">in</span><span class="WHIT"> </span><span class="NAME">d.attributes</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">j</span><span class="PUNC">=</span><span class="NAME">d.attributes</span><span class="PUNC">[</span><span class="NAME">p</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">q</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">q</span><span class="WHIT"> </span><span class="KEYW">in</span><span class="WHIT"> </span><span class="NAME">j</span><span class="PUNC">)</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NAME">q</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">j</span><span class="PUNC">[</span><span class="NAME">q</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">c.__webglInitialized</span><span class="PUNC">||</span><span class="NAME">c.createUniqueBuffers</span><span class="PUNC">)</span><span class="NAME">c.__webglInitialized</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="STRN">"v2"</span><span class="PUNC">===</span><span class="NAME">c.type</span><span class="PUNC">?</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NUMB">2</span><span class="PUNC">:</span><span class="WHIT">
<span class='line'>383</span> </span><span class="STRN">"v3"</span><span class="PUNC">===</span><span class="NAME">c.type</span><span class="PUNC">?</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NUMB">3</span><span class="PUNC">:</span><span class="STRN">"v4"</span><span class="PUNC">===</span><span class="NAME">c.type</span><span class="PUNC">?</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NUMB">4</span><span class="PUNC">:</span><span class="STRN">"c"</span><span class="PUNC">===</span><span class="NAME">c.type</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NUMB">3</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">c.size</span><span class="PUNC">=</span><span class="NAME">g</span><span class="PUNC">,</span><span class="NAME">c.array</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Float32Array</span><span class="PUNC">(</span><span class="NAME">i</span><span class="PUNC">*</span><span class="NAME">g</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">c.buffer</span><span class="PUNC">=</span><span class="NAME">k.createBuffer</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">c.buffer.belongsToAttribute</span><span class="PUNC">=</span><span class="NAME">p</span><span class="PUNC">,</span><span class="NAME">j.needsUpdate</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">c.__original</span><span class="PUNC">=</span><span class="NAME">j</span><span class="PUNC">;</span><span class="NAME">a.__webglCustomAttributesList.push</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="NAME">a.__inittedArrays</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">}</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">e</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a.material</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">THREE.MeshFaceMaterial</span><span class="PUNC">?</span><span class="NAME">a.material.materials</span><span class="PUNC">[</span><span class="NAME">b.materialIndex</span><span class="PUNC">]</span><span class="PUNC">:</span><span class="NAME">a.material</span><span class="PUNC">}</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">f</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">THREE.MeshBasicMaterial</span><span class="PUNC">&&</span><span class="PUNC">!</span><span class="NAME">a.envMap</span><span class="PUNC">||</span><span class="NAME">a</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">THREE.MeshDepthMaterial</span><span class="PUNC">?</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">:</span><span class="NAME">a</span><span class="PUNC">&&</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">a.shading</span><span class="PUNC">&&</span><span class="NAME">a.shading</span><span class="PUNC">===</span><span class="WHIT">
<span class='line'>384</span> </span><span class="NAME">THREE.SmoothShading</span><span class="PUNC">?</span><span class="NAME">THREE.SmoothShading</span><span class="PUNC">:</span><span class="NAME">THREE.FlatShading</span><span class="PUNC">}</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">h</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a.map</span><span class="PUNC">||</span><span class="NAME">a.lightMap</span><span class="PUNC">||</span><span class="NAME">a.bumpMap</span><span class="PUNC">||</span><span class="NAME">a.normalMap</span><span class="PUNC">||</span><span class="NAME">a.specularMap</span><span class="PUNC">||</span><span class="NAME">a</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">THREE.ShaderMaterial</span><span class="PUNC">?</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">:</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">}</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">g</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">Ab</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">]</span><span class="PUNC">||</span><span class="PUNC">(</span><span class="NAME">k.enableVertexAttribArray</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">Ab</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="WHIT"> </span><span class="KEYW">in</span><span class="WHIT"> </span><span class="NAME">Ab</span><span class="PUNC">)</span><span class="NAME">Ab</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">]</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">k.disableVertexAttribArray</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">Ab</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">j</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a.z</span><span class="PUNC">!==</span><span class="NAME">b.z</span><span class="PUNC">?</span><span class="NAME">b.z</span><span class="PUNC">-</span><span class="NAME">a.z</span><span class="PUNC">:</span><span class="NAME">a.id</span><span class="PUNC">-</span><span class="NAME">b.id</span><span class="PUNC">}</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">l</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">-</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">}</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">m</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">a.length</span><span class="PUNC">)</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">a.length</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">&lt;</span><span class="NAME">e</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">ya</span><span class="PUNC">=</span><span class="NAME">qa</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">pb</span><span class="PUNC">=</span><span class="NAME">ub</span><span class="PUNC">=</span><span class="NAME">T</span><span class="PUNC">=</span><span class="NAME">da</span><span class="PUNC">=</span><span class="NAME">ab</span><span class="PUNC">=</span><span class="NAME">xa</span><span class="PUNC">=</span><span class="NAME">aa</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">yb</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NAME">d</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">render</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>385</span> </span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">Xb</span><span class="PUNC">,</span><span class="NAME">Jb</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">ya</span><span class="PUNC">=</span><span class="NAME">qa</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">pb</span><span class="PUNC">=</span><span class="NAME">ub</span><span class="PUNC">=</span><span class="NAME">T</span><span class="PUNC">=</span><span class="NAME">da</span><span class="PUNC">=</span><span class="NAME">ab</span><span class="PUNC">=</span><span class="NAME">xa</span><span class="PUNC">=</span><span class="NAME">aa</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">yb</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">}</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">n</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">k</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">,</span><span class="NAME">j</span><span class="PUNC">,</span><span class="NAME">m</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">?</span><span class="PUNC">(</span><span class="NAME">i</span><span class="PUNC">=</span><span class="NAME">a.length</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">m</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="PUNC">(</span><span class="NAME">i</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">a.length</span><span class="PUNC">,</span><span class="NAME">m</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">l</span><span class="PUNC">=</span><span class="NAME">i</span><span class="PUNC">;</span><span class="NAME">l</span><span class="PUNC">!==</span><span class="NAME">b</span><span class="PUNC">;</span><span class="NAME">l</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">m</span><span class="PUNC">)</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">k</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NAME">l</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">k.render</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">i</span><span class="PUNC">=</span><span class="NAME">k.object</span><span class="PUNC">;</span><span class="NAME">j</span><span class="PUNC">=</span><span class="NAME">k.buffer</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">g</span><span class="PUNC">)</span><span class="NAME">k</span><span class="PUNC">=</span><span class="NAME">g</span><span class="PUNC">;</span><span class="KEYW">else</span><span class="PUNC">{</span><span class="NAME">k</span><span class="PUNC">=</span><span class="NAME">k</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">k</span><span class="PUNC">)</span><span class="KEYW">continue</span><span class="PUNC">;</span><span class="NAME">h</span><span class="PUNC">&&</span><span class="NAME">D.setBlending</span><span class="PUNC">(</span><span class="NAME">k.blending</span><span class="PUNC">,</span><span class="NAME">k.blendEquation</span><span class="PUNC">,</span><span class="NAME">k.blendSrc</span><span class="PUNC">,</span><span class="NAME">k.blendDst</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">D.setDepthTest</span><span class="PUNC">(</span><span class="NAME">k.depthTest</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">D.setDepthWrite</span><span class="PUNC">(</span><span class="NAME">k.depthWrite</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">K</span><span class="PUNC">(</span><span class="NAME">k.polygonOffset</span><span class="PUNC">,</span><span class="NAME">k.polygonOffsetFactor</span><span class="PUNC">,</span><span class="NAME">k.polygonOffsetUnits</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="NAME">D.setMaterialFaces</span><span class="PUNC">(</span><span class="NAME">k</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">j</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">THREE.BufferGeometry</span><span class="PUNC">?</span><span class="NAME">D.renderBufferDirect</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>386</span> </span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">k</span><span class="PUNC">,</span><span class="NAME">j</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">D.renderBuffer</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">k</span><span class="PUNC">,</span><span class="NAME">j</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">p</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">g</span><span class="PUNC">,</span><span class="NAME">k</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">j</span><span class="PUNC">=</span><span class="NAME">a.length</span><span class="PUNC">;</span><span class="NAME">i</span><span class="PUNC">&lt;</span><span class="NAME">j</span><span class="PUNC">;</span><span class="NAME">i</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">k</span><span class="PUNC">=</span><span class="NAME">g.object</span><span class="PUNC">,</span><span class="NAME">k.visible</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">h</span><span class="PUNC">)</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">h</span><span class="PUNC">;</span><span class="KEYW">else</span><span class="PUNC">{</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">g</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">g</span><span class="PUNC">)</span><span class="KEYW">continue</span><span class="PUNC">;</span><span class="NAME">f</span><span class="PUNC">&&</span><span class="NAME">D.setBlending</span><span class="PUNC">(</span><span class="NAME">g.blending</span><span class="PUNC">,</span><span class="NAME">g.blendEquation</span><span class="PUNC">,</span><span class="NAME">g.blendSrc</span><span class="PUNC">,</span><span class="NAME">g.blendDst</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">D.setDepthTest</span><span class="PUNC">(</span><span class="NAME">g.depthTest</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">D.setDepthWrite</span><span class="PUNC">(</span><span class="NAME">g.depthWrite</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">K</span><span class="PUNC">(</span><span class="NAME">g.polygonOffset</span><span class="PUNC">,</span><span class="NAME">g.polygonOffsetFactor</span><span class="PUNC">,</span><span class="NAME">g.polygonOffsetUnits</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="NAME">D.renderImmediateObject</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">,</span><span class="NAME">k</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">t</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">===</span><span class="NAME">a.__webglInit</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">a.__webglInit</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">a._modelViewMatrix</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Matrix4</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>387</span> </span><span class="NAME">a._normalMatrix</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Matrix3</span><span class="PUNC">,</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">a.geometry</span><span class="PUNC">&&</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">===</span><span class="NAME">a.geometry.__webglInit</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">a.geometry.__webglInit</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">a.geometry.addEventListener</span><span class="PUNC">(</span><span class="STRN">"dispose"</span><span class="PUNC">,</span><span class="NAME">lc</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">a.geometry</span><span class="PUNC">,</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">f</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">THREE.BufferGeometry</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">,</span><span class="NAME">j</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">i</span><span class="WHIT"> </span><span class="KEYW">in</span><span class="WHIT"> </span><span class="NAME">f.attributes</span><span class="PUNC">)</span><span class="NAME">j</span><span class="PUNC">=</span><span class="STRN">"index"</span><span class="PUNC">===</span><span class="NAME">i</span><span class="PUNC">?</span><span class="NAME">k.ELEMENT_ARRAY_BUFFER</span><span class="PUNC">:</span><span class="NAME">k.ARRAY_BUFFER</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">f.attributes</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">===</span><span class="NAME">g.numItems</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">g.numItems</span><span class="PUNC">=</span><span class="NAME">g.array.length</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">g.buffer</span><span class="PUNC">=</span><span class="NAME">k.createBuffer</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">k.bindBuffer</span><span class="PUNC">(</span><span class="NAME">j</span><span class="PUNC">,</span><span class="NAME">g.buffer</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">k.bufferData</span><span class="PUNC">(</span><span class="NAME">j</span><span class="PUNC">,</span><span class="NAME">g.array</span><span class="PUNC">,</span><span class="NAME">k.STATIC_DRAW</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">a</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">THREE.Mesh</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">a.material</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>388</span> </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">===</span><span class="NAME">f.geometryGroups</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">i</span><span class="PUNC">=</span><span class="NAME">f</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">m</span><span class="PUNC">,</span><span class="NAME">l</span><span class="PUNC">,</span><span class="NAME">n</span><span class="PUNC">,</span><span class="NAME">p</span><span class="PUNC">,</span><span class="NAME">r</span><span class="PUNC">;</span><span class="NAME">j</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">s</span><span class="PUNC">=</span><span class="NAME">i.morphTargets.length</span><span class="PUNC">,</span><span class="NAME">t</span><span class="PUNC">=</span><span class="NAME">i.morphNormals.length</span><span class="PUNC">,</span><span class="NAME">v</span><span class="PUNC">=</span><span class="NAME">h</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">THREE.MeshFaceMaterial</span><span class="PUNC">;</span><span class="NAME">i.geometryGroups</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">m</span><span class="PUNC">=</span><span class="NAME">i.faces.length</span><span class="PUNC">;</span><span class="NAME">h</span><span class="PUNC">&lt;</span><span class="NAME">m</span><span class="PUNC">;</span><span class="NAME">h</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">l</span><span class="PUNC">=</span><span class="NAME">i.faces</span><span class="PUNC">[</span><span class="NAME">h</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">n</span><span class="PUNC">=</span><span class="NAME">v</span><span class="PUNC">?</span><span class="NAME">l.materialIndex</span><span class="PUNC">:</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">===</span><span class="NAME">j</span><span class="PUNC">[</span><span class="NAME">n</span><span class="PUNC">]</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">j</span><span class="PUNC">[</span><span class="NAME">n</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="NAME">hash</span><span class="PUNC">:</span><span class="NAME">n</span><span class="PUNC">,</span><span class="NAME">counter</span><span class="PUNC">:</span><span class="NUMB">0</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">r</span><span class="PUNC">=</span><span class="NAME">j</span><span class="PUNC">[</span><span class="NAME">n</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">hash</span><span class="PUNC">+</span><span class="STRN">"_"</span><span class="PUNC">+</span><span class="NAME">j</span><span class="PUNC">[</span><span class="NAME">n</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">counter</span><span class="PUNC">,</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">===</span><span class="NAME">i.geometryGroups</span><span class="PUNC">[</span><span class="NAME">r</span><span class="PUNC">]</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">i.geometryGroups</span><span class="PUNC">[</span><span class="NAME">r</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="NAME">faces3</span><span class="PUNC">:</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">faces4</span><span class="PUNC">:</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">materialIndex</span><span class="PUNC">:</span><span class="NAME">n</span><span class="PUNC">,</span><span class="NAME">vertices</span><span class="PUNC">:</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">numMorphTargets</span><span class="PUNC">:</span><span class="NAME">s</span><span class="PUNC">,</span><span class="NAME">numMorphNormals</span><span class="PUNC">:</span><span class="NAME">t</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">p</span><span class="PUNC">=</span><span class="NAME">l</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">THREE.Face3</span><span class="PUNC">?</span><span class="NUMB">3</span><span class="PUNC">:</span><span class="NUMB">4</span><span class="PUNC">,</span><span class="NUMB">65535</span><span class="PUNC">&lt;</span><span class="NAME">i.geometryGroups</span><span class="PUNC">[</span><span class="NAME">r</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">vertices</span><span class="PUNC">+</span><span class="WHIT">
<span class='line'>389</span> </span><span class="NAME">p</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">j</span><span class="PUNC">[</span><span class="NAME">n</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">counter</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">r</span><span class="PUNC">=</span><span class="NAME">j</span><span class="PUNC">[</span><span class="NAME">n</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">hash</span><span class="PUNC">+</span><span class="STRN">"_"</span><span class="PUNC">+</span><span class="NAME">j</span><span class="PUNC">[</span><span class="NAME">n</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">counter</span><span class="PUNC">,</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">===</span><span class="NAME">i.geometryGroups</span><span class="PUNC">[</span><span class="NAME">r</span><span class="PUNC">]</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">i.geometryGroups</span><span class="PUNC">[</span><span class="NAME">r</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="NAME">faces3</span><span class="PUNC">:</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">faces4</span><span class="PUNC">:</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">materialIndex</span><span class="PUNC">:</span><span class="NAME">n</span><span class="PUNC">,</span><span class="NAME">vertices</span><span class="PUNC">:</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">numMorphTargets</span><span class="PUNC">:</span><span class="NAME">s</span><span class="PUNC">,</span><span class="NAME">numMorphNormals</span><span class="PUNC">:</span><span class="NAME">t</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">l</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">THREE.Face3</span><span class="PUNC">?</span><span class="NAME">i.geometryGroups</span><span class="PUNC">[</span><span class="NAME">r</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">faces3.push</span><span class="PUNC">(</span><span class="NAME">h</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">i.geometryGroups</span><span class="PUNC">[</span><span class="NAME">r</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">faces4.push</span><span class="PUNC">(</span><span class="NAME">h</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">i.geometryGroups</span><span class="PUNC">[</span><span class="NAME">r</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">vertices</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">p</span><span class="PUNC">;</span><span class="NAME">i.geometryGroupsList</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">g</span><span class="WHIT"> </span><span class="KEYW">in</span><span class="WHIT"> </span><span class="NAME">i.geometryGroups</span><span class="PUNC">)</span><span class="NAME">i.geometryGroups</span><span class="PUNC">[</span><span class="NAME">g</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">id</span><span class="PUNC">=</span><span class="NAME">Ha</span><span class="PUNC">++</span><span class="PUNC">,</span><span class="NAME">i.geometryGroupsList.push</span><span class="PUNC">(</span><span class="NAME">i.geometryGroups</span><span class="PUNC">[</span><span class="NAME">g</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">e</span><span class="WHIT"> </span><span class="KEYW">in</span><span class="WHIT"> </span><span class="NAME">f.geometryGroups</span><span class="PUNC">)</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">f.geometryGroups</span><span class="PUNC">[</span><span class="NAME">e</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="PUNC">!</span><span class="NAME">g.__webglVertexBuffer</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">i</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>390</span> </span><span class="NAME">g</span><span class="PUNC">;</span><span class="NAME">i.__webglVertexBuffer</span><span class="PUNC">=</span><span class="NAME">k.createBuffer</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">i.__webglNormalBuffer</span><span class="PUNC">=</span><span class="NAME">k.createBuffer</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">i.__webglTangentBuffer</span><span class="PUNC">=</span><span class="NAME">k.createBuffer</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">i.__webglColorBuffer</span><span class="PUNC">=</span><span class="NAME">k.createBuffer</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">i.__webglUVBuffer</span><span class="PUNC">=</span><span class="NAME">k.createBuffer</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">i.__webglUV2Buffer</span><span class="PUNC">=</span><span class="NAME">k.createBuffer</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">i.__webglSkinIndicesBuffer</span><span class="PUNC">=</span><span class="NAME">k.createBuffer</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">i.__webglSkinWeightsBuffer</span><span class="PUNC">=</span><span class="NAME">k.createBuffer</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">i.__webglFaceBuffer</span><span class="PUNC">=</span><span class="NAME">k.createBuffer</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">i.__webglLineBuffer</span><span class="PUNC">=</span><span class="NAME">k.createBuffer</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">s</span><span class="PUNC">=</span><span class="NAME">j</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">i.numMorphTargets</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">i.__webglMorphTargetsBuffers</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">j</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">s</span><span class="PUNC">=</span><span class="NAME">i.numMorphTargets</span><span class="PUNC">;</span><span class="NAME">j</span><span class="PUNC">&lt;</span><span class="NAME">s</span><span class="PUNC">;</span><span class="NAME">j</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">i.__webglMorphTargetsBuffers.push</span><span class="PUNC">(</span><span class="NAME">k.createBuffer</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">i.numMorphNormals</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">i.__webglMorphNormalsBuffers</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>391</span> </span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">j</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">s</span><span class="PUNC">=</span><span class="NAME">i.numMorphNormals</span><span class="PUNC">;</span><span class="NAME">j</span><span class="PUNC">&lt;</span><span class="NAME">s</span><span class="PUNC">;</span><span class="NAME">j</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">i.__webglMorphNormalsBuffers.push</span><span class="PUNC">(</span><span class="NAME">k.createBuffer</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="NAME">D.info.memory.geometries</span><span class="PUNC">++</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">(</span><span class="NAME">g</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">f.verticesNeedUpdate</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">f.morphTargetsNeedUpdate</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">f.elementsNeedUpdate</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">f.uvsNeedUpdate</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">f.normalsNeedUpdate</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">f.tangentsNeedUpdate</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">f.colorsNeedUpdate</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="NAME">a</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">THREE.Ribbon</span><span class="PUNC">?</span><span class="NAME">f.__webglVertexBuffer</span><span class="PUNC">||</span><span class="PUNC">(</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">g.__webglVertexBuffer</span><span class="PUNC">=</span><span class="NAME">k.createBuffer</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">g.__webglColorBuffer</span><span class="PUNC">=</span><span class="NAME">k.createBuffer</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">g.__webglNormalBuffer</span><span class="PUNC">=</span><span class="NAME">k.createBuffer</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">D.info.memory.geometries</span><span class="PUNC">++</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">=</span><span class="NAME">g.vertices.length</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>392</span> </span><span class="NAME">g.__vertexArray</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Float32Array</span><span class="PUNC">(</span><span class="NUMB">3</span><span class="PUNC">*</span><span class="NAME">i</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">g.__colorArray</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Float32Array</span><span class="PUNC">(</span><span class="NUMB">3</span><span class="PUNC">*</span><span class="NAME">i</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">g.__normalArray</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Float32Array</span><span class="PUNC">(</span><span class="NUMB">3</span><span class="PUNC">*</span><span class="NAME">i</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">g.__webglVertexCount</span><span class="PUNC">=</span><span class="NAME">i</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">(</span><span class="NAME">g</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">f.verticesNeedUpdate</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">f.colorsNeedUpdate</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">f.normalsNeedUpdate</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">a</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">THREE.Line</span><span class="PUNC">?</span><span class="NAME">f.__webglVertexBuffer</span><span class="PUNC">||</span><span class="PUNC">(</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">g.__webglVertexBuffer</span><span class="PUNC">=</span><span class="NAME">k.createBuffer</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">g.__webglColorBuffer</span><span class="PUNC">=</span><span class="NAME">k.createBuffer</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">g.__webglLineDistanceBuffer</span><span class="PUNC">=</span><span class="NAME">k.createBuffer</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">D.info.memory.geometries</span><span class="PUNC">++</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">=</span><span class="NAME">g.vertices.length</span><span class="PUNC">,</span><span class="NAME">g.__vertexArray</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Float32Array</span><span class="PUNC">(</span><span class="NUMB">3</span><span class="PUNC">*</span><span class="NAME">i</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">g.__colorArray</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Float32Array</span><span class="PUNC">(</span><span class="NUMB">3</span><span class="PUNC">*</span><span class="WHIT">
<span class='line'>393</span> </span><span class="NAME">i</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">g.__lineDistanceArray</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Float32Array</span><span class="PUNC">(</span><span class="NUMB">1</span><span class="PUNC">*</span><span class="NAME">i</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">g.__webglLineCount</span><span class="PUNC">=</span><span class="NAME">i</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">(</span><span class="NAME">g</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">f.verticesNeedUpdate</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">f.colorsNeedUpdate</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">f.lineDistancesNeedUpdate</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">a</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">THREE.ParticleSystem</span><span class="PUNC">&&</span><span class="PUNC">!</span><span class="NAME">f.__webglVertexBuffer</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">g.__webglVertexBuffer</span><span class="PUNC">=</span><span class="NAME">k.createBuffer</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">g.__webglColorBuffer</span><span class="PUNC">=</span><span class="NAME">k.createBuffer</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">D.info.memory.geometries</span><span class="PUNC">++</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">=</span><span class="NAME">g.vertices.length</span><span class="PUNC">,</span><span class="NAME">g.__vertexArray</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Float32Array</span><span class="PUNC">(</span><span class="NUMB">3</span><span class="PUNC">*</span><span class="NAME">i</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">g.__colorArray</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Float32Array</span><span class="PUNC">(</span><span class="NUMB">3</span><span class="PUNC">*</span><span class="NAME">i</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">g.__sortArray</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">g.__webglParticleCount</span><span class="PUNC">=</span><span class="NAME">i</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">(</span><span class="NAME">g</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">f.verticesNeedUpdate</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">f.colorsNeedUpdate</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>394</span> </span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">===</span><span class="NAME">a.__webglActive</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">a</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">THREE.Mesh</span><span class="PUNC">)</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">a.geometry</span><span class="PUNC">,</span><span class="NAME">f</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">THREE.BufferGeometry</span><span class="PUNC">)</span><span class="NAME">q</span><span class="PUNC">(</span><span class="NAME">b.__webglObjects</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">else</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">f</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">THREE.Geometry</span><span class="PUNC">)</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">e</span><span class="WHIT"> </span><span class="KEYW">in</span><span class="WHIT"> </span><span class="NAME">f.geometryGroups</span><span class="PUNC">)</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">f.geometryGroups</span><span class="PUNC">[</span><span class="NAME">e</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">q</span><span class="PUNC">(</span><span class="NAME">b.__webglObjects</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="NAME">a</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">THREE.Ribbon</span><span class="PUNC">||</span><span class="NAME">a</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">THREE.Line</span><span class="PUNC">||</span><span class="NAME">a</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">THREE.ParticleSystem</span><span class="PUNC">?</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">a.geometry</span><span class="PUNC">,</span><span class="NAME">q</span><span class="PUNC">(</span><span class="NAME">b.__webglObjects</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">a</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">THREE.ImmediateRenderObject</span><span class="PUNC">||</span><span class="NAME">a.immediateRenderCallback</span><span class="PUNC">?</span><span class="NAME">b.__webglObjectsImmediate.push</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">id</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">object</span><span class="PUNC">:</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">opaque</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>395</span> </span><span class="NAME">transparent</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">z</span><span class="PUNC">:</span><span class="NUMB">0</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">a</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">THREE.Sprite</span><span class="PUNC">?</span><span class="NAME">b.__webglSprites.push</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">a</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">THREE.LensFlare</span><span class="PUNC">&&</span><span class="NAME">b.__webglFlares.push</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a.__webglActive</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">q</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">a.push</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">id</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">buffer</span><span class="PUNC">:</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">object</span><span class="PUNC">:</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">opaque</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">transparent</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">z</span><span class="PUNC">:</span><span class="NUMB">0</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">r</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="WHIT"> </span><span class="KEYW">in</span><span class="WHIT"> </span><span class="NAME">a.attributes</span><span class="PUNC">)</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">a.attributes</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">needsUpdate</span><span class="PUNC">)</span><span class="KEYW">return</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">}</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">s</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="WHIT"> </span><span class="KEYW">in</span><span class="WHIT"> </span><span class="NAME">a.attributes</span><span class="PUNC">)</span><span class="NAME">a.attributes</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">needsUpdate</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">}</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">v</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">a</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">THREE.Mesh</span><span class="PUNC">||</span><span class="NAME">a</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">THREE.ParticleSystem</span><span class="PUNC">||</span><span class="NAME">a</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">THREE.Ribbon</span><span class="PUNC">||</span><span class="NAME">a</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT">
<span class='line'>396</span> </span><span class="NAME">THREE.Line</span><span class="PUNC">?</span><span class="NAME">z</span><span class="PUNC">(</span><span class="NAME">b.__webglObjects</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">a</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">THREE.Sprite</span><span class="PUNC">?</span><span class="NAME">C</span><span class="PUNC">(</span><span class="NAME">b.__webglSprites</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">a</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">THREE.LensFlare</span><span class="PUNC">?</span><span class="NAME">C</span><span class="PUNC">(</span><span class="NAME">b.__webglFlares</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="PUNC">(</span><span class="NAME">a</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">THREE.ImmediateRenderObject</span><span class="PUNC">||</span><span class="NAME">a.immediateRenderCallback</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="NAME">z</span><span class="PUNC">(</span><span class="NAME">b.__webglObjectsImmediate</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">delete</span><span class="WHIT"> </span><span class="NAME">a.__webglActive</span><span class="PUNC">}</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">z</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">a.length</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NUMB">0</span><span class="PUNC">&lt;=</span><span class="NAME">c</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">--</span><span class="PUNC">)</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">object</span><span class="PUNC">===</span><span class="NAME">b</span><span class="PUNC">&&</span><span class="NAME">a.splice</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">C</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">a.length</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NUMB">0</span><span class="PUNC">&lt;=</span><span class="NAME">c</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">--</span><span class="PUNC">)</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">]</span><span class="PUNC">===</span><span class="NAME">b</span><span class="PUNC">&&</span><span class="NAME">a.splice</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">F</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">fa</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">d.needsUpdate</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">d.program</span><span class="PUNC">&&</span><span class="NAME">vc</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">D.initMaterial</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">d.needsUpdate</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>397</span> </span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">d.morphTargets</span><span class="PUNC">&&</span><span class="PUNC">!</span><span class="NAME">e.__webglMorphTargetInfluences</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">e.__webglMorphTargetInfluences</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Float32Array</span><span class="PUNC">(</span><span class="NAME">D.maxMorphTargets</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">f</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">d.program</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">g.uniforms</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">=</span><span class="NAME">d.uniforms</span><span class="PUNC">;</span><span class="NAME">g</span><span class="PUNC">!==</span><span class="NAME">qa</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">k.useProgram</span><span class="PUNC">(</span><span class="NAME">g</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">qa</span><span class="PUNC">=</span><span class="NAME">g</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">d.id</span><span class="PUNC">!==</span><span class="NAME">pb</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">pb</span><span class="PUNC">=</span><span class="NAME">d.id</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">||</span><span class="NAME">a</span><span class="PUNC">!==</span><span class="NAME">ya</span><span class="PUNC">)</span><span class="NAME">k.uniformMatrix4fv</span><span class="PUNC">(</span><span class="NAME">h.projectionMatrix</span><span class="PUNC">,</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">a.projectionMatrix.elements</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">!==</span><span class="NAME">ya</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">ya</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">d.skinning</span><span class="PUNC">)</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">Bb</span><span class="PUNC">&&</span><span class="NAME">e.useVertexTexture</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="KEYW">null</span><span class="PUNC">!==</span><span class="NAME">h.boneTexture</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">j</span><span class="PUNC">=</span><span class="NAME">H</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">k.uniform1i</span><span class="PUNC">(</span><span class="NAME">h.boneTexture</span><span class="PUNC">,</span><span class="NAME">j</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">D.setTexture</span><span class="PUNC">(</span><span class="NAME">e.boneTexture</span><span class="PUNC">,</span><span class="NAME">j</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">!==</span><span class="NAME">h.boneGlobalMatrices</span><span class="PUNC">&&</span><span class="NAME">k.uniformMatrix4fv</span><span class="PUNC">(</span><span class="NAME">h.boneGlobalMatrices</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>398</span> </span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">e.boneMatrices</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">c</span><span class="PUNC">&&</span><span class="NAME">d.fog</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">i.fogColor.value</span><span class="PUNC">=</span><span class="NAME">c.color</span><span class="PUNC">,</span><span class="NAME">c</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">THREE.Fog</span><span class="PUNC">?</span><span class="PUNC">(</span><span class="NAME">i.fogNear.value</span><span class="PUNC">=</span><span class="NAME">c.near</span><span class="PUNC">,</span><span class="NAME">i.fogFar.value</span><span class="PUNC">=</span><span class="NAME">c.far</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">c</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">THREE.FogExp2</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">i.fogDensity.value</span><span class="PUNC">=</span><span class="NAME">c.density</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">d</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">THREE.MeshPhongMaterial</span><span class="PUNC">||</span><span class="NAME">d</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">THREE.MeshLambertMaterial</span><span class="PUNC">||</span><span class="NAME">d.lights</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">yb</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">m</span><span class="PUNC">,</span><span class="NAME">l</span><span class="PUNC">=</span><span class="NAME">j</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">n</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">p</span><span class="PUNC">,</span><span class="NAME">q</span><span class="PUNC">,</span><span class="NAME">r</span><span class="PUNC">,</span><span class="NAME">s</span><span class="PUNC">=</span><span class="NAME">Ib</span><span class="PUNC">,</span><span class="NAME">t</span><span class="PUNC">=</span><span class="NAME">s.directional.colors</span><span class="PUNC">,</span><span class="NAME">v</span><span class="PUNC">=</span><span class="NAME">s.directional.positions</span><span class="PUNC">,</span><span class="NAME">z</span><span class="PUNC">=</span><span class="NAME">s.point.colors</span><span class="PUNC">,</span><span class="NAME">y</span><span class="PUNC">=</span><span class="NAME">s.point.positions</span><span class="PUNC">,</span><span class="NAME">A</span><span class="PUNC">=</span><span class="NAME">s.point.distances</span><span class="PUNC">,</span><span class="NAME">B</span><span class="PUNC">=</span><span class="NAME">s.spot.colors</span><span class="PUNC">,</span><span class="NAME">F</span><span class="PUNC">=</span><span class="NAME">s.spot.positions</span><span class="PUNC">,</span><span class="NAME">C</span><span class="PUNC">=</span><span class="NAME">s.spot.distances</span><span class="PUNC">,</span><span class="NAME">E</span><span class="PUNC">=</span><span class="NAME">s.spot.directions</span><span class="PUNC">,</span><span class="NAME">J</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>399</span> </span><span class="NAME">s.spot.anglesCos</span><span class="PUNC">,</span><span class="NAME">L</span><span class="PUNC">=</span><span class="NAME">s.spot.exponents</span><span class="PUNC">,</span><span class="NAME">V</span><span class="PUNC">=</span><span class="NAME">s.hemi.skyColors</span><span class="PUNC">,</span><span class="NAME">K</span><span class="PUNC">=</span><span class="NAME">s.hemi.groundColors</span><span class="PUNC">,</span><span class="NAME">M</span><span class="PUNC">=</span><span class="NAME">s.hemi.positions</span><span class="PUNC">,</span><span class="NAME">O</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">ea</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">T</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">aa</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">da</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">R</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">S</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">P</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">ba</span><span class="PUNC">=</span><span class="NAME">m</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">r</span><span class="PUNC">=</span><span class="NAME">ba</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">b.length</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">&lt;</span><span class="NAME">f</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">m</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">m.onlyShadow</span><span class="PUNC">||</span><span class="PUNC">(</span><span class="NAME">p</span><span class="PUNC">=</span><span class="NAME">m.color</span><span class="PUNC">,</span><span class="NAME">q</span><span class="PUNC">=</span><span class="NAME">m.intensity</span><span class="PUNC">,</span><span class="NAME">r</span><span class="PUNC">=</span><span class="NAME">m.distance</span><span class="PUNC">,</span><span class="NAME">m</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">THREE.AmbientLight</span><span class="PUNC">?</span><span class="NAME">m.visible</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">D.gammaInput</span><span class="PUNC">?</span><span class="PUNC">(</span><span class="NAME">j</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">p.r</span><span class="PUNC">*</span><span class="NAME">p.r</span><span class="PUNC">,</span><span class="NAME">l</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">p.g</span><span class="PUNC">*</span><span class="NAME">p.g</span><span class="PUNC">,</span><span class="NAME">n</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">p.b</span><span class="PUNC">*</span><span class="NAME">p.b</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="PUNC">(</span><span class="NAME">j</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">p.r</span><span class="PUNC">,</span><span class="NAME">l</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">p.g</span><span class="PUNC">,</span><span class="NAME">n</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">p.b</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">m</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">THREE.DirectionalLight</span><span class="PUNC">?</span><span class="PUNC">(</span><span class="NAME">da</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">m.visible</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">Ca.getPositionFromMatrix</span><span class="PUNC">(</span><span class="NAME">m.matrixWorld</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">Ga.getPositionFromMatrix</span><span class="PUNC">(</span><span class="NAME">m.target.matrixWorld</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">Ca.sub</span><span class="PUNC">(</span><span class="NAME">Ga</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">Ca.normalize</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>400</span> </span><span class="NUMB">0</span><span class="PUNC">===</span><span class="NAME">Ca.x</span><span class="PUNC">&&</span><span class="NUMB">0</span><span class="PUNC">===</span><span class="NAME">Ca.y</span><span class="PUNC">&&</span><span class="NUMB">0</span><span class="PUNC">===</span><span class="NAME">Ca.z</span><span class="PUNC">||</span><span class="PUNC">(</span><span class="NAME">m</span><span class="PUNC">=</span><span class="NUMB">3</span><span class="PUNC">*</span><span class="NAME">O</span><span class="PUNC">,</span><span class="NAME">v</span><span class="PUNC">[</span><span class="NAME">m</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">Ca.x</span><span class="PUNC">,</span><span class="NAME">v</span><span class="PUNC">[</span><span class="NAME">m</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">Ca.y</span><span class="PUNC">,</span><span class="NAME">v</span><span class="PUNC">[</span><span class="NAME">m</span><span class="PUNC">+</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">Ca.z</span><span class="PUNC">,</span><span class="NAME">D.gammaInput</span><span class="PUNC">?</span><span class="NAME">I</span><span class="PUNC">(</span><span class="NAME">t</span><span class="PUNC">,</span><span class="NAME">m</span><span class="PUNC">,</span><span class="NAME">p</span><span class="PUNC">,</span><span class="NAME">q</span><span class="PUNC">*</span><span class="NAME">q</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">G</span><span class="PUNC">(</span><span class="NAME">t</span><span class="PUNC">,</span><span class="NAME">m</span><span class="PUNC">,</span><span class="NAME">p</span><span class="PUNC">,</span><span class="NAME">q</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">O</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">m</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">THREE.PointLight</span><span class="PUNC">?</span><span class="PUNC">(</span><span class="NAME">R</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">m.visible</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">ba</span><span class="PUNC">=</span><span class="NUMB">3</span><span class="PUNC">*</span><span class="NAME">ea</span><span class="PUNC">,</span><span class="NAME">D.gammaInput</span><span class="PUNC">?</span><span class="NAME">I</span><span class="PUNC">(</span><span class="NAME">z</span><span class="PUNC">,</span><span class="NAME">ba</span><span class="PUNC">,</span><span class="NAME">p</span><span class="PUNC">,</span><span class="NAME">q</span><span class="PUNC">*</span><span class="NAME">q</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">G</span><span class="PUNC">(</span><span class="NAME">z</span><span class="PUNC">,</span><span class="NAME">ba</span><span class="PUNC">,</span><span class="NAME">p</span><span class="PUNC">,</span><span class="NAME">q</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">Ga.getPositionFromMatrix</span><span class="PUNC">(</span><span class="NAME">m.matrixWorld</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">y</span><span class="PUNC">[</span><span class="NAME">ba</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">Ga.x</span><span class="PUNC">,</span><span class="NAME">y</span><span class="PUNC">[</span><span class="NAME">ba</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">Ga.y</span><span class="PUNC">,</span><span class="NAME">y</span><span class="PUNC">[</span><span class="NAME">ba</span><span class="PUNC">+</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">Ga.z</span><span class="PUNC">,</span><span class="NAME">A</span><span class="PUNC">[</span><span class="NAME">ea</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">r</span><span class="PUNC">,</span><span class="NAME">ea</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">m</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">THREE.SpotLight</span><span class="PUNC">?</span><span class="PUNC">(</span><span class="NAME">S</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">m.visible</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">ba</span><span class="PUNC">=</span><span class="NUMB">3</span><span class="PUNC">*</span><span class="NAME">T</span><span class="PUNC">,</span><span class="NAME">D.gammaInput</span><span class="PUNC">?</span><span class="NAME">I</span><span class="PUNC">(</span><span class="NAME">B</span><span class="PUNC">,</span><span class="NAME">ba</span><span class="PUNC">,</span><span class="NAME">p</span><span class="PUNC">,</span><span class="NAME">q</span><span class="PUNC">*</span><span class="NAME">q</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">G</span><span class="PUNC">(</span><span class="NAME">B</span><span class="PUNC">,</span><span class="NAME">ba</span><span class="PUNC">,</span><span class="NAME">p</span><span class="PUNC">,</span><span class="NAME">q</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">Ga.getPositionFromMatrix</span><span class="PUNC">(</span><span class="NAME">m.matrixWorld</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">F</span><span class="PUNC">[</span><span class="NAME">ba</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">Ga.x</span><span class="PUNC">,</span><span class="NAME">F</span><span class="PUNC">[</span><span class="NAME">ba</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">Ga.y</span><span class="PUNC">,</span><span class="NAME">F</span><span class="PUNC">[</span><span class="NAME">ba</span><span class="PUNC">+</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">Ga.z</span><span class="PUNC">,</span><span class="NAME">C</span><span class="PUNC">[</span><span class="NAME">T</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">r</span><span class="PUNC">,</span><span class="NAME">Ca.copy</span><span class="PUNC">(</span><span class="NAME">Ga</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">Ga.getPositionFromMatrix</span><span class="PUNC">(</span><span class="NAME">m.target.matrixWorld</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>401</span> </span><span class="NAME">Ca.sub</span><span class="PUNC">(</span><span class="NAME">Ga</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">Ca.normalize</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">E</span><span class="PUNC">[</span><span class="NAME">ba</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">Ca.x</span><span class="PUNC">,</span><span class="NAME">E</span><span class="PUNC">[</span><span class="NAME">ba</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">Ca.y</span><span class="PUNC">,</span><span class="NAME">E</span><span class="PUNC">[</span><span class="NAME">ba</span><span class="PUNC">+</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">Ca.z</span><span class="PUNC">,</span><span class="NAME">J</span><span class="PUNC">[</span><span class="NAME">T</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">Math.cos</span><span class="PUNC">(</span><span class="NAME">m.angle</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">L</span><span class="PUNC">[</span><span class="NAME">T</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">m.exponent</span><span class="PUNC">,</span><span class="NAME">T</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">m</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">THREE.HemisphereLight</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">P</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">m.visible</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">Ca.getPositionFromMatrix</span><span class="PUNC">(</span><span class="NAME">m.matrixWorld</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">Ca.normalize</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">===</span><span class="NAME">Ca.x</span><span class="PUNC">&&</span><span class="NUMB">0</span><span class="PUNC">===</span><span class="NAME">Ca.y</span><span class="PUNC">&&</span><span class="NUMB">0</span><span class="PUNC">===</span><span class="NAME">Ca.z</span><span class="PUNC">||</span><span class="PUNC">(</span><span class="NAME">r</span><span class="PUNC">=</span><span class="NUMB">3</span><span class="PUNC">*</span><span class="NAME">aa</span><span class="PUNC">,</span><span class="NAME">M</span><span class="PUNC">[</span><span class="NAME">r</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">Ca.x</span><span class="PUNC">,</span><span class="NAME">M</span><span class="PUNC">[</span><span class="NAME">r</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">Ca.y</span><span class="PUNC">,</span><span class="NAME">M</span><span class="PUNC">[</span><span class="NAME">r</span><span class="PUNC">+</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">Ca.z</span><span class="PUNC">,</span><span class="NAME">p</span><span class="PUNC">=</span><span class="NAME">m.color</span><span class="PUNC">,</span><span class="NAME">m</span><span class="PUNC">=</span><span class="NAME">m.groundColor</span><span class="PUNC">,</span><span class="NAME">D.gammaInput</span><span class="PUNC">?</span><span class="PUNC">(</span><span class="NAME">q</span><span class="PUNC">*</span><span class="PUNC">=</span><span class="NAME">q</span><span class="PUNC">,</span><span class="NAME">I</span><span class="PUNC">(</span><span class="NAME">V</span><span class="PUNC">,</span><span class="NAME">r</span><span class="PUNC">,</span><span class="NAME">p</span><span class="PUNC">,</span><span class="NAME">q</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">I</span><span class="PUNC">(</span><span class="NAME">K</span><span class="PUNC">,</span><span class="NAME">r</span><span class="PUNC">,</span><span class="NAME">m</span><span class="PUNC">,</span><span class="NAME">q</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="PUNC">(</span><span class="NAME">G</span><span class="PUNC">(</span><span class="NAME">V</span><span class="PUNC">,</span><span class="NAME">r</span><span class="PUNC">,</span><span class="NAME">p</span><span class="PUNC">,</span><span class="NAME">q</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">G</span><span class="PUNC">(</span><span class="NAME">K</span><span class="PUNC">,</span><span class="NAME">r</span><span class="PUNC">,</span><span class="NAME">m</span><span class="PUNC">,</span><span class="NAME">q</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">aa</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NUMB">3</span><span class="PUNC">*</span><span class="NAME">O</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">Math.max</span><span class="PUNC">(</span><span class="NAME">t.length</span><span class="PUNC">,</span><span class="NUMB">3</span><span class="PUNC">*</span><span class="NAME">da</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">&lt;</span><span class="NAME">f</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">t</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NUMB">3</span><span class="PUNC">*</span><span class="NAME">ea</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">Math.max</span><span class="PUNC">(</span><span class="NAME">z.length</span><span class="PUNC">,</span><span class="NUMB">3</span><span class="PUNC">*</span><span class="NAME">R</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">&lt;</span><span class="NAME">f</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">z</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NUMB">3</span><span class="PUNC">*</span><span class="NAME">T</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>402</span> </span><span class="NAME">Math.max</span><span class="PUNC">(</span><span class="NAME">B.length</span><span class="PUNC">,</span><span class="NUMB">3</span><span class="PUNC">*</span><span class="NAME">S</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">&lt;</span><span class="NAME">f</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">B</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NUMB">3</span><span class="PUNC">*</span><span class="NAME">aa</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">Math.max</span><span class="PUNC">(</span><span class="NAME">V.length</span><span class="PUNC">,</span><span class="NUMB">3</span><span class="PUNC">*</span><span class="NAME">P</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">&lt;</span><span class="NAME">f</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">V</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NUMB">3</span><span class="PUNC">*</span><span class="NAME">aa</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">Math.max</span><span class="PUNC">(</span><span class="NAME">K.length</span><span class="PUNC">,</span><span class="NUMB">3</span><span class="PUNC">*</span><span class="NAME">P</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">&lt;</span><span class="NAME">f</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">K</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">s.directional.length</span><span class="PUNC">=</span><span class="NAME">O</span><span class="PUNC">;</span><span class="NAME">s.point.length</span><span class="PUNC">=</span><span class="NAME">ea</span><span class="PUNC">;</span><span class="NAME">s.spot.length</span><span class="PUNC">=</span><span class="NAME">T</span><span class="PUNC">;</span><span class="NAME">s.hemi.length</span><span class="PUNC">=</span><span class="NAME">aa</span><span class="PUNC">;</span><span class="NAME">s.ambient</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">j</span><span class="PUNC">;</span><span class="NAME">s.ambient</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">l</span><span class="PUNC">;</span><span class="NAME">s.ambient</span><span class="PUNC">[</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">n</span><span class="PUNC">;</span><span class="NAME">yb</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">}</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">Ib</span><span class="PUNC">;</span><span class="NAME">i.ambientLightColor.value</span><span class="PUNC">=</span><span class="NAME">c.ambient</span><span class="PUNC">;</span><span class="NAME">i.directionalLightColor.value</span><span class="PUNC">=</span><span class="NAME">c.directional.colors</span><span class="PUNC">;</span><span class="NAME">i.directionalLightDirection.value</span><span class="PUNC">=</span><span class="NAME">c.directional.positions</span><span class="PUNC">;</span><span class="NAME">i.pointLightColor.value</span><span class="PUNC">=</span><span class="NAME">c.point.colors</span><span class="PUNC">;</span><span class="NAME">i.pointLightPosition.value</span><span class="PUNC">=</span><span class="NAME">c.point.positions</span><span class="PUNC">;</span><span class="NAME">i.pointLightDistance.value</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>403</span> </span><span class="NAME">c.point.distances</span><span class="PUNC">;</span><span class="NAME">i.spotLightColor.value</span><span class="PUNC">=</span><span class="NAME">c.spot.colors</span><span class="PUNC">;</span><span class="NAME">i.spotLightPosition.value</span><span class="PUNC">=</span><span class="NAME">c.spot.positions</span><span class="PUNC">;</span><span class="NAME">i.spotLightDistance.value</span><span class="PUNC">=</span><span class="NAME">c.spot.distances</span><span class="PUNC">;</span><span class="NAME">i.spotLightDirection.value</span><span class="PUNC">=</span><span class="NAME">c.spot.directions</span><span class="PUNC">;</span><span class="NAME">i.spotLightAngleCos.value</span><span class="PUNC">=</span><span class="NAME">c.spot.anglesCos</span><span class="PUNC">;</span><span class="NAME">i.spotLightExponent.value</span><span class="PUNC">=</span><span class="NAME">c.spot.exponents</span><span class="PUNC">;</span><span class="NAME">i.hemisphereLightSkyColor.value</span><span class="PUNC">=</span><span class="NAME">c.hemi.skyColors</span><span class="PUNC">;</span><span class="NAME">i.hemisphereLightGroundColor.value</span><span class="PUNC">=</span><span class="NAME">c.hemi.groundColors</span><span class="PUNC">;</span><span class="NAME">i.hemisphereLightDirection.value</span><span class="PUNC">=</span><span class="NAME">c.hemi.positions</span><span class="PUNC">}</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">d</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">THREE.MeshBasicMaterial</span><span class="PUNC">||</span><span class="NAME">d</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">THREE.MeshLambertMaterial</span><span class="PUNC">||</span><span class="WHIT">
<span class='line'>404</span> </span><span class="NAME">d</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">THREE.MeshPhongMaterial</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">i.opacity.value</span><span class="PUNC">=</span><span class="NAME">d.opacity</span><span class="PUNC">;</span><span class="NAME">D.gammaInput</span><span class="PUNC">?</span><span class="NAME">i.diffuse.value.copyGammaToLinear</span><span class="PUNC">(</span><span class="NAME">d.color</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">i.diffuse.value</span><span class="PUNC">=</span><span class="NAME">d.color</span><span class="PUNC">;</span><span class="NAME">i.map.value</span><span class="PUNC">=</span><span class="NAME">d.map</span><span class="PUNC">;</span><span class="NAME">i.lightMap.value</span><span class="PUNC">=</span><span class="NAME">d.lightMap</span><span class="PUNC">;</span><span class="NAME">i.specularMap.value</span><span class="PUNC">=</span><span class="NAME">d.specularMap</span><span class="PUNC">;</span><span class="NAME">d.bumpMap</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">i.bumpMap.value</span><span class="PUNC">=</span><span class="NAME">d.bumpMap</span><span class="PUNC">,</span><span class="NAME">i.bumpScale.value</span><span class="PUNC">=</span><span class="NAME">d.bumpScale</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">d.normalMap</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">i.normalMap.value</span><span class="PUNC">=</span><span class="NAME">d.normalMap</span><span class="PUNC">,</span><span class="NAME">i.normalScale.value.copy</span><span class="PUNC">(</span><span class="NAME">d.normalScale</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">X</span><span class="PUNC">;</span><span class="NAME">d.map</span><span class="PUNC">?</span><span class="NAME">X</span><span class="PUNC">=</span><span class="NAME">d.map</span><span class="PUNC">:</span><span class="NAME">d.specularMap</span><span class="PUNC">?</span><span class="NAME">X</span><span class="PUNC">=</span><span class="NAME">d.specularMap</span><span class="PUNC">:</span><span class="NAME">d.normalMap</span><span class="PUNC">?</span><span class="NAME">X</span><span class="PUNC">=</span><span class="NAME">d.normalMap</span><span class="PUNC">:</span><span class="NAME">d.bumpMap</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">X</span><span class="PUNC">=</span><span class="NAME">d.bumpMap</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">X</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">X.offset</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>405</span> </span><span class="NAME">X</span><span class="PUNC">=</span><span class="NAME">X.repeat</span><span class="PUNC">,</span><span class="NAME">i.offsetRepeat.value.set</span><span class="PUNC">(</span><span class="NAME">c.x</span><span class="PUNC">,</span><span class="NAME">c.y</span><span class="PUNC">,</span><span class="NAME">X.x</span><span class="PUNC">,</span><span class="NAME">X.y</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">i.envMap.value</span><span class="PUNC">=</span><span class="NAME">d.envMap</span><span class="PUNC">;</span><span class="NAME">i.flipEnvMap.value</span><span class="PUNC">=</span><span class="NAME">d.envMap</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">THREE.WebGLRenderTargetCube</span><span class="PUNC">?</span><span class="NUMB">1</span><span class="PUNC">:</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">i.reflectivity.value</span><span class="PUNC">=</span><span class="NAME">d.reflectivity</span><span class="PUNC">;</span><span class="NAME">i.refractionRatio.value</span><span class="PUNC">=</span><span class="NAME">d.refractionRatio</span><span class="PUNC">;</span><span class="NAME">i.combine.value</span><span class="PUNC">=</span><span class="NAME">d.combine</span><span class="PUNC">;</span><span class="NAME">i.useRefract.value</span><span class="PUNC">=</span><span class="NAME">d.envMap</span><span class="PUNC">&&</span><span class="NAME">d.envMap.mapping</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">THREE.CubeRefractionMapping</span><span class="PUNC">}</span><span class="NAME">d</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">THREE.LineBasicMaterial</span><span class="PUNC">?</span><span class="PUNC">(</span><span class="NAME">i.diffuse.value</span><span class="PUNC">=</span><span class="NAME">d.color</span><span class="PUNC">,</span><span class="NAME">i.opacity.value</span><span class="PUNC">=</span><span class="NAME">d.opacity</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">d</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">THREE.LineDashedMaterial</span><span class="PUNC">?</span><span class="PUNC">(</span><span class="NAME">i.diffuse.value</span><span class="PUNC">=</span><span class="NAME">d.color</span><span class="PUNC">,</span><span class="NAME">i.opacity.value</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>406</span> </span><span class="NAME">d.opacity</span><span class="PUNC">,</span><span class="NAME">i.dashSize.value</span><span class="PUNC">=</span><span class="NAME">d.dashSize</span><span class="PUNC">,</span><span class="NAME">i.totalSize.value</span><span class="PUNC">=</span><span class="NAME">d.dashSize</span><span class="PUNC">+</span><span class="NAME">d.gapSize</span><span class="PUNC">,</span><span class="NAME">i.scale.value</span><span class="PUNC">=</span><span class="NAME">d.scale</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">d</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">THREE.ParticleBasicMaterial</span><span class="PUNC">?</span><span class="PUNC">(</span><span class="NAME">i.psColor.value</span><span class="PUNC">=</span><span class="NAME">d.color</span><span class="PUNC">,</span><span class="NAME">i.opacity.value</span><span class="PUNC">=</span><span class="NAME">d.opacity</span><span class="PUNC">,</span><span class="NAME">i.size.value</span><span class="PUNC">=</span><span class="NAME">d.size</span><span class="PUNC">,</span><span class="NAME">i.scale.value</span><span class="PUNC">=</span><span class="NAME">Z.height</span><span class="PUNC">/</span><span class="NUMB">2</span><span class="PUNC">,</span><span class="NAME">i.map.value</span><span class="PUNC">=</span><span class="NAME">d.map</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">d</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">THREE.MeshPhongMaterial</span><span class="PUNC">?</span><span class="PUNC">(</span><span class="NAME">i.shininess.value</span><span class="PUNC">=</span><span class="NAME">d.shininess</span><span class="PUNC">,</span><span class="NAME">D.gammaInput</span><span class="PUNC">?</span><span class="PUNC">(</span><span class="NAME">i.ambient.value.copyGammaToLinear</span><span class="PUNC">(</span><span class="NAME">d.ambient</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">i.emissive.value.copyGammaToLinear</span><span class="PUNC">(</span><span class="NAME">d.emissive</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">i.specular.value.copyGammaToLinear</span><span class="PUNC">(</span><span class="NAME">d.specular</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="PUNC">(</span><span class="NAME">i.ambient.value</span><span class="PUNC">=</span><span class="NAME">d.ambient</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>407</span> </span><span class="NAME">i.emissive.value</span><span class="PUNC">=</span><span class="NAME">d.emissive</span><span class="PUNC">,</span><span class="NAME">i.specular.value</span><span class="PUNC">=</span><span class="NAME">d.specular</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">d.wrapAround</span><span class="PUNC">&&</span><span class="NAME">i.wrapRGB.value.copy</span><span class="PUNC">(</span><span class="NAME">d.wrapRGB</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">d</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">THREE.MeshLambertMaterial</span><span class="PUNC">?</span><span class="PUNC">(</span><span class="NAME">D.gammaInput</span><span class="PUNC">?</span><span class="PUNC">(</span><span class="NAME">i.ambient.value.copyGammaToLinear</span><span class="PUNC">(</span><span class="NAME">d.ambient</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">i.emissive.value.copyGammaToLinear</span><span class="PUNC">(</span><span class="NAME">d.emissive</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="PUNC">(</span><span class="NAME">i.ambient.value</span><span class="PUNC">=</span><span class="NAME">d.ambient</span><span class="PUNC">,</span><span class="NAME">i.emissive.value</span><span class="PUNC">=</span><span class="NAME">d.emissive</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">d.wrapAround</span><span class="PUNC">&&</span><span class="NAME">i.wrapRGB.value.copy</span><span class="PUNC">(</span><span class="NAME">d.wrapRGB</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">d</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">THREE.MeshDepthMaterial</span><span class="PUNC">?</span><span class="PUNC">(</span><span class="NAME">i.mNear.value</span><span class="PUNC">=</span><span class="NAME">a.near</span><span class="PUNC">,</span><span class="NAME">i.mFar.value</span><span class="PUNC">=</span><span class="NAME">a.far</span><span class="PUNC">,</span><span class="NAME">i.opacity.value</span><span class="PUNC">=</span><span class="NAME">d.opacity</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">d</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">THREE.MeshNormalMaterial</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">i.opacity.value</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>408</span> </span><span class="NAME">d.opacity</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">e.receiveShadow</span><span class="PUNC">&&</span><span class="PUNC">!</span><span class="NAME">d._shadowPass</span><span class="PUNC">&&</span><span class="NAME">i.shadowMatrix</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">X</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">b.length</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">&lt;</span><span class="NAME">f</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">j</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">j.castShadow</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">j</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">THREE.SpotLight</span><span class="PUNC">||</span><span class="NAME">j</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">THREE.DirectionalLight</span><span class="PUNC">&&</span><span class="PUNC">!</span><span class="NAME">j.shadowCascade</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="NAME">i.shadowMap.value</span><span class="PUNC">[</span><span class="NAME">X</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">j.shadowMap</span><span class="PUNC">,</span><span class="NAME">i.shadowMapSize.value</span><span class="PUNC">[</span><span class="NAME">X</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">j.shadowMapSize</span><span class="PUNC">,</span><span class="NAME">i.shadowMatrix.value</span><span class="PUNC">[</span><span class="NAME">X</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">j.shadowMatrix</span><span class="PUNC">,</span><span class="NAME">i.shadowDarkness.value</span><span class="PUNC">[</span><span class="NAME">X</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">j.shadowDarkness</span><span class="PUNC">,</span><span class="NAME">i.shadowBias.value</span><span class="PUNC">[</span><span class="NAME">X</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">j.shadowBias</span><span class="PUNC">,</span><span class="NAME">X</span><span class="PUNC">++</span><span class="PUNC">}</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">d.uniformsList</span><span class="PUNC">;</span><span class="NAME">i</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">X</span><span class="PUNC">=</span><span class="NAME">b.length</span><span class="PUNC">;</span><span class="NAME">i</span><span class="PUNC">&lt;</span><span class="NAME">X</span><span class="PUNC">;</span><span class="NAME">i</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">g.uniforms</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">l</span><span class="PUNC">=</span><span class="NAME">c.type</span><span class="PUNC">,</span><span class="NAME">j</span><span class="PUNC">=</span><span class="NAME">c.value</span><span class="PUNC">,</span><span class="STRN">"i"</span><span class="PUNC">===</span><span class="WHIT">
<span class='line'>409</span> </span><span class="NAME">l</span><span class="PUNC">)</span><span class="NAME">k.uniform1i</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">j</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="STRN">"f"</span><span class="PUNC">===</span><span class="NAME">l</span><span class="PUNC">)</span><span class="NAME">k.uniform1f</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">j</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="STRN">"v2"</span><span class="PUNC">===</span><span class="NAME">l</span><span class="PUNC">)</span><span class="NAME">k.uniform2f</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">j.x</span><span class="PUNC">,</span><span class="NAME">j.y</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="STRN">"v3"</span><span class="PUNC">===</span><span class="NAME">l</span><span class="PUNC">)</span><span class="NAME">k.uniform3f</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">j.x</span><span class="PUNC">,</span><span class="NAME">j.y</span><span class="PUNC">,</span><span class="NAME">j.z</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="STRN">"v4"</span><span class="PUNC">===</span><span class="NAME">l</span><span class="PUNC">)</span><span class="NAME">k.uniform4f</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">j.x</span><span class="PUNC">,</span><span class="NAME">j.y</span><span class="PUNC">,</span><span class="NAME">j.z</span><span class="PUNC">,</span><span class="NAME">j.w</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="STRN">"c"</span><span class="PUNC">===</span><span class="NAME">l</span><span class="PUNC">)</span><span class="NAME">k.uniform3f</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">j.r</span><span class="PUNC">,</span><span class="NAME">j.g</span><span class="PUNC">,</span><span class="NAME">j.b</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="STRN">"iv1"</span><span class="PUNC">===</span><span class="NAME">l</span><span class="PUNC">)</span><span class="NAME">k.uniform1iv</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">j</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="STRN">"iv"</span><span class="PUNC">===</span><span class="NAME">l</span><span class="PUNC">)</span><span class="NAME">k.uniform3iv</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">j</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="STRN">"fv1"</span><span class="PUNC">===</span><span class="NAME">l</span><span class="PUNC">)</span><span class="NAME">k.uniform1fv</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">j</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="STRN">"fv"</span><span class="PUNC">===</span><span class="NAME">l</span><span class="PUNC">)</span><span class="NAME">k.uniform3fv</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">j</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="STRN">"v2v"</span><span class="PUNC">===</span><span class="NAME">l</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">===</span><span class="NAME">c._array</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">c._array</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Float32Array</span><span class="PUNC">(</span><span class="NUMB">2</span><span class="PUNC">*</span><span class="NAME">j.length</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">l</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">n</span><span class="PUNC">=</span><span class="NAME">j.length</span><span class="PUNC">;</span><span class="NAME">l</span><span class="PUNC">&lt;</span><span class="NAME">n</span><span class="PUNC">;</span><span class="NAME">l</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">s</span><span class="PUNC">=</span><span class="NUMB">2</span><span class="PUNC">*</span><span class="NAME">l</span><span class="PUNC">,</span><span class="NAME">c._array</span><span class="PUNC">[</span><span class="NAME">s</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">j</span><span class="PUNC">[</span><span class="NAME">l</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">x</span><span class="PUNC">,</span><span class="NAME">c._array</span><span class="PUNC">[</span><span class="NAME">s</span><span class="PUNC">+</span><span class="WHIT">
<span class='line'>410</span> </span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">j</span><span class="PUNC">[</span><span class="NAME">l</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">y</span><span class="PUNC">;</span><span class="NAME">k.uniform2fv</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">c._array</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="STRN">"v3v"</span><span class="PUNC">===</span><span class="NAME">l</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">===</span><span class="NAME">c._array</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">c._array</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Float32Array</span><span class="PUNC">(</span><span class="NUMB">3</span><span class="PUNC">*</span><span class="NAME">j.length</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">l</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">n</span><span class="PUNC">=</span><span class="NAME">j.length</span><span class="PUNC">;</span><span class="NAME">l</span><span class="PUNC">&lt;</span><span class="NAME">n</span><span class="PUNC">;</span><span class="NAME">l</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">s</span><span class="PUNC">=</span><span class="NUMB">3</span><span class="PUNC">*</span><span class="NAME">l</span><span class="PUNC">,</span><span class="NAME">c._array</span><span class="PUNC">[</span><span class="NAME">s</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">j</span><span class="PUNC">[</span><span class="NAME">l</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">x</span><span class="PUNC">,</span><span class="NAME">c._array</span><span class="PUNC">[</span><span class="NAME">s</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">j</span><span class="PUNC">[</span><span class="NAME">l</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">y</span><span class="PUNC">,</span><span class="NAME">c._array</span><span class="PUNC">[</span><span class="NAME">s</span><span class="PUNC">+</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">j</span><span class="PUNC">[</span><span class="NAME">l</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">z</span><span class="PUNC">;</span><span class="NAME">k.uniform3fv</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">c._array</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="STRN">"v4v"</span><span class="PUNC">===</span><span class="NAME">l</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">===</span><span class="NAME">c._array</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">c._array</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Float32Array</span><span class="PUNC">(</span><span class="NUMB">4</span><span class="PUNC">*</span><span class="NAME">j.length</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">l</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">n</span><span class="PUNC">=</span><span class="NAME">j.length</span><span class="PUNC">;</span><span class="NAME">l</span><span class="PUNC">&lt;</span><span class="NAME">n</span><span class="PUNC">;</span><span class="NAME">l</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">s</span><span class="PUNC">=</span><span class="NUMB">4</span><span class="PUNC">*</span><span class="NAME">l</span><span class="PUNC">,</span><span class="NAME">c._array</span><span class="PUNC">[</span><span class="NAME">s</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">j</span><span class="PUNC">[</span><span class="NAME">l</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">x</span><span class="PUNC">,</span><span class="NAME">c._array</span><span class="PUNC">[</span><span class="NAME">s</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">j</span><span class="PUNC">[</span><span class="NAME">l</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">y</span><span class="PUNC">,</span><span class="NAME">c._array</span><span class="PUNC">[</span><span class="NAME">s</span><span class="PUNC">+</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">j</span><span class="PUNC">[</span><span class="NAME">l</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">z</span><span class="PUNC">,</span><span class="NAME">c._array</span><span class="PUNC">[</span><span class="NAME">s</span><span class="PUNC">+</span><span class="NUMB">3</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">j</span><span class="PUNC">[</span><span class="NAME">l</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">w</span><span class="PUNC">;</span><span class="NAME">k.uniform4fv</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">c._array</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="STRN">"m4"</span><span class="PUNC">===</span><span class="NAME">l</span><span class="PUNC">)</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">===</span><span class="NAME">c._array</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">c._array</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Float32Array</span><span class="PUNC">(</span><span class="NUMB">16</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>411</span> </span><span class="NAME">j.flattenToArray</span><span class="PUNC">(</span><span class="NAME">c._array</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">k.uniformMatrix4fv</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">,</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">c._array</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="STRN">"m4v"</span><span class="PUNC">===</span><span class="NAME">l</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">===</span><span class="NAME">c._array</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">c._array</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Float32Array</span><span class="PUNC">(</span><span class="NUMB">16</span><span class="PUNC">*</span><span class="NAME">j.length</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">l</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">n</span><span class="PUNC">=</span><span class="NAME">j.length</span><span class="PUNC">;</span><span class="NAME">l</span><span class="PUNC">&lt;</span><span class="NAME">n</span><span class="PUNC">;</span><span class="NAME">l</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">j</span><span class="PUNC">[</span><span class="NAME">l</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">flattenToArrayOffset</span><span class="PUNC">(</span><span class="NAME">c._array</span><span class="PUNC">,</span><span class="NUMB">16</span><span class="PUNC">*</span><span class="NAME">l</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">k.uniformMatrix4fv</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">,</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">c._array</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="STRN">"t"</span><span class="PUNC">===</span><span class="NAME">l</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">s</span><span class="PUNC">=</span><span class="NAME">j</span><span class="PUNC">,</span><span class="NAME">j</span><span class="PUNC">=</span><span class="NAME">H</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">k.uniform1i</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">j</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">s</span><span class="PUNC">)</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">s.image</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">Array</span><span class="PUNC">&&</span><span class="NUMB">6</span><span class="PUNC">===</span><span class="NAME">s.image.length</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">s</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">j</span><span class="PUNC">,</span><span class="NUMB">6</span><span class="PUNC">===</span><span class="NAME">c.image.length</span><span class="PUNC">)</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">c.needsUpdate</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">c.image.__webglTextureCube</span><span class="PUNC">||</span><span class="PUNC">(</span><span class="NAME">c.addEventListener</span><span class="PUNC">(</span><span class="STRN">"dispose"</span><span class="PUNC">,</span><span class="NAME">gc</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">c.image.__webglTextureCube</span><span class="PUNC">=</span><span class="NAME">k.createTexture</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">D.info.memory.textures</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>412</span> </span><span class="NAME">k.activeTexture</span><span class="PUNC">(</span><span class="NAME">k.TEXTURE0</span><span class="PUNC">+</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">k.bindTexture</span><span class="PUNC">(</span><span class="NAME">k.TEXTURE_CUBE_MAP</span><span class="PUNC">,</span><span class="NAME">c.image.__webglTextureCube</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">k.pixelStorei</span><span class="PUNC">(</span><span class="NAME">k.UNPACK_FLIP_Y_WEBGL</span><span class="PUNC">,</span><span class="NAME">c.flipY</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">c</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">THREE.CompressedTexture</span><span class="PUNC">;</span><span class="NAME">j</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">l</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NUMB">6</span><span class="PUNC">></span><span class="NAME">l</span><span class="PUNC">;</span><span class="NAME">l</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">D.autoScaleCubemaps</span><span class="PUNC">&&</span><span class="PUNC">!</span><span class="NAME">f</span><span class="PUNC">?</span><span class="PUNC">(</span><span class="NAME">n</span><span class="PUNC">=</span><span class="NAME">j</span><span class="PUNC">,</span><span class="NAME">s</span><span class="PUNC">=</span><span class="NAME">l</span><span class="PUNC">,</span><span class="NAME">t</span><span class="PUNC">=</span><span class="NAME">c.image</span><span class="PUNC">[</span><span class="NAME">l</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">z</span><span class="PUNC">=</span><span class="NAME">Ub</span><span class="PUNC">,</span><span class="NAME">t.width</span><span class="PUNC">&lt;=</span><span class="NAME">z</span><span class="PUNC">&&</span><span class="NAME">t.height</span><span class="PUNC">&lt;=</span><span class="NAME">z</span><span class="PUNC">||</span><span class="PUNC">(</span><span class="NAME">y</span><span class="PUNC">=</span><span class="NAME">Math.max</span><span class="PUNC">(</span><span class="NAME">t.width</span><span class="PUNC">,</span><span class="NAME">t.height</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">v</span><span class="PUNC">=</span><span class="NAME">Math.floor</span><span class="PUNC">(</span><span class="NAME">t.width</span><span class="PUNC">*</span><span class="NAME">z</span><span class="PUNC">/</span><span class="NAME">y</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">z</span><span class="PUNC">=</span><span class="NAME">Math.floor</span><span class="PUNC">(</span><span class="NAME">t.height</span><span class="PUNC">*</span><span class="NAME">z</span><span class="PUNC">/</span><span class="NAME">y</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">y</span><span class="PUNC">=</span><span class="NAME">document.createElement</span><span class="PUNC">(</span><span class="STRN">"canvas"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">y.width</span><span class="PUNC">=</span><span class="NAME">v</span><span class="PUNC">,</span><span class="NAME">y.height</span><span class="PUNC">=</span><span class="NAME">z</span><span class="PUNC">,</span><span class="NAME">y.getContext</span><span class="PUNC">(</span><span class="STRN">"2d"</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">drawImage</span><span class="PUNC">(</span><span class="NAME">t</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">t.width</span><span class="PUNC">,</span><span class="NAME">t.height</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">v</span><span class="PUNC">,</span><span class="NAME">z</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">t</span><span class="PUNC">=</span><span class="NAME">y</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">n</span><span class="PUNC">[</span><span class="NAME">s</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">t</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">j</span><span class="PUNC">[</span><span class="NAME">l</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">c.image</span><span class="PUNC">[</span><span class="NAME">l</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>413</span> </span><span class="NAME">l</span><span class="PUNC">=</span><span class="NAME">j</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">n</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">===</span><span class="PUNC">(</span><span class="NAME">l.width</span><span class="PUNC">&</span><span class="NAME">l.width</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="NUMB">0</span><span class="PUNC">===</span><span class="PUNC">(</span><span class="NAME">l.height</span><span class="PUNC">&</span><span class="NAME">l.height</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">s</span><span class="PUNC">=</span><span class="NAME">w</span><span class="PUNC">(</span><span class="NAME">c.format</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">t</span><span class="PUNC">=</span><span class="NAME">w</span><span class="PUNC">(</span><span class="NAME">c.type</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">N</span><span class="PUNC">(</span><span class="NAME">k.TEXTURE_CUBE_MAP</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">n</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">l</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NUMB">6</span><span class="PUNC">></span><span class="NAME">l</span><span class="PUNC">;</span><span class="NAME">l</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">z</span><span class="PUNC">=</span><span class="NAME">j</span><span class="PUNC">[</span><span class="NAME">l</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">mipmaps</span><span class="PUNC">;</span><span class="NAME">y</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">A</span><span class="PUNC">=</span><span class="NAME">z.length</span><span class="PUNC">;</span><span class="NAME">y</span><span class="PUNC">&lt;</span><span class="NAME">A</span><span class="PUNC">;</span><span class="NAME">y</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">v</span><span class="PUNC">=</span><span class="NAME">z</span><span class="PUNC">[</span><span class="NAME">y</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">k.compressedTexImage2D</span><span class="PUNC">(</span><span class="NAME">k.TEXTURE_CUBE_MAP_POSITIVE_X</span><span class="PUNC">+</span><span class="NAME">l</span><span class="PUNC">,</span><span class="NAME">y</span><span class="PUNC">,</span><span class="NAME">s</span><span class="PUNC">,</span><span class="NAME">v.width</span><span class="PUNC">,</span><span class="NAME">v.height</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">v.data</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="NAME">k.texImage2D</span><span class="PUNC">(</span><span class="NAME">k.TEXTURE_CUBE_MAP_POSITIVE_X</span><span class="PUNC">+</span><span class="NAME">l</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">s</span><span class="PUNC">,</span><span class="NAME">s</span><span class="PUNC">,</span><span class="NAME">t</span><span class="PUNC">,</span><span class="NAME">j</span><span class="PUNC">[</span><span class="NAME">l</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">c.generateMipmaps</span><span class="PUNC">&&</span><span class="NAME">n</span><span class="PUNC">&&</span><span class="NAME">k.generateMipmap</span><span class="PUNC">(</span><span class="NAME">k.TEXTURE_CUBE_MAP</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">c.needsUpdate</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">c.onUpdate</span><span class="PUNC">)</span><span class="NAME">c.onUpdate</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="NAME">k.activeTexture</span><span class="PUNC">(</span><span class="NAME">k.TEXTURE0</span><span class="PUNC">+</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">k.bindTexture</span><span class="PUNC">(</span><span class="NAME">k.TEXTURE_CUBE_MAP</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>414</span> </span><span class="NAME">c.image.__webglTextureCube</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="NAME">s</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">THREE.WebGLRenderTargetCube</span><span class="PUNC">?</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">s</span><span class="PUNC">,</span><span class="NAME">k.activeTexture</span><span class="PUNC">(</span><span class="NAME">k.TEXTURE0</span><span class="PUNC">+</span><span class="NAME">j</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">k.bindTexture</span><span class="PUNC">(</span><span class="NAME">k.TEXTURE_CUBE_MAP</span><span class="PUNC">,</span><span class="NAME">c.__webglTexture</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">D.setTexture</span><span class="PUNC">(</span><span class="NAME">s</span><span class="PUNC">,</span><span class="NAME">j</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="STRN">"tv"</span><span class="PUNC">===</span><span class="NAME">l</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">===</span><span class="NAME">c._array</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">c._array</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">l</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">n</span><span class="PUNC">=</span><span class="NAME">c.value.length</span><span class="PUNC">;</span><span class="NAME">l</span><span class="PUNC">&lt;</span><span class="NAME">n</span><span class="PUNC">;</span><span class="NAME">l</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">c._array</span><span class="PUNC">[</span><span class="NAME">l</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">H</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">k.uniform1iv</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">c._array</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">l</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">n</span><span class="PUNC">=</span><span class="NAME">c.value.length</span><span class="PUNC">;</span><span class="NAME">l</span><span class="PUNC">&lt;</span><span class="NAME">n</span><span class="PUNC">;</span><span class="NAME">l</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">s</span><span class="PUNC">=</span><span class="NAME">c.value</span><span class="PUNC">[</span><span class="NAME">l</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">j</span><span class="PUNC">=</span><span class="NAME">c._array</span><span class="PUNC">[</span><span class="NAME">l</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">s</span><span class="PUNC">&&</span><span class="NAME">D.setTexture</span><span class="PUNC">(</span><span class="NAME">s</span><span class="PUNC">,</span><span class="NAME">j</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="NAME">console.warn</span><span class="PUNC">(</span><span class="STRN">"THREE.WebGLRenderer: Unknown uniform type: "</span><span class="PUNC">+</span><span class="NAME">l</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">(</span><span class="NAME">d</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">THREE.ShaderMaterial</span><span class="PUNC">||</span><span class="NAME">d</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT">
<span class='line'>415</span> </span><span class="NAME">THREE.MeshPhongMaterial</span><span class="PUNC">||</span><span class="NAME">d.envMap</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="KEYW">null</span><span class="PUNC">!==</span><span class="NAME">h.cameraPosition</span><span class="PUNC">)</span><span class="NAME">Ga.getPositionFromMatrix</span><span class="PUNC">(</span><span class="NAME">a.matrixWorld</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">k.uniform3f</span><span class="PUNC">(</span><span class="NAME">h.cameraPosition</span><span class="PUNC">,</span><span class="NAME">Ga.x</span><span class="PUNC">,</span><span class="NAME">Ga.y</span><span class="PUNC">,</span><span class="NAME">Ga.z</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="PUNC">(</span><span class="NAME">d</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">THREE.MeshPhongMaterial</span><span class="PUNC">||</span><span class="NAME">d</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">THREE.MeshLambertMaterial</span><span class="PUNC">||</span><span class="NAME">d</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">THREE.ShaderMaterial</span><span class="PUNC">||</span><span class="NAME">d.skinning</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="KEYW">null</span><span class="PUNC">!==</span><span class="NAME">h.viewMatrix</span><span class="PUNC">&&</span><span class="NAME">k.uniformMatrix4fv</span><span class="PUNC">(</span><span class="NAME">h.viewMatrix</span><span class="PUNC">,</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">a.matrixWorldInverse.elements</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="NAME">k.uniformMatrix4fv</span><span class="PUNC">(</span><span class="NAME">h.modelViewMatrix</span><span class="PUNC">,</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">e._modelViewMatrix.elements</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">h.normalMatrix</span><span class="PUNC">&&</span><span class="NAME">k.uniformMatrix3fv</span><span class="PUNC">(</span><span class="NAME">h.normalMatrix</span><span class="PUNC">,</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">e._normalMatrix.elements</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>416</span> </span><span class="KEYW">null</span><span class="PUNC">!==</span><span class="NAME">h.modelMatrix</span><span class="PUNC">&&</span><span class="NAME">k.uniformMatrix4fv</span><span class="PUNC">(</span><span class="NAME">h.modelMatrix</span><span class="PUNC">,</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">e.matrixWorld.elements</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">g</span><span class="PUNC">}</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">H</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">fa</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">>=</span><span class="NAME">ib</span><span class="PUNC">&&</span><span class="NAME">console.warn</span><span class="PUNC">(</span><span class="STRN">"WebGLRenderer: trying to use "</span><span class="PUNC">+</span><span class="NAME">a</span><span class="PUNC">+</span><span class="STRN">" texture units while this GPU supports only "</span><span class="PUNC">+</span><span class="NAME">ib</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">fa</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">}</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">I</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">c.r</span><span class="PUNC">*</span><span class="NAME">c.r</span><span class="PUNC">*</span><span class="NAME">d</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">c.g</span><span class="PUNC">*</span><span class="NAME">c.g</span><span class="PUNC">*</span><span class="NAME">d</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">+</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">c.b</span><span class="PUNC">*</span><span class="NAME">c.b</span><span class="PUNC">*</span><span class="NAME">d</span><span class="PUNC">}</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">G</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">c.r</span><span class="PUNC">*</span><span class="NAME">d</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">c.g</span><span class="PUNC">*</span><span class="NAME">d</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">+</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">c.b</span><span class="PUNC">*</span><span class="NAME">d</span><span class="PUNC">}</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">A</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">a</span><span class="PUNC">!==</span><span class="NAME">ja</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">k.lineWidth</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">ja</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">K</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">la</span><span class="PUNC">!==</span><span class="NAME">a</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">?</span><span class="NAME">k.enable</span><span class="PUNC">(</span><span class="NAME">k.POLYGON_OFFSET_FILL</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">k.disable</span><span class="PUNC">(</span><span class="NAME">k.POLYGON_OFFSET_FILL</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">la</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>417</span> </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">ia</span><span class="PUNC">!==</span><span class="NAME">b</span><span class="PUNC">||</span><span class="NAME">ra</span><span class="PUNC">!==</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="NAME">k.polygonOffset</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">ia</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">ra</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">}</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">B</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">a.split</span><span class="PUNC">(</span><span class="STRN">"\n"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">a.length</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">&lt;</span><span class="NAME">c</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">+</span><span class="STRN">": "</span><span class="PUNC">+</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a.join</span><span class="PUNC">(</span><span class="STRN">"\n"</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">J</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">;</span><span class="STRN">"fragment"</span><span class="PUNC">===</span><span class="NAME">a</span><span class="PUNC">?</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">k.createShader</span><span class="PUNC">(</span><span class="NAME">k.FRAGMENT_SHADER</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="STRN">"vertex"</span><span class="PUNC">===</span><span class="NAME">a</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">k.createShader</span><span class="PUNC">(</span><span class="NAME">k.VERTEX_SHADER</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">k.shaderSource</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">k.compileShader</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="PUNC">!</span><span class="NAME">k.getShaderParameter</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">k.COMPILE_STATUS</span><span class="PUNC">)</span><span class="PUNC">?</span><span class="PUNC">(</span><span class="NAME">console.error</span><span class="PUNC">(</span><span class="NAME">k.getShaderInfoLog</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">console.error</span><span class="PUNC">(</span><span class="NAME">B</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="KEYW">null</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">c</span><span class="PUNC">}</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">N</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">c</span><span class="PUNC">?</span><span class="PUNC">(</span><span class="NAME">k.texParameteri</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">k.TEXTURE_WRAP_S</span><span class="PUNC">,</span><span class="NAME">w</span><span class="PUNC">(</span><span class="NAME">b.wrapS</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">k.texParameteri</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>418</span> </span><span class="NAME">k.TEXTURE_WRAP_T</span><span class="PUNC">,</span><span class="NAME">w</span><span class="PUNC">(</span><span class="NAME">b.wrapT</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">k.texParameteri</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">k.TEXTURE_MAG_FILTER</span><span class="PUNC">,</span><span class="NAME">w</span><span class="PUNC">(</span><span class="NAME">b.magFilter</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">k.texParameteri</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">k.TEXTURE_MIN_FILTER</span><span class="PUNC">,</span><span class="NAME">w</span><span class="PUNC">(</span><span class="NAME">b.minFilter</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="PUNC">(</span><span class="NAME">k.texParameteri</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">k.TEXTURE_WRAP_S</span><span class="PUNC">,</span><span class="NAME">k.CLAMP_TO_EDGE</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">k.texParameteri</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">k.TEXTURE_WRAP_T</span><span class="PUNC">,</span><span class="NAME">k.CLAMP_TO_EDGE</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">k.texParameteri</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">k.TEXTURE_MAG_FILTER</span><span class="PUNC">,</span><span class="NAME">M</span><span class="PUNC">(</span><span class="NAME">b.magFilter</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">k.texParameteri</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">k.TEXTURE_MIN_FILTER</span><span class="PUNC">,</span><span class="NAME">M</span><span class="PUNC">(</span><span class="NAME">b.minFilter</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">fb</span><span class="PUNC">&&</span><span class="NAME">b.type</span><span class="PUNC">!==</span><span class="NAME">THREE.FloatType</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NUMB">1</span><span class="PUNC">&lt;</span><span class="NAME">b.anisotropy</span><span class="PUNC">||</span><span class="NAME">b.__oldAnisotropy</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="NAME">k.texParameterf</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">fb.TEXTURE_MAX_ANISOTROPY_EXT</span><span class="PUNC">,</span><span class="NAME">Math.min</span><span class="PUNC">(</span><span class="NAME">b.anisotropy</span><span class="PUNC">,</span><span class="NAME">Wa</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">b.__oldAnisotropy</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>419</span> </span><span class="NAME">b.anisotropy</span><span class="PUNC">}</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">y</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">k.bindRenderbuffer</span><span class="PUNC">(</span><span class="NAME">k.RENDERBUFFER</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b.depthBuffer</span><span class="PUNC">&&</span><span class="PUNC">!</span><span class="NAME">b.stencilBuffer</span><span class="PUNC">?</span><span class="PUNC">(</span><span class="NAME">k.renderbufferStorage</span><span class="PUNC">(</span><span class="NAME">k.RENDERBUFFER</span><span class="PUNC">,</span><span class="NAME">k.DEPTH_COMPONENT16</span><span class="PUNC">,</span><span class="NAME">b.width</span><span class="PUNC">,</span><span class="NAME">b.height</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">k.framebufferRenderbuffer</span><span class="PUNC">(</span><span class="NAME">k.FRAMEBUFFER</span><span class="PUNC">,</span><span class="NAME">k.DEPTH_ATTACHMENT</span><span class="PUNC">,</span><span class="NAME">k.RENDERBUFFER</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">b.depthBuffer</span><span class="PUNC">&&</span><span class="NAME">b.stencilBuffer</span><span class="PUNC">?</span><span class="PUNC">(</span><span class="NAME">k.renderbufferStorage</span><span class="PUNC">(</span><span class="NAME">k.RENDERBUFFER</span><span class="PUNC">,</span><span class="NAME">k.DEPTH_STENCIL</span><span class="PUNC">,</span><span class="NAME">b.width</span><span class="PUNC">,</span><span class="NAME">b.height</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">k.framebufferRenderbuffer</span><span class="PUNC">(</span><span class="NAME">k.FRAMEBUFFER</span><span class="PUNC">,</span><span class="NAME">k.DEPTH_STENCIL_ATTACHMENT</span><span class="PUNC">,</span><span class="NAME">k.RENDERBUFFER</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">k.renderbufferStorage</span><span class="PUNC">(</span><span class="NAME">k.RENDERBUFFER</span><span class="PUNC">,</span><span class="NAME">k.RGBA4</span><span class="PUNC">,</span><span class="NAME">b.width</span><span class="PUNC">,</span><span class="NAME">b.height</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>420</span> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">M</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">===</span><span class="NAME">THREE.NearestFilter</span><span class="PUNC">||</span><span class="NAME">a</span><span class="PUNC">===</span><span class="NAME">THREE.NearestMipMapNearestFilter</span><span class="PUNC">||</span><span class="NAME">a</span><span class="PUNC">===</span><span class="NAME">THREE.NearestMipMapLinearFilter</span><span class="PUNC">?</span><span class="NAME">k.NEAREST</span><span class="PUNC">:</span><span class="NAME">k.LINEAR</span><span class="PUNC">}</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">w</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">===</span><span class="NAME">THREE.RepeatWrapping</span><span class="PUNC">)</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">k.REPEAT</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">===</span><span class="NAME">THREE.ClampToEdgeWrapping</span><span class="PUNC">)</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">k.CLAMP_TO_EDGE</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">===</span><span class="NAME">THREE.MirroredRepeatWrapping</span><span class="PUNC">)</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">k.MIRRORED_REPEAT</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">===</span><span class="NAME">THREE.NearestFilter</span><span class="PUNC">)</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">k.NEAREST</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">===</span><span class="NAME">THREE.NearestMipMapNearestFilter</span><span class="PUNC">)</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">k.NEAREST_MIPMAP_NEAREST</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">===</span><span class="NAME">THREE.NearestMipMapLinearFilter</span><span class="PUNC">)</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">k.NEAREST_MIPMAP_LINEAR</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">===</span><span class="WHIT">
<span class='line'>421</span> </span><span class="NAME">THREE.LinearFilter</span><span class="PUNC">)</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">k.LINEAR</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">===</span><span class="NAME">THREE.LinearMipMapNearestFilter</span><span class="PUNC">)</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">k.LINEAR_MIPMAP_NEAREST</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">===</span><span class="NAME">THREE.LinearMipMapLinearFilter</span><span class="PUNC">)</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">k.LINEAR_MIPMAP_LINEAR</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">===</span><span class="NAME">THREE.UnsignedByteType</span><span class="PUNC">)</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">k.UNSIGNED_BYTE</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">===</span><span class="NAME">THREE.UnsignedShort4444Type</span><span class="PUNC">)</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">k.UNSIGNED_SHORT_4_4_4_4</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">===</span><span class="NAME">THREE.UnsignedShort5551Type</span><span class="PUNC">)</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">k.UNSIGNED_SHORT_5_5_5_1</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">===</span><span class="NAME">THREE.UnsignedShort565Type</span><span class="PUNC">)</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">k.UNSIGNED_SHORT_5_6_5</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">===</span><span class="NAME">THREE.ByteType</span><span class="PUNC">)</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">k.BYTE</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">===</span><span class="NAME">THREE.ShortType</span><span class="PUNC">)</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">k.SHORT</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">===</span><span class="WHIT">
<span class='line'>422</span> </span><span class="NAME">THREE.UnsignedShortType</span><span class="PUNC">)</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">k.UNSIGNED_SHORT</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">===</span><span class="NAME">THREE.IntType</span><span class="PUNC">)</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">k.INT</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">===</span><span class="NAME">THREE.UnsignedIntType</span><span class="PUNC">)</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">k.UNSIGNED_INT</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">===</span><span class="NAME">THREE.FloatType</span><span class="PUNC">)</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">k.FLOAT</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">===</span><span class="NAME">THREE.AlphaFormat</span><span class="PUNC">)</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">k.ALPHA</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">===</span><span class="NAME">THREE.RGBFormat</span><span class="PUNC">)</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">k.RGB</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">===</span><span class="NAME">THREE.RGBAFormat</span><span class="PUNC">)</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">k.RGBA</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">===</span><span class="NAME">THREE.LuminanceFormat</span><span class="PUNC">)</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">k.LUMINANCE</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">===</span><span class="NAME">THREE.LuminanceAlphaFormat</span><span class="PUNC">)</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">k.LUMINANCE_ALPHA</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">===</span><span class="NAME">THREE.AddEquation</span><span class="PUNC">)</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">k.FUNC_ADD</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">===</span><span class="NAME">THREE.SubtractEquation</span><span class="PUNC">)</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">k.FUNC_SUBTRACT</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">===</span><span class="NAME">THREE.ReverseSubtractEquation</span><span class="PUNC">)</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">k.FUNC_REVERSE_SUBTRACT</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>423</span> </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">===</span><span class="NAME">THREE.ZeroFactor</span><span class="PUNC">)</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">k.ZERO</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">===</span><span class="NAME">THREE.OneFactor</span><span class="PUNC">)</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">k.ONE</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">===</span><span class="NAME">THREE.SrcColorFactor</span><span class="PUNC">)</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">k.SRC_COLOR</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">===</span><span class="NAME">THREE.OneMinusSrcColorFactor</span><span class="PUNC">)</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">k.ONE_MINUS_SRC_COLOR</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">===</span><span class="NAME">THREE.SrcAlphaFactor</span><span class="PUNC">)</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">k.SRC_ALPHA</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">===</span><span class="NAME">THREE.OneMinusSrcAlphaFactor</span><span class="PUNC">)</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">k.ONE_MINUS_SRC_ALPHA</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">===</span><span class="NAME">THREE.DstAlphaFactor</span><span class="PUNC">)</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">k.DST_ALPHA</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">===</span><span class="NAME">THREE.OneMinusDstAlphaFactor</span><span class="PUNC">)</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">k.ONE_MINUS_DST_ALPHA</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">===</span><span class="NAME">THREE.DstColorFactor</span><span class="PUNC">)</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">k.DST_COLOR</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">===</span><span class="NAME">THREE.OneMinusDstColorFactor</span><span class="PUNC">)</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">k.ONE_MINUS_DST_COLOR</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>424</span> </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">===</span><span class="NAME">THREE.SrcAlphaSaturateFactor</span><span class="PUNC">)</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">k.SRC_ALPHA_SATURATE</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">oa</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">===</span><span class="NAME">THREE.RGB_S3TC_DXT1_Format</span><span class="PUNC">)</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">oa.COMPRESSED_RGB_S3TC_DXT1_EXT</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">===</span><span class="NAME">THREE.RGBA_S3TC_DXT1_Format</span><span class="PUNC">)</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">oa.COMPRESSED_RGBA_S3TC_DXT1_EXT</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">===</span><span class="NAME">THREE.RGBA_S3TC_DXT3_Format</span><span class="PUNC">)</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">oa.COMPRESSED_RGBA_S3TC_DXT3_EXT</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">===</span><span class="NAME">THREE.RGBA_S3TC_DXT5_Format</span><span class="PUNC">)</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">oa.COMPRESSED_RGBA_S3TC_DXT5_EXT</span><span class="PUNC">}</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">}</span><span class="NAME">console.log</span><span class="PUNC">(</span><span class="STRN">"THREE.WebGLRenderer"</span><span class="PUNC">,</span><span class="NAME">THREE.REVISION</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">||</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">Z</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">a.canvas</span><span class="PUNC">?</span><span class="NAME">a.canvas</span><span class="PUNC">:</span><span class="NAME">document.createElement</span><span class="PUNC">(</span><span class="STRN">"canvas"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>425</span> </span><span class="NAME">L</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">a.precision</span><span class="PUNC">?</span><span class="NAME">a.precision</span><span class="PUNC">:</span><span class="STRN">"highp"</span><span class="PUNC">,</span><span class="NAME">pa</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">a.alpha</span><span class="PUNC">?</span><span class="NAME">a.alpha</span><span class="PUNC">:</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">Pa</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">a.premultipliedAlpha</span><span class="PUNC">?</span><span class="NAME">a.premultipliedAlpha</span><span class="PUNC">:</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">Ua</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">a.antialias</span><span class="PUNC">?</span><span class="NAME">a.antialias</span><span class="PUNC">:</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">O</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">a.stencil</span><span class="PUNC">?</span><span class="NAME">a.stencil</span><span class="PUNC">:</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">ka</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">a.preserveDrawingBuffer</span><span class="PUNC">?</span><span class="NAME">a.preserveDrawingBuffer</span><span class="PUNC">:</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">Fa</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Color</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">wa</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">a.clearColor</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">console.warn</span><span class="PUNC">(</span><span class="STRN">"DEPRECATED: clearColor in WebGLRenderer constructor parameters is being removed. Use .setClearColor() instead."</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">Fa.setHex</span><span class="PUNC">(</span><span class="NAME">a.clearColor</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">a.clearAlpha</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">console.warn</span><span class="PUNC">(</span><span class="STRN">"DEPRECATED: clearAlpha in WebGLRenderer constructor parameters is being removed. Use .setClearColor() instead."</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>426</span> </span><span class="NAME">wa</span><span class="PUNC">=</span><span class="NAME">a.clearAlpha</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.domElement</span><span class="PUNC">=</span><span class="NAME">Z</span><span class="PUNC">;</span><span class="NAME">this.context</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">;</span><span class="NAME">this.devicePixelRatio</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">a.devicePixelRatio</span><span class="PUNC">?</span><span class="NAME">a.devicePixelRatio</span><span class="PUNC">:</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">window.devicePixelRatio</span><span class="PUNC">?</span><span class="NAME">window.devicePixelRatio</span><span class="PUNC">:</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">this.autoUpdateObjects</span><span class="PUNC">=</span><span class="NAME">this.sortObjects</span><span class="PUNC">=</span><span class="NAME">this.autoClearStencil</span><span class="PUNC">=</span><span class="NAME">this.autoClearDepth</span><span class="PUNC">=</span><span class="NAME">this.autoClearColor</span><span class="PUNC">=</span><span class="NAME">this.autoClear</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">this.shadowMapEnabled</span><span class="PUNC">=</span><span class="NAME">this.physicallyBasedShading</span><span class="PUNC">=</span><span class="NAME">this.gammaOutput</span><span class="PUNC">=</span><span class="NAME">this.gammaInput</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">this.shadowMapAutoUpdate</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">this.shadowMapType</span><span class="PUNC">=</span><span class="NAME">THREE.PCFShadowMap</span><span class="PUNC">;</span><span class="NAME">this.shadowMapCullFace</span><span class="PUNC">=</span><span class="NAME">THREE.CullFaceFront</span><span class="PUNC">;</span><span class="NAME">this.shadowMapCascade</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>427</span> </span><span class="NAME">this.shadowMapDebug</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">this.maxMorphTargets</span><span class="PUNC">=</span><span class="NUMB">8</span><span class="PUNC">;</span><span class="NAME">this.maxMorphNormals</span><span class="PUNC">=</span><span class="NUMB">4</span><span class="PUNC">;</span><span class="NAME">this.autoScaleCubemaps</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">this.renderPluginsPre</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">this.renderPluginsPost</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">this.info</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="NAME">memory</span><span class="PUNC">:</span><span class="PUNC">{</span><span class="NAME">programs</span><span class="PUNC">:</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">geometries</span><span class="PUNC">:</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">textures</span><span class="PUNC">:</span><span class="NUMB">0</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">render</span><span class="PUNC">:</span><span class="PUNC">{</span><span class="NAME">calls</span><span class="PUNC">:</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">vertices</span><span class="PUNC">:</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">faces</span><span class="PUNC">:</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">points</span><span class="PUNC">:</span><span class="NUMB">0</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">D</span><span class="PUNC">=</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">V</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">ea</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">qa</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">eb</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">pb</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">ub</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">ya</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">Ha</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">fa</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">da</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">T</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">aa</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">na</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">ha</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">X</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">xa</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">ab</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">la</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">ia</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">ra</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">ja</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">ua</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">Ra</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">Qa</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">Xa</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">Xb</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">Jb</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">Ab</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">Sa</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Frustum</span><span class="PUNC">,</span><span class="NAME">xb</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Matrix4</span><span class="PUNC">,</span><span class="NAME">lb</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Matrix4</span><span class="PUNC">,</span><span class="NAME">Ga</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>428</span> </span><span class="NAME">Ca</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">,</span><span class="NAME">yb</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">Ib</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="NAME">ambient</span><span class="PUNC">:</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">directional</span><span class="PUNC">:</span><span class="PUNC">{</span><span class="NAME">length</span><span class="PUNC">:</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">colors</span><span class="PUNC">:</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">positions</span><span class="PUNC">:</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">point</span><span class="PUNC">:</span><span class="PUNC">{</span><span class="NAME">length</span><span class="PUNC">:</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">colors</span><span class="PUNC">:</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">positions</span><span class="PUNC">:</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">distances</span><span class="PUNC">:</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">spot</span><span class="PUNC">:</span><span class="PUNC">{</span><span class="NAME">length</span><span class="PUNC">:</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">colors</span><span class="PUNC">:</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">positions</span><span class="PUNC">:</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">distances</span><span class="PUNC">:</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">directions</span><span class="PUNC">:</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">anglesCos</span><span class="PUNC">:</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">exponents</span><span class="PUNC">:</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">hemi</span><span class="PUNC">:</span><span class="PUNC">{</span><span class="NAME">length</span><span class="PUNC">:</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">skyColors</span><span class="PUNC">:</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">groundColors</span><span class="PUNC">:</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">positions</span><span class="PUNC">:</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">k</span><span class="PUNC">,</span><span class="NAME">Rb</span><span class="PUNC">,</span><span class="NAME">Yb</span><span class="PUNC">,</span><span class="NAME">fb</span><span class="PUNC">,</span><span class="NAME">oa</span><span class="PUNC">;</span><span class="KEYW">try</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="PUNC">(</span><span class="NAME">k</span><span class="PUNC">=</span><span class="NAME">Z.getContext</span><span class="PUNC">(</span><span class="STRN">"experimental-webgl"</span><span class="PUNC">,</span><span class="PUNC">{</span><span class="NAME">alpha</span><span class="PUNC">:</span><span class="NAME">pa</span><span class="PUNC">,</span><span class="NAME">premultipliedAlpha</span><span class="PUNC">:</span><span class="NAME">Pa</span><span class="PUNC">,</span><span class="NAME">antialias</span><span class="PUNC">:</span><span class="NAME">Ua</span><span class="PUNC">,</span><span class="NAME">stencil</span><span class="PUNC">:</span><span class="NAME">O</span><span class="PUNC">,</span><span class="NAME">preserveDrawingBuffer</span><span class="PUNC">:</span><span class="NAME">ka</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="KEYW">throw</span><span class="STRN">"Error creating WebGL context."</span><span class="PUNC">;</span><span class="PUNC">}</span><span class="KEYW">catch</span><span class="PUNC">(</span><span class="NAME">va</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">console.error</span><span class="PUNC">(</span><span class="NAME">va</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="NAME">Rb</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>429</span> </span><span class="NAME">k.getExtension</span><span class="PUNC">(</span><span class="STRN">"OES_texture_float"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">k.getExtension</span><span class="PUNC">(</span><span class="STRN">"OES_texture_float_linear"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">Yb</span><span class="PUNC">=</span><span class="NAME">k.getExtension</span><span class="PUNC">(</span><span class="STRN">"OES_standard_derivatives"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">fb</span><span class="PUNC">=</span><span class="NAME">k.getExtension</span><span class="PUNC">(</span><span class="STRN">"EXT_texture_filter_anisotropic"</span><span class="PUNC">)</span><span class="PUNC">||</span><span class="NAME">k.getExtension</span><span class="PUNC">(</span><span class="STRN">"MOZ_EXT_texture_filter_anisotropic"</span><span class="PUNC">)</span><span class="PUNC">||</span><span class="NAME">k.getExtension</span><span class="PUNC">(</span><span class="STRN">"WEBKIT_EXT_texture_filter_anisotropic"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">oa</span><span class="PUNC">=</span><span class="NAME">k.getExtension</span><span class="PUNC">(</span><span class="STRN">"WEBGL_compressed_texture_s3tc"</span><span class="PUNC">)</span><span class="PUNC">||</span><span class="NAME">k.getExtension</span><span class="PUNC">(</span><span class="STRN">"MOZ_WEBGL_compressed_texture_s3tc"</span><span class="PUNC">)</span><span class="PUNC">||</span><span class="NAME">k.getExtension</span><span class="PUNC">(</span><span class="STRN">"WEBKIT_WEBGL_compressed_texture_s3tc"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">Rb</span><span class="PUNC">||</span><span class="NAME">console.log</span><span class="PUNC">(</span><span class="STRN">"THREE.WebGLRenderer: Float textures not supported."</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>430</span> </span><span class="NAME">Yb</span><span class="PUNC">||</span><span class="NAME">console.log</span><span class="PUNC">(</span><span class="STRN">"THREE.WebGLRenderer: Standard derivatives not supported."</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">fb</span><span class="PUNC">||</span><span class="NAME">console.log</span><span class="PUNC">(</span><span class="STRN">"THREE.WebGLRenderer: Anisotropic texture filtering not supported."</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">oa</span><span class="PUNC">||</span><span class="NAME">console.log</span><span class="PUNC">(</span><span class="STRN">"THREE.WebGLRenderer: S3TC compressed textures not supported."</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">===</span><span class="NAME">k.getShaderPrecisionFormat</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">k.getShaderPrecisionFormat</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="PUNC">{</span><span class="NAME">rangeMin</span><span class="PUNC">:</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">rangeMax</span><span class="PUNC">:</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">precision</span><span class="PUNC">:</span><span class="NUMB">1</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">k.clearColor</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">k.clearDepth</span><span class="PUNC">(</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">k.clearStencil</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">k.enable</span><span class="PUNC">(</span><span class="NAME">k.DEPTH_TEST</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">k.depthFunc</span><span class="PUNC">(</span><span class="NAME">k.LEQUAL</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">k.frontFace</span><span class="PUNC">(</span><span class="NAME">k.CCW</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">k.cullFace</span><span class="PUNC">(</span><span class="NAME">k.BACK</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">k.enable</span><span class="PUNC">(</span><span class="NAME">k.CULL_FACE</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>431</span> </span><span class="NAME">k.enable</span><span class="PUNC">(</span><span class="NAME">k.BLEND</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">k.blendEquation</span><span class="PUNC">(</span><span class="NAME">k.FUNC_ADD</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">k.blendFunc</span><span class="PUNC">(</span><span class="NAME">k.SRC_ALPHA</span><span class="PUNC">,</span><span class="NAME">k.ONE_MINUS_SRC_ALPHA</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">k.clearColor</span><span class="PUNC">(</span><span class="NAME">Fa.r</span><span class="PUNC">,</span><span class="NAME">Fa.g</span><span class="PUNC">,</span><span class="NAME">Fa.b</span><span class="PUNC">,</span><span class="NAME">wa</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.context</span><span class="PUNC">=</span><span class="NAME">k</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">ib</span><span class="PUNC">=</span><span class="NAME">k.getParameter</span><span class="PUNC">(</span><span class="NAME">k.MAX_TEXTURE_IMAGE_UNITS</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">Tb</span><span class="PUNC">=</span><span class="NAME">k.getParameter</span><span class="PUNC">(</span><span class="NAME">k.MAX_VERTEX_TEXTURE_IMAGE_UNITS</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">k.getParameter</span><span class="PUNC">(</span><span class="NAME">k.MAX_TEXTURE_SIZE</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">Ub</span><span class="PUNC">=</span><span class="NAME">k.getParameter</span><span class="PUNC">(</span><span class="NAME">k.MAX_CUBE_MAP_TEXTURE_SIZE</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">Wa</span><span class="PUNC">=</span><span class="NAME">fb</span><span class="PUNC">?</span><span class="NAME">k.getParameter</span><span class="PUNC">(</span><span class="NAME">fb.MAX_TEXTURE_MAX_ANISOTROPY_EXT</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">Gb</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">&lt;</span><span class="NAME">Tb</span><span class="PUNC">,</span><span class="NAME">Bb</span><span class="PUNC">=</span><span class="NAME">Gb</span><span class="PUNC">&&</span><span class="NAME">Rb</span><span class="PUNC">;</span><span class="NAME">oa</span><span class="PUNC">&&</span><span class="NAME">k.getParameter</span><span class="PUNC">(</span><span class="NAME">k.COMPRESSED_TEXTURE_FORMATS</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">Kb</span><span class="PUNC">=</span><span class="NAME">k.getShaderPrecisionFormat</span><span class="PUNC">(</span><span class="NAME">k.VERTEX_SHADER</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>432</span> </span><span class="NAME">k.HIGH_FLOAT</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">Ka</span><span class="PUNC">=</span><span class="NAME">k.getShaderPrecisionFormat</span><span class="PUNC">(</span><span class="NAME">k.VERTEX_SHADER</span><span class="PUNC">,</span><span class="NAME">k.MEDIUM_FLOAT</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">k.getShaderPrecisionFormat</span><span class="PUNC">(</span><span class="NAME">k.VERTEX_SHADER</span><span class="PUNC">,</span><span class="NAME">k.LOW_FLOAT</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">Sb</span><span class="PUNC">=</span><span class="NAME">k.getShaderPrecisionFormat</span><span class="PUNC">(</span><span class="NAME">k.FRAGMENT_SHADER</span><span class="PUNC">,</span><span class="NAME">k.HIGH_FLOAT</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">Lb</span><span class="PUNC">=</span><span class="NAME">k.getShaderPrecisionFormat</span><span class="PUNC">(</span><span class="NAME">k.FRAGMENT_SHADER</span><span class="PUNC">,</span><span class="NAME">k.MEDIUM_FLOAT</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">k.getShaderPrecisionFormat</span><span class="PUNC">(</span><span class="NAME">k.FRAGMENT_SHADER</span><span class="PUNC">,</span><span class="NAME">k.LOW_FLOAT</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">k.getShaderPrecisionFormat</span><span class="PUNC">(</span><span class="NAME">k.VERTEX_SHADER</span><span class="PUNC">,</span><span class="NAME">k.HIGH_INT</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">k.getShaderPrecisionFormat</span><span class="PUNC">(</span><span class="NAME">k.VERTEX_SHADER</span><span class="PUNC">,</span><span class="NAME">k.MEDIUM_INT</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">k.getShaderPrecisionFormat</span><span class="PUNC">(</span><span class="NAME">k.VERTEX_SHADER</span><span class="PUNC">,</span><span class="NAME">k.LOW_INT</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">k.getShaderPrecisionFormat</span><span class="PUNC">(</span><span class="NAME">k.FRAGMENT_SHADER</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>433</span> </span><span class="NAME">k.HIGH_INT</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">k.getShaderPrecisionFormat</span><span class="PUNC">(</span><span class="NAME">k.FRAGMENT_SHADER</span><span class="PUNC">,</span><span class="NAME">k.MEDIUM_INT</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">k.getShaderPrecisionFormat</span><span class="PUNC">(</span><span class="NAME">k.FRAGMENT_SHADER</span><span class="PUNC">,</span><span class="NAME">k.LOW_INT</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">Hb</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">&lt;</span><span class="NAME">Kb.precision</span><span class="PUNC">&&</span><span class="NUMB">0</span><span class="PUNC">&lt;</span><span class="NAME">Sb.precision</span><span class="PUNC">,</span><span class="NAME">kc</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">&lt;</span><span class="NAME">Ka.precision</span><span class="PUNC">&&</span><span class="NUMB">0</span><span class="PUNC">&lt;</span><span class="NAME">Lb.precision</span><span class="PUNC">;</span><span class="STRN">"highp"</span><span class="PUNC">===</span><span class="NAME">L</span><span class="PUNC">&&</span><span class="PUNC">!</span><span class="NAME">Hb</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">kc</span><span class="PUNC">?</span><span class="PUNC">(</span><span class="NAME">L</span><span class="PUNC">=</span><span class="STRN">"mediump"</span><span class="PUNC">,</span><span class="NAME">console.warn</span><span class="PUNC">(</span><span class="STRN">"WebGLRenderer: highp not supported, using mediump"</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="PUNC">(</span><span class="NAME">L</span><span class="PUNC">=</span><span class="STRN">"lowp"</span><span class="PUNC">,</span><span class="NAME">console.warn</span><span class="PUNC">(</span><span class="STRN">"WebGLRenderer: highp and mediump not supported, using lowp"</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="STRN">"mediump"</span><span class="PUNC">===</span><span class="NAME">L</span><span class="PUNC">&&</span><span class="PUNC">!</span><span class="NAME">kc</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">L</span><span class="PUNC">=</span><span class="STRN">"lowp"</span><span class="PUNC">,</span><span class="NAME">console.warn</span><span class="PUNC">(</span><span class="STRN">"WebGLRenderer: mediump not supported, using lowp"</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.getContext</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">k</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>434</span> </span><span class="NAME">this.supportsVertexTextures</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">Gb</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">this.supportsFloatTextures</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">Rb</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">this.supportsStandardDerivatives</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">Yb</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">this.supportsCompressedTextureS3TC</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">oa</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">this.getMaxAnisotropy</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">Wa</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">this.getPrecision</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">L</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">this.setSize</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">Z.width</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">*</span><span class="NAME">this.devicePixelRatio</span><span class="PUNC">;</span><span class="NAME">Z.height</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">*</span><span class="NAME">this.devicePixelRatio</span><span class="PUNC">;</span><span class="NUMB">1</span><span class="PUNC">!==</span><span class="NAME">this.devicePixelRatio</span><span class="PUNC">&&</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">!==</span><span class="NAME">c</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">Z.style.width</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">+</span><span class="STRN">"px"</span><span class="PUNC">,</span><span class="NAME">Z.style.height</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">+</span><span class="STRN">"px"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.setViewport</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">Z.width</span><span class="PUNC">,</span><span class="NAME">Z.height</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>435</span> </span><span class="NAME">this.setViewport</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">ua</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">a</span><span class="PUNC">?</span><span class="NAME">a</span><span class="PUNC">:</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">Ra</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">b</span><span class="PUNC">?</span><span class="NAME">b</span><span class="PUNC">:</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">Qa</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">c</span><span class="PUNC">?</span><span class="NAME">c</span><span class="PUNC">:</span><span class="NAME">Z.width</span><span class="PUNC">;</span><span class="NAME">Xa</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">d</span><span class="PUNC">?</span><span class="NAME">d</span><span class="PUNC">:</span><span class="NAME">Z.height</span><span class="PUNC">;</span><span class="NAME">k.viewport</span><span class="PUNC">(</span><span class="NAME">ua</span><span class="PUNC">,</span><span class="NAME">Ra</span><span class="PUNC">,</span><span class="NAME">Qa</span><span class="PUNC">,</span><span class="NAME">Xa</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">this.setScissor</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">k.scissor</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">this.enableScissorTest</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">a</span><span class="PUNC">?</span><span class="NAME">k.enable</span><span class="PUNC">(</span><span class="NAME">k.SCISSOR_TEST</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">k.disable</span><span class="PUNC">(</span><span class="NAME">k.SCISSOR_TEST</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">this.setClearColor</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">Fa.set</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">wa</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">b</span><span class="PUNC">?</span><span class="NAME">b</span><span class="PUNC">:</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">k.clearColor</span><span class="PUNC">(</span><span class="NAME">Fa.r</span><span class="PUNC">,</span><span class="NAME">Fa.g</span><span class="PUNC">,</span><span class="NAME">Fa.b</span><span class="PUNC">,</span><span class="NAME">wa</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">this.setClearColorHex</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">console.warn</span><span class="PUNC">(</span><span class="STRN">"DEPRECATED: .setClearColorHex() is being removed. Use .setClearColor() instead."</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>436</span> </span><span class="NAME">this.setClearColor</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">this.getClearColor</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">Fa</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">this.getClearAlpha</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">wa</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">this.clear</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">===</span><span class="NAME">a</span><span class="PUNC">||</span><span class="NAME">a</span><span class="PUNC">)</span><span class="NAME">d</span><span class="PUNC">|</span><span class="PUNC">=</span><span class="NAME">k.COLOR_BUFFER_BIT</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">===</span><span class="NAME">b</span><span class="PUNC">||</span><span class="NAME">b</span><span class="PUNC">)</span><span class="NAME">d</span><span class="PUNC">|</span><span class="PUNC">=</span><span class="NAME">k.DEPTH_BUFFER_BIT</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">===</span><span class="NAME">c</span><span class="PUNC">||</span><span class="NAME">c</span><span class="PUNC">)</span><span class="NAME">d</span><span class="PUNC">|</span><span class="PUNC">=</span><span class="NAME">k.STENCIL_BUFFER_BIT</span><span class="PUNC">;</span><span class="NAME">k.clear</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">this.clearTarget</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.setRenderTarget</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.clear</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">this.addPostPlugin</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">a.init</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.renderPluginsPost.push</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">this.addPrePlugin</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">a.init</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.renderPluginsPre.push</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>437</span> </span><span class="NAME">this.updateShadowMap</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">qa</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">;</span><span class="NAME">pb</span><span class="PUNC">=</span><span class="NAME">ub</span><span class="PUNC">=</span><span class="NAME">ab</span><span class="PUNC">=</span><span class="NAME">xa</span><span class="PUNC">=</span><span class="NAME">aa</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">yb</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">T</span><span class="PUNC">=</span><span class="NAME">da</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">this.shadowMapPlugin.update</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">lc</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">a.target</span><span class="PUNC">;</span><span class="NAME">a.removeEventListener</span><span class="PUNC">(</span><span class="STRN">"dispose"</span><span class="PUNC">,</span><span class="NAME">lc</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a.__webglInit</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">a.__webglVertexBuffer</span><span class="PUNC">&&</span><span class="NAME">k.deleteBuffer</span><span class="PUNC">(</span><span class="NAME">a.__webglVertexBuffer</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">a.__webglNormalBuffer</span><span class="PUNC">&&</span><span class="NAME">k.deleteBuffer</span><span class="PUNC">(</span><span class="NAME">a.__webglNormalBuffer</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">a.__webglTangentBuffer</span><span class="PUNC">&&</span><span class="NAME">k.deleteBuffer</span><span class="PUNC">(</span><span class="NAME">a.__webglTangentBuffer</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">a.__webglColorBuffer</span><span class="PUNC">&&</span><span class="NAME">k.deleteBuffer</span><span class="PUNC">(</span><span class="NAME">a.__webglColorBuffer</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">a.__webglUVBuffer</span><span class="PUNC">&&</span><span class="WHIT">
<span class='line'>438</span> </span><span class="NAME">k.deleteBuffer</span><span class="PUNC">(</span><span class="NAME">a.__webglUVBuffer</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">a.__webglUV2Buffer</span><span class="PUNC">&&</span><span class="NAME">k.deleteBuffer</span><span class="PUNC">(</span><span class="NAME">a.__webglUV2Buffer</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">a.__webglSkinIndicesBuffer</span><span class="PUNC">&&</span><span class="NAME">k.deleteBuffer</span><span class="PUNC">(</span><span class="NAME">a.__webglSkinIndicesBuffer</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">a.__webglSkinWeightsBuffer</span><span class="PUNC">&&</span><span class="NAME">k.deleteBuffer</span><span class="PUNC">(</span><span class="NAME">a.__webglSkinWeightsBuffer</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">a.__webglFaceBuffer</span><span class="PUNC">&&</span><span class="NAME">k.deleteBuffer</span><span class="PUNC">(</span><span class="NAME">a.__webglFaceBuffer</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">a.__webglLineBuffer</span><span class="PUNC">&&</span><span class="NAME">k.deleteBuffer</span><span class="PUNC">(</span><span class="NAME">a.__webglLineBuffer</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">a.__webglLineDistanceBuffer</span><span class="PUNC">&&</span><span class="NAME">k.deleteBuffer</span><span class="PUNC">(</span><span class="NAME">a.__webglLineDistanceBuffer</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">a.geometryGroups</span><span class="PUNC">)</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="WHIT"> </span><span class="KEYW">in</span><span class="WHIT"> </span><span class="NAME">a.geometryGroups</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>439</span> </span><span class="NAME">a.geometryGroups</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">d.numMorphTargets</span><span class="PUNC">)</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">e</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">d.numMorphTargets</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">&lt;</span><span class="NAME">f</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">k.deleteBuffer</span><span class="PUNC">(</span><span class="NAME">d.__webglMorphTargetsBuffers</span><span class="PUNC">[</span><span class="NAME">e</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">d.numMorphNormals</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">d.numMorphNormals</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">&lt;</span><span class="NAME">f</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">k.deleteBuffer</span><span class="PUNC">(</span><span class="NAME">d.__webglMorphNormalsBuffers</span><span class="PUNC">[</span><span class="NAME">e</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="NAME">b</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="NAME">b</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">D.info.memory.geometries</span><span class="PUNC">--</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">gc</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">a.target</span><span class="PUNC">;</span><span class="NAME">a.removeEventListener</span><span class="PUNC">(</span><span class="STRN">"dispose"</span><span class="PUNC">,</span><span class="NAME">gc</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a.image</span><span class="PUNC">&&</span><span class="NAME">a.image.__webglTextureCube</span><span class="PUNC">?</span><span class="NAME">k.deleteTexture</span><span class="PUNC">(</span><span class="NAME">a.image.__webglTextureCube</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">a.__webglInit</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">a.__webglInit</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">k.deleteTexture</span><span class="PUNC">(</span><span class="NAME">a.__webglTexture</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>440</span> </span><span class="NAME">D.info.memory.textures</span><span class="PUNC">--</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">mc</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">a.target</span><span class="PUNC">;</span><span class="NAME">a.removeEventListener</span><span class="PUNC">(</span><span class="STRN">"dispose"</span><span class="PUNC">,</span><span class="NAME">mc</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">&&</span><span class="NAME">a.__webglTexture</span><span class="PUNC">)</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">k.deleteTexture</span><span class="PUNC">(</span><span class="NAME">a.__webglTexture</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">a</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">THREE.WebGLRenderTargetCube</span><span class="PUNC">)</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NUMB">6</span><span class="PUNC">></span><span class="NAME">b</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">k.deleteFramebuffer</span><span class="PUNC">(</span><span class="NAME">a.__webglFramebuffer</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">k.deleteRenderbuffer</span><span class="PUNC">(</span><span class="NAME">a.__webglRenderbuffer</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="NAME">k.deleteFramebuffer</span><span class="PUNC">(</span><span class="NAME">a.__webglFramebuffer</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">k.deleteRenderbuffer</span><span class="PUNC">(</span><span class="NAME">a.__webglRenderbuffer</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">D.info.memory.textures</span><span class="PUNC">--</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">uc</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">a.target</span><span class="PUNC">;</span><span class="NAME">a.removeEventListener</span><span class="PUNC">(</span><span class="STRN">"dispose"</span><span class="PUNC">,</span><span class="NAME">uc</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">vc</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">vc</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>441</span> </span><span class="NAME">a.program</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">a.program</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">V.length</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">&lt;</span><span class="NAME">c</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">V</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">d.program</span><span class="PUNC">===</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">d.usedTimes</span><span class="PUNC">--</span><span class="PUNC">;</span><span class="NUMB">0</span><span class="PUNC">===</span><span class="NAME">d.usedTimes</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">break</span><span class="PUNC">}</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">===</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">e</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">V.length</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">&lt;</span><span class="NAME">c</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">V</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">d.program</span><span class="PUNC">!==</span><span class="NAME">b</span><span class="PUNC">&&</span><span class="NAME">e.push</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">V</span><span class="PUNC">=</span><span class="NAME">e</span><span class="PUNC">;</span><span class="NAME">k.deleteProgram</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">D.info.memory.programs</span><span class="PUNC">--</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">this.renderBufferImmediate</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">a.hasPositions</span><span class="PUNC">&&</span><span class="PUNC">!</span><span class="NAME">a.__webglVertexBuffer</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">a.__webglVertexBuffer</span><span class="PUNC">=</span><span class="NAME">k.createBuffer</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a.hasNormals</span><span class="PUNC">&&</span><span class="PUNC">!</span><span class="NAME">a.__webglNormalBuffer</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">a.__webglNormalBuffer</span><span class="PUNC">=</span><span class="NAME">k.createBuffer</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a.hasUvs</span><span class="PUNC">&&</span><span class="PUNC">!</span><span class="NAME">a.__webglUvBuffer</span><span class="PUNC">&&</span><span class="WHIT">
<span class='line'>442</span> </span><span class="PUNC">(</span><span class="NAME">a.__webglUvBuffer</span><span class="PUNC">=</span><span class="NAME">k.createBuffer</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a.hasColors</span><span class="PUNC">&&</span><span class="PUNC">!</span><span class="NAME">a.__webglColorBuffer</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">a.__webglColorBuffer</span><span class="PUNC">=</span><span class="NAME">k.createBuffer</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a.hasPositions</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">k.bindBuffer</span><span class="PUNC">(</span><span class="NAME">k.ARRAY_BUFFER</span><span class="PUNC">,</span><span class="NAME">a.__webglVertexBuffer</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">k.bufferData</span><span class="PUNC">(</span><span class="NAME">k.ARRAY_BUFFER</span><span class="PUNC">,</span><span class="NAME">a.positionArray</span><span class="PUNC">,</span><span class="NAME">k.DYNAMIC_DRAW</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">k.enableVertexAttribArray</span><span class="PUNC">(</span><span class="NAME">b.attributes.position</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">k.vertexAttribPointer</span><span class="PUNC">(</span><span class="NAME">b.attributes.position</span><span class="PUNC">,</span><span class="NUMB">3</span><span class="PUNC">,</span><span class="NAME">k.FLOAT</span><span class="PUNC">,</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">a.hasNormals</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">k.bindBuffer</span><span class="PUNC">(</span><span class="NAME">k.ARRAY_BUFFER</span><span class="PUNC">,</span><span class="NAME">a.__webglNormalBuffer</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">c.shading</span><span class="PUNC">===</span><span class="NAME">THREE.FlatShading</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">,</span><span class="NAME">j</span><span class="PUNC">,</span><span class="NAME">l</span><span class="PUNC">,</span><span class="NAME">m</span><span class="PUNC">,</span><span class="NAME">n</span><span class="PUNC">,</span><span class="NAME">p</span><span class="PUNC">,</span><span class="NAME">q</span><span class="PUNC">=</span><span class="NUMB">3</span><span class="PUNC">*</span><span class="NAME">a.count</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">p</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">p</span><span class="PUNC">&lt;</span><span class="WHIT">
<span class='line'>443</span> </span><span class="NAME">q</span><span class="PUNC">;</span><span class="NAME">p</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NUMB">9</span><span class="PUNC">)</span><span class="NAME">n</span><span class="PUNC">=</span><span class="NAME">a.normalArray</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">n</span><span class="PUNC">[</span><span class="NAME">p</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">n</span><span class="PUNC">[</span><span class="NAME">p</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">n</span><span class="PUNC">[</span><span class="NAME">p</span><span class="PUNC">+</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">n</span><span class="PUNC">[</span><span class="NAME">p</span><span class="PUNC">+</span><span class="NUMB">3</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">=</span><span class="NAME">n</span><span class="PUNC">[</span><span class="NAME">p</span><span class="PUNC">+</span><span class="NUMB">4</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">l</span><span class="PUNC">=</span><span class="NAME">n</span><span class="PUNC">[</span><span class="NAME">p</span><span class="PUNC">+</span><span class="NUMB">5</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">n</span><span class="PUNC">[</span><span class="NAME">p</span><span class="PUNC">+</span><span class="NUMB">6</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">j</span><span class="PUNC">=</span><span class="NAME">n</span><span class="PUNC">[</span><span class="NAME">p</span><span class="PUNC">+</span><span class="NUMB">7</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">m</span><span class="PUNC">=</span><span class="NAME">n</span><span class="PUNC">[</span><span class="NAME">p</span><span class="PUNC">+</span><span class="NUMB">8</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">+</span><span class="NAME">g</span><span class="PUNC">+</span><span class="NAME">h</span><span class="PUNC">)</span><span class="PUNC">/</span><span class="NUMB">3</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">+</span><span class="NAME">i</span><span class="PUNC">+</span><span class="NAME">j</span><span class="PUNC">)</span><span class="PUNC">/</span><span class="NUMB">3</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">=</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">+</span><span class="NAME">l</span><span class="PUNC">+</span><span class="NAME">m</span><span class="PUNC">)</span><span class="PUNC">/</span><span class="NUMB">3</span><span class="PUNC">,</span><span class="NAME">n</span><span class="PUNC">[</span><span class="NAME">p</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">n</span><span class="PUNC">[</span><span class="NAME">p</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">n</span><span class="PUNC">[</span><span class="NAME">p</span><span class="PUNC">+</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">n</span><span class="PUNC">[</span><span class="NAME">p</span><span class="PUNC">+</span><span class="NUMB">3</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">n</span><span class="PUNC">[</span><span class="NAME">p</span><span class="PUNC">+</span><span class="NUMB">4</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">n</span><span class="PUNC">[</span><span class="NAME">p</span><span class="PUNC">+</span><span class="NUMB">5</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">n</span><span class="PUNC">[</span><span class="NAME">p</span><span class="PUNC">+</span><span class="NUMB">6</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">n</span><span class="PUNC">[</span><span class="NAME">p</span><span class="PUNC">+</span><span class="NUMB">7</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">n</span><span class="PUNC">[</span><span class="NAME">p</span><span class="PUNC">+</span><span class="NUMB">8</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">f</span><span class="PUNC">}</span><span class="NAME">k.bufferData</span><span class="PUNC">(</span><span class="NAME">k.ARRAY_BUFFER</span><span class="PUNC">,</span><span class="NAME">a.normalArray</span><span class="PUNC">,</span><span class="NAME">k.DYNAMIC_DRAW</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">k.enableVertexAttribArray</span><span class="PUNC">(</span><span class="NAME">b.attributes.normal</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">k.vertexAttribPointer</span><span class="PUNC">(</span><span class="NAME">b.attributes.normal</span><span class="PUNC">,</span><span class="NUMB">3</span><span class="PUNC">,</span><span class="NAME">k.FLOAT</span><span class="PUNC">,</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="NAME">a.hasUvs</span><span class="PUNC">&&</span><span class="NAME">c.map</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">k.bindBuffer</span><span class="PUNC">(</span><span class="NAME">k.ARRAY_BUFFER</span><span class="PUNC">,</span><span class="NAME">a.__webglUvBuffer</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">k.bufferData</span><span class="PUNC">(</span><span class="NAME">k.ARRAY_BUFFER</span><span class="PUNC">,</span><span class="NAME">a.uvArray</span><span class="PUNC">,</span><span class="NAME">k.DYNAMIC_DRAW</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>444</span> </span><span class="NAME">k.enableVertexAttribArray</span><span class="PUNC">(</span><span class="NAME">b.attributes.uv</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">k.vertexAttribPointer</span><span class="PUNC">(</span><span class="NAME">b.attributes.uv</span><span class="PUNC">,</span><span class="NUMB">2</span><span class="PUNC">,</span><span class="NAME">k.FLOAT</span><span class="PUNC">,</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a.hasColors</span><span class="PUNC">&&</span><span class="NAME">c.vertexColors</span><span class="PUNC">!==</span><span class="NAME">THREE.NoColors</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">k.bindBuffer</span><span class="PUNC">(</span><span class="NAME">k.ARRAY_BUFFER</span><span class="PUNC">,</span><span class="NAME">a.__webglColorBuffer</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">k.bufferData</span><span class="PUNC">(</span><span class="NAME">k.ARRAY_BUFFER</span><span class="PUNC">,</span><span class="NAME">a.colorArray</span><span class="PUNC">,</span><span class="NAME">k.DYNAMIC_DRAW</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">k.enableVertexAttribArray</span><span class="PUNC">(</span><span class="NAME">b.attributes.color</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">k.vertexAttribPointer</span><span class="PUNC">(</span><span class="NAME">b.attributes.color</span><span class="PUNC">,</span><span class="NUMB">3</span><span class="PUNC">,</span><span class="NAME">k.FLOAT</span><span class="PUNC">,</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">k.drawArrays</span><span class="PUNC">(</span><span class="NAME">k.TRIANGLES</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">a.count</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a.count</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">this.renderBufferDirect</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">!==</span><span class="NAME">d.visible</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">h</span><span class="PUNC">,</span><span class="NAME">j</span><span class="PUNC">,</span><span class="NAME">l</span><span class="PUNC">,</span><span class="NAME">m</span><span class="PUNC">;</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">F</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>445</span> </span><span class="NAME">h.attributes</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">e.attributes</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NUMB">16777215</span><span class="PUNC">*</span><span class="NAME">e.id</span><span class="PUNC">+</span><span class="NUMB">2</span><span class="PUNC">*</span><span class="NAME">h.id</span><span class="PUNC">+</span><span class="PUNC">(</span><span class="NAME">d.wireframe</span><span class="PUNC">?</span><span class="NUMB">1</span><span class="PUNC">:</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">h</span><span class="PUNC">!==</span><span class="NAME">ub</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">ub</span><span class="PUNC">=</span><span class="NAME">h</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">&&</span><span class="NAME">i</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">f</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">THREE.Mesh</span><span class="PUNC">)</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">a.index</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">e.offsets</span><span class="PUNC">;</span><span class="NUMB">1</span><span class="PUNC">&lt;</span><span class="NAME">e.length</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">f</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">n</span><span class="PUNC">=</span><span class="NAME">e.length</span><span class="PUNC">;</span><span class="NAME">f</span><span class="PUNC">&lt;</span><span class="NAME">n</span><span class="PUNC">;</span><span class="NAME">f</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">p</span><span class="PUNC">=</span><span class="NAME">e</span><span class="PUNC">[</span><span class="NAME">f</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">index</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">j</span><span class="WHIT"> </span><span class="KEYW">in</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">)</span><span class="STRN">"index"</span><span class="PUNC">!==</span><span class="NAME">j</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">l</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NAME">j</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NAME">j</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">m</span><span class="PUNC">=</span><span class="NAME">h.itemSize</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">&lt;=</span><span class="NAME">l</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">k.bindBuffer</span><span class="PUNC">(</span><span class="NAME">k.ARRAY_BUFFER</span><span class="PUNC">,</span><span class="NAME">h.buffer</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">(</span><span class="NAME">l</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">k.vertexAttribPointer</span><span class="PUNC">(</span><span class="NAME">l</span><span class="PUNC">,</span><span class="NAME">m</span><span class="PUNC">,</span><span class="NAME">k.FLOAT</span><span class="PUNC">,</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">4</span><span class="PUNC">*</span><span class="NAME">p</span><span class="PUNC">*</span><span class="NAME">m</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">k.bindBuffer</span><span class="PUNC">(</span><span class="NAME">k.ELEMENT_ARRAY_BUFFER</span><span class="PUNC">,</span><span class="NAME">d.buffer</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="NAME">k.drawElements</span><span class="PUNC">(</span><span class="NAME">k.TRIANGLES</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">[</span><span class="NAME">f</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">count</span><span class="PUNC">,</span><span class="NAME">k.UNSIGNED_SHORT</span><span class="PUNC">,</span><span class="NUMB">2</span><span class="PUNC">*</span><span class="NAME">e</span><span class="PUNC">[</span><span class="NAME">f</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">start</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">D.info.render.calls</span><span class="PUNC">++</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>446</span> </span><span class="NAME">D.info.render.vertices</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">e</span><span class="PUNC">[</span><span class="NAME">f</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">count</span><span class="PUNC">;</span><span class="NAME">D.info.render.faces</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">e</span><span class="PUNC">[</span><span class="NAME">f</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">count</span><span class="PUNC">/</span><span class="NUMB">3</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">)</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">j</span><span class="WHIT"> </span><span class="KEYW">in</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">)</span><span class="STRN">"index"</span><span class="PUNC">!==</span><span class="NAME">j</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">l</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NAME">j</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NAME">j</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">m</span><span class="PUNC">=</span><span class="NAME">h.itemSize</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">&lt;=</span><span class="NAME">l</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">k.bindBuffer</span><span class="PUNC">(</span><span class="NAME">k.ARRAY_BUFFER</span><span class="PUNC">,</span><span class="NAME">h.buffer</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">(</span><span class="NAME">l</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">k.vertexAttribPointer</span><span class="PUNC">(</span><span class="NAME">l</span><span class="PUNC">,</span><span class="NAME">m</span><span class="PUNC">,</span><span class="NAME">k.FLOAT</span><span class="PUNC">,</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">e.attributes.position</span><span class="PUNC">;</span><span class="NAME">k.drawArrays</span><span class="PUNC">(</span><span class="NAME">k.TRIANGLES</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">a.numItems</span><span class="PUNC">/</span><span class="NUMB">3</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">D.info.render.calls</span><span class="PUNC">++</span><span class="PUNC">;</span><span class="NAME">D.info.render.vertices</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">a.numItems</span><span class="PUNC">/</span><span class="NUMB">3</span><span class="PUNC">;</span><span class="NAME">D.info.render.faces</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">a.numItems</span><span class="PUNC">/</span><span class="NUMB">3</span><span class="PUNC">/</span><span class="NUMB">3</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">f</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">THREE.ParticleSystem</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">j</span><span class="WHIT"> </span><span class="KEYW">in</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">)</span><span class="NAME">l</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NAME">j</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NAME">j</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">m</span><span class="PUNC">=</span><span class="NAME">h.itemSize</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">&lt;=</span><span class="NAME">l</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">k.bindBuffer</span><span class="PUNC">(</span><span class="NAME">k.ARRAY_BUFFER</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>447</span> </span><span class="NAME">h.buffer</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">(</span><span class="NAME">l</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">k.vertexAttribPointer</span><span class="PUNC">(</span><span class="NAME">l</span><span class="PUNC">,</span><span class="NAME">m</span><span class="PUNC">,</span><span class="NAME">k.FLOAT</span><span class="PUNC">,</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">a.position</span><span class="PUNC">;</span><span class="NAME">k.drawArrays</span><span class="PUNC">(</span><span class="NAME">k.POINTS</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">a.numItems</span><span class="PUNC">/</span><span class="NUMB">3</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">D.info.render.calls</span><span class="PUNC">++</span><span class="PUNC">;</span><span class="NAME">D.info.render.points</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">a.numItems</span><span class="PUNC">/</span><span class="NUMB">3</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">f</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">THREE.Line</span><span class="PUNC">&&</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">j</span><span class="WHIT"> </span><span class="KEYW">in</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">)</span><span class="NAME">l</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NAME">j</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NAME">j</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">m</span><span class="PUNC">=</span><span class="NAME">h.itemSize</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">&lt;=</span><span class="NAME">l</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">k.bindBuffer</span><span class="PUNC">(</span><span class="NAME">k.ARRAY_BUFFER</span><span class="PUNC">,</span><span class="NAME">h.buffer</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">(</span><span class="NAME">l</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">k.vertexAttribPointer</span><span class="PUNC">(</span><span class="NAME">l</span><span class="PUNC">,</span><span class="NAME">m</span><span class="PUNC">,</span><span class="NAME">k.FLOAT</span><span class="PUNC">,</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">j</span><span class="PUNC">=</span><span class="NAME">f.type</span><span class="PUNC">===</span><span class="NAME">THREE.LineStrip</span><span class="PUNC">?</span><span class="NAME">k.LINE_STRIP</span><span class="PUNC">:</span><span class="NAME">k.LINES</span><span class="PUNC">;</span><span class="NAME">A</span><span class="PUNC">(</span><span class="NAME">d.linewidth</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">a.position</span><span class="PUNC">;</span><span class="NAME">k.drawArrays</span><span class="PUNC">(</span><span class="NAME">j</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">a.numItems</span><span class="PUNC">/</span><span class="NUMB">3</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">D.info.render.calls</span><span class="PUNC">++</span><span class="PUNC">;</span><span class="NAME">D.info.render.points</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">a.numItems</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">this.renderBuffer</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>448</span> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">!==</span><span class="NAME">d.visible</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">h</span><span class="PUNC">,</span><span class="NAME">j</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">F</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">c.attributes</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NUMB">16777215</span><span class="PUNC">*</span><span class="NAME">e.id</span><span class="PUNC">+</span><span class="NUMB">2</span><span class="PUNC">*</span><span class="NAME">c.id</span><span class="PUNC">+</span><span class="PUNC">(</span><span class="NAME">d.wireframe</span><span class="PUNC">?</span><span class="NUMB">1</span><span class="PUNC">:</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">!==</span><span class="NAME">ub</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">ub</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">&&</span><span class="NAME">i</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">d.morphTargets</span><span class="PUNC">&&</span><span class="NUMB">0</span><span class="PUNC">&lt;=</span><span class="NAME">a.position</span><span class="PUNC">)</span><span class="NAME">b</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">k.bindBuffer</span><span class="PUNC">(</span><span class="NAME">k.ARRAY_BUFFER</span><span class="PUNC">,</span><span class="NAME">e.__webglVertexBuffer</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">(</span><span class="NAME">a.position</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">k.vertexAttribPointer</span><span class="PUNC">(</span><span class="NAME">a.position</span><span class="PUNC">,</span><span class="NUMB">3</span><span class="PUNC">,</span><span class="NAME">k.FLOAT</span><span class="PUNC">,</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">f.morphTargetBase</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">d.program.attributes</span><span class="PUNC">;</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">!==</span><span class="NAME">f.morphTargetBase</span><span class="PUNC">&&</span><span class="NUMB">0</span><span class="PUNC">&lt;=</span><span class="NAME">c.position</span><span class="PUNC">?</span><span class="PUNC">(</span><span class="NAME">k.bindBuffer</span><span class="PUNC">(</span><span class="NAME">k.ARRAY_BUFFER</span><span class="PUNC">,</span><span class="NAME">e.__webglMorphTargetsBuffers</span><span class="PUNC">[</span><span class="NAME">f.morphTargetBase</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">(</span><span class="NAME">c.position</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">k.vertexAttribPointer</span><span class="PUNC">(</span><span class="NAME">c.position</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>449</span> </span><span class="NUMB">3</span><span class="PUNC">,</span><span class="NAME">k.FLOAT</span><span class="PUNC">,</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NUMB">0</span><span class="PUNC">&lt;=</span><span class="NAME">c.position</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">k.bindBuffer</span><span class="PUNC">(</span><span class="NAME">k.ARRAY_BUFFER</span><span class="PUNC">,</span><span class="NAME">e.__webglVertexBuffer</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">(</span><span class="NAME">c.position</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">k.vertexAttribPointer</span><span class="PUNC">(</span><span class="NAME">c.position</span><span class="PUNC">,</span><span class="NUMB">3</span><span class="PUNC">,</span><span class="NAME">k.FLOAT</span><span class="PUNC">,</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">f.morphTargetForcedOrder.length</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">m</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">j</span><span class="PUNC">=</span><span class="NAME">f.morphTargetForcedOrder</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">f.morphTargetInfluences</span><span class="PUNC">;</span><span class="NAME">m</span><span class="PUNC">&lt;</span><span class="NAME">d.numSupportedMorphTargets</span><span class="PUNC">&&</span><span class="NAME">m</span><span class="PUNC">&lt;</span><span class="NAME">j.length</span><span class="PUNC">;</span><span class="PUNC">)</span><span class="NUMB">0</span><span class="PUNC">&lt;=</span><span class="NAME">c</span><span class="PUNC">[</span><span class="STRN">"morphTarget"</span><span class="PUNC">+</span><span class="NAME">m</span><span class="PUNC">]</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">k.bindBuffer</span><span class="PUNC">(</span><span class="NAME">k.ARRAY_BUFFER</span><span class="PUNC">,</span><span class="NAME">e.__webglMorphTargetsBuffers</span><span class="PUNC">[</span><span class="NAME">j</span><span class="PUNC">[</span><span class="NAME">m</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">[</span><span class="STRN">"morphTarget"</span><span class="PUNC">+</span><span class="NAME">m</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">k.vertexAttribPointer</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">[</span><span class="STRN">"morphTarget"</span><span class="PUNC">+</span><span class="NAME">m</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NUMB">3</span><span class="PUNC">,</span><span class="NAME">k.FLOAT</span><span class="PUNC">,</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">&lt;=</span><span class="NAME">c</span><span class="PUNC">[</span><span class="STRN">"morphNormal"</span><span class="PUNC">+</span><span class="NAME">m</span><span class="PUNC">]</span><span class="PUNC">&&</span><span class="NAME">d.morphNormals</span><span class="PUNC">&&</span><span class="WHIT">
<span class='line'>450</span> </span><span class="PUNC">(</span><span class="NAME">k.bindBuffer</span><span class="PUNC">(</span><span class="NAME">k.ARRAY_BUFFER</span><span class="PUNC">,</span><span class="NAME">e.__webglMorphNormalsBuffers</span><span class="PUNC">[</span><span class="NAME">j</span><span class="PUNC">[</span><span class="NAME">m</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">[</span><span class="STRN">"morphNormal"</span><span class="PUNC">+</span><span class="NAME">m</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">k.vertexAttribPointer</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">[</span><span class="STRN">"morphNormal"</span><span class="PUNC">+</span><span class="NAME">m</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NUMB">3</span><span class="PUNC">,</span><span class="NAME">k.FLOAT</span><span class="PUNC">,</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">f.__webglMorphTargetInfluences</span><span class="PUNC">[</span><span class="NAME">m</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">h</span><span class="PUNC">[</span><span class="NAME">j</span><span class="PUNC">[</span><span class="NAME">m</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">m</span><span class="PUNC">++</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="PUNC">{</span><span class="NAME">j</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">f.morphTargetInfluences</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">n</span><span class="PUNC">,</span><span class="NAME">p</span><span class="PUNC">=</span><span class="NAME">h.length</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">n</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">n</span><span class="PUNC">&lt;</span><span class="NAME">p</span><span class="PUNC">;</span><span class="NAME">n</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">m</span><span class="PUNC">=</span><span class="NAME">h</span><span class="PUNC">[</span><span class="NAME">n</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">&lt;</span><span class="NAME">m</span><span class="PUNC">&&</span><span class="NAME">j.push</span><span class="PUNC">(</span><span class="PUNC">[</span><span class="NAME">m</span><span class="PUNC">,</span><span class="NAME">n</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">j.length</span><span class="PUNC">></span><span class="NAME">d.numSupportedMorphTargets</span><span class="PUNC">?</span><span class="PUNC">(</span><span class="NAME">j.sort</span><span class="PUNC">(</span><span class="NAME">l</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">j.length</span><span class="PUNC">=</span><span class="NAME">d.numSupportedMorphTargets</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">j.length</span><span class="PUNC">></span><span class="NAME">d.numSupportedMorphNormals</span><span class="PUNC">?</span><span class="NAME">j.sort</span><span class="PUNC">(</span><span class="NAME">l</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NUMB">0</span><span class="PUNC">===</span><span class="NAME">j.length</span><span class="PUNC">&&</span><span class="NAME">j.push</span><span class="PUNC">(</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">m</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">m</span><span class="PUNC">&lt;</span><span class="NAME">d.numSupportedMorphTargets</span><span class="PUNC">;</span><span class="PUNC">)</span><span class="NAME">j</span><span class="PUNC">[</span><span class="NAME">m</span><span class="PUNC">]</span><span class="PUNC">?</span><span class="PUNC">(</span><span class="NAME">n</span><span class="PUNC">=</span><span class="NAME">j</span><span class="PUNC">[</span><span class="NAME">m</span><span class="PUNC">]</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">&lt;=</span><span class="WHIT">
<span class='line'>451</span> </span><span class="NAME">c</span><span class="PUNC">[</span><span class="STRN">"morphTarget"</span><span class="PUNC">+</span><span class="NAME">m</span><span class="PUNC">]</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">k.bindBuffer</span><span class="PUNC">(</span><span class="NAME">k.ARRAY_BUFFER</span><span class="PUNC">,</span><span class="NAME">e.__webglMorphTargetsBuffers</span><span class="PUNC">[</span><span class="NAME">n</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">[</span><span class="STRN">"morphTarget"</span><span class="PUNC">+</span><span class="NAME">m</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">k.vertexAttribPointer</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">[</span><span class="STRN">"morphTarget"</span><span class="PUNC">+</span><span class="NAME">m</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NUMB">3</span><span class="PUNC">,</span><span class="NAME">k.FLOAT</span><span class="PUNC">,</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">&lt;=</span><span class="NAME">c</span><span class="PUNC">[</span><span class="STRN">"morphNormal"</span><span class="PUNC">+</span><span class="NAME">m</span><span class="PUNC">]</span><span class="PUNC">&&</span><span class="NAME">d.morphNormals</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">k.bindBuffer</span><span class="PUNC">(</span><span class="NAME">k.ARRAY_BUFFER</span><span class="PUNC">,</span><span class="NAME">e.__webglMorphNormalsBuffers</span><span class="PUNC">[</span><span class="NAME">n</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">[</span><span class="STRN">"morphNormal"</span><span class="PUNC">+</span><span class="NAME">m</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">k.vertexAttribPointer</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">[</span><span class="STRN">"morphNormal"</span><span class="PUNC">+</span><span class="NAME">m</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NUMB">3</span><span class="PUNC">,</span><span class="NAME">k.FLOAT</span><span class="PUNC">,</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">f.__webglMorphTargetInfluences</span><span class="PUNC">[</span><span class="NAME">m</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">h</span><span class="PUNC">[</span><span class="NAME">n</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">f.__webglMorphTargetInfluences</span><span class="PUNC">[</span><span class="NAME">m</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">m</span><span class="PUNC">++</span><span class="PUNC">}</span><span class="KEYW">null</span><span class="PUNC">!==</span><span class="NAME">d.program.uniforms.morphTargetInfluences</span><span class="PUNC">&&</span><span class="NAME">k.uniform1fv</span><span class="PUNC">(</span><span class="NAME">d.program.uniforms.morphTargetInfluences</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>452</span> </span><span class="NAME">f.__webglMorphTargetInfluences</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">e.__webglCustomAttributesList</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">j</span><span class="PUNC">=</span><span class="NAME">e.__webglCustomAttributesList.length</span><span class="PUNC">;</span><span class="NAME">h</span><span class="PUNC">&lt;</span><span class="NAME">j</span><span class="PUNC">;</span><span class="NAME">h</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">e.__webglCustomAttributesList</span><span class="PUNC">[</span><span class="NAME">h</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">&lt;=</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NAME">c.buffer.belongsToAttribute</span><span class="PUNC">]</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">k.bindBuffer</span><span class="PUNC">(</span><span class="NAME">k.ARRAY_BUFFER</span><span class="PUNC">,</span><span class="NAME">c.buffer</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NAME">c.buffer.belongsToAttribute</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">k.vertexAttribPointer</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NAME">c.buffer.belongsToAttribute</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">c.size</span><span class="PUNC">,</span><span class="NAME">k.FLOAT</span><span class="PUNC">,</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="NUMB">0</span><span class="PUNC">&lt;=</span><span class="NAME">a.color</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">k.bindBuffer</span><span class="PUNC">(</span><span class="NAME">k.ARRAY_BUFFER</span><span class="PUNC">,</span><span class="NAME">e.__webglColorBuffer</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">(</span><span class="NAME">a.color</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">k.vertexAttribPointer</span><span class="PUNC">(</span><span class="NAME">a.color</span><span class="PUNC">,</span><span class="NUMB">3</span><span class="PUNC">,</span><span class="NAME">k.FLOAT</span><span class="PUNC">,</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NUMB">0</span><span class="PUNC">&lt;=</span><span class="NAME">a.normal</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">k.bindBuffer</span><span class="PUNC">(</span><span class="NAME">k.ARRAY_BUFFER</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>453</span> </span><span class="NAME">e.__webglNormalBuffer</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">(</span><span class="NAME">a.normal</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">k.vertexAttribPointer</span><span class="PUNC">(</span><span class="NAME">a.normal</span><span class="PUNC">,</span><span class="NUMB">3</span><span class="PUNC">,</span><span class="NAME">k.FLOAT</span><span class="PUNC">,</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NUMB">0</span><span class="PUNC">&lt;=</span><span class="NAME">a.tangent</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">k.bindBuffer</span><span class="PUNC">(</span><span class="NAME">k.ARRAY_BUFFER</span><span class="PUNC">,</span><span class="NAME">e.__webglTangentBuffer</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">(</span><span class="NAME">a.tangent</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">k.vertexAttribPointer</span><span class="PUNC">(</span><span class="NAME">a.tangent</span><span class="PUNC">,</span><span class="NUMB">4</span><span class="PUNC">,</span><span class="NAME">k.FLOAT</span><span class="PUNC">,</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NUMB">0</span><span class="PUNC">&lt;=</span><span class="NAME">a.uv</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">k.bindBuffer</span><span class="PUNC">(</span><span class="NAME">k.ARRAY_BUFFER</span><span class="PUNC">,</span><span class="NAME">e.__webglUVBuffer</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">(</span><span class="NAME">a.uv</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">k.vertexAttribPointer</span><span class="PUNC">(</span><span class="NAME">a.uv</span><span class="PUNC">,</span><span class="NUMB">2</span><span class="PUNC">,</span><span class="NAME">k.FLOAT</span><span class="PUNC">,</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NUMB">0</span><span class="PUNC">&lt;=</span><span class="NAME">a.uv2</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">k.bindBuffer</span><span class="PUNC">(</span><span class="NAME">k.ARRAY_BUFFER</span><span class="PUNC">,</span><span class="NAME">e.__webglUV2Buffer</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">(</span><span class="NAME">a.uv2</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">k.vertexAttribPointer</span><span class="PUNC">(</span><span class="NAME">a.uv2</span><span class="PUNC">,</span><span class="NUMB">2</span><span class="PUNC">,</span><span class="NAME">k.FLOAT</span><span class="PUNC">,</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">d.skinning</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">&lt;=</span><span class="NAME">a.skinIndex</span><span class="PUNC">&&</span><span class="NUMB">0</span><span class="PUNC">&lt;=</span><span class="NAME">a.skinWeight</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">k.bindBuffer</span><span class="PUNC">(</span><span class="NAME">k.ARRAY_BUFFER</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>454</span> </span><span class="NAME">e.__webglSkinIndicesBuffer</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">(</span><span class="NAME">a.skinIndex</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">k.vertexAttribPointer</span><span class="PUNC">(</span><span class="NAME">a.skinIndex</span><span class="PUNC">,</span><span class="NUMB">4</span><span class="PUNC">,</span><span class="NAME">k.FLOAT</span><span class="PUNC">,</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">k.bindBuffer</span><span class="PUNC">(</span><span class="NAME">k.ARRAY_BUFFER</span><span class="PUNC">,</span><span class="NAME">e.__webglSkinWeightsBuffer</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">(</span><span class="NAME">a.skinWeight</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">k.vertexAttribPointer</span><span class="PUNC">(</span><span class="NAME">a.skinWeight</span><span class="PUNC">,</span><span class="NUMB">4</span><span class="PUNC">,</span><span class="NAME">k.FLOAT</span><span class="PUNC">,</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NUMB">0</span><span class="PUNC">&lt;=</span><span class="NAME">a.lineDistance</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">k.bindBuffer</span><span class="PUNC">(</span><span class="NAME">k.ARRAY_BUFFER</span><span class="PUNC">,</span><span class="NAME">e.__webglLineDistanceBuffer</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">(</span><span class="NAME">a.lineDistance</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">k.vertexAttribPointer</span><span class="PUNC">(</span><span class="NAME">a.lineDistance</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">k.FLOAT</span><span class="PUNC">,</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="NAME">f</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">THREE.Mesh</span><span class="PUNC">?</span><span class="PUNC">(</span><span class="NAME">d.wireframe</span><span class="PUNC">?</span><span class="PUNC">(</span><span class="NAME">A</span><span class="PUNC">(</span><span class="NAME">d.wireframeLinewidth</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">&&</span><span class="NAME">k.bindBuffer</span><span class="PUNC">(</span><span class="NAME">k.ELEMENT_ARRAY_BUFFER</span><span class="PUNC">,</span><span class="NAME">e.__webglLineBuffer</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">k.drawElements</span><span class="PUNC">(</span><span class="NAME">k.LINES</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>455</span> </span><span class="NAME">e.__webglLineCount</span><span class="PUNC">,</span><span class="NAME">k.UNSIGNED_SHORT</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">&&</span><span class="NAME">k.bindBuffer</span><span class="PUNC">(</span><span class="NAME">k.ELEMENT_ARRAY_BUFFER</span><span class="PUNC">,</span><span class="NAME">e.__webglFaceBuffer</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">k.drawElements</span><span class="PUNC">(</span><span class="NAME">k.TRIANGLES</span><span class="PUNC">,</span><span class="NAME">e.__webglFaceCount</span><span class="PUNC">,</span><span class="NAME">k.UNSIGNED_SHORT</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">D.info.render.calls</span><span class="PUNC">++</span><span class="PUNC">,</span><span class="NAME">D.info.render.vertices</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">e.__webglFaceCount</span><span class="PUNC">,</span><span class="NAME">D.info.render.faces</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">e.__webglFaceCount</span><span class="PUNC">/</span><span class="NUMB">3</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">f</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">THREE.Line</span><span class="PUNC">?</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">f.type</span><span class="PUNC">===</span><span class="NAME">THREE.LineStrip</span><span class="PUNC">?</span><span class="NAME">k.LINE_STRIP</span><span class="PUNC">:</span><span class="NAME">k.LINES</span><span class="PUNC">,</span><span class="NAME">A</span><span class="PUNC">(</span><span class="NAME">d.linewidth</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">k.drawArrays</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">e.__webglLineCount</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">D.info.render.calls</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">f</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">THREE.ParticleSystem</span><span class="PUNC">?</span><span class="PUNC">(</span><span class="NAME">k.drawArrays</span><span class="PUNC">(</span><span class="NAME">k.POINTS</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">e.__webglParticleCount</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>456</span> </span><span class="NAME">D.info.render.calls</span><span class="PUNC">++</span><span class="PUNC">,</span><span class="NAME">D.info.render.points</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">e.__webglParticleCount</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">f</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">THREE.Ribbon</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">k.drawArrays</span><span class="PUNC">(</span><span class="NAME">k.TRIANGLE_STRIP</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">e.__webglVertexCount</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">D.info.render.calls</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">this.render</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">===</span><span class="NAME">b</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">THREE.Camera</span><span class="PUNC">)</span><span class="NAME">console.error</span><span class="PUNC">(</span><span class="STRN">"THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera."</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">else</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">=</span><span class="NAME">a.__lights</span><span class="PUNC">,</span><span class="NAME">l</span><span class="PUNC">=</span><span class="NAME">a.fog</span><span class="PUNC">;</span><span class="NAME">pb</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">yb</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">===</span><span class="NAME">a.autoUpdate</span><span class="PUNC">&&</span><span class="NAME">a.updateMatrixWorld</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">===</span><span class="NAME">b.parent</span><span class="PUNC">&&</span><span class="NAME">b.updateMatrixWorld</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b.matrixWorldInverse.getInverse</span><span class="PUNC">(</span><span class="NAME">b.matrixWorld</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>457</span> </span><span class="NAME">xb.multiplyMatrices</span><span class="PUNC">(</span><span class="NAME">b.projectionMatrix</span><span class="PUNC">,</span><span class="NAME">b.matrixWorldInverse</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">Sa.setFromMatrix</span><span class="PUNC">(</span><span class="NAME">xb</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.autoUpdateObjects</span><span class="PUNC">&&</span><span class="NAME">this.initWebGLObjects</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">m</span><span class="PUNC">(</span><span class="NAME">this.renderPluginsPre</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">D.info.render.calls</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">D.info.render.vertices</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">D.info.render.faces</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">D.info.render.points</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">this.setRenderTarget</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="PUNC">(</span><span class="NAME">this.autoClear</span><span class="PUNC">||</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="NAME">this.clear</span><span class="PUNC">(</span><span class="NAME">this.autoClearColor</span><span class="PUNC">,</span><span class="NAME">this.autoClearDepth</span><span class="PUNC">,</span><span class="NAME">this.autoClearStencil</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">a.__webglObjects</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">g.length</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">&lt;</span><span class="NAME">e</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">g</span><span class="PUNC">[</span><span class="NAME">d</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">f.object</span><span class="PUNC">,</span><span class="NAME">f.id</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">f.render</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">h.visible</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="PUNC">(</span><span class="NAME">h</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">THREE.Mesh</span><span class="PUNC">||</span><span class="NAME">h</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT">
<span class='line'>458</span> </span><span class="NAME">THREE.ParticleSystem</span><span class="PUNC">)</span><span class="PUNC">||</span><span class="PUNC">!</span><span class="NAME">h.frustumCulled</span><span class="PUNC">||</span><span class="NAME">Sa.intersectsObject</span><span class="PUNC">(</span><span class="NAME">h</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">q</span><span class="PUNC">=</span><span class="NAME">h</span><span class="PUNC">;</span><span class="NAME">q._modelViewMatrix.multiplyMatrices</span><span class="PUNC">(</span><span class="NAME">b.matrixWorldInverse</span><span class="PUNC">,</span><span class="NAME">q.matrixWorld</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">q._normalMatrix.getNormalMatrix</span><span class="PUNC">(</span><span class="NAME">q._modelViewMatrix</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">q</span><span class="PUNC">=</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">r</span><span class="PUNC">=</span><span class="NAME">q.buffer</span><span class="PUNC">,</span><span class="NAME">s</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">t</span><span class="PUNC">=</span><span class="NAME">s</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">t</span><span class="PUNC">=</span><span class="NAME">q.object.material</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">t</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">THREE.MeshFaceMaterial</span><span class="PUNC">)</span><span class="NAME">s</span><span class="PUNC">=</span><span class="NAME">r.materialIndex</span><span class="PUNC">,</span><span class="NAME">s</span><span class="PUNC">=</span><span class="NAME">t.materials</span><span class="PUNC">[</span><span class="NAME">s</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">s.transparent</span><span class="PUNC">?</span><span class="PUNC">(</span><span class="NAME">q.transparent</span><span class="PUNC">=</span><span class="NAME">s</span><span class="PUNC">,</span><span class="NAME">q.opaque</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="PUNC">(</span><span class="NAME">q.opaque</span><span class="PUNC">=</span><span class="NAME">s</span><span class="PUNC">,</span><span class="NAME">q.transparent</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">s</span><span class="PUNC">=</span><span class="NAME">t</span><span class="PUNC">)</span><span class="NAME">s.transparent</span><span class="PUNC">?</span><span class="PUNC">(</span><span class="NAME">q.transparent</span><span class="PUNC">=</span><span class="NAME">s</span><span class="PUNC">,</span><span class="NAME">q.opaque</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="PUNC">(</span><span class="NAME">q.opaque</span><span class="PUNC">=</span><span class="NAME">s</span><span class="PUNC">,</span><span class="NAME">q.transparent</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">f.render</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>459</span> </span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">===</span><span class="NAME">this.sortObjects</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="KEYW">null</span><span class="PUNC">!==</span><span class="NAME">h.renderDepth</span><span class="PUNC">?</span><span class="NAME">f.z</span><span class="PUNC">=</span><span class="NAME">h.renderDepth</span><span class="PUNC">:</span><span class="PUNC">(</span><span class="NAME">Ga.getPositionFromMatrix</span><span class="PUNC">(</span><span class="NAME">h.matrixWorld</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">Ga.applyProjection</span><span class="PUNC">(</span><span class="NAME">xb</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">f.z</span><span class="PUNC">=</span><span class="NAME">Ga.z</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="NAME">this.sortObjects</span><span class="PUNC">&&</span><span class="NAME">g.sort</span><span class="PUNC">(</span><span class="NAME">j</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">a.__webglObjectsImmediate</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">g.length</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">&lt;</span><span class="NAME">e</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">g</span><span class="PUNC">[</span><span class="NAME">d</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">f.object</span><span class="PUNC">,</span><span class="NAME">h.visible</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">h._modelViewMatrix.multiplyMatrices</span><span class="PUNC">(</span><span class="NAME">b.matrixWorldInverse</span><span class="PUNC">,</span><span class="NAME">h.matrixWorld</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">h._normalMatrix.getNormalMatrix</span><span class="PUNC">(</span><span class="NAME">h._modelViewMatrix</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">f.object.material</span><span class="PUNC">,</span><span class="NAME">h.transparent</span><span class="PUNC">?</span><span class="PUNC">(</span><span class="NAME">f.transparent</span><span class="PUNC">=</span><span class="NAME">h</span><span class="PUNC">,</span><span class="NAME">f.opaque</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="PUNC">(</span><span class="NAME">f.opaque</span><span class="PUNC">=</span><span class="NAME">h</span><span class="PUNC">,</span><span class="NAME">f.transparent</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a.overrideMaterial</span><span class="PUNC">?</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">a.overrideMaterial</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>460</span> </span><span class="NAME">this.setBlending</span><span class="PUNC">(</span><span class="NAME">d.blending</span><span class="PUNC">,</span><span class="NAME">d.blendEquation</span><span class="PUNC">,</span><span class="NAME">d.blendSrc</span><span class="PUNC">,</span><span class="NAME">d.blendDst</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this.setDepthTest</span><span class="PUNC">(</span><span class="NAME">d.depthTest</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this.setDepthWrite</span><span class="PUNC">(</span><span class="NAME">d.depthWrite</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">K</span><span class="PUNC">(</span><span class="NAME">d.polygonOffset</span><span class="PUNC">,</span><span class="NAME">d.polygonOffsetFactor</span><span class="PUNC">,</span><span class="NAME">d.polygonOffsetUnits</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">n</span><span class="PUNC">(</span><span class="NAME">a.__webglObjects</span><span class="PUNC">,</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="STRN">""</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">,</span><span class="NAME">l</span><span class="PUNC">,</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">p</span><span class="PUNC">(</span><span class="NAME">a.__webglObjectsImmediate</span><span class="PUNC">,</span><span class="STRN">""</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">,</span><span class="NAME">l</span><span class="PUNC">,</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">this.setBlending</span><span class="PUNC">(</span><span class="NAME">THREE.NoBlending</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">n</span><span class="PUNC">(</span><span class="NAME">a.__webglObjects</span><span class="PUNC">,</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="STRN">"opaque"</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">,</span><span class="NAME">l</span><span class="PUNC">,</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">p</span><span class="PUNC">(</span><span class="NAME">a.__webglObjectsImmediate</span><span class="PUNC">,</span><span class="STRN">"opaque"</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">,</span><span class="NAME">l</span><span class="PUNC">,</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">n</span><span class="PUNC">(</span><span class="NAME">a.__webglObjects</span><span class="PUNC">,</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="STRN">"transparent"</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">,</span><span class="NAME">l</span><span class="PUNC">,</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">p</span><span class="PUNC">(</span><span class="NAME">a.__webglObjectsImmediate</span><span class="PUNC">,</span><span class="STRN">"transparent"</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>461</span> </span><span class="NAME">i</span><span class="PUNC">,</span><span class="NAME">l</span><span class="PUNC">,</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">m</span><span class="PUNC">(</span><span class="NAME">this.renderPluginsPost</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">c.generateMipmaps</span><span class="PUNC">&&</span><span class="NAME">c.minFilter</span><span class="PUNC">!==</span><span class="NAME">THREE.NearestFilter</span><span class="PUNC">&&</span><span class="NAME">c.minFilter</span><span class="PUNC">!==</span><span class="NAME">THREE.LinearFilter</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">c</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">THREE.WebGLRenderTargetCube</span><span class="PUNC">?</span><span class="PUNC">(</span><span class="NAME">k.bindTexture</span><span class="PUNC">(</span><span class="NAME">k.TEXTURE_CUBE_MAP</span><span class="PUNC">,</span><span class="NAME">c.__webglTexture</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">k.generateMipmap</span><span class="PUNC">(</span><span class="NAME">k.TEXTURE_CUBE_MAP</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">k.bindTexture</span><span class="PUNC">(</span><span class="NAME">k.TEXTURE_CUBE_MAP</span><span class="PUNC">,</span><span class="KEYW">null</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="PUNC">(</span><span class="NAME">k.bindTexture</span><span class="PUNC">(</span><span class="NAME">k.TEXTURE_2D</span><span class="PUNC">,</span><span class="NAME">c.__webglTexture</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">k.generateMipmap</span><span class="PUNC">(</span><span class="NAME">k.TEXTURE_2D</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">k.bindTexture</span><span class="PUNC">(</span><span class="NAME">k.TEXTURE_2D</span><span class="PUNC">,</span><span class="KEYW">null</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.setDepthTest</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.setDepthWrite</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">this.renderImmediateObject</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>462</span> </span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">F</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">ub</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">D.setMaterialFaces</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">e.immediateRenderCallback</span><span class="PUNC">?</span><span class="NAME">e.immediateRenderCallback</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">k</span><span class="PUNC">,</span><span class="NAME">Sa</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">e.render</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">D.renderBufferImmediate</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">this.initWebGLObjects</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">a.__webglObjects</span><span class="PUNC">||</span><span class="PUNC">(</span><span class="NAME">a.__webglObjects</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">a.__webglObjectsImmediate</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">a.__webglSprites</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">a.__webglFlares</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="PUNC">;</span><span class="NAME">a.__objectsAdded.length</span><span class="PUNC">;</span><span class="PUNC">)</span><span class="NAME">t</span><span class="PUNC">(</span><span class="NAME">a.__objectsAdded</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">a.__objectsAdded.splice</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="PUNC">;</span><span class="NAME">a.__objectsRemoved.length</span><span class="PUNC">;</span><span class="PUNC">)</span><span class="NAME">v</span><span class="PUNC">(</span><span class="NAME">a.__objectsRemoved</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">a.__objectsRemoved.splice</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>463</span> </span><span class="NAME">a.__webglObjects.length</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">&lt;</span><span class="NAME">c</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">a.__webglObjects</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">object</span><span class="PUNC">;</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">===</span><span class="NAME">g.__webglInit</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">g.__webglActive</span><span class="PUNC">&&</span><span class="NAME">v</span><span class="PUNC">(</span><span class="NAME">g</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">t</span><span class="PUNC">(</span><span class="NAME">g</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">=</span><span class="NAME">g</span><span class="PUNC">,</span><span class="NAME">j</span><span class="PUNC">=</span><span class="NAME">i.geometry</span><span class="PUNC">,</span><span class="NAME">m</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">n</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">p</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">j</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">THREE.BufferGeometry</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">q</span><span class="PUNC">=</span><span class="NAME">k.DYNAMIC_DRAW</span><span class="PUNC">,</span><span class="NAME">z</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NAME">j.dynamic</span><span class="PUNC">,</span><span class="NAME">w</span><span class="PUNC">=</span><span class="NAME">j.attributes</span><span class="PUNC">,</span><span class="NAME">y</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">A</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">y</span><span class="WHIT"> </span><span class="KEYW">in</span><span class="WHIT"> </span><span class="NAME">w</span><span class="PUNC">)</span><span class="NAME">A</span><span class="PUNC">=</span><span class="NAME">w</span><span class="PUNC">[</span><span class="NAME">y</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">A.needsUpdate</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="STRN">"index"</span><span class="PUNC">===</span><span class="NAME">y</span><span class="PUNC">?</span><span class="PUNC">(</span><span class="NAME">k.bindBuffer</span><span class="PUNC">(</span><span class="NAME">k.ELEMENT_ARRAY_BUFFER</span><span class="PUNC">,</span><span class="NAME">A.buffer</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">k.bufferData</span><span class="PUNC">(</span><span class="NAME">k.ELEMENT_ARRAY_BUFFER</span><span class="PUNC">,</span><span class="NAME">A.array</span><span class="PUNC">,</span><span class="NAME">q</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="PUNC">(</span><span class="NAME">k.bindBuffer</span><span class="PUNC">(</span><span class="NAME">k.ARRAY_BUFFER</span><span class="PUNC">,</span><span class="NAME">A.buffer</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">k.bufferData</span><span class="PUNC">(</span><span class="NAME">k.ARRAY_BUFFER</span><span class="PUNC">,</span><span class="NAME">A.array</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>464</span> </span><span class="NAME">q</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">A.needsUpdate</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">z</span><span class="PUNC">&&</span><span class="PUNC">!</span><span class="NAME">A.dynamic</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">A.array</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">i</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">THREE.Mesh</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">B</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">F</span><span class="PUNC">=</span><span class="NAME">j.geometryGroupsList.length</span><span class="PUNC">;</span><span class="NAME">B</span><span class="PUNC">&lt;</span><span class="NAME">F</span><span class="PUNC">;</span><span class="NAME">B</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">m</span><span class="PUNC">=</span><span class="NAME">j.geometryGroupsList</span><span class="PUNC">[</span><span class="NAME">B</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">p</span><span class="PUNC">=</span><span class="NAME">e</span><span class="PUNC">(</span><span class="NAME">i</span><span class="PUNC">,</span><span class="NAME">m</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">j.buffersNeedUpdate</span><span class="PUNC">&&</span><span class="NAME">d</span><span class="PUNC">(</span><span class="NAME">m</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">n</span><span class="PUNC">=</span><span class="NAME">p.attributes</span><span class="PUNC">&&</span><span class="NAME">r</span><span class="PUNC">(</span><span class="NAME">p</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">j.verticesNeedUpdate</span><span class="PUNC">||</span><span class="NAME">j.morphTargetsNeedUpdate</span><span class="PUNC">||</span><span class="NAME">j.elementsNeedUpdate</span><span class="PUNC">||</span><span class="NAME">j.uvsNeedUpdate</span><span class="PUNC">||</span><span class="NAME">j.normalsNeedUpdate</span><span class="PUNC">||</span><span class="NAME">j.colorsNeedUpdate</span><span class="PUNC">||</span><span class="NAME">j.tangentsNeedUpdate</span><span class="PUNC">||</span><span class="NAME">n</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">C</span><span class="PUNC">=</span><span class="NAME">m</span><span class="PUNC">,</span><span class="NAME">G</span><span class="PUNC">=</span><span class="NAME">i</span><span class="PUNC">,</span><span class="NAME">H</span><span class="PUNC">=</span><span class="NAME">k.DYNAMIC_DRAW</span><span class="PUNC">,</span><span class="NAME">I</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NAME">j.dynamic</span><span class="PUNC">,</span><span class="NAME">J</span><span class="PUNC">=</span><span class="NAME">p</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">C.__inittedArrays</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">V</span><span class="PUNC">=</span><span class="NAME">f</span><span class="PUNC">(</span><span class="NAME">J</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">K</span><span class="PUNC">=</span><span class="NAME">J.vertexColors</span><span class="PUNC">?</span><span class="NAME">J.vertexColors</span><span class="PUNC">:</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">L</span><span class="PUNC">=</span><span class="NAME">h</span><span class="PUNC">(</span><span class="NAME">J</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">M</span><span class="PUNC">=</span><span class="NAME">V</span><span class="PUNC">===</span><span class="WHIT">
<span class='line'>465</span> </span><span class="NAME">THREE.SmoothShading</span><span class="PUNC">,</span><span class="NAME">E</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">D</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">N</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">Q</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">O</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">ea</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">T</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">X</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">qa</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">fa</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">aa</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">R</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">S</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">P</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">ba</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">Z</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">da</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">ya</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">ja</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">ha</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">Ha</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">ia</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">eb</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">ka</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">na</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">la</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">ua</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">oa</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">pa</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">ra</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">Ca</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">va</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">wa</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">xa</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">pb</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">za</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">ub</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">Fa</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">Pa</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">Ra</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">bb</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">ab</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">Za</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">$a</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">Ua</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">Qa</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">Ta</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">Ya</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">Wa</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">Xa</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">Ka</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">jb</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">Da</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>466</span> </span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">ob</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">Va</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">Y</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">ga</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">x</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">Aa</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">cb</span><span class="PUNC">=</span><span class="NAME">C.__vertexArray</span><span class="PUNC">,</span><span class="NAME">fb</span><span class="PUNC">=</span><span class="NAME">C.__uvArray</span><span class="PUNC">,</span><span class="NAME">ib</span><span class="PUNC">=</span><span class="NAME">C.__uv2Array</span><span class="PUNC">,</span><span class="NAME">Sa</span><span class="PUNC">=</span><span class="NAME">C.__normalArray</span><span class="PUNC">,</span><span class="NAME">La</span><span class="PUNC">=</span><span class="NAME">C.__tangentArray</span><span class="PUNC">,</span><span class="NAME">db</span><span class="PUNC">=</span><span class="NAME">C.__colorArray</span><span class="PUNC">,</span><span class="NAME">Ma</span><span class="PUNC">=</span><span class="NAME">C.__skinIndexArray</span><span class="PUNC">,</span><span class="NAME">Na</span><span class="PUNC">=</span><span class="NAME">C.__skinWeightArray</span><span class="PUNC">,</span><span class="NAME">yb</span><span class="PUNC">=</span><span class="NAME">C.__morphTargetsArrays</span><span class="PUNC">,</span><span class="NAME">Ab</span><span class="PUNC">=</span><span class="NAME">C.__morphNormalsArrays</span><span class="PUNC">,</span><span class="NAME">Bb</span><span class="PUNC">=</span><span class="NAME">C.__webglCustomAttributesList</span><span class="PUNC">,</span><span class="NAME">u</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">Mb</span><span class="PUNC">=</span><span class="NAME">C.__faceArray</span><span class="PUNC">,</span><span class="NAME">wb</span><span class="PUNC">=</span><span class="NAME">C.__lineArray</span><span class="PUNC">,</span><span class="NAME">qb</span><span class="PUNC">=</span><span class="NAME">G.geometry</span><span class="PUNC">,</span><span class="NAME">Gb</span><span class="PUNC">=</span><span class="NAME">qb.elementsNeedUpdate</span><span class="PUNC">,</span><span class="NAME">Hb</span><span class="PUNC">=</span><span class="NAME">qb.uvsNeedUpdate</span><span class="PUNC">,</span><span class="NAME">Rb</span><span class="PUNC">=</span><span class="NAME">qb.normalsNeedUpdate</span><span class="PUNC">,</span><span class="NAME">Sb</span><span class="PUNC">=</span><span class="NAME">qb.tangentsNeedUpdate</span><span class="PUNC">,</span><span class="NAME">Xb</span><span class="PUNC">=</span><span class="NAME">qb.colorsNeedUpdate</span><span class="PUNC">,</span><span class="NAME">Yb</span><span class="PUNC">=</span><span class="NAME">qb.morphTargetsNeedUpdate</span><span class="PUNC">,</span><span class="NAME">cc</span><span class="PUNC">=</span><span class="NAME">qb.vertices</span><span class="PUNC">,</span><span class="NAME">sa</span><span class="PUNC">=</span><span class="NAME">C.faces3</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>467</span> </span><span class="NAME">ta</span><span class="PUNC">=</span><span class="NAME">C.faces4</span><span class="PUNC">,</span><span class="NAME">kb</span><span class="PUNC">=</span><span class="NAME">qb.faces</span><span class="PUNC">,</span><span class="NAME">Jb</span><span class="PUNC">=</span><span class="NAME">qb.faceVertexUvs</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">Lb</span><span class="PUNC">=</span><span class="NAME">qb.faceVertexUvs</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">dc</span><span class="PUNC">=</span><span class="NAME">qb.skinIndices</span><span class="PUNC">,</span><span class="NAME">$b</span><span class="PUNC">=</span><span class="NAME">qb.skinWeights</span><span class="PUNC">,</span><span class="NAME">ac</span><span class="PUNC">=</span><span class="NAME">qb.morphTargets</span><span class="PUNC">,</span><span class="NAME">Ib</span><span class="PUNC">=</span><span class="NAME">qb.morphNormals</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">qb.verticesNeedUpdate</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">E</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">D</span><span class="PUNC">=</span><span class="NAME">sa.length</span><span class="PUNC">;</span><span class="NAME">E</span><span class="PUNC">&lt;</span><span class="NAME">D</span><span class="PUNC">;</span><span class="NAME">E</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">Q</span><span class="PUNC">=</span><span class="NAME">kb</span><span class="PUNC">[</span><span class="NAME">sa</span><span class="PUNC">[</span><span class="NAME">E</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">R</span><span class="PUNC">=</span><span class="NAME">cc</span><span class="PUNC">[</span><span class="NAME">Q.a</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">S</span><span class="PUNC">=</span><span class="NAME">cc</span><span class="PUNC">[</span><span class="NAME">Q.b</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">P</span><span class="PUNC">=</span><span class="NAME">cc</span><span class="PUNC">[</span><span class="NAME">Q.c</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">cb</span><span class="PUNC">[</span><span class="NAME">Ya</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">R.x</span><span class="PUNC">,</span><span class="NAME">cb</span><span class="PUNC">[</span><span class="NAME">Ya</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">R.y</span><span class="PUNC">,</span><span class="NAME">cb</span><span class="PUNC">[</span><span class="NAME">Ya</span><span class="PUNC">+</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">R.z</span><span class="PUNC">,</span><span class="NAME">cb</span><span class="PUNC">[</span><span class="NAME">Ya</span><span class="PUNC">+</span><span class="NUMB">3</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">S.x</span><span class="PUNC">,</span><span class="NAME">cb</span><span class="PUNC">[</span><span class="NAME">Ya</span><span class="PUNC">+</span><span class="NUMB">4</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">S.y</span><span class="PUNC">,</span><span class="NAME">cb</span><span class="PUNC">[</span><span class="NAME">Ya</span><span class="PUNC">+</span><span class="NUMB">5</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">S.z</span><span class="PUNC">,</span><span class="NAME">cb</span><span class="PUNC">[</span><span class="NAME">Ya</span><span class="PUNC">+</span><span class="NUMB">6</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">P.x</span><span class="PUNC">,</span><span class="NAME">cb</span><span class="PUNC">[</span><span class="NAME">Ya</span><span class="PUNC">+</span><span class="NUMB">7</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">P.y</span><span class="PUNC">,</span><span class="NAME">cb</span><span class="PUNC">[</span><span class="NAME">Ya</span><span class="PUNC">+</span><span class="NUMB">8</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">P.z</span><span class="PUNC">,</span><span class="NAME">Ya</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NUMB">9</span><span class="PUNC">;</span><span class="NAME">E</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">D</span><span class="PUNC">=</span><span class="NAME">ta.length</span><span class="PUNC">;</span><span class="NAME">E</span><span class="PUNC">&lt;</span><span class="NAME">D</span><span class="PUNC">;</span><span class="NAME">E</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">Q</span><span class="PUNC">=</span><span class="NAME">kb</span><span class="PUNC">[</span><span class="NAME">ta</span><span class="PUNC">[</span><span class="NAME">E</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">R</span><span class="PUNC">=</span><span class="NAME">cc</span><span class="PUNC">[</span><span class="NAME">Q.a</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">S</span><span class="PUNC">=</span><span class="NAME">cc</span><span class="PUNC">[</span><span class="NAME">Q.b</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">P</span><span class="PUNC">=</span><span class="NAME">cc</span><span class="PUNC">[</span><span class="NAME">Q.c</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">ba</span><span class="PUNC">=</span><span class="NAME">cc</span><span class="PUNC">[</span><span class="NAME">Q.d</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">cb</span><span class="PUNC">[</span><span class="NAME">Ya</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">R.x</span><span class="PUNC">,</span><span class="NAME">cb</span><span class="PUNC">[</span><span class="NAME">Ya</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">R.y</span><span class="PUNC">,</span><span class="NAME">cb</span><span class="PUNC">[</span><span class="NAME">Ya</span><span class="PUNC">+</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">R.z</span><span class="PUNC">,</span><span class="NAME">cb</span><span class="PUNC">[</span><span class="NAME">Ya</span><span class="PUNC">+</span><span class="NUMB">3</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">S.x</span><span class="PUNC">,</span><span class="NAME">cb</span><span class="PUNC">[</span><span class="NAME">Ya</span><span class="PUNC">+</span><span class="NUMB">4</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>468</span> </span><span class="NAME">S.y</span><span class="PUNC">,</span><span class="NAME">cb</span><span class="PUNC">[</span><span class="NAME">Ya</span><span class="PUNC">+</span><span class="NUMB">5</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">S.z</span><span class="PUNC">,</span><span class="NAME">cb</span><span class="PUNC">[</span><span class="NAME">Ya</span><span class="PUNC">+</span><span class="NUMB">6</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">P.x</span><span class="PUNC">,</span><span class="NAME">cb</span><span class="PUNC">[</span><span class="NAME">Ya</span><span class="PUNC">+</span><span class="NUMB">7</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">P.y</span><span class="PUNC">,</span><span class="NAME">cb</span><span class="PUNC">[</span><span class="NAME">Ya</span><span class="PUNC">+</span><span class="NUMB">8</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">P.z</span><span class="PUNC">,</span><span class="NAME">cb</span><span class="PUNC">[</span><span class="NAME">Ya</span><span class="PUNC">+</span><span class="NUMB">9</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">ba.x</span><span class="PUNC">,</span><span class="NAME">cb</span><span class="PUNC">[</span><span class="NAME">Ya</span><span class="PUNC">+</span><span class="NUMB">10</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">ba.y</span><span class="PUNC">,</span><span class="NAME">cb</span><span class="PUNC">[</span><span class="NAME">Ya</span><span class="PUNC">+</span><span class="NUMB">11</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">ba.z</span><span class="PUNC">,</span><span class="NAME">Ya</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NUMB">12</span><span class="PUNC">;</span><span class="NAME">k.bindBuffer</span><span class="PUNC">(</span><span class="NAME">k.ARRAY_BUFFER</span><span class="PUNC">,</span><span class="NAME">C.__webglVertexBuffer</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">k.bufferData</span><span class="PUNC">(</span><span class="NAME">k.ARRAY_BUFFER</span><span class="PUNC">,</span><span class="NAME">cb</span><span class="PUNC">,</span><span class="NAME">H</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">Yb</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">bb</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">ab</span><span class="PUNC">=</span><span class="NAME">ac.length</span><span class="PUNC">;</span><span class="NAME">bb</span><span class="PUNC">&lt;</span><span class="NAME">ab</span><span class="PUNC">;</span><span class="NAME">bb</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">E</span><span class="PUNC">=</span><span class="NAME">ga</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">D</span><span class="PUNC">=</span><span class="NAME">sa.length</span><span class="PUNC">;</span><span class="NAME">E</span><span class="PUNC">&lt;</span><span class="NAME">D</span><span class="PUNC">;</span><span class="NAME">E</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">Ua</span><span class="PUNC">=</span><span class="NAME">sa</span><span class="PUNC">[</span><span class="NAME">E</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">Q</span><span class="PUNC">=</span><span class="NAME">kb</span><span class="PUNC">[</span><span class="NAME">Ua</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">R</span><span class="PUNC">=</span><span class="NAME">ac</span><span class="PUNC">[</span><span class="NAME">bb</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">vertices</span><span class="PUNC">[</span><span class="NAME">Q.a</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">S</span><span class="PUNC">=</span><span class="NAME">ac</span><span class="PUNC">[</span><span class="NAME">bb</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">vertices</span><span class="PUNC">[</span><span class="NAME">Q.b</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">P</span><span class="PUNC">=</span><span class="NAME">ac</span><span class="PUNC">[</span><span class="NAME">bb</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">vertices</span><span class="PUNC">[</span><span class="NAME">Q.c</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">Za</span><span class="PUNC">=</span><span class="NAME">yb</span><span class="PUNC">[</span><span class="NAME">bb</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">Za</span><span class="PUNC">[</span><span class="NAME">ga</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">R.x</span><span class="PUNC">,</span><span class="NAME">Za</span><span class="PUNC">[</span><span class="NAME">ga</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">R.y</span><span class="PUNC">,</span><span class="NAME">Za</span><span class="PUNC">[</span><span class="NAME">ga</span><span class="PUNC">+</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">R.z</span><span class="PUNC">,</span><span class="NAME">Za</span><span class="PUNC">[</span><span class="NAME">ga</span><span class="PUNC">+</span><span class="NUMB">3</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">S.x</span><span class="PUNC">,</span><span class="NAME">Za</span><span class="PUNC">[</span><span class="NAME">ga</span><span class="PUNC">+</span><span class="NUMB">4</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">S.y</span><span class="PUNC">,</span><span class="NAME">Za</span><span class="PUNC">[</span><span class="NAME">ga</span><span class="PUNC">+</span><span class="NUMB">5</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">S.z</span><span class="PUNC">,</span><span class="NAME">Za</span><span class="PUNC">[</span><span class="NAME">ga</span><span class="PUNC">+</span><span class="NUMB">6</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">P.x</span><span class="PUNC">,</span><span class="NAME">Za</span><span class="PUNC">[</span><span class="NAME">ga</span><span class="PUNC">+</span><span class="NUMB">7</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">P.y</span><span class="PUNC">,</span><span class="NAME">Za</span><span class="PUNC">[</span><span class="NAME">ga</span><span class="PUNC">+</span><span class="NUMB">8</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">P.z</span><span class="PUNC">,</span><span class="NAME">J.morphNormals</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">M</span><span class="PUNC">?</span><span class="PUNC">(</span><span class="NAME">Qa</span><span class="PUNC">=</span><span class="NAME">Ib</span><span class="PUNC">[</span><span class="NAME">bb</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">vertexNormals</span><span class="PUNC">[</span><span class="NAME">Ua</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>469</span> </span><span class="NAME">ha</span><span class="PUNC">=</span><span class="NAME">Qa.a</span><span class="PUNC">,</span><span class="NAME">Ha</span><span class="PUNC">=</span><span class="NAME">Qa.b</span><span class="PUNC">,</span><span class="NAME">ia</span><span class="PUNC">=</span><span class="NAME">Qa.c</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">ia</span><span class="PUNC">=</span><span class="NAME">Ha</span><span class="PUNC">=</span><span class="NAME">ha</span><span class="PUNC">=</span><span class="NAME">Ib</span><span class="PUNC">[</span><span class="NAME">bb</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">faceNormals</span><span class="PUNC">[</span><span class="NAME">Ua</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">$a</span><span class="PUNC">=</span><span class="NAME">Ab</span><span class="PUNC">[</span><span class="NAME">bb</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">$a</span><span class="PUNC">[</span><span class="NAME">ga</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">ha.x</span><span class="PUNC">,</span><span class="NAME">$a</span><span class="PUNC">[</span><span class="NAME">ga</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">ha.y</span><span class="PUNC">,</span><span class="NAME">$a</span><span class="PUNC">[</span><span class="NAME">ga</span><span class="PUNC">+</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">ha.z</span><span class="PUNC">,</span><span class="NAME">$a</span><span class="PUNC">[</span><span class="NAME">ga</span><span class="PUNC">+</span><span class="NUMB">3</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">Ha.x</span><span class="PUNC">,</span><span class="NAME">$a</span><span class="PUNC">[</span><span class="NAME">ga</span><span class="PUNC">+</span><span class="NUMB">4</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">Ha.y</span><span class="PUNC">,</span><span class="NAME">$a</span><span class="PUNC">[</span><span class="NAME">ga</span><span class="PUNC">+</span><span class="NUMB">5</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">Ha.z</span><span class="PUNC">,</span><span class="NAME">$a</span><span class="PUNC">[</span><span class="NAME">ga</span><span class="PUNC">+</span><span class="NUMB">6</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">ia.x</span><span class="PUNC">,</span><span class="NAME">$a</span><span class="PUNC">[</span><span class="NAME">ga</span><span class="PUNC">+</span><span class="NUMB">7</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">ia.y</span><span class="PUNC">,</span><span class="NAME">$a</span><span class="PUNC">[</span><span class="NAME">ga</span><span class="PUNC">+</span><span class="NUMB">8</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">ia.z</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">ga</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NUMB">9</span><span class="PUNC">;</span><span class="NAME">E</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">D</span><span class="PUNC">=</span><span class="NAME">ta.length</span><span class="PUNC">;</span><span class="NAME">E</span><span class="PUNC">&lt;</span><span class="NAME">D</span><span class="PUNC">;</span><span class="NAME">E</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">Ua</span><span class="PUNC">=</span><span class="NAME">ta</span><span class="PUNC">[</span><span class="NAME">E</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">Q</span><span class="PUNC">=</span><span class="NAME">kb</span><span class="PUNC">[</span><span class="NAME">Ua</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">R</span><span class="PUNC">=</span><span class="NAME">ac</span><span class="PUNC">[</span><span class="NAME">bb</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">vertices</span><span class="PUNC">[</span><span class="NAME">Q.a</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">S</span><span class="PUNC">=</span><span class="NAME">ac</span><span class="PUNC">[</span><span class="NAME">bb</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">vertices</span><span class="PUNC">[</span><span class="NAME">Q.b</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">P</span><span class="PUNC">=</span><span class="NAME">ac</span><span class="PUNC">[</span><span class="NAME">bb</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">vertices</span><span class="PUNC">[</span><span class="NAME">Q.c</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">ba</span><span class="PUNC">=</span><span class="NAME">ac</span><span class="PUNC">[</span><span class="NAME">bb</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">vertices</span><span class="PUNC">[</span><span class="NAME">Q.d</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">Za</span><span class="PUNC">=</span><span class="NAME">yb</span><span class="PUNC">[</span><span class="NAME">bb</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">Za</span><span class="PUNC">[</span><span class="NAME">ga</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">R.x</span><span class="PUNC">,</span><span class="NAME">Za</span><span class="PUNC">[</span><span class="NAME">ga</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">R.y</span><span class="PUNC">,</span><span class="NAME">Za</span><span class="PUNC">[</span><span class="NAME">ga</span><span class="PUNC">+</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">R.z</span><span class="PUNC">,</span><span class="NAME">Za</span><span class="PUNC">[</span><span class="NAME">ga</span><span class="PUNC">+</span><span class="NUMB">3</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">S.x</span><span class="PUNC">,</span><span class="NAME">Za</span><span class="PUNC">[</span><span class="NAME">ga</span><span class="PUNC">+</span><span class="NUMB">4</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">S.y</span><span class="PUNC">,</span><span class="NAME">Za</span><span class="PUNC">[</span><span class="NAME">ga</span><span class="PUNC">+</span><span class="NUMB">5</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">S.z</span><span class="PUNC">,</span><span class="NAME">Za</span><span class="PUNC">[</span><span class="NAME">ga</span><span class="PUNC">+</span><span class="NUMB">6</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">P.x</span><span class="PUNC">,</span><span class="NAME">Za</span><span class="PUNC">[</span><span class="NAME">ga</span><span class="PUNC">+</span><span class="NUMB">7</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">P.y</span><span class="PUNC">,</span><span class="NAME">Za</span><span class="PUNC">[</span><span class="NAME">ga</span><span class="PUNC">+</span><span class="NUMB">8</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">P.z</span><span class="PUNC">,</span><span class="NAME">Za</span><span class="PUNC">[</span><span class="NAME">ga</span><span class="PUNC">+</span><span class="NUMB">9</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">ba.x</span><span class="PUNC">,</span><span class="NAME">Za</span><span class="PUNC">[</span><span class="NAME">ga</span><span class="PUNC">+</span><span class="NUMB">10</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">ba.y</span><span class="PUNC">,</span><span class="NAME">Za</span><span class="PUNC">[</span><span class="NAME">ga</span><span class="PUNC">+</span><span class="NUMB">11</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>470</span> </span><span class="NAME">ba.z</span><span class="PUNC">,</span><span class="NAME">J.morphNormals</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">M</span><span class="PUNC">?</span><span class="PUNC">(</span><span class="NAME">Qa</span><span class="PUNC">=</span><span class="NAME">Ib</span><span class="PUNC">[</span><span class="NAME">bb</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">vertexNormals</span><span class="PUNC">[</span><span class="NAME">Ua</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">ha</span><span class="PUNC">=</span><span class="NAME">Qa.a</span><span class="PUNC">,</span><span class="NAME">Ha</span><span class="PUNC">=</span><span class="NAME">Qa.b</span><span class="PUNC">,</span><span class="NAME">ia</span><span class="PUNC">=</span><span class="NAME">Qa.c</span><span class="PUNC">,</span><span class="NAME">eb</span><span class="PUNC">=</span><span class="NAME">Qa.d</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">eb</span><span class="PUNC">=</span><span class="NAME">ia</span><span class="PUNC">=</span><span class="NAME">Ha</span><span class="PUNC">=</span><span class="NAME">ha</span><span class="PUNC">=</span><span class="NAME">Ib</span><span class="PUNC">[</span><span class="NAME">bb</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">faceNormals</span><span class="PUNC">[</span><span class="NAME">Ua</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">$a</span><span class="PUNC">=</span><span class="NAME">Ab</span><span class="PUNC">[</span><span class="NAME">bb</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">$a</span><span class="PUNC">[</span><span class="NAME">ga</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">ha.x</span><span class="PUNC">,</span><span class="NAME">$a</span><span class="PUNC">[</span><span class="NAME">ga</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">ha.y</span><span class="PUNC">,</span><span class="NAME">$a</span><span class="PUNC">[</span><span class="NAME">ga</span><span class="PUNC">+</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">ha.z</span><span class="PUNC">,</span><span class="NAME">$a</span><span class="PUNC">[</span><span class="NAME">ga</span><span class="PUNC">+</span><span class="NUMB">3</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">Ha.x</span><span class="PUNC">,</span><span class="NAME">$a</span><span class="PUNC">[</span><span class="NAME">ga</span><span class="PUNC">+</span><span class="NUMB">4</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">Ha.y</span><span class="PUNC">,</span><span class="NAME">$a</span><span class="PUNC">[</span><span class="NAME">ga</span><span class="PUNC">+</span><span class="NUMB">5</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">Ha.z</span><span class="PUNC">,</span><span class="NAME">$a</span><span class="PUNC">[</span><span class="NAME">ga</span><span class="PUNC">+</span><span class="NUMB">6</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">ia.x</span><span class="PUNC">,</span><span class="NAME">$a</span><span class="PUNC">[</span><span class="NAME">ga</span><span class="PUNC">+</span><span class="NUMB">7</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">ia.y</span><span class="PUNC">,</span><span class="NAME">$a</span><span class="PUNC">[</span><span class="NAME">ga</span><span class="PUNC">+</span><span class="NUMB">8</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">ia.z</span><span class="PUNC">,</span><span class="NAME">$a</span><span class="PUNC">[</span><span class="NAME">ga</span><span class="PUNC">+</span><span class="NUMB">9</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">eb.x</span><span class="PUNC">,</span><span class="NAME">$a</span><span class="PUNC">[</span><span class="NAME">ga</span><span class="PUNC">+</span><span class="NUMB">10</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">eb.y</span><span class="PUNC">,</span><span class="NAME">$a</span><span class="PUNC">[</span><span class="NAME">ga</span><span class="PUNC">+</span><span class="NUMB">11</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">eb.z</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">ga</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NUMB">12</span><span class="PUNC">;</span><span class="NAME">k.bindBuffer</span><span class="PUNC">(</span><span class="NAME">k.ARRAY_BUFFER</span><span class="PUNC">,</span><span class="NAME">C.__webglMorphTargetsBuffers</span><span class="PUNC">[</span><span class="NAME">bb</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">k.bufferData</span><span class="PUNC">(</span><span class="NAME">k.ARRAY_BUFFER</span><span class="PUNC">,</span><span class="NAME">yb</span><span class="PUNC">[</span><span class="NAME">bb</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">H</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">J.morphNormals</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">k.bindBuffer</span><span class="PUNC">(</span><span class="NAME">k.ARRAY_BUFFER</span><span class="PUNC">,</span><span class="NAME">C.__webglMorphNormalsBuffers</span><span class="PUNC">[</span><span class="NAME">bb</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">k.bufferData</span><span class="PUNC">(</span><span class="NAME">k.ARRAY_BUFFER</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>471</span> </span><span class="NAME">Ab</span><span class="PUNC">[</span><span class="NAME">bb</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">H</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">$b.length</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">E</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">D</span><span class="PUNC">=</span><span class="NAME">sa.length</span><span class="PUNC">;</span><span class="NAME">E</span><span class="PUNC">&lt;</span><span class="NAME">D</span><span class="PUNC">;</span><span class="NAME">E</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">Q</span><span class="PUNC">=</span><span class="NAME">kb</span><span class="PUNC">[</span><span class="NAME">sa</span><span class="PUNC">[</span><span class="NAME">E</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">oa</span><span class="PUNC">=</span><span class="NAME">$b</span><span class="PUNC">[</span><span class="NAME">Q.a</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">pa</span><span class="PUNC">=</span><span class="NAME">$b</span><span class="PUNC">[</span><span class="NAME">Q.b</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">ra</span><span class="PUNC">=</span><span class="NAME">$b</span><span class="PUNC">[</span><span class="NAME">Q.c</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">Na</span><span class="PUNC">[</span><span class="NAME">Y</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">oa.x</span><span class="PUNC">,</span><span class="NAME">Na</span><span class="PUNC">[</span><span class="NAME">Y</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">oa.y</span><span class="PUNC">,</span><span class="NAME">Na</span><span class="PUNC">[</span><span class="NAME">Y</span><span class="PUNC">+</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">oa.z</span><span class="PUNC">,</span><span class="NAME">Na</span><span class="PUNC">[</span><span class="NAME">Y</span><span class="PUNC">+</span><span class="NUMB">3</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">oa.w</span><span class="PUNC">,</span><span class="NAME">Na</span><span class="PUNC">[</span><span class="NAME">Y</span><span class="PUNC">+</span><span class="NUMB">4</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">pa.x</span><span class="PUNC">,</span><span class="NAME">Na</span><span class="PUNC">[</span><span class="NAME">Y</span><span class="PUNC">+</span><span class="NUMB">5</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">pa.y</span><span class="PUNC">,</span><span class="NAME">Na</span><span class="PUNC">[</span><span class="NAME">Y</span><span class="PUNC">+</span><span class="NUMB">6</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">pa.z</span><span class="PUNC">,</span><span class="NAME">Na</span><span class="PUNC">[</span><span class="NAME">Y</span><span class="PUNC">+</span><span class="NUMB">7</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">pa.w</span><span class="PUNC">,</span><span class="NAME">Na</span><span class="PUNC">[</span><span class="NAME">Y</span><span class="PUNC">+</span><span class="NUMB">8</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">ra.x</span><span class="PUNC">,</span><span class="NAME">Na</span><span class="PUNC">[</span><span class="NAME">Y</span><span class="PUNC">+</span><span class="NUMB">9</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">ra.y</span><span class="PUNC">,</span><span class="NAME">Na</span><span class="PUNC">[</span><span class="NAME">Y</span><span class="PUNC">+</span><span class="NUMB">10</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">ra.z</span><span class="PUNC">,</span><span class="NAME">Na</span><span class="PUNC">[</span><span class="NAME">Y</span><span class="PUNC">+</span><span class="NUMB">11</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">ra.w</span><span class="PUNC">,</span><span class="NAME">va</span><span class="PUNC">=</span><span class="NAME">dc</span><span class="PUNC">[</span><span class="NAME">Q.a</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">wa</span><span class="PUNC">=</span><span class="NAME">dc</span><span class="PUNC">[</span><span class="NAME">Q.b</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">xa</span><span class="PUNC">=</span><span class="NAME">dc</span><span class="PUNC">[</span><span class="NAME">Q.c</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">Ma</span><span class="PUNC">[</span><span class="NAME">Y</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">va.x</span><span class="PUNC">,</span><span class="NAME">Ma</span><span class="PUNC">[</span><span class="NAME">Y</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">va.y</span><span class="PUNC">,</span><span class="NAME">Ma</span><span class="PUNC">[</span><span class="NAME">Y</span><span class="PUNC">+</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">va.z</span><span class="PUNC">,</span><span class="NAME">Ma</span><span class="PUNC">[</span><span class="NAME">Y</span><span class="PUNC">+</span><span class="NUMB">3</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">va.w</span><span class="PUNC">,</span><span class="NAME">Ma</span><span class="PUNC">[</span><span class="NAME">Y</span><span class="PUNC">+</span><span class="NUMB">4</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">wa.x</span><span class="PUNC">,</span><span class="NAME">Ma</span><span class="PUNC">[</span><span class="NAME">Y</span><span class="PUNC">+</span><span class="NUMB">5</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">wa.y</span><span class="PUNC">,</span><span class="NAME">Ma</span><span class="PUNC">[</span><span class="NAME">Y</span><span class="PUNC">+</span><span class="NUMB">6</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">wa.z</span><span class="PUNC">,</span><span class="NAME">Ma</span><span class="PUNC">[</span><span class="NAME">Y</span><span class="PUNC">+</span><span class="NUMB">7</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">wa.w</span><span class="PUNC">,</span><span class="NAME">Ma</span><span class="PUNC">[</span><span class="NAME">Y</span><span class="PUNC">+</span><span class="NUMB">8</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">xa.x</span><span class="PUNC">,</span><span class="NAME">Ma</span><span class="PUNC">[</span><span class="NAME">Y</span><span class="PUNC">+</span><span class="NUMB">9</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">xa.y</span><span class="PUNC">,</span><span class="NAME">Ma</span><span class="PUNC">[</span><span class="NAME">Y</span><span class="PUNC">+</span><span class="NUMB">10</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">xa.z</span><span class="PUNC">,</span><span class="NAME">Ma</span><span class="PUNC">[</span><span class="NAME">Y</span><span class="PUNC">+</span><span class="NUMB">11</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">xa.w</span><span class="PUNC">,</span><span class="NAME">Y</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NUMB">12</span><span class="PUNC">;</span><span class="NAME">E</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">D</span><span class="PUNC">=</span><span class="NAME">ta.length</span><span class="PUNC">;</span><span class="NAME">E</span><span class="PUNC">&lt;</span><span class="NAME">D</span><span class="PUNC">;</span><span class="NAME">E</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">Q</span><span class="PUNC">=</span><span class="NAME">kb</span><span class="PUNC">[</span><span class="NAME">ta</span><span class="PUNC">[</span><span class="NAME">E</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">oa</span><span class="PUNC">=</span><span class="NAME">$b</span><span class="PUNC">[</span><span class="NAME">Q.a</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>472</span> </span><span class="NAME">pa</span><span class="PUNC">=</span><span class="NAME">$b</span><span class="PUNC">[</span><span class="NAME">Q.b</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">ra</span><span class="PUNC">=</span><span class="NAME">$b</span><span class="PUNC">[</span><span class="NAME">Q.c</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">Ca</span><span class="PUNC">=</span><span class="NAME">$b</span><span class="PUNC">[</span><span class="NAME">Q.d</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">Na</span><span class="PUNC">[</span><span class="NAME">Y</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">oa.x</span><span class="PUNC">,</span><span class="NAME">Na</span><span class="PUNC">[</span><span class="NAME">Y</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">oa.y</span><span class="PUNC">,</span><span class="NAME">Na</span><span class="PUNC">[</span><span class="NAME">Y</span><span class="PUNC">+</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">oa.z</span><span class="PUNC">,</span><span class="NAME">Na</span><span class="PUNC">[</span><span class="NAME">Y</span><span class="PUNC">+</span><span class="NUMB">3</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">oa.w</span><span class="PUNC">,</span><span class="NAME">Na</span><span class="PUNC">[</span><span class="NAME">Y</span><span class="PUNC">+</span><span class="NUMB">4</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">pa.x</span><span class="PUNC">,</span><span class="NAME">Na</span><span class="PUNC">[</span><span class="NAME">Y</span><span class="PUNC">+</span><span class="NUMB">5</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">pa.y</span><span class="PUNC">,</span><span class="NAME">Na</span><span class="PUNC">[</span><span class="NAME">Y</span><span class="PUNC">+</span><span class="NUMB">6</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">pa.z</span><span class="PUNC">,</span><span class="NAME">Na</span><span class="PUNC">[</span><span class="NAME">Y</span><span class="PUNC">+</span><span class="NUMB">7</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">pa.w</span><span class="PUNC">,</span><span class="NAME">Na</span><span class="PUNC">[</span><span class="NAME">Y</span><span class="PUNC">+</span><span class="NUMB">8</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">ra.x</span><span class="PUNC">,</span><span class="NAME">Na</span><span class="PUNC">[</span><span class="NAME">Y</span><span class="PUNC">+</span><span class="NUMB">9</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">ra.y</span><span class="PUNC">,</span><span class="NAME">Na</span><span class="PUNC">[</span><span class="NAME">Y</span><span class="PUNC">+</span><span class="NUMB">10</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">ra.z</span><span class="PUNC">,</span><span class="NAME">Na</span><span class="PUNC">[</span><span class="NAME">Y</span><span class="PUNC">+</span><span class="NUMB">11</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">ra.w</span><span class="PUNC">,</span><span class="NAME">Na</span><span class="PUNC">[</span><span class="NAME">Y</span><span class="PUNC">+</span><span class="NUMB">12</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">Ca.x</span><span class="PUNC">,</span><span class="NAME">Na</span><span class="PUNC">[</span><span class="NAME">Y</span><span class="PUNC">+</span><span class="NUMB">13</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">Ca.y</span><span class="PUNC">,</span><span class="NAME">Na</span><span class="PUNC">[</span><span class="NAME">Y</span><span class="PUNC">+</span><span class="NUMB">14</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">Ca.z</span><span class="PUNC">,</span><span class="NAME">Na</span><span class="PUNC">[</span><span class="NAME">Y</span><span class="PUNC">+</span><span class="NUMB">15</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">Ca.w</span><span class="PUNC">,</span><span class="NAME">va</span><span class="PUNC">=</span><span class="NAME">dc</span><span class="PUNC">[</span><span class="NAME">Q.a</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">wa</span><span class="PUNC">=</span><span class="NAME">dc</span><span class="PUNC">[</span><span class="NAME">Q.b</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">xa</span><span class="PUNC">=</span><span class="NAME">dc</span><span class="PUNC">[</span><span class="NAME">Q.c</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">pb</span><span class="PUNC">=</span><span class="NAME">dc</span><span class="PUNC">[</span><span class="NAME">Q.d</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">Ma</span><span class="PUNC">[</span><span class="NAME">Y</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">va.x</span><span class="PUNC">,</span><span class="NAME">Ma</span><span class="PUNC">[</span><span class="NAME">Y</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">va.y</span><span class="PUNC">,</span><span class="NAME">Ma</span><span class="PUNC">[</span><span class="NAME">Y</span><span class="PUNC">+</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">va.z</span><span class="PUNC">,</span><span class="NAME">Ma</span><span class="PUNC">[</span><span class="NAME">Y</span><span class="PUNC">+</span><span class="NUMB">3</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">va.w</span><span class="PUNC">,</span><span class="NAME">Ma</span><span class="PUNC">[</span><span class="NAME">Y</span><span class="PUNC">+</span><span class="NUMB">4</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">wa.x</span><span class="PUNC">,</span><span class="NAME">Ma</span><span class="PUNC">[</span><span class="NAME">Y</span><span class="PUNC">+</span><span class="NUMB">5</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">wa.y</span><span class="PUNC">,</span><span class="NAME">Ma</span><span class="PUNC">[</span><span class="NAME">Y</span><span class="PUNC">+</span><span class="NUMB">6</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">wa.z</span><span class="PUNC">,</span><span class="NAME">Ma</span><span class="PUNC">[</span><span class="NAME">Y</span><span class="PUNC">+</span><span class="NUMB">7</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">wa.w</span><span class="PUNC">,</span><span class="NAME">Ma</span><span class="PUNC">[</span><span class="NAME">Y</span><span class="PUNC">+</span><span class="NUMB">8</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">xa.x</span><span class="PUNC">,</span><span class="NAME">Ma</span><span class="PUNC">[</span><span class="NAME">Y</span><span class="PUNC">+</span><span class="NUMB">9</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">xa.y</span><span class="PUNC">,</span><span class="NAME">Ma</span><span class="PUNC">[</span><span class="NAME">Y</span><span class="PUNC">+</span><span class="NUMB">10</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">xa.z</span><span class="PUNC">,</span><span class="NAME">Ma</span><span class="PUNC">[</span><span class="NAME">Y</span><span class="PUNC">+</span><span class="NUMB">11</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">xa.w</span><span class="PUNC">,</span><span class="NAME">Ma</span><span class="PUNC">[</span><span class="NAME">Y</span><span class="PUNC">+</span><span class="NUMB">12</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">pb.x</span><span class="PUNC">,</span><span class="NAME">Ma</span><span class="PUNC">[</span><span class="NAME">Y</span><span class="PUNC">+</span><span class="NUMB">13</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">pb.y</span><span class="PUNC">,</span><span class="NAME">Ma</span><span class="PUNC">[</span><span class="NAME">Y</span><span class="PUNC">+</span><span class="NUMB">14</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">pb.z</span><span class="PUNC">,</span><span class="NAME">Ma</span><span class="PUNC">[</span><span class="NAME">Y</span><span class="PUNC">+</span><span class="NUMB">15</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">pb.w</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>473</span> </span><span class="NAME">Y</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NUMB">16</span><span class="PUNC">;</span><span class="NUMB">0</span><span class="PUNC">&lt;</span><span class="NAME">Y</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">k.bindBuffer</span><span class="PUNC">(</span><span class="NAME">k.ARRAY_BUFFER</span><span class="PUNC">,</span><span class="NAME">C.__webglSkinIndicesBuffer</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">k.bufferData</span><span class="PUNC">(</span><span class="NAME">k.ARRAY_BUFFER</span><span class="PUNC">,</span><span class="NAME">Ma</span><span class="PUNC">,</span><span class="NAME">H</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">k.bindBuffer</span><span class="PUNC">(</span><span class="NAME">k.ARRAY_BUFFER</span><span class="PUNC">,</span><span class="NAME">C.__webglSkinWeightsBuffer</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">k.bufferData</span><span class="PUNC">(</span><span class="NAME">k.ARRAY_BUFFER</span><span class="PUNC">,</span><span class="NAME">Na</span><span class="PUNC">,</span><span class="NAME">H</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">Xb</span><span class="PUNC">&&</span><span class="NAME">K</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">E</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">D</span><span class="PUNC">=</span><span class="NAME">sa.length</span><span class="PUNC">;</span><span class="NAME">E</span><span class="PUNC">&lt;</span><span class="NAME">D</span><span class="PUNC">;</span><span class="NAME">E</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">Q</span><span class="PUNC">=</span><span class="NAME">kb</span><span class="PUNC">[</span><span class="NAME">sa</span><span class="PUNC">[</span><span class="NAME">E</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">T</span><span class="PUNC">=</span><span class="NAME">Q.vertexColors</span><span class="PUNC">,</span><span class="NAME">X</span><span class="PUNC">=</span><span class="NAME">Q.color</span><span class="PUNC">,</span><span class="NUMB">3</span><span class="PUNC">===</span><span class="NAME">T.length</span><span class="PUNC">&&</span><span class="NAME">K</span><span class="PUNC">===</span><span class="NAME">THREE.VertexColors</span><span class="PUNC">?</span><span class="PUNC">(</span><span class="NAME">ka</span><span class="PUNC">=</span><span class="NAME">T</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">na</span><span class="PUNC">=</span><span class="NAME">T</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">la</span><span class="PUNC">=</span><span class="NAME">T</span><span class="PUNC">[</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">la</span><span class="PUNC">=</span><span class="NAME">na</span><span class="PUNC">=</span><span class="NAME">ka</span><span class="PUNC">=</span><span class="NAME">X</span><span class="PUNC">,</span><span class="NAME">db</span><span class="PUNC">[</span><span class="NAME">Va</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">ka.r</span><span class="PUNC">,</span><span class="NAME">db</span><span class="PUNC">[</span><span class="NAME">Va</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">ka.g</span><span class="PUNC">,</span><span class="NAME">db</span><span class="PUNC">[</span><span class="NAME">Va</span><span class="PUNC">+</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">ka.b</span><span class="PUNC">,</span><span class="NAME">db</span><span class="PUNC">[</span><span class="NAME">Va</span><span class="PUNC">+</span><span class="NUMB">3</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">na.r</span><span class="PUNC">,</span><span class="NAME">db</span><span class="PUNC">[</span><span class="NAME">Va</span><span class="PUNC">+</span><span class="NUMB">4</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">na.g</span><span class="PUNC">,</span><span class="NAME">db</span><span class="PUNC">[</span><span class="NAME">Va</span><span class="PUNC">+</span><span class="NUMB">5</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">na.b</span><span class="PUNC">,</span><span class="NAME">db</span><span class="PUNC">[</span><span class="NAME">Va</span><span class="PUNC">+</span><span class="NUMB">6</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">la.r</span><span class="PUNC">,</span><span class="NAME">db</span><span class="PUNC">[</span><span class="NAME">Va</span><span class="PUNC">+</span><span class="NUMB">7</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">la.g</span><span class="PUNC">,</span><span class="NAME">db</span><span class="PUNC">[</span><span class="NAME">Va</span><span class="PUNC">+</span><span class="NUMB">8</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">la.b</span><span class="PUNC">,</span><span class="NAME">Va</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NUMB">9</span><span class="PUNC">;</span><span class="NAME">E</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">D</span><span class="PUNC">=</span><span class="NAME">ta.length</span><span class="PUNC">;</span><span class="NAME">E</span><span class="PUNC">&lt;</span><span class="NAME">D</span><span class="PUNC">;</span><span class="NAME">E</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">Q</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>474</span> </span><span class="NAME">kb</span><span class="PUNC">[</span><span class="NAME">ta</span><span class="PUNC">[</span><span class="NAME">E</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">T</span><span class="PUNC">=</span><span class="NAME">Q.vertexColors</span><span class="PUNC">,</span><span class="NAME">X</span><span class="PUNC">=</span><span class="NAME">Q.color</span><span class="PUNC">,</span><span class="NUMB">4</span><span class="PUNC">===</span><span class="NAME">T.length</span><span class="PUNC">&&</span><span class="NAME">K</span><span class="PUNC">===</span><span class="NAME">THREE.VertexColors</span><span class="PUNC">?</span><span class="PUNC">(</span><span class="NAME">ka</span><span class="PUNC">=</span><span class="NAME">T</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">na</span><span class="PUNC">=</span><span class="NAME">T</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">la</span><span class="PUNC">=</span><span class="NAME">T</span><span class="PUNC">[</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">ua</span><span class="PUNC">=</span><span class="NAME">T</span><span class="PUNC">[</span><span class="NUMB">3</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">ua</span><span class="PUNC">=</span><span class="NAME">la</span><span class="PUNC">=</span><span class="NAME">na</span><span class="PUNC">=</span><span class="NAME">ka</span><span class="PUNC">=</span><span class="NAME">X</span><span class="PUNC">,</span><span class="NAME">db</span><span class="PUNC">[</span><span class="NAME">Va</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">ka.r</span><span class="PUNC">,</span><span class="NAME">db</span><span class="PUNC">[</span><span class="NAME">Va</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">ka.g</span><span class="PUNC">,</span><span class="NAME">db</span><span class="PUNC">[</span><span class="NAME">Va</span><span class="PUNC">+</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">ka.b</span><span class="PUNC">,</span><span class="NAME">db</span><span class="PUNC">[</span><span class="NAME">Va</span><span class="PUNC">+</span><span class="NUMB">3</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">na.r</span><span class="PUNC">,</span><span class="NAME">db</span><span class="PUNC">[</span><span class="NAME">Va</span><span class="PUNC">+</span><span class="NUMB">4</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">na.g</span><span class="PUNC">,</span><span class="NAME">db</span><span class="PUNC">[</span><span class="NAME">Va</span><span class="PUNC">+</span><span class="NUMB">5</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">na.b</span><span class="PUNC">,</span><span class="NAME">db</span><span class="PUNC">[</span><span class="NAME">Va</span><span class="PUNC">+</span><span class="NUMB">6</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">la.r</span><span class="PUNC">,</span><span class="NAME">db</span><span class="PUNC">[</span><span class="NAME">Va</span><span class="PUNC">+</span><span class="NUMB">7</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">la.g</span><span class="PUNC">,</span><span class="NAME">db</span><span class="PUNC">[</span><span class="NAME">Va</span><span class="PUNC">+</span><span class="NUMB">8</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">la.b</span><span class="PUNC">,</span><span class="NAME">db</span><span class="PUNC">[</span><span class="NAME">Va</span><span class="PUNC">+</span><span class="NUMB">9</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">ua.r</span><span class="PUNC">,</span><span class="NAME">db</span><span class="PUNC">[</span><span class="NAME">Va</span><span class="PUNC">+</span><span class="NUMB">10</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">ua.g</span><span class="PUNC">,</span><span class="NAME">db</span><span class="PUNC">[</span><span class="NAME">Va</span><span class="PUNC">+</span><span class="NUMB">11</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">ua.b</span><span class="PUNC">,</span><span class="NAME">Va</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NUMB">12</span><span class="PUNC">;</span><span class="NUMB">0</span><span class="PUNC">&lt;</span><span class="NAME">Va</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">k.bindBuffer</span><span class="PUNC">(</span><span class="NAME">k.ARRAY_BUFFER</span><span class="PUNC">,</span><span class="NAME">C.__webglColorBuffer</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">k.bufferData</span><span class="PUNC">(</span><span class="NAME">k.ARRAY_BUFFER</span><span class="PUNC">,</span><span class="NAME">db</span><span class="PUNC">,</span><span class="NAME">H</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">Sb</span><span class="PUNC">&&</span><span class="NAME">qb.hasTangents</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">E</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">D</span><span class="PUNC">=</span><span class="NAME">sa.length</span><span class="PUNC">;</span><span class="NAME">E</span><span class="PUNC">&lt;</span><span class="NAME">D</span><span class="PUNC">;</span><span class="NAME">E</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">Q</span><span class="PUNC">=</span><span class="NAME">kb</span><span class="PUNC">[</span><span class="NAME">sa</span><span class="PUNC">[</span><span class="NAME">E</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">qa</span><span class="PUNC">=</span><span class="NAME">Q.vertexTangents</span><span class="PUNC">,</span><span class="NAME">Z</span><span class="PUNC">=</span><span class="NAME">qa</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">da</span><span class="PUNC">=</span><span class="NAME">qa</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">ya</span><span class="PUNC">=</span><span class="NAME">qa</span><span class="PUNC">[</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">La</span><span class="PUNC">[</span><span class="NAME">Da</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>475</span> </span><span class="NAME">Z.x</span><span class="PUNC">,</span><span class="NAME">La</span><span class="PUNC">[</span><span class="NAME">Da</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">Z.y</span><span class="PUNC">,</span><span class="NAME">La</span><span class="PUNC">[</span><span class="NAME">Da</span><span class="PUNC">+</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">Z.z</span><span class="PUNC">,</span><span class="NAME">La</span><span class="PUNC">[</span><span class="NAME">Da</span><span class="PUNC">+</span><span class="NUMB">3</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">Z.w</span><span class="PUNC">,</span><span class="NAME">La</span><span class="PUNC">[</span><span class="NAME">Da</span><span class="PUNC">+</span><span class="NUMB">4</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">da.x</span><span class="PUNC">,</span><span class="NAME">La</span><span class="PUNC">[</span><span class="NAME">Da</span><span class="PUNC">+</span><span class="NUMB">5</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">da.y</span><span class="PUNC">,</span><span class="NAME">La</span><span class="PUNC">[</span><span class="NAME">Da</span><span class="PUNC">+</span><span class="NUMB">6</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">da.z</span><span class="PUNC">,</span><span class="NAME">La</span><span class="PUNC">[</span><span class="NAME">Da</span><span class="PUNC">+</span><span class="NUMB">7</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">da.w</span><span class="PUNC">,</span><span class="NAME">La</span><span class="PUNC">[</span><span class="NAME">Da</span><span class="PUNC">+</span><span class="NUMB">8</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">ya.x</span><span class="PUNC">,</span><span class="NAME">La</span><span class="PUNC">[</span><span class="NAME">Da</span><span class="PUNC">+</span><span class="NUMB">9</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">ya.y</span><span class="PUNC">,</span><span class="NAME">La</span><span class="PUNC">[</span><span class="NAME">Da</span><span class="PUNC">+</span><span class="NUMB">10</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">ya.z</span><span class="PUNC">,</span><span class="NAME">La</span><span class="PUNC">[</span><span class="NAME">Da</span><span class="PUNC">+</span><span class="NUMB">11</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">ya.w</span><span class="PUNC">,</span><span class="NAME">Da</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NUMB">12</span><span class="PUNC">;</span><span class="NAME">E</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">D</span><span class="PUNC">=</span><span class="NAME">ta.length</span><span class="PUNC">;</span><span class="NAME">E</span><span class="PUNC">&lt;</span><span class="NAME">D</span><span class="PUNC">;</span><span class="NAME">E</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">Q</span><span class="PUNC">=</span><span class="NAME">kb</span><span class="PUNC">[</span><span class="NAME">ta</span><span class="PUNC">[</span><span class="NAME">E</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">qa</span><span class="PUNC">=</span><span class="NAME">Q.vertexTangents</span><span class="PUNC">,</span><span class="NAME">Z</span><span class="PUNC">=</span><span class="NAME">qa</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">da</span><span class="PUNC">=</span><span class="NAME">qa</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">ya</span><span class="PUNC">=</span><span class="NAME">qa</span><span class="PUNC">[</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">ja</span><span class="PUNC">=</span><span class="NAME">qa</span><span class="PUNC">[</span><span class="NUMB">3</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">La</span><span class="PUNC">[</span><span class="NAME">Da</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">Z.x</span><span class="PUNC">,</span><span class="NAME">La</span><span class="PUNC">[</span><span class="NAME">Da</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">Z.y</span><span class="PUNC">,</span><span class="NAME">La</span><span class="PUNC">[</span><span class="NAME">Da</span><span class="PUNC">+</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">Z.z</span><span class="PUNC">,</span><span class="NAME">La</span><span class="PUNC">[</span><span class="NAME">Da</span><span class="PUNC">+</span><span class="NUMB">3</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">Z.w</span><span class="PUNC">,</span><span class="NAME">La</span><span class="PUNC">[</span><span class="NAME">Da</span><span class="PUNC">+</span><span class="NUMB">4</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">da.x</span><span class="PUNC">,</span><span class="NAME">La</span><span class="PUNC">[</span><span class="NAME">Da</span><span class="PUNC">+</span><span class="NUMB">5</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">da.y</span><span class="PUNC">,</span><span class="NAME">La</span><span class="PUNC">[</span><span class="NAME">Da</span><span class="PUNC">+</span><span class="NUMB">6</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">da.z</span><span class="PUNC">,</span><span class="NAME">La</span><span class="PUNC">[</span><span class="NAME">Da</span><span class="PUNC">+</span><span class="NUMB">7</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">da.w</span><span class="PUNC">,</span><span class="NAME">La</span><span class="PUNC">[</span><span class="NAME">Da</span><span class="PUNC">+</span><span class="NUMB">8</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">ya.x</span><span class="PUNC">,</span><span class="NAME">La</span><span class="PUNC">[</span><span class="NAME">Da</span><span class="PUNC">+</span><span class="NUMB">9</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">ya.y</span><span class="PUNC">,</span><span class="NAME">La</span><span class="PUNC">[</span><span class="NAME">Da</span><span class="PUNC">+</span><span class="NUMB">10</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">ya.z</span><span class="PUNC">,</span><span class="NAME">La</span><span class="PUNC">[</span><span class="NAME">Da</span><span class="PUNC">+</span><span class="NUMB">11</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">ya.w</span><span class="PUNC">,</span><span class="NAME">La</span><span class="PUNC">[</span><span class="NAME">Da</span><span class="PUNC">+</span><span class="NUMB">12</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">ja.x</span><span class="PUNC">,</span><span class="NAME">La</span><span class="PUNC">[</span><span class="NAME">Da</span><span class="PUNC">+</span><span class="NUMB">13</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">ja.y</span><span class="PUNC">,</span><span class="NAME">La</span><span class="PUNC">[</span><span class="NAME">Da</span><span class="PUNC">+</span><span class="NUMB">14</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">ja.z</span><span class="PUNC">,</span><span class="NAME">La</span><span class="PUNC">[</span><span class="NAME">Da</span><span class="PUNC">+</span><span class="NUMB">15</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">ja.w</span><span class="PUNC">,</span><span class="NAME">Da</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NUMB">16</span><span class="PUNC">;</span><span class="NAME">k.bindBuffer</span><span class="PUNC">(</span><span class="NAME">k.ARRAY_BUFFER</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>476</span> </span><span class="NAME">C.__webglTangentBuffer</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">k.bufferData</span><span class="PUNC">(</span><span class="NAME">k.ARRAY_BUFFER</span><span class="PUNC">,</span><span class="NAME">La</span><span class="PUNC">,</span><span class="NAME">H</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">Rb</span><span class="PUNC">&&</span><span class="NAME">V</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">E</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">D</span><span class="PUNC">=</span><span class="NAME">sa.length</span><span class="PUNC">;</span><span class="NAME">E</span><span class="PUNC">&lt;</span><span class="NAME">D</span><span class="PUNC">;</span><span class="NAME">E</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">Q</span><span class="PUNC">=</span><span class="NAME">kb</span><span class="PUNC">[</span><span class="NAME">sa</span><span class="PUNC">[</span><span class="NAME">E</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">O</span><span class="PUNC">=</span><span class="NAME">Q.vertexNormals</span><span class="PUNC">,</span><span class="NAME">ea</span><span class="PUNC">=</span><span class="NAME">Q.normal</span><span class="PUNC">,</span><span class="NUMB">3</span><span class="PUNC">===</span><span class="NAME">O.length</span><span class="PUNC">&&</span><span class="NAME">M</span><span class="PUNC">)</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">za</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NUMB">3</span><span class="PUNC">></span><span class="NAME">za</span><span class="PUNC">;</span><span class="NAME">za</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">Fa</span><span class="PUNC">=</span><span class="NAME">O</span><span class="PUNC">[</span><span class="NAME">za</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">Sa</span><span class="PUNC">[</span><span class="NAME">jb</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">Fa.x</span><span class="PUNC">,</span><span class="NAME">Sa</span><span class="PUNC">[</span><span class="NAME">jb</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">Fa.y</span><span class="PUNC">,</span><span class="NAME">Sa</span><span class="PUNC">[</span><span class="NAME">jb</span><span class="PUNC">+</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">Fa.z</span><span class="PUNC">,</span><span class="NAME">jb</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NUMB">3</span><span class="PUNC">;</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">za</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NUMB">3</span><span class="PUNC">></span><span class="NAME">za</span><span class="PUNC">;</span><span class="NAME">za</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">Sa</span><span class="PUNC">[</span><span class="NAME">jb</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">ea.x</span><span class="PUNC">,</span><span class="NAME">Sa</span><span class="PUNC">[</span><span class="NAME">jb</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">ea.y</span><span class="PUNC">,</span><span class="NAME">Sa</span><span class="PUNC">[</span><span class="NAME">jb</span><span class="PUNC">+</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">ea.z</span><span class="PUNC">,</span><span class="NAME">jb</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NUMB">3</span><span class="PUNC">;</span><span class="NAME">E</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">D</span><span class="PUNC">=</span><span class="NAME">ta.length</span><span class="PUNC">;</span><span class="NAME">E</span><span class="PUNC">&lt;</span><span class="NAME">D</span><span class="PUNC">;</span><span class="NAME">E</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">Q</span><span class="PUNC">=</span><span class="NAME">kb</span><span class="PUNC">[</span><span class="NAME">ta</span><span class="PUNC">[</span><span class="NAME">E</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">O</span><span class="PUNC">=</span><span class="NAME">Q.vertexNormals</span><span class="PUNC">,</span><span class="NAME">ea</span><span class="PUNC">=</span><span class="NAME">Q.normal</span><span class="PUNC">,</span><span class="NUMB">4</span><span class="PUNC">===</span><span class="NAME">O.length</span><span class="PUNC">&&</span><span class="NAME">M</span><span class="PUNC">)</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">za</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NUMB">4</span><span class="PUNC">></span><span class="NAME">za</span><span class="PUNC">;</span><span class="NAME">za</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">Fa</span><span class="PUNC">=</span><span class="NAME">O</span><span class="PUNC">[</span><span class="NAME">za</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">Sa</span><span class="PUNC">[</span><span class="NAME">jb</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">Fa.x</span><span class="PUNC">,</span><span class="NAME">Sa</span><span class="PUNC">[</span><span class="NAME">jb</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">Fa.y</span><span class="PUNC">,</span><span class="NAME">Sa</span><span class="PUNC">[</span><span class="NAME">jb</span><span class="PUNC">+</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">Fa.z</span><span class="PUNC">,</span><span class="NAME">jb</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NUMB">3</span><span class="PUNC">;</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">za</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NUMB">4</span><span class="PUNC">></span><span class="NAME">za</span><span class="PUNC">;</span><span class="NAME">za</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">Sa</span><span class="PUNC">[</span><span class="NAME">jb</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">ea.x</span><span class="PUNC">,</span><span class="NAME">Sa</span><span class="PUNC">[</span><span class="NAME">jb</span><span class="PUNC">+</span><span class="WHIT">
<span class='line'>477</span> </span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">ea.y</span><span class="PUNC">,</span><span class="NAME">Sa</span><span class="PUNC">[</span><span class="NAME">jb</span><span class="PUNC">+</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">ea.z</span><span class="PUNC">,</span><span class="NAME">jb</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NUMB">3</span><span class="PUNC">;</span><span class="NAME">k.bindBuffer</span><span class="PUNC">(</span><span class="NAME">k.ARRAY_BUFFER</span><span class="PUNC">,</span><span class="NAME">C.__webglNormalBuffer</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">k.bufferData</span><span class="PUNC">(</span><span class="NAME">k.ARRAY_BUFFER</span><span class="PUNC">,</span><span class="NAME">Sa</span><span class="PUNC">,</span><span class="NAME">H</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">Hb</span><span class="PUNC">&&</span><span class="NAME">Jb</span><span class="PUNC">&&</span><span class="NAME">L</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">E</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">D</span><span class="PUNC">=</span><span class="NAME">sa.length</span><span class="PUNC">;</span><span class="NAME">E</span><span class="PUNC">&lt;</span><span class="NAME">D</span><span class="PUNC">;</span><span class="NAME">E</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">N</span><span class="PUNC">=</span><span class="NAME">sa</span><span class="PUNC">[</span><span class="NAME">E</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">fa</span><span class="PUNC">=</span><span class="NAME">Jb</span><span class="PUNC">[</span><span class="NAME">N</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">fa</span><span class="PUNC">)</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">za</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NUMB">3</span><span class="PUNC">></span><span class="NAME">za</span><span class="PUNC">;</span><span class="NAME">za</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">Pa</span><span class="PUNC">=</span><span class="NAME">fa</span><span class="PUNC">[</span><span class="NAME">za</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">fb</span><span class="PUNC">[</span><span class="NAME">Wa</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">Pa.x</span><span class="PUNC">,</span><span class="NAME">fb</span><span class="PUNC">[</span><span class="NAME">Wa</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">Pa.y</span><span class="PUNC">,</span><span class="NAME">Wa</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NUMB">2</span><span class="PUNC">;</span><span class="NAME">E</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">D</span><span class="PUNC">=</span><span class="NAME">ta.length</span><span class="PUNC">;</span><span class="NAME">E</span><span class="PUNC">&lt;</span><span class="NAME">D</span><span class="PUNC">;</span><span class="NAME">E</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">N</span><span class="PUNC">=</span><span class="NAME">ta</span><span class="PUNC">[</span><span class="NAME">E</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">fa</span><span class="PUNC">=</span><span class="NAME">Jb</span><span class="PUNC">[</span><span class="NAME">N</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">fa</span><span class="PUNC">)</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">za</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NUMB">4</span><span class="PUNC">></span><span class="NAME">za</span><span class="PUNC">;</span><span class="NAME">za</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">Pa</span><span class="PUNC">=</span><span class="NAME">fa</span><span class="PUNC">[</span><span class="NAME">za</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">fb</span><span class="PUNC">[</span><span class="NAME">Wa</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">Pa.x</span><span class="PUNC">,</span><span class="NAME">fb</span><span class="PUNC">[</span><span class="NAME">Wa</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">Pa.y</span><span class="PUNC">,</span><span class="NAME">Wa</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NUMB">2</span><span class="PUNC">;</span><span class="NUMB">0</span><span class="PUNC">&lt;</span><span class="NAME">Wa</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">k.bindBuffer</span><span class="PUNC">(</span><span class="NAME">k.ARRAY_BUFFER</span><span class="PUNC">,</span><span class="NAME">C.__webglUVBuffer</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">k.bufferData</span><span class="PUNC">(</span><span class="NAME">k.ARRAY_BUFFER</span><span class="PUNC">,</span><span class="NAME">fb</span><span class="PUNC">,</span><span class="NAME">H</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">Hb</span><span class="PUNC">&&</span><span class="NAME">Lb</span><span class="PUNC">&&</span><span class="NAME">L</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">E</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">D</span><span class="PUNC">=</span><span class="NAME">sa.length</span><span class="PUNC">;</span><span class="NAME">E</span><span class="PUNC">&lt;</span><span class="NAME">D</span><span class="PUNC">;</span><span class="NAME">E</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">N</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>478</span> </span><span class="NAME">sa</span><span class="PUNC">[</span><span class="NAME">E</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">aa</span><span class="PUNC">=</span><span class="NAME">Lb</span><span class="PUNC">[</span><span class="NAME">N</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">aa</span><span class="PUNC">)</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">za</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NUMB">3</span><span class="PUNC">></span><span class="NAME">za</span><span class="PUNC">;</span><span class="NAME">za</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">Ra</span><span class="PUNC">=</span><span class="NAME">aa</span><span class="PUNC">[</span><span class="NAME">za</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">ib</span><span class="PUNC">[</span><span class="NAME">Xa</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">Ra.x</span><span class="PUNC">,</span><span class="NAME">ib</span><span class="PUNC">[</span><span class="NAME">Xa</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">Ra.y</span><span class="PUNC">,</span><span class="NAME">Xa</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NUMB">2</span><span class="PUNC">;</span><span class="NAME">E</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">D</span><span class="PUNC">=</span><span class="NAME">ta.length</span><span class="PUNC">;</span><span class="NAME">E</span><span class="PUNC">&lt;</span><span class="NAME">D</span><span class="PUNC">;</span><span class="NAME">E</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">N</span><span class="PUNC">=</span><span class="NAME">ta</span><span class="PUNC">[</span><span class="NAME">E</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">aa</span><span class="PUNC">=</span><span class="NAME">Lb</span><span class="PUNC">[</span><span class="NAME">N</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">aa</span><span class="PUNC">)</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">za</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NUMB">4</span><span class="PUNC">></span><span class="NAME">za</span><span class="PUNC">;</span><span class="NAME">za</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">Ra</span><span class="PUNC">=</span><span class="NAME">aa</span><span class="PUNC">[</span><span class="NAME">za</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">ib</span><span class="PUNC">[</span><span class="NAME">Xa</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">Ra.x</span><span class="PUNC">,</span><span class="NAME">ib</span><span class="PUNC">[</span><span class="NAME">Xa</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">Ra.y</span><span class="PUNC">,</span><span class="NAME">Xa</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NUMB">2</span><span class="PUNC">;</span><span class="NUMB">0</span><span class="PUNC">&lt;</span><span class="NAME">Xa</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">k.bindBuffer</span><span class="PUNC">(</span><span class="NAME">k.ARRAY_BUFFER</span><span class="PUNC">,</span><span class="NAME">C.__webglUV2Buffer</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">k.bufferData</span><span class="PUNC">(</span><span class="NAME">k.ARRAY_BUFFER</span><span class="PUNC">,</span><span class="NAME">ib</span><span class="PUNC">,</span><span class="NAME">H</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">Gb</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">E</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">D</span><span class="PUNC">=</span><span class="NAME">sa.length</span><span class="PUNC">;</span><span class="NAME">E</span><span class="PUNC">&lt;</span><span class="NAME">D</span><span class="PUNC">;</span><span class="NAME">E</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">Mb</span><span class="PUNC">[</span><span class="NAME">Ka</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">Ta</span><span class="PUNC">,</span><span class="NAME">Mb</span><span class="PUNC">[</span><span class="NAME">Ka</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">Ta</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">Mb</span><span class="PUNC">[</span><span class="NAME">Ka</span><span class="PUNC">+</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">Ta</span><span class="PUNC">+</span><span class="NUMB">2</span><span class="PUNC">,</span><span class="NAME">Ka</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NUMB">3</span><span class="PUNC">,</span><span class="NAME">wb</span><span class="PUNC">[</span><span class="NAME">ob</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">Ta</span><span class="PUNC">,</span><span class="NAME">wb</span><span class="PUNC">[</span><span class="NAME">ob</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">Ta</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">wb</span><span class="PUNC">[</span><span class="NAME">ob</span><span class="PUNC">+</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">Ta</span><span class="PUNC">,</span><span class="NAME">wb</span><span class="PUNC">[</span><span class="NAME">ob</span><span class="PUNC">+</span><span class="NUMB">3</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">Ta</span><span class="PUNC">+</span><span class="NUMB">2</span><span class="PUNC">,</span><span class="NAME">wb</span><span class="PUNC">[</span><span class="NAME">ob</span><span class="PUNC">+</span><span class="NUMB">4</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">Ta</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">wb</span><span class="PUNC">[</span><span class="NAME">ob</span><span class="PUNC">+</span><span class="NUMB">5</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">Ta</span><span class="PUNC">+</span><span class="NUMB">2</span><span class="PUNC">,</span><span class="NAME">ob</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NUMB">6</span><span class="PUNC">,</span><span class="NAME">Ta</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NUMB">3</span><span class="PUNC">;</span><span class="NAME">E</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">D</span><span class="PUNC">=</span><span class="NAME">ta.length</span><span class="PUNC">;</span><span class="NAME">E</span><span class="PUNC">&lt;</span><span class="NAME">D</span><span class="PUNC">;</span><span class="NAME">E</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">Mb</span><span class="PUNC">[</span><span class="NAME">Ka</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>479</span> </span><span class="NAME">Ta</span><span class="PUNC">,</span><span class="NAME">Mb</span><span class="PUNC">[</span><span class="NAME">Ka</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">Ta</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">Mb</span><span class="PUNC">[</span><span class="NAME">Ka</span><span class="PUNC">+</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">Ta</span><span class="PUNC">+</span><span class="NUMB">3</span><span class="PUNC">,</span><span class="NAME">Mb</span><span class="PUNC">[</span><span class="NAME">Ka</span><span class="PUNC">+</span><span class="NUMB">3</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">Ta</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">Mb</span><span class="PUNC">[</span><span class="NAME">Ka</span><span class="PUNC">+</span><span class="NUMB">4</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">Ta</span><span class="PUNC">+</span><span class="NUMB">2</span><span class="PUNC">,</span><span class="NAME">Mb</span><span class="PUNC">[</span><span class="NAME">Ka</span><span class="PUNC">+</span><span class="NUMB">5</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">Ta</span><span class="PUNC">+</span><span class="NUMB">3</span><span class="PUNC">,</span><span class="NAME">Ka</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NUMB">6</span><span class="PUNC">,</span><span class="NAME">wb</span><span class="PUNC">[</span><span class="NAME">ob</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">Ta</span><span class="PUNC">,</span><span class="NAME">wb</span><span class="PUNC">[</span><span class="NAME">ob</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">Ta</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">wb</span><span class="PUNC">[</span><span class="NAME">ob</span><span class="PUNC">+</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">Ta</span><span class="PUNC">,</span><span class="NAME">wb</span><span class="PUNC">[</span><span class="NAME">ob</span><span class="PUNC">+</span><span class="NUMB">3</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">Ta</span><span class="PUNC">+</span><span class="NUMB">3</span><span class="PUNC">,</span><span class="NAME">wb</span><span class="PUNC">[</span><span class="NAME">ob</span><span class="PUNC">+</span><span class="NUMB">4</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">Ta</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">wb</span><span class="PUNC">[</span><span class="NAME">ob</span><span class="PUNC">+</span><span class="NUMB">5</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">Ta</span><span class="PUNC">+</span><span class="NUMB">2</span><span class="PUNC">,</span><span class="NAME">wb</span><span class="PUNC">[</span><span class="NAME">ob</span><span class="PUNC">+</span><span class="NUMB">6</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">Ta</span><span class="PUNC">+</span><span class="NUMB">2</span><span class="PUNC">,</span><span class="NAME">wb</span><span class="PUNC">[</span><span class="NAME">ob</span><span class="PUNC">+</span><span class="NUMB">7</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">Ta</span><span class="PUNC">+</span><span class="NUMB">3</span><span class="PUNC">,</span><span class="NAME">ob</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NUMB">8</span><span class="PUNC">,</span><span class="NAME">Ta</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NUMB">4</span><span class="PUNC">;</span><span class="NAME">k.bindBuffer</span><span class="PUNC">(</span><span class="NAME">k.ELEMENT_ARRAY_BUFFER</span><span class="PUNC">,</span><span class="NAME">C.__webglFaceBuffer</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">k.bufferData</span><span class="PUNC">(</span><span class="NAME">k.ELEMENT_ARRAY_BUFFER</span><span class="PUNC">,</span><span class="NAME">Mb</span><span class="PUNC">,</span><span class="NAME">H</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">k.bindBuffer</span><span class="PUNC">(</span><span class="NAME">k.ELEMENT_ARRAY_BUFFER</span><span class="PUNC">,</span><span class="NAME">C.__webglLineBuffer</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">k.bufferData</span><span class="PUNC">(</span><span class="NAME">k.ELEMENT_ARRAY_BUFFER</span><span class="PUNC">,</span><span class="NAME">wb</span><span class="PUNC">,</span><span class="NAME">H</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">Bb</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">za</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">ub</span><span class="PUNC">=</span><span class="NAME">Bb.length</span><span class="PUNC">;</span><span class="NAME">za</span><span class="PUNC">&lt;</span><span class="NAME">ub</span><span class="PUNC">;</span><span class="NAME">za</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">u</span><span class="PUNC">=</span><span class="NAME">Bb</span><span class="PUNC">[</span><span class="NAME">za</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">u.__original.needsUpdate</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">x</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NUMB">1</span><span class="PUNC">===</span><span class="NAME">u.size</span><span class="PUNC">)</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">===</span><span class="WHIT">
<span class='line'>480</span> </span><span class="NAME">u.boundTo</span><span class="PUNC">||</span><span class="STRN">"vertices"</span><span class="PUNC">===</span><span class="NAME">u.boundTo</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">E</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">D</span><span class="PUNC">=</span><span class="NAME">sa.length</span><span class="PUNC">;</span><span class="NAME">E</span><span class="PUNC">&lt;</span><span class="NAME">D</span><span class="PUNC">;</span><span class="NAME">E</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">Q</span><span class="PUNC">=</span><span class="NAME">kb</span><span class="PUNC">[</span><span class="NAME">sa</span><span class="PUNC">[</span><span class="NAME">E</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">u.array</span><span class="PUNC">[</span><span class="NAME">x</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">u.value</span><span class="PUNC">[</span><span class="NAME">Q.a</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">u.array</span><span class="PUNC">[</span><span class="NAME">x</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">u.value</span><span class="PUNC">[</span><span class="NAME">Q.b</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">u.array</span><span class="PUNC">[</span><span class="NAME">x</span><span class="PUNC">+</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">u.value</span><span class="PUNC">[</span><span class="NAME">Q.c</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">x</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NUMB">3</span><span class="PUNC">;</span><span class="NAME">E</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">D</span><span class="PUNC">=</span><span class="NAME">ta.length</span><span class="PUNC">;</span><span class="NAME">E</span><span class="PUNC">&lt;</span><span class="NAME">D</span><span class="PUNC">;</span><span class="NAME">E</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">Q</span><span class="PUNC">=</span><span class="NAME">kb</span><span class="PUNC">[</span><span class="NAME">ta</span><span class="PUNC">[</span><span class="NAME">E</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">u.array</span><span class="PUNC">[</span><span class="NAME">x</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">u.value</span><span class="PUNC">[</span><span class="NAME">Q.a</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">u.array</span><span class="PUNC">[</span><span class="NAME">x</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">u.value</span><span class="PUNC">[</span><span class="NAME">Q.b</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">u.array</span><span class="PUNC">[</span><span class="NAME">x</span><span class="PUNC">+</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">u.value</span><span class="PUNC">[</span><span class="NAME">Q.c</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">u.array</span><span class="PUNC">[</span><span class="NAME">x</span><span class="PUNC">+</span><span class="NUMB">3</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">u.value</span><span class="PUNC">[</span><span class="NAME">Q.d</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">x</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NUMB">4</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="STRN">"faces"</span><span class="PUNC">===</span><span class="NAME">u.boundTo</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">E</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">D</span><span class="PUNC">=</span><span class="NAME">sa.length</span><span class="PUNC">;</span><span class="NAME">E</span><span class="PUNC">&lt;</span><span class="NAME">D</span><span class="PUNC">;</span><span class="NAME">E</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">Aa</span><span class="PUNC">=</span><span class="NAME">u.value</span><span class="PUNC">[</span><span class="NAME">sa</span><span class="PUNC">[</span><span class="NAME">E</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">u.array</span><span class="PUNC">[</span><span class="NAME">x</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">Aa</span><span class="PUNC">,</span><span class="NAME">u.array</span><span class="PUNC">[</span><span class="NAME">x</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">Aa</span><span class="PUNC">,</span><span class="NAME">u.array</span><span class="PUNC">[</span><span class="NAME">x</span><span class="PUNC">+</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">Aa</span><span class="PUNC">,</span><span class="NAME">x</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NUMB">3</span><span class="PUNC">;</span><span class="NAME">E</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">D</span><span class="PUNC">=</span><span class="NAME">ta.length</span><span class="PUNC">;</span><span class="NAME">E</span><span class="PUNC">&lt;</span><span class="NAME">D</span><span class="PUNC">;</span><span class="NAME">E</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">Aa</span><span class="PUNC">=</span><span class="NAME">u.value</span><span class="PUNC">[</span><span class="NAME">ta</span><span class="PUNC">[</span><span class="NAME">E</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">u.array</span><span class="PUNC">[</span><span class="NAME">x</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">Aa</span><span class="PUNC">,</span><span class="NAME">u.array</span><span class="PUNC">[</span><span class="NAME">x</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>481</span> </span><span class="NAME">Aa</span><span class="PUNC">,</span><span class="NAME">u.array</span><span class="PUNC">[</span><span class="NAME">x</span><span class="PUNC">+</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">Aa</span><span class="PUNC">,</span><span class="NAME">u.array</span><span class="PUNC">[</span><span class="NAME">x</span><span class="PUNC">+</span><span class="NUMB">3</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">Aa</span><span class="PUNC">,</span><span class="NAME">x</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NUMB">4</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NUMB">2</span><span class="PUNC">===</span><span class="NAME">u.size</span><span class="PUNC">)</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">===</span><span class="NAME">u.boundTo</span><span class="PUNC">||</span><span class="STRN">"vertices"</span><span class="PUNC">===</span><span class="NAME">u.boundTo</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">E</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">D</span><span class="PUNC">=</span><span class="NAME">sa.length</span><span class="PUNC">;</span><span class="NAME">E</span><span class="PUNC">&lt;</span><span class="NAME">D</span><span class="PUNC">;</span><span class="NAME">E</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">Q</span><span class="PUNC">=</span><span class="NAME">kb</span><span class="PUNC">[</span><span class="NAME">sa</span><span class="PUNC">[</span><span class="NAME">E</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">R</span><span class="PUNC">=</span><span class="NAME">u.value</span><span class="PUNC">[</span><span class="NAME">Q.a</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">S</span><span class="PUNC">=</span><span class="NAME">u.value</span><span class="PUNC">[</span><span class="NAME">Q.b</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">P</span><span class="PUNC">=</span><span class="NAME">u.value</span><span class="PUNC">[</span><span class="NAME">Q.c</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">u.array</span><span class="PUNC">[</span><span class="NAME">x</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">R.x</span><span class="PUNC">,</span><span class="NAME">u.array</span><span class="PUNC">[</span><span class="NAME">x</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">R.y</span><span class="PUNC">,</span><span class="NAME">u.array</span><span class="PUNC">[</span><span class="NAME">x</span><span class="PUNC">+</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">S.x</span><span class="PUNC">,</span><span class="NAME">u.array</span><span class="PUNC">[</span><span class="NAME">x</span><span class="PUNC">+</span><span class="NUMB">3</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">S.y</span><span class="PUNC">,</span><span class="NAME">u.array</span><span class="PUNC">[</span><span class="NAME">x</span><span class="PUNC">+</span><span class="NUMB">4</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">P.x</span><span class="PUNC">,</span><span class="NAME">u.array</span><span class="PUNC">[</span><span class="NAME">x</span><span class="PUNC">+</span><span class="NUMB">5</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">P.y</span><span class="PUNC">,</span><span class="NAME">x</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NUMB">6</span><span class="PUNC">;</span><span class="NAME">E</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">D</span><span class="PUNC">=</span><span class="NAME">ta.length</span><span class="PUNC">;</span><span class="NAME">E</span><span class="PUNC">&lt;</span><span class="NAME">D</span><span class="PUNC">;</span><span class="NAME">E</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">Q</span><span class="PUNC">=</span><span class="NAME">kb</span><span class="PUNC">[</span><span class="NAME">ta</span><span class="PUNC">[</span><span class="NAME">E</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">R</span><span class="PUNC">=</span><span class="NAME">u.value</span><span class="PUNC">[</span><span class="NAME">Q.a</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">S</span><span class="PUNC">=</span><span class="NAME">u.value</span><span class="PUNC">[</span><span class="NAME">Q.b</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">P</span><span class="PUNC">=</span><span class="NAME">u.value</span><span class="PUNC">[</span><span class="NAME">Q.c</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">ba</span><span class="PUNC">=</span><span class="NAME">u.value</span><span class="PUNC">[</span><span class="NAME">Q.d</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">u.array</span><span class="PUNC">[</span><span class="NAME">x</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">R.x</span><span class="PUNC">,</span><span class="NAME">u.array</span><span class="PUNC">[</span><span class="NAME">x</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">R.y</span><span class="PUNC">,</span><span class="NAME">u.array</span><span class="PUNC">[</span><span class="NAME">x</span><span class="PUNC">+</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">S.x</span><span class="PUNC">,</span><span class="NAME">u.array</span><span class="PUNC">[</span><span class="NAME">x</span><span class="PUNC">+</span><span class="NUMB">3</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">S.y</span><span class="PUNC">,</span><span class="NAME">u.array</span><span class="PUNC">[</span><span class="NAME">x</span><span class="PUNC">+</span><span class="NUMB">4</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">P.x</span><span class="PUNC">,</span><span class="NAME">u.array</span><span class="PUNC">[</span><span class="NAME">x</span><span class="PUNC">+</span><span class="NUMB">5</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">P.y</span><span class="PUNC">,</span><span class="NAME">u.array</span><span class="PUNC">[</span><span class="NAME">x</span><span class="PUNC">+</span><span class="WHIT">
<span class='line'>482</span> </span><span class="NUMB">6</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">ba.x</span><span class="PUNC">,</span><span class="NAME">u.array</span><span class="PUNC">[</span><span class="NAME">x</span><span class="PUNC">+</span><span class="NUMB">7</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">ba.y</span><span class="PUNC">,</span><span class="NAME">x</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NUMB">8</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="STRN">"faces"</span><span class="PUNC">===</span><span class="NAME">u.boundTo</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">E</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">D</span><span class="PUNC">=</span><span class="NAME">sa.length</span><span class="PUNC">;</span><span class="NAME">E</span><span class="PUNC">&lt;</span><span class="NAME">D</span><span class="PUNC">;</span><span class="NAME">E</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">P</span><span class="PUNC">=</span><span class="NAME">S</span><span class="PUNC">=</span><span class="NAME">R</span><span class="PUNC">=</span><span class="NAME">Aa</span><span class="PUNC">=</span><span class="NAME">u.value</span><span class="PUNC">[</span><span class="NAME">sa</span><span class="PUNC">[</span><span class="NAME">E</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">u.array</span><span class="PUNC">[</span><span class="NAME">x</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">R.x</span><span class="PUNC">,</span><span class="NAME">u.array</span><span class="PUNC">[</span><span class="NAME">x</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">R.y</span><span class="PUNC">,</span><span class="NAME">u.array</span><span class="PUNC">[</span><span class="NAME">x</span><span class="PUNC">+</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">S.x</span><span class="PUNC">,</span><span class="NAME">u.array</span><span class="PUNC">[</span><span class="NAME">x</span><span class="PUNC">+</span><span class="NUMB">3</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">S.y</span><span class="PUNC">,</span><span class="NAME">u.array</span><span class="PUNC">[</span><span class="NAME">x</span><span class="PUNC">+</span><span class="NUMB">4</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">P.x</span><span class="PUNC">,</span><span class="NAME">u.array</span><span class="PUNC">[</span><span class="NAME">x</span><span class="PUNC">+</span><span class="NUMB">5</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">P.y</span><span class="PUNC">,</span><span class="NAME">x</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NUMB">6</span><span class="PUNC">;</span><span class="NAME">E</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">D</span><span class="PUNC">=</span><span class="NAME">ta.length</span><span class="PUNC">;</span><span class="NAME">E</span><span class="PUNC">&lt;</span><span class="NAME">D</span><span class="PUNC">;</span><span class="NAME">E</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">ba</span><span class="PUNC">=</span><span class="NAME">P</span><span class="PUNC">=</span><span class="NAME">S</span><span class="PUNC">=</span><span class="NAME">R</span><span class="PUNC">=</span><span class="NAME">Aa</span><span class="PUNC">=</span><span class="NAME">u.value</span><span class="PUNC">[</span><span class="NAME">ta</span><span class="PUNC">[</span><span class="NAME">E</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">u.array</span><span class="PUNC">[</span><span class="NAME">x</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">R.x</span><span class="PUNC">,</span><span class="NAME">u.array</span><span class="PUNC">[</span><span class="NAME">x</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">R.y</span><span class="PUNC">,</span><span class="NAME">u.array</span><span class="PUNC">[</span><span class="NAME">x</span><span class="PUNC">+</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">S.x</span><span class="PUNC">,</span><span class="NAME">u.array</span><span class="PUNC">[</span><span class="NAME">x</span><span class="PUNC">+</span><span class="NUMB">3</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">S.y</span><span class="PUNC">,</span><span class="NAME">u.array</span><span class="PUNC">[</span><span class="NAME">x</span><span class="PUNC">+</span><span class="NUMB">4</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">P.x</span><span class="PUNC">,</span><span class="NAME">u.array</span><span class="PUNC">[</span><span class="NAME">x</span><span class="PUNC">+</span><span class="NUMB">5</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">P.y</span><span class="PUNC">,</span><span class="NAME">u.array</span><span class="PUNC">[</span><span class="NAME">x</span><span class="PUNC">+</span><span class="NUMB">6</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">ba.x</span><span class="PUNC">,</span><span class="NAME">u.array</span><span class="PUNC">[</span><span class="NAME">x</span><span class="PUNC">+</span><span class="NUMB">7</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">ba.y</span><span class="PUNC">,</span><span class="NAME">x</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NUMB">8</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NUMB">3</span><span class="PUNC">===</span><span class="NAME">u.size</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">W</span><span class="PUNC">;</span><span class="NAME">W</span><span class="PUNC">=</span><span class="STRN">"c"</span><span class="PUNC">===</span><span class="NAME">u.type</span><span class="PUNC">?</span><span class="PUNC">[</span><span class="STRN">"r"</span><span class="PUNC">,</span><span class="STRN">"g"</span><span class="PUNC">,</span><span class="STRN">"b"</span><span class="PUNC">]</span><span class="PUNC">:</span><span class="PUNC">[</span><span class="STRN">"x"</span><span class="PUNC">,</span><span class="STRN">"y"</span><span class="PUNC">,</span><span class="STRN">"z"</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">===</span><span class="NAME">u.boundTo</span><span class="PUNC">||</span><span class="WHIT">
<span class='line'>483</span> </span><span class="STRN">"vertices"</span><span class="PUNC">===</span><span class="NAME">u.boundTo</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">E</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">D</span><span class="PUNC">=</span><span class="NAME">sa.length</span><span class="PUNC">;</span><span class="NAME">E</span><span class="PUNC">&lt;</span><span class="NAME">D</span><span class="PUNC">;</span><span class="NAME">E</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">Q</span><span class="PUNC">=</span><span class="NAME">kb</span><span class="PUNC">[</span><span class="NAME">sa</span><span class="PUNC">[</span><span class="NAME">E</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">R</span><span class="PUNC">=</span><span class="NAME">u.value</span><span class="PUNC">[</span><span class="NAME">Q.a</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">S</span><span class="PUNC">=</span><span class="NAME">u.value</span><span class="PUNC">[</span><span class="NAME">Q.b</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">P</span><span class="PUNC">=</span><span class="NAME">u.value</span><span class="PUNC">[</span><span class="NAME">Q.c</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">u.array</span><span class="PUNC">[</span><span class="NAME">x</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">R</span><span class="PUNC">[</span><span class="NAME">W</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">u.array</span><span class="PUNC">[</span><span class="NAME">x</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">R</span><span class="PUNC">[</span><span class="NAME">W</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">u.array</span><span class="PUNC">[</span><span class="NAME">x</span><span class="PUNC">+</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">R</span><span class="PUNC">[</span><span class="NAME">W</span><span class="PUNC">[</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">u.array</span><span class="PUNC">[</span><span class="NAME">x</span><span class="PUNC">+</span><span class="NUMB">3</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">S</span><span class="PUNC">[</span><span class="NAME">W</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">u.array</span><span class="PUNC">[</span><span class="NAME">x</span><span class="PUNC">+</span><span class="NUMB">4</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">S</span><span class="PUNC">[</span><span class="NAME">W</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">u.array</span><span class="PUNC">[</span><span class="NAME">x</span><span class="PUNC">+</span><span class="NUMB">5</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">S</span><span class="PUNC">[</span><span class="NAME">W</span><span class="PUNC">[</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">u.array</span><span class="PUNC">[</span><span class="NAME">x</span><span class="PUNC">+</span><span class="NUMB">6</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">P</span><span class="PUNC">[</span><span class="NAME">W</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">u.array</span><span class="PUNC">[</span><span class="NAME">x</span><span class="PUNC">+</span><span class="NUMB">7</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">P</span><span class="PUNC">[</span><span class="NAME">W</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">u.array</span><span class="PUNC">[</span><span class="NAME">x</span><span class="PUNC">+</span><span class="NUMB">8</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">P</span><span class="PUNC">[</span><span class="NAME">W</span><span class="PUNC">[</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">x</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NUMB">9</span><span class="PUNC">;</span><span class="NAME">E</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">D</span><span class="PUNC">=</span><span class="NAME">ta.length</span><span class="PUNC">;</span><span class="NAME">E</span><span class="PUNC">&lt;</span><span class="NAME">D</span><span class="PUNC">;</span><span class="NAME">E</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">Q</span><span class="PUNC">=</span><span class="NAME">kb</span><span class="PUNC">[</span><span class="NAME">ta</span><span class="PUNC">[</span><span class="NAME">E</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">R</span><span class="PUNC">=</span><span class="NAME">u.value</span><span class="PUNC">[</span><span class="NAME">Q.a</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">S</span><span class="PUNC">=</span><span class="NAME">u.value</span><span class="PUNC">[</span><span class="NAME">Q.b</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">P</span><span class="PUNC">=</span><span class="NAME">u.value</span><span class="PUNC">[</span><span class="NAME">Q.c</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">ba</span><span class="PUNC">=</span><span class="NAME">u.value</span><span class="PUNC">[</span><span class="NAME">Q.d</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">u.array</span><span class="PUNC">[</span><span class="NAME">x</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">R</span><span class="PUNC">[</span><span class="NAME">W</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">u.array</span><span class="PUNC">[</span><span class="NAME">x</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">R</span><span class="PUNC">[</span><span class="NAME">W</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">u.array</span><span class="PUNC">[</span><span class="NAME">x</span><span class="PUNC">+</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">R</span><span class="PUNC">[</span><span class="NAME">W</span><span class="PUNC">[</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">u.array</span><span class="PUNC">[</span><span class="NAME">x</span><span class="PUNC">+</span><span class="NUMB">3</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">S</span><span class="PUNC">[</span><span class="NAME">W</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">u.array</span><span class="PUNC">[</span><span class="NAME">x</span><span class="PUNC">+</span><span class="NUMB">4</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">S</span><span class="PUNC">[</span><span class="NAME">W</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>484</span> </span><span class="NAME">u.array</span><span class="PUNC">[</span><span class="NAME">x</span><span class="PUNC">+</span><span class="NUMB">5</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">S</span><span class="PUNC">[</span><span class="NAME">W</span><span class="PUNC">[</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">u.array</span><span class="PUNC">[</span><span class="NAME">x</span><span class="PUNC">+</span><span class="NUMB">6</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">P</span><span class="PUNC">[</span><span class="NAME">W</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">u.array</span><span class="PUNC">[</span><span class="NAME">x</span><span class="PUNC">+</span><span class="NUMB">7</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">P</span><span class="PUNC">[</span><span class="NAME">W</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">u.array</span><span class="PUNC">[</span><span class="NAME">x</span><span class="PUNC">+</span><span class="NUMB">8</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">P</span><span class="PUNC">[</span><span class="NAME">W</span><span class="PUNC">[</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">u.array</span><span class="PUNC">[</span><span class="NAME">x</span><span class="PUNC">+</span><span class="NUMB">9</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">ba</span><span class="PUNC">[</span><span class="NAME">W</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">u.array</span><span class="PUNC">[</span><span class="NAME">x</span><span class="PUNC">+</span><span class="NUMB">10</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">ba</span><span class="PUNC">[</span><span class="NAME">W</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">u.array</span><span class="PUNC">[</span><span class="NAME">x</span><span class="PUNC">+</span><span class="NUMB">11</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">ba</span><span class="PUNC">[</span><span class="NAME">W</span><span class="PUNC">[</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">x</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NUMB">12</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="STRN">"faces"</span><span class="PUNC">===</span><span class="NAME">u.boundTo</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">E</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">D</span><span class="PUNC">=</span><span class="NAME">sa.length</span><span class="PUNC">;</span><span class="NAME">E</span><span class="PUNC">&lt;</span><span class="NAME">D</span><span class="PUNC">;</span><span class="NAME">E</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">P</span><span class="PUNC">=</span><span class="NAME">S</span><span class="PUNC">=</span><span class="NAME">R</span><span class="PUNC">=</span><span class="NAME">Aa</span><span class="PUNC">=</span><span class="NAME">u.value</span><span class="PUNC">[</span><span class="NAME">sa</span><span class="PUNC">[</span><span class="NAME">E</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">u.array</span><span class="PUNC">[</span><span class="NAME">x</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">R</span><span class="PUNC">[</span><span class="NAME">W</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">u.array</span><span class="PUNC">[</span><span class="NAME">x</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">R</span><span class="PUNC">[</span><span class="NAME">W</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">u.array</span><span class="PUNC">[</span><span class="NAME">x</span><span class="PUNC">+</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">R</span><span class="PUNC">[</span><span class="NAME">W</span><span class="PUNC">[</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">u.array</span><span class="PUNC">[</span><span class="NAME">x</span><span class="PUNC">+</span><span class="NUMB">3</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">S</span><span class="PUNC">[</span><span class="NAME">W</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">u.array</span><span class="PUNC">[</span><span class="NAME">x</span><span class="PUNC">+</span><span class="NUMB">4</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">S</span><span class="PUNC">[</span><span class="NAME">W</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">u.array</span><span class="PUNC">[</span><span class="NAME">x</span><span class="PUNC">+</span><span class="NUMB">5</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">S</span><span class="PUNC">[</span><span class="NAME">W</span><span class="PUNC">[</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">u.array</span><span class="PUNC">[</span><span class="NAME">x</span><span class="PUNC">+</span><span class="NUMB">6</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">P</span><span class="PUNC">[</span><span class="NAME">W</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">u.array</span><span class="PUNC">[</span><span class="NAME">x</span><span class="PUNC">+</span><span class="NUMB">7</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">P</span><span class="PUNC">[</span><span class="NAME">W</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">u.array</span><span class="PUNC">[</span><span class="NAME">x</span><span class="PUNC">+</span><span class="NUMB">8</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">P</span><span class="PUNC">[</span><span class="NAME">W</span><span class="PUNC">[</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">x</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NUMB">9</span><span class="PUNC">;</span><span class="NAME">E</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">D</span><span class="PUNC">=</span><span class="NAME">ta.length</span><span class="PUNC">;</span><span class="NAME">E</span><span class="PUNC">&lt;</span><span class="NAME">D</span><span class="PUNC">;</span><span class="NAME">E</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">ba</span><span class="PUNC">=</span><span class="NAME">P</span><span class="PUNC">=</span><span class="NAME">S</span><span class="PUNC">=</span><span class="NAME">R</span><span class="PUNC">=</span><span class="NAME">Aa</span><span class="PUNC">=</span><span class="NAME">u.value</span><span class="PUNC">[</span><span class="NAME">ta</span><span class="PUNC">[</span><span class="NAME">E</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">u.array</span><span class="PUNC">[</span><span class="NAME">x</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">R</span><span class="PUNC">[</span><span class="NAME">W</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>485</span> </span><span class="NAME">u.array</span><span class="PUNC">[</span><span class="NAME">x</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">R</span><span class="PUNC">[</span><span class="NAME">W</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">u.array</span><span class="PUNC">[</span><span class="NAME">x</span><span class="PUNC">+</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">R</span><span class="PUNC">[</span><span class="NAME">W</span><span class="PUNC">[</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">u.array</span><span class="PUNC">[</span><span class="NAME">x</span><span class="PUNC">+</span><span class="NUMB">3</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">S</span><span class="PUNC">[</span><span class="NAME">W</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">u.array</span><span class="PUNC">[</span><span class="NAME">x</span><span class="PUNC">+</span><span class="NUMB">4</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">S</span><span class="PUNC">[</span><span class="NAME">W</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">u.array</span><span class="PUNC">[</span><span class="NAME">x</span><span class="PUNC">+</span><span class="NUMB">5</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">S</span><span class="PUNC">[</span><span class="NAME">W</span><span class="PUNC">[</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">u.array</span><span class="PUNC">[</span><span class="NAME">x</span><span class="PUNC">+</span><span class="NUMB">6</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">P</span><span class="PUNC">[</span><span class="NAME">W</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">u.array</span><span class="PUNC">[</span><span class="NAME">x</span><span class="PUNC">+</span><span class="NUMB">7</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">P</span><span class="PUNC">[</span><span class="NAME">W</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">u.array</span><span class="PUNC">[</span><span class="NAME">x</span><span class="PUNC">+</span><span class="NUMB">8</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">P</span><span class="PUNC">[</span><span class="NAME">W</span><span class="PUNC">[</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">u.array</span><span class="PUNC">[</span><span class="NAME">x</span><span class="PUNC">+</span><span class="NUMB">9</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">ba</span><span class="PUNC">[</span><span class="NAME">W</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">u.array</span><span class="PUNC">[</span><span class="NAME">x</span><span class="PUNC">+</span><span class="NUMB">10</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">ba</span><span class="PUNC">[</span><span class="NAME">W</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">u.array</span><span class="PUNC">[</span><span class="NAME">x</span><span class="PUNC">+</span><span class="NUMB">11</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">ba</span><span class="PUNC">[</span><span class="NAME">W</span><span class="PUNC">[</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">x</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NUMB">12</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="STRN">"faceVertices"</span><span class="PUNC">===</span><span class="NAME">u.boundTo</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">E</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">D</span><span class="PUNC">=</span><span class="NAME">sa.length</span><span class="PUNC">;</span><span class="NAME">E</span><span class="PUNC">&lt;</span><span class="NAME">D</span><span class="PUNC">;</span><span class="NAME">E</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">Aa</span><span class="PUNC">=</span><span class="NAME">u.value</span><span class="PUNC">[</span><span class="NAME">sa</span><span class="PUNC">[</span><span class="NAME">E</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">R</span><span class="PUNC">=</span><span class="NAME">Aa</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">S</span><span class="PUNC">=</span><span class="NAME">Aa</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">P</span><span class="PUNC">=</span><span class="NAME">Aa</span><span class="PUNC">[</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">u.array</span><span class="PUNC">[</span><span class="NAME">x</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">R</span><span class="PUNC">[</span><span class="NAME">W</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">u.array</span><span class="PUNC">[</span><span class="NAME">x</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">R</span><span class="PUNC">[</span><span class="NAME">W</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">u.array</span><span class="PUNC">[</span><span class="NAME">x</span><span class="PUNC">+</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">R</span><span class="PUNC">[</span><span class="NAME">W</span><span class="PUNC">[</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">u.array</span><span class="PUNC">[</span><span class="NAME">x</span><span class="PUNC">+</span><span class="NUMB">3</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">S</span><span class="PUNC">[</span><span class="NAME">W</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">u.array</span><span class="PUNC">[</span><span class="NAME">x</span><span class="PUNC">+</span><span class="NUMB">4</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">S</span><span class="PUNC">[</span><span class="NAME">W</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">u.array</span><span class="PUNC">[</span><span class="NAME">x</span><span class="PUNC">+</span><span class="NUMB">5</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">S</span><span class="PUNC">[</span><span class="NAME">W</span><span class="PUNC">[</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">u.array</span><span class="PUNC">[</span><span class="NAME">x</span><span class="PUNC">+</span><span class="NUMB">6</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">P</span><span class="PUNC">[</span><span class="NAME">W</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">u.array</span><span class="PUNC">[</span><span class="NAME">x</span><span class="PUNC">+</span><span class="WHIT">
<span class='line'>486</span> </span><span class="NUMB">7</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">P</span><span class="PUNC">[</span><span class="NAME">W</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">u.array</span><span class="PUNC">[</span><span class="NAME">x</span><span class="PUNC">+</span><span class="NUMB">8</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">P</span><span class="PUNC">[</span><span class="NAME">W</span><span class="PUNC">[</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">x</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NUMB">9</span><span class="PUNC">;</span><span class="NAME">E</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">D</span><span class="PUNC">=</span><span class="NAME">ta.length</span><span class="PUNC">;</span><span class="NAME">E</span><span class="PUNC">&lt;</span><span class="NAME">D</span><span class="PUNC">;</span><span class="NAME">E</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">Aa</span><span class="PUNC">=</span><span class="NAME">u.value</span><span class="PUNC">[</span><span class="NAME">ta</span><span class="PUNC">[</span><span class="NAME">E</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">R</span><span class="PUNC">=</span><span class="NAME">Aa</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">S</span><span class="PUNC">=</span><span class="NAME">Aa</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">P</span><span class="PUNC">=</span><span class="NAME">Aa</span><span class="PUNC">[</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">ba</span><span class="PUNC">=</span><span class="NAME">Aa</span><span class="PUNC">[</span><span class="NUMB">3</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">u.array</span><span class="PUNC">[</span><span class="NAME">x</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">R</span><span class="PUNC">[</span><span class="NAME">W</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">u.array</span><span class="PUNC">[</span><span class="NAME">x</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">R</span><span class="PUNC">[</span><span class="NAME">W</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">u.array</span><span class="PUNC">[</span><span class="NAME">x</span><span class="PUNC">+</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">R</span><span class="PUNC">[</span><span class="NAME">W</span><span class="PUNC">[</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">u.array</span><span class="PUNC">[</span><span class="NAME">x</span><span class="PUNC">+</span><span class="NUMB">3</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">S</span><span class="PUNC">[</span><span class="NAME">W</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">u.array</span><span class="PUNC">[</span><span class="NAME">x</span><span class="PUNC">+</span><span class="NUMB">4</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">S</span><span class="PUNC">[</span><span class="NAME">W</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">u.array</span><span class="PUNC">[</span><span class="NAME">x</span><span class="PUNC">+</span><span class="NUMB">5</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">S</span><span class="PUNC">[</span><span class="NAME">W</span><span class="PUNC">[</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">u.array</span><span class="PUNC">[</span><span class="NAME">x</span><span class="PUNC">+</span><span class="NUMB">6</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">P</span><span class="PUNC">[</span><span class="NAME">W</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">u.array</span><span class="PUNC">[</span><span class="NAME">x</span><span class="PUNC">+</span><span class="NUMB">7</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">P</span><span class="PUNC">[</span><span class="NAME">W</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">u.array</span><span class="PUNC">[</span><span class="NAME">x</span><span class="PUNC">+</span><span class="NUMB">8</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">P</span><span class="PUNC">[</span><span class="NAME">W</span><span class="PUNC">[</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">u.array</span><span class="PUNC">[</span><span class="NAME">x</span><span class="PUNC">+</span><span class="NUMB">9</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">ba</span><span class="PUNC">[</span><span class="NAME">W</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">u.array</span><span class="PUNC">[</span><span class="NAME">x</span><span class="PUNC">+</span><span class="NUMB">10</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">ba</span><span class="PUNC">[</span><span class="NAME">W</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">u.array</span><span class="PUNC">[</span><span class="NAME">x</span><span class="PUNC">+</span><span class="NUMB">11</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">ba</span><span class="PUNC">[</span><span class="NAME">W</span><span class="PUNC">[</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">x</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NUMB">12</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NUMB">4</span><span class="PUNC">===</span><span class="NAME">u.size</span><span class="PUNC">)</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">===</span><span class="NAME">u.boundTo</span><span class="PUNC">||</span><span class="STRN">"vertices"</span><span class="PUNC">===</span><span class="NAME">u.boundTo</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">E</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">D</span><span class="PUNC">=</span><span class="NAME">sa.length</span><span class="PUNC">;</span><span class="NAME">E</span><span class="PUNC">&lt;</span><span class="NAME">D</span><span class="PUNC">;</span><span class="NAME">E</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">Q</span><span class="PUNC">=</span><span class="NAME">kb</span><span class="PUNC">[</span><span class="NAME">sa</span><span class="PUNC">[</span><span class="NAME">E</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">R</span><span class="PUNC">=</span><span class="NAME">u.value</span><span class="PUNC">[</span><span class="NAME">Q.a</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">S</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>487</span> </span><span class="NAME">u.value</span><span class="PUNC">[</span><span class="NAME">Q.b</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">P</span><span class="PUNC">=</span><span class="NAME">u.value</span><span class="PUNC">[</span><span class="NAME">Q.c</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">u.array</span><span class="PUNC">[</span><span class="NAME">x</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">R.x</span><span class="PUNC">,</span><span class="NAME">u.array</span><span class="PUNC">[</span><span class="NAME">x</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">R.y</span><span class="PUNC">,</span><span class="NAME">u.array</span><span class="PUNC">[</span><span class="NAME">x</span><span class="PUNC">+</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">R.z</span><span class="PUNC">,</span><span class="NAME">u.array</span><span class="PUNC">[</span><span class="NAME">x</span><span class="PUNC">+</span><span class="NUMB">3</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">R.w</span><span class="PUNC">,</span><span class="NAME">u.array</span><span class="PUNC">[</span><span class="NAME">x</span><span class="PUNC">+</span><span class="NUMB">4</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">S.x</span><span class="PUNC">,</span><span class="NAME">u.array</span><span class="PUNC">[</span><span class="NAME">x</span><span class="PUNC">+</span><span class="NUMB">5</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">S.y</span><span class="PUNC">,</span><span class="NAME">u.array</span><span class="PUNC">[</span><span class="NAME">x</span><span class="PUNC">+</span><span class="NUMB">6</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">S.z</span><span class="PUNC">,</span><span class="NAME">u.array</span><span class="PUNC">[</span><span class="NAME">x</span><span class="PUNC">+</span><span class="NUMB">7</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">S.w</span><span class="PUNC">,</span><span class="NAME">u.array</span><span class="PUNC">[</span><span class="NAME">x</span><span class="PUNC">+</span><span class="NUMB">8</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">P.x</span><span class="PUNC">,</span><span class="NAME">u.array</span><span class="PUNC">[</span><span class="NAME">x</span><span class="PUNC">+</span><span class="NUMB">9</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">P.y</span><span class="PUNC">,</span><span class="NAME">u.array</span><span class="PUNC">[</span><span class="NAME">x</span><span class="PUNC">+</span><span class="NUMB">10</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">P.z</span><span class="PUNC">,</span><span class="NAME">u.array</span><span class="PUNC">[</span><span class="NAME">x</span><span class="PUNC">+</span><span class="NUMB">11</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">P.w</span><span class="PUNC">,</span><span class="NAME">x</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NUMB">12</span><span class="PUNC">;</span><span class="NAME">E</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">D</span><span class="PUNC">=</span><span class="NAME">ta.length</span><span class="PUNC">;</span><span class="NAME">E</span><span class="PUNC">&lt;</span><span class="NAME">D</span><span class="PUNC">;</span><span class="NAME">E</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">Q</span><span class="PUNC">=</span><span class="NAME">kb</span><span class="PUNC">[</span><span class="NAME">ta</span><span class="PUNC">[</span><span class="NAME">E</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">R</span><span class="PUNC">=</span><span class="NAME">u.value</span><span class="PUNC">[</span><span class="NAME">Q.a</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">S</span><span class="PUNC">=</span><span class="NAME">u.value</span><span class="PUNC">[</span><span class="NAME">Q.b</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">P</span><span class="PUNC">=</span><span class="NAME">u.value</span><span class="PUNC">[</span><span class="NAME">Q.c</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">ba</span><span class="PUNC">=</span><span class="NAME">u.value</span><span class="PUNC">[</span><span class="NAME">Q.d</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">u.array</span><span class="PUNC">[</span><span class="NAME">x</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">R.x</span><span class="PUNC">,</span><span class="NAME">u.array</span><span class="PUNC">[</span><span class="NAME">x</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">R.y</span><span class="PUNC">,</span><span class="NAME">u.array</span><span class="PUNC">[</span><span class="NAME">x</span><span class="PUNC">+</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">R.z</span><span class="PUNC">,</span><span class="NAME">u.array</span><span class="PUNC">[</span><span class="NAME">x</span><span class="PUNC">+</span><span class="NUMB">3</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">R.w</span><span class="PUNC">,</span><span class="NAME">u.array</span><span class="PUNC">[</span><span class="NAME">x</span><span class="PUNC">+</span><span class="NUMB">4</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">S.x</span><span class="PUNC">,</span><span class="NAME">u.array</span><span class="PUNC">[</span><span class="NAME">x</span><span class="PUNC">+</span><span class="NUMB">5</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">S.y</span><span class="PUNC">,</span><span class="NAME">u.array</span><span class="PUNC">[</span><span class="NAME">x</span><span class="PUNC">+</span><span class="NUMB">6</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">S.z</span><span class="PUNC">,</span><span class="NAME">u.array</span><span class="PUNC">[</span><span class="NAME">x</span><span class="PUNC">+</span><span class="NUMB">7</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">S.w</span><span class="PUNC">,</span><span class="NAME">u.array</span><span class="PUNC">[</span><span class="NAME">x</span><span class="PUNC">+</span><span class="NUMB">8</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">P.x</span><span class="PUNC">,</span><span class="NAME">u.array</span><span class="PUNC">[</span><span class="NAME">x</span><span class="PUNC">+</span><span class="NUMB">9</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>488</span> </span><span class="NAME">P.y</span><span class="PUNC">,</span><span class="NAME">u.array</span><span class="PUNC">[</span><span class="NAME">x</span><span class="PUNC">+</span><span class="NUMB">10</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">P.z</span><span class="PUNC">,</span><span class="NAME">u.array</span><span class="PUNC">[</span><span class="NAME">x</span><span class="PUNC">+</span><span class="NUMB">11</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">P.w</span><span class="PUNC">,</span><span class="NAME">u.array</span><span class="PUNC">[</span><span class="NAME">x</span><span class="PUNC">+</span><span class="NUMB">12</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">ba.x</span><span class="PUNC">,</span><span class="NAME">u.array</span><span class="PUNC">[</span><span class="NAME">x</span><span class="PUNC">+</span><span class="NUMB">13</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">ba.y</span><span class="PUNC">,</span><span class="NAME">u.array</span><span class="PUNC">[</span><span class="NAME">x</span><span class="PUNC">+</span><span class="NUMB">14</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">ba.z</span><span class="PUNC">,</span><span class="NAME">u.array</span><span class="PUNC">[</span><span class="NAME">x</span><span class="PUNC">+</span><span class="NUMB">15</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">ba.w</span><span class="PUNC">,</span><span class="NAME">x</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NUMB">16</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="STRN">"faces"</span><span class="PUNC">===</span><span class="NAME">u.boundTo</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">E</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">D</span><span class="PUNC">=</span><span class="NAME">sa.length</span><span class="PUNC">;</span><span class="NAME">E</span><span class="PUNC">&lt;</span><span class="NAME">D</span><span class="PUNC">;</span><span class="NAME">E</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">P</span><span class="PUNC">=</span><span class="NAME">S</span><span class="PUNC">=</span><span class="NAME">R</span><span class="PUNC">=</span><span class="NAME">Aa</span><span class="PUNC">=</span><span class="NAME">u.value</span><span class="PUNC">[</span><span class="NAME">sa</span><span class="PUNC">[</span><span class="NAME">E</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">u.array</span><span class="PUNC">[</span><span class="NAME">x</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">R.x</span><span class="PUNC">,</span><span class="NAME">u.array</span><span class="PUNC">[</span><span class="NAME">x</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">R.y</span><span class="PUNC">,</span><span class="NAME">u.array</span><span class="PUNC">[</span><span class="NAME">x</span><span class="PUNC">+</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">R.z</span><span class="PUNC">,</span><span class="NAME">u.array</span><span class="PUNC">[</span><span class="NAME">x</span><span class="PUNC">+</span><span class="NUMB">3</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">R.w</span><span class="PUNC">,</span><span class="NAME">u.array</span><span class="PUNC">[</span><span class="NAME">x</span><span class="PUNC">+</span><span class="NUMB">4</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">S.x</span><span class="PUNC">,</span><span class="NAME">u.array</span><span class="PUNC">[</span><span class="NAME">x</span><span class="PUNC">+</span><span class="NUMB">5</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">S.y</span><span class="PUNC">,</span><span class="NAME">u.array</span><span class="PUNC">[</span><span class="NAME">x</span><span class="PUNC">+</span><span class="NUMB">6</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">S.z</span><span class="PUNC">,</span><span class="NAME">u.array</span><span class="PUNC">[</span><span class="NAME">x</span><span class="PUNC">+</span><span class="NUMB">7</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">S.w</span><span class="PUNC">,</span><span class="NAME">u.array</span><span class="PUNC">[</span><span class="NAME">x</span><span class="PUNC">+</span><span class="NUMB">8</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">P.x</span><span class="PUNC">,</span><span class="NAME">u.array</span><span class="PUNC">[</span><span class="NAME">x</span><span class="PUNC">+</span><span class="NUMB">9</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">P.y</span><span class="PUNC">,</span><span class="NAME">u.array</span><span class="PUNC">[</span><span class="NAME">x</span><span class="PUNC">+</span><span class="NUMB">10</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">P.z</span><span class="PUNC">,</span><span class="NAME">u.array</span><span class="PUNC">[</span><span class="NAME">x</span><span class="PUNC">+</span><span class="NUMB">11</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">P.w</span><span class="PUNC">,</span><span class="NAME">x</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NUMB">12</span><span class="PUNC">;</span><span class="NAME">E</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">D</span><span class="PUNC">=</span><span class="NAME">ta.length</span><span class="PUNC">;</span><span class="NAME">E</span><span class="PUNC">&lt;</span><span class="NAME">D</span><span class="PUNC">;</span><span class="NAME">E</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">ba</span><span class="PUNC">=</span><span class="NAME">P</span><span class="PUNC">=</span><span class="NAME">S</span><span class="PUNC">=</span><span class="NAME">R</span><span class="PUNC">=</span><span class="NAME">Aa</span><span class="PUNC">=</span><span class="NAME">u.value</span><span class="PUNC">[</span><span class="NAME">ta</span><span class="PUNC">[</span><span class="NAME">E</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">u.array</span><span class="PUNC">[</span><span class="NAME">x</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">R.x</span><span class="PUNC">,</span><span class="NAME">u.array</span><span class="PUNC">[</span><span class="NAME">x</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">R.y</span><span class="PUNC">,</span><span class="NAME">u.array</span><span class="PUNC">[</span><span class="NAME">x</span><span class="PUNC">+</span><span class="WHIT">
<span class='line'>489</span> </span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">R.z</span><span class="PUNC">,</span><span class="NAME">u.array</span><span class="PUNC">[</span><span class="NAME">x</span><span class="PUNC">+</span><span class="NUMB">3</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">R.w</span><span class="PUNC">,</span><span class="NAME">u.array</span><span class="PUNC">[</span><span class="NAME">x</span><span class="PUNC">+</span><span class="NUMB">4</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">S.x</span><span class="PUNC">,</span><span class="NAME">u.array</span><span class="PUNC">[</span><span class="NAME">x</span><span class="PUNC">+</span><span class="NUMB">5</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">S.y</span><span class="PUNC">,</span><span class="NAME">u.array</span><span class="PUNC">[</span><span class="NAME">x</span><span class="PUNC">+</span><span class="NUMB">6</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">S.z</span><span class="PUNC">,</span><span class="NAME">u.array</span><span class="PUNC">[</span><span class="NAME">x</span><span class="PUNC">+</span><span class="NUMB">7</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">S.w</span><span class="PUNC">,</span><span class="NAME">u.array</span><span class="PUNC">[</span><span class="NAME">x</span><span class="PUNC">+</span><span class="NUMB">8</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">P.x</span><span class="PUNC">,</span><span class="NAME">u.array</span><span class="PUNC">[</span><span class="NAME">x</span><span class="PUNC">+</span><span class="NUMB">9</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">P.y</span><span class="PUNC">,</span><span class="NAME">u.array</span><span class="PUNC">[</span><span class="NAME">x</span><span class="PUNC">+</span><span class="NUMB">10</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">P.z</span><span class="PUNC">,</span><span class="NAME">u.array</span><span class="PUNC">[</span><span class="NAME">x</span><span class="PUNC">+</span><span class="NUMB">11</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">P.w</span><span class="PUNC">,</span><span class="NAME">u.array</span><span class="PUNC">[</span><span class="NAME">x</span><span class="PUNC">+</span><span class="NUMB">12</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">ba.x</span><span class="PUNC">,</span><span class="NAME">u.array</span><span class="PUNC">[</span><span class="NAME">x</span><span class="PUNC">+</span><span class="NUMB">13</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">ba.y</span><span class="PUNC">,</span><span class="NAME">u.array</span><span class="PUNC">[</span><span class="NAME">x</span><span class="PUNC">+</span><span class="NUMB">14</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">ba.z</span><span class="PUNC">,</span><span class="NAME">u.array</span><span class="PUNC">[</span><span class="NAME">x</span><span class="PUNC">+</span><span class="NUMB">15</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">ba.w</span><span class="PUNC">,</span><span class="NAME">x</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NUMB">16</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="STRN">"faceVertices"</span><span class="PUNC">===</span><span class="NAME">u.boundTo</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">E</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">D</span><span class="PUNC">=</span><span class="NAME">sa.length</span><span class="PUNC">;</span><span class="NAME">E</span><span class="PUNC">&lt;</span><span class="NAME">D</span><span class="PUNC">;</span><span class="NAME">E</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">Aa</span><span class="PUNC">=</span><span class="NAME">u.value</span><span class="PUNC">[</span><span class="NAME">sa</span><span class="PUNC">[</span><span class="NAME">E</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">R</span><span class="PUNC">=</span><span class="NAME">Aa</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">S</span><span class="PUNC">=</span><span class="NAME">Aa</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">P</span><span class="PUNC">=</span><span class="NAME">Aa</span><span class="PUNC">[</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">u.array</span><span class="PUNC">[</span><span class="NAME">x</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">R.x</span><span class="PUNC">,</span><span class="NAME">u.array</span><span class="PUNC">[</span><span class="NAME">x</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">R.y</span><span class="PUNC">,</span><span class="NAME">u.array</span><span class="PUNC">[</span><span class="NAME">x</span><span class="PUNC">+</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">R.z</span><span class="PUNC">,</span><span class="NAME">u.array</span><span class="PUNC">[</span><span class="NAME">x</span><span class="PUNC">+</span><span class="NUMB">3</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">R.w</span><span class="PUNC">,</span><span class="NAME">u.array</span><span class="PUNC">[</span><span class="NAME">x</span><span class="PUNC">+</span><span class="NUMB">4</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">S.x</span><span class="PUNC">,</span><span class="NAME">u.array</span><span class="PUNC">[</span><span class="NAME">x</span><span class="PUNC">+</span><span class="NUMB">5</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">S.y</span><span class="PUNC">,</span><span class="NAME">u.array</span><span class="PUNC">[</span><span class="NAME">x</span><span class="PUNC">+</span><span class="NUMB">6</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">S.z</span><span class="PUNC">,</span><span class="NAME">u.array</span><span class="PUNC">[</span><span class="NAME">x</span><span class="PUNC">+</span><span class="NUMB">7</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">S.w</span><span class="PUNC">,</span><span class="NAME">u.array</span><span class="PUNC">[</span><span class="NAME">x</span><span class="PUNC">+</span><span class="NUMB">8</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">P.x</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>490</span> </span><span class="NAME">u.array</span><span class="PUNC">[</span><span class="NAME">x</span><span class="PUNC">+</span><span class="NUMB">9</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">P.y</span><span class="PUNC">,</span><span class="NAME">u.array</span><span class="PUNC">[</span><span class="NAME">x</span><span class="PUNC">+</span><span class="NUMB">10</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">P.z</span><span class="PUNC">,</span><span class="NAME">u.array</span><span class="PUNC">[</span><span class="NAME">x</span><span class="PUNC">+</span><span class="NUMB">11</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">P.w</span><span class="PUNC">,</span><span class="NAME">x</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NUMB">12</span><span class="PUNC">;</span><span class="NAME">E</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">D</span><span class="PUNC">=</span><span class="NAME">ta.length</span><span class="PUNC">;</span><span class="NAME">E</span><span class="PUNC">&lt;</span><span class="NAME">D</span><span class="PUNC">;</span><span class="NAME">E</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">Aa</span><span class="PUNC">=</span><span class="NAME">u.value</span><span class="PUNC">[</span><span class="NAME">ta</span><span class="PUNC">[</span><span class="NAME">E</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">R</span><span class="PUNC">=</span><span class="NAME">Aa</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">S</span><span class="PUNC">=</span><span class="NAME">Aa</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">P</span><span class="PUNC">=</span><span class="NAME">Aa</span><span class="PUNC">[</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">ba</span><span class="PUNC">=</span><span class="NAME">Aa</span><span class="PUNC">[</span><span class="NUMB">3</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">u.array</span><span class="PUNC">[</span><span class="NAME">x</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">R.x</span><span class="PUNC">,</span><span class="NAME">u.array</span><span class="PUNC">[</span><span class="NAME">x</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">R.y</span><span class="PUNC">,</span><span class="NAME">u.array</span><span class="PUNC">[</span><span class="NAME">x</span><span class="PUNC">+</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">R.z</span><span class="PUNC">,</span><span class="NAME">u.array</span><span class="PUNC">[</span><span class="NAME">x</span><span class="PUNC">+</span><span class="NUMB">3</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">R.w</span><span class="PUNC">,</span><span class="NAME">u.array</span><span class="PUNC">[</span><span class="NAME">x</span><span class="PUNC">+</span><span class="NUMB">4</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">S.x</span><span class="PUNC">,</span><span class="NAME">u.array</span><span class="PUNC">[</span><span class="NAME">x</span><span class="PUNC">+</span><span class="NUMB">5</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">S.y</span><span class="PUNC">,</span><span class="NAME">u.array</span><span class="PUNC">[</span><span class="NAME">x</span><span class="PUNC">+</span><span class="NUMB">6</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">S.z</span><span class="PUNC">,</span><span class="NAME">u.array</span><span class="PUNC">[</span><span class="NAME">x</span><span class="PUNC">+</span><span class="NUMB">7</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">S.w</span><span class="PUNC">,</span><span class="NAME">u.array</span><span class="PUNC">[</span><span class="NAME">x</span><span class="PUNC">+</span><span class="NUMB">8</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">P.x</span><span class="PUNC">,</span><span class="NAME">u.array</span><span class="PUNC">[</span><span class="NAME">x</span><span class="PUNC">+</span><span class="NUMB">9</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">P.y</span><span class="PUNC">,</span><span class="NAME">u.array</span><span class="PUNC">[</span><span class="NAME">x</span><span class="PUNC">+</span><span class="NUMB">10</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">P.z</span><span class="PUNC">,</span><span class="NAME">u.array</span><span class="PUNC">[</span><span class="NAME">x</span><span class="PUNC">+</span><span class="NUMB">11</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">P.w</span><span class="PUNC">,</span><span class="NAME">u.array</span><span class="PUNC">[</span><span class="NAME">x</span><span class="PUNC">+</span><span class="NUMB">12</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">ba.x</span><span class="PUNC">,</span><span class="NAME">u.array</span><span class="PUNC">[</span><span class="NAME">x</span><span class="PUNC">+</span><span class="NUMB">13</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">ba.y</span><span class="PUNC">,</span><span class="NAME">u.array</span><span class="PUNC">[</span><span class="NAME">x</span><span class="PUNC">+</span><span class="NUMB">14</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">ba.z</span><span class="PUNC">,</span><span class="NAME">u.array</span><span class="PUNC">[</span><span class="NAME">x</span><span class="PUNC">+</span><span class="NUMB">15</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">ba.w</span><span class="PUNC">,</span><span class="NAME">x</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NUMB">16</span><span class="PUNC">}</span><span class="NAME">k.bindBuffer</span><span class="PUNC">(</span><span class="NAME">k.ARRAY_BUFFER</span><span class="PUNC">,</span><span class="NAME">u.buffer</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">k.bufferData</span><span class="PUNC">(</span><span class="NAME">k.ARRAY_BUFFER</span><span class="PUNC">,</span><span class="NAME">u.array</span><span class="PUNC">,</span><span class="NAME">H</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="NAME">I</span><span class="PUNC">&&</span><span class="WHIT">
<span class='line'>491</span> </span><span class="PUNC">(</span><span class="KEYW">delete</span><span class="WHIT"> </span><span class="NAME">C.__inittedArrays</span><span class="PUNC">,</span><span class="KEYW">delete</span><span class="WHIT"> </span><span class="NAME">C.__colorArray</span><span class="PUNC">,</span><span class="KEYW">delete</span><span class="WHIT"> </span><span class="NAME">C.__normalArray</span><span class="PUNC">,</span><span class="KEYW">delete</span><span class="WHIT"> </span><span class="NAME">C.__tangentArray</span><span class="PUNC">,</span><span class="KEYW">delete</span><span class="WHIT"> </span><span class="NAME">C.__uvArray</span><span class="PUNC">,</span><span class="KEYW">delete</span><span class="WHIT"> </span><span class="NAME">C.__uv2Array</span><span class="PUNC">,</span><span class="KEYW">delete</span><span class="WHIT"> </span><span class="NAME">C.__faceArray</span><span class="PUNC">,</span><span class="KEYW">delete</span><span class="WHIT"> </span><span class="NAME">C.__vertexArray</span><span class="PUNC">,</span><span class="KEYW">delete</span><span class="WHIT"> </span><span class="NAME">C.__lineArray</span><span class="PUNC">,</span><span class="KEYW">delete</span><span class="WHIT"> </span><span class="NAME">C.__skinIndexArray</span><span class="PUNC">,</span><span class="KEYW">delete</span><span class="WHIT"> </span><span class="NAME">C.__skinWeightArray</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="NAME">j.verticesNeedUpdate</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">j.morphTargetsNeedUpdate</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">j.elementsNeedUpdate</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">j.uvsNeedUpdate</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">j.normalsNeedUpdate</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">j.colorsNeedUpdate</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">j.tangentsNeedUpdate</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">j.buffersNeedUpdate</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">p.attributes</span><span class="PUNC">&&</span><span class="NAME">s</span><span class="PUNC">(</span><span class="NAME">p</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">i</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">THREE.Ribbon</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">p</span><span class="PUNC">=</span><span class="NAME">e</span><span class="PUNC">(</span><span class="NAME">i</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>492</span> </span><span class="NAME">j</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">n</span><span class="PUNC">=</span><span class="NAME">p.attributes</span><span class="PUNC">&&</span><span class="NAME">r</span><span class="PUNC">(</span><span class="NAME">p</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">j.verticesNeedUpdate</span><span class="PUNC">||</span><span class="NAME">j.colorsNeedUpdate</span><span class="PUNC">||</span><span class="NAME">j.normalsNeedUpdate</span><span class="PUNC">||</span><span class="NAME">n</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">Cb</span><span class="PUNC">=</span><span class="NAME">j</span><span class="PUNC">,</span><span class="NAME">Kb</span><span class="PUNC">=</span><span class="NAME">k.DYNAMIC_DRAW</span><span class="PUNC">,</span><span class="NAME">nc</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">oc</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">pc</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">Tb</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">Ba</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">Ub</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">xc</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">yc</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">gc</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">gb</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">hc</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">Ia</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">rb</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">kc</span><span class="PUNC">=</span><span class="NAME">Cb.vertices</span><span class="PUNC">,</span><span class="NAME">lc</span><span class="PUNC">=</span><span class="NAME">Cb.colors</span><span class="PUNC">,</span><span class="NAME">mc</span><span class="PUNC">=</span><span class="NAME">Cb.normals</span><span class="PUNC">,</span><span class="NAME">uc</span><span class="PUNC">=</span><span class="NAME">kc.length</span><span class="PUNC">,</span><span class="NAME">vc</span><span class="PUNC">=</span><span class="NAME">lc.length</span><span class="PUNC">,</span><span class="NAME">Yc</span><span class="PUNC">=</span><span class="NAME">mc.length</span><span class="PUNC">,</span><span class="NAME">zc</span><span class="PUNC">=</span><span class="NAME">Cb.__vertexArray</span><span class="PUNC">,</span><span class="NAME">Ac</span><span class="PUNC">=</span><span class="NAME">Cb.__colorArray</span><span class="PUNC">,</span><span class="NAME">Bc</span><span class="PUNC">=</span><span class="NAME">Cb.__normalArray</span><span class="PUNC">,</span><span class="NAME">Zc</span><span class="PUNC">=</span><span class="NAME">Cb.colorsNeedUpdate</span><span class="PUNC">,</span><span class="NAME">$c</span><span class="PUNC">=</span><span class="NAME">Cb.normalsNeedUpdate</span><span class="PUNC">,</span><span class="NAME">Lc</span><span class="PUNC">=</span><span class="NAME">Cb.__webglCustomAttributesList</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">Cb.verticesNeedUpdate</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">nc</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>493</span> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">nc</span><span class="PUNC">&lt;</span><span class="NAME">uc</span><span class="PUNC">;</span><span class="NAME">nc</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">Tb</span><span class="PUNC">=</span><span class="NAME">kc</span><span class="PUNC">[</span><span class="NAME">nc</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">Ba</span><span class="PUNC">=</span><span class="NUMB">3</span><span class="PUNC">*</span><span class="NAME">nc</span><span class="PUNC">,</span><span class="NAME">zc</span><span class="PUNC">[</span><span class="NAME">Ba</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">Tb.x</span><span class="PUNC">,</span><span class="NAME">zc</span><span class="PUNC">[</span><span class="NAME">Ba</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">Tb.y</span><span class="PUNC">,</span><span class="NAME">zc</span><span class="PUNC">[</span><span class="NAME">Ba</span><span class="PUNC">+</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">Tb.z</span><span class="PUNC">;</span><span class="NAME">k.bindBuffer</span><span class="PUNC">(</span><span class="NAME">k.ARRAY_BUFFER</span><span class="PUNC">,</span><span class="NAME">Cb.__webglVertexBuffer</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">k.bufferData</span><span class="PUNC">(</span><span class="NAME">k.ARRAY_BUFFER</span><span class="PUNC">,</span><span class="NAME">zc</span><span class="PUNC">,</span><span class="NAME">Kb</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">Zc</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">oc</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">oc</span><span class="PUNC">&lt;</span><span class="NAME">vc</span><span class="PUNC">;</span><span class="NAME">oc</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">Ub</span><span class="PUNC">=</span><span class="NAME">lc</span><span class="PUNC">[</span><span class="NAME">oc</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">Ba</span><span class="PUNC">=</span><span class="NUMB">3</span><span class="PUNC">*</span><span class="NAME">oc</span><span class="PUNC">,</span><span class="NAME">Ac</span><span class="PUNC">[</span><span class="NAME">Ba</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">Ub.r</span><span class="PUNC">,</span><span class="NAME">Ac</span><span class="PUNC">[</span><span class="NAME">Ba</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">Ub.g</span><span class="PUNC">,</span><span class="NAME">Ac</span><span class="PUNC">[</span><span class="NAME">Ba</span><span class="PUNC">+</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">Ub.b</span><span class="PUNC">;</span><span class="NAME">k.bindBuffer</span><span class="PUNC">(</span><span class="NAME">k.ARRAY_BUFFER</span><span class="PUNC">,</span><span class="NAME">Cb.__webglColorBuffer</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">k.bufferData</span><span class="PUNC">(</span><span class="NAME">k.ARRAY_BUFFER</span><span class="PUNC">,</span><span class="NAME">Ac</span><span class="PUNC">,</span><span class="NAME">Kb</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">$c</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">pc</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">pc</span><span class="PUNC">&lt;</span><span class="NAME">Yc</span><span class="PUNC">;</span><span class="NAME">pc</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">xc</span><span class="PUNC">=</span><span class="NAME">mc</span><span class="PUNC">[</span><span class="NAME">pc</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">Ba</span><span class="PUNC">=</span><span class="NUMB">3</span><span class="PUNC">*</span><span class="NAME">pc</span><span class="PUNC">,</span><span class="NAME">Bc</span><span class="PUNC">[</span><span class="NAME">Ba</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">xc.x</span><span class="PUNC">,</span><span class="NAME">Bc</span><span class="PUNC">[</span><span class="NAME">Ba</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">xc.y</span><span class="PUNC">,</span><span class="NAME">Bc</span><span class="PUNC">[</span><span class="NAME">Ba</span><span class="PUNC">+</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">xc.z</span><span class="PUNC">;</span><span class="NAME">k.bindBuffer</span><span class="PUNC">(</span><span class="NAME">k.ARRAY_BUFFER</span><span class="PUNC">,</span><span class="NAME">Cb.__webglNormalBuffer</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">k.bufferData</span><span class="PUNC">(</span><span class="NAME">k.ARRAY_BUFFER</span><span class="PUNC">,</span><span class="NAME">Bc</span><span class="PUNC">,</span><span class="NAME">Kb</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">Lc</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">yc</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>494</span> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">gc</span><span class="PUNC">=</span><span class="NAME">Lc.length</span><span class="PUNC">;</span><span class="NAME">yc</span><span class="PUNC">&lt;</span><span class="NAME">gc</span><span class="PUNC">;</span><span class="NAME">yc</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">Ia</span><span class="PUNC">=</span><span class="NAME">Lc</span><span class="PUNC">[</span><span class="NAME">yc</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">Ia.needsUpdate</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">===</span><span class="NAME">Ia.boundTo</span><span class="PUNC">||</span><span class="STRN">"vertices"</span><span class="PUNC">===</span><span class="NAME">Ia.boundTo</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">Ba</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">hc</span><span class="PUNC">=</span><span class="NAME">Ia.value.length</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NUMB">1</span><span class="PUNC">===</span><span class="NAME">Ia.size</span><span class="PUNC">)</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">gb</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">gb</span><span class="PUNC">&lt;</span><span class="NAME">hc</span><span class="PUNC">;</span><span class="NAME">gb</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">Ia.array</span><span class="PUNC">[</span><span class="NAME">gb</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">Ia.value</span><span class="PUNC">[</span><span class="NAME">gb</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NUMB">2</span><span class="PUNC">===</span><span class="NAME">Ia.size</span><span class="PUNC">)</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">gb</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">gb</span><span class="PUNC">&lt;</span><span class="NAME">hc</span><span class="PUNC">;</span><span class="NAME">gb</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">rb</span><span class="PUNC">=</span><span class="NAME">Ia.value</span><span class="PUNC">[</span><span class="NAME">gb</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">Ia.array</span><span class="PUNC">[</span><span class="NAME">Ba</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">rb.x</span><span class="PUNC">,</span><span class="NAME">Ia.array</span><span class="PUNC">[</span><span class="NAME">Ba</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">rb.y</span><span class="PUNC">,</span><span class="NAME">Ba</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NUMB">2</span><span class="PUNC">;</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NUMB">3</span><span class="PUNC">===</span><span class="NAME">Ia.size</span><span class="PUNC">)</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="STRN">"c"</span><span class="PUNC">===</span><span class="NAME">Ia.type</span><span class="PUNC">)</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">gb</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">gb</span><span class="PUNC">&lt;</span><span class="NAME">hc</span><span class="PUNC">;</span><span class="NAME">gb</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">rb</span><span class="PUNC">=</span><span class="NAME">Ia.value</span><span class="PUNC">[</span><span class="NAME">gb</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">Ia.array</span><span class="PUNC">[</span><span class="NAME">Ba</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">rb.r</span><span class="PUNC">,</span><span class="NAME">Ia.array</span><span class="PUNC">[</span><span class="NAME">Ba</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">rb.g</span><span class="PUNC">,</span><span class="NAME">Ia.array</span><span class="PUNC">[</span><span class="NAME">Ba</span><span class="PUNC">+</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">rb.b</span><span class="PUNC">,</span><span class="NAME">Ba</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NUMB">3</span><span class="PUNC">;</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">gb</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">gb</span><span class="PUNC">&lt;</span><span class="NAME">hc</span><span class="PUNC">;</span><span class="NAME">gb</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">rb</span><span class="PUNC">=</span><span class="NAME">Ia.value</span><span class="PUNC">[</span><span class="NAME">gb</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">Ia.array</span><span class="PUNC">[</span><span class="NAME">Ba</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">rb.x</span><span class="PUNC">,</span><span class="NAME">Ia.array</span><span class="PUNC">[</span><span class="NAME">Ba</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>495</span> </span><span class="NAME">rb.y</span><span class="PUNC">,</span><span class="NAME">Ia.array</span><span class="PUNC">[</span><span class="NAME">Ba</span><span class="PUNC">+</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">rb.z</span><span class="PUNC">,</span><span class="NAME">Ba</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NUMB">3</span><span class="PUNC">;</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NUMB">4</span><span class="PUNC">===</span><span class="NAME">Ia.size</span><span class="PUNC">)</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">gb</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">gb</span><span class="PUNC">&lt;</span><span class="NAME">hc</span><span class="PUNC">;</span><span class="NAME">gb</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">rb</span><span class="PUNC">=</span><span class="NAME">Ia.value</span><span class="PUNC">[</span><span class="NAME">gb</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">Ia.array</span><span class="PUNC">[</span><span class="NAME">Ba</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">rb.x</span><span class="PUNC">,</span><span class="NAME">Ia.array</span><span class="PUNC">[</span><span class="NAME">Ba</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">rb.y</span><span class="PUNC">,</span><span class="NAME">Ia.array</span><span class="PUNC">[</span><span class="NAME">Ba</span><span class="PUNC">+</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">rb.z</span><span class="PUNC">,</span><span class="NAME">Ia.array</span><span class="PUNC">[</span><span class="NAME">Ba</span><span class="PUNC">+</span><span class="NUMB">3</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">rb.w</span><span class="PUNC">,</span><span class="NAME">Ba</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NUMB">4</span><span class="PUNC">;</span><span class="NAME">k.bindBuffer</span><span class="PUNC">(</span><span class="NAME">k.ARRAY_BUFFER</span><span class="PUNC">,</span><span class="NAME">Ia.buffer</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">k.bufferData</span><span class="PUNC">(</span><span class="NAME">k.ARRAY_BUFFER</span><span class="PUNC">,</span><span class="NAME">Ia.array</span><span class="PUNC">,</span><span class="NAME">Kb</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="NAME">j.verticesNeedUpdate</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">j.colorsNeedUpdate</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">j.normalsNeedUpdate</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">p.attributes</span><span class="PUNC">&&</span><span class="NAME">s</span><span class="PUNC">(</span><span class="NAME">p</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">i</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">THREE.Line</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">p</span><span class="PUNC">=</span><span class="NAME">e</span><span class="PUNC">(</span><span class="NAME">i</span><span class="PUNC">,</span><span class="NAME">j</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">n</span><span class="PUNC">=</span><span class="NAME">p.attributes</span><span class="PUNC">&&</span><span class="NAME">r</span><span class="PUNC">(</span><span class="NAME">p</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">j.verticesNeedUpdate</span><span class="PUNC">||</span><span class="NAME">j.colorsNeedUpdate</span><span class="PUNC">||</span><span class="NAME">j.lineDistancesNeedUpdate</span><span class="PUNC">||</span><span class="NAME">n</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">Db</span><span class="PUNC">=</span><span class="NAME">j</span><span class="PUNC">,</span><span class="NAME">Cc</span><span class="PUNC">=</span><span class="NAME">k.DYNAMIC_DRAW</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>496</span> </span><span class="NAME">qc</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">rc</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">sc</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">Dc</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">Oa</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">Ec</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">Qc</span><span class="PUNC">=</span><span class="NAME">Db.vertices</span><span class="PUNC">,</span><span class="NAME">Rc</span><span class="PUNC">=</span><span class="NAME">Db.colors</span><span class="PUNC">,</span><span class="NAME">Sc</span><span class="PUNC">=</span><span class="NAME">Db.lineDistances</span><span class="PUNC">,</span><span class="NAME">ad</span><span class="PUNC">=</span><span class="NAME">Qc.length</span><span class="PUNC">,</span><span class="NAME">bd</span><span class="PUNC">=</span><span class="NAME">Rc.length</span><span class="PUNC">,</span><span class="NAME">cd</span><span class="PUNC">=</span><span class="NAME">Sc.length</span><span class="PUNC">,</span><span class="NAME">Fc</span><span class="PUNC">=</span><span class="NAME">Db.__vertexArray</span><span class="PUNC">,</span><span class="NAME">Gc</span><span class="PUNC">=</span><span class="NAME">Db.__colorArray</span><span class="PUNC">,</span><span class="NAME">Tc</span><span class="PUNC">=</span><span class="NAME">Db.__lineDistanceArray</span><span class="PUNC">,</span><span class="NAME">dd</span><span class="PUNC">=</span><span class="NAME">Db.colorsNeedUpdate</span><span class="PUNC">,</span><span class="NAME">ed</span><span class="PUNC">=</span><span class="NAME">Db.lineDistancesNeedUpdate</span><span class="PUNC">,</span><span class="NAME">Mc</span><span class="PUNC">=</span><span class="NAME">Db.__webglCustomAttributesList</span><span class="PUNC">,</span><span class="NAME">Hc</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">Uc</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">hb</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">ic</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">sb</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">Ja</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">Db.verticesNeedUpdate</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">qc</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">qc</span><span class="PUNC">&lt;</span><span class="NAME">ad</span><span class="PUNC">;</span><span class="NAME">qc</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">Dc</span><span class="PUNC">=</span><span class="NAME">Qc</span><span class="PUNC">[</span><span class="NAME">qc</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">Oa</span><span class="PUNC">=</span><span class="NUMB">3</span><span class="PUNC">*</span><span class="NAME">qc</span><span class="PUNC">,</span><span class="NAME">Fc</span><span class="PUNC">[</span><span class="NAME">Oa</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">Dc.x</span><span class="PUNC">,</span><span class="NAME">Fc</span><span class="PUNC">[</span><span class="NAME">Oa</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">Dc.y</span><span class="PUNC">,</span><span class="NAME">Fc</span><span class="PUNC">[</span><span class="NAME">Oa</span><span class="PUNC">+</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">Dc.z</span><span class="PUNC">;</span><span class="NAME">k.bindBuffer</span><span class="PUNC">(</span><span class="NAME">k.ARRAY_BUFFER</span><span class="PUNC">,</span><span class="NAME">Db.__webglVertexBuffer</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>497</span> </span><span class="NAME">k.bufferData</span><span class="PUNC">(</span><span class="NAME">k.ARRAY_BUFFER</span><span class="PUNC">,</span><span class="NAME">Fc</span><span class="PUNC">,</span><span class="NAME">Cc</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">dd</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">rc</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">rc</span><span class="PUNC">&lt;</span><span class="NAME">bd</span><span class="PUNC">;</span><span class="NAME">rc</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">Ec</span><span class="PUNC">=</span><span class="NAME">Rc</span><span class="PUNC">[</span><span class="NAME">rc</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">Oa</span><span class="PUNC">=</span><span class="NUMB">3</span><span class="PUNC">*</span><span class="NAME">rc</span><span class="PUNC">,</span><span class="NAME">Gc</span><span class="PUNC">[</span><span class="NAME">Oa</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">Ec.r</span><span class="PUNC">,</span><span class="NAME">Gc</span><span class="PUNC">[</span><span class="NAME">Oa</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">Ec.g</span><span class="PUNC">,</span><span class="NAME">Gc</span><span class="PUNC">[</span><span class="NAME">Oa</span><span class="PUNC">+</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">Ec.b</span><span class="PUNC">;</span><span class="NAME">k.bindBuffer</span><span class="PUNC">(</span><span class="NAME">k.ARRAY_BUFFER</span><span class="PUNC">,</span><span class="NAME">Db.__webglColorBuffer</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">k.bufferData</span><span class="PUNC">(</span><span class="NAME">k.ARRAY_BUFFER</span><span class="PUNC">,</span><span class="NAME">Gc</span><span class="PUNC">,</span><span class="NAME">Cc</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">ed</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">sc</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">sc</span><span class="PUNC">&lt;</span><span class="NAME">cd</span><span class="PUNC">;</span><span class="NAME">sc</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">Tc</span><span class="PUNC">[</span><span class="NAME">sc</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">Sc</span><span class="PUNC">[</span><span class="NAME">sc</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">k.bindBuffer</span><span class="PUNC">(</span><span class="NAME">k.ARRAY_BUFFER</span><span class="PUNC">,</span><span class="NAME">Db.__webglLineDistanceBuffer</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">k.bufferData</span><span class="PUNC">(</span><span class="NAME">k.ARRAY_BUFFER</span><span class="PUNC">,</span><span class="NAME">Tc</span><span class="PUNC">,</span><span class="NAME">Cc</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">Mc</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">Hc</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">Uc</span><span class="PUNC">=</span><span class="NAME">Mc.length</span><span class="PUNC">;</span><span class="NAME">Hc</span><span class="PUNC">&lt;</span><span class="NAME">Uc</span><span class="PUNC">;</span><span class="NAME">Hc</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">Ja</span><span class="PUNC">=</span><span class="NAME">Mc</span><span class="PUNC">[</span><span class="NAME">Hc</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">Ja.needsUpdate</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">===</span><span class="NAME">Ja.boundTo</span><span class="PUNC">||</span><span class="STRN">"vertices"</span><span class="PUNC">===</span><span class="NAME">Ja.boundTo</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">Oa</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">ic</span><span class="PUNC">=</span><span class="NAME">Ja.value.length</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NUMB">1</span><span class="PUNC">===</span><span class="NAME">Ja.size</span><span class="PUNC">)</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">hb</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>498</span> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">hb</span><span class="PUNC">&lt;</span><span class="NAME">ic</span><span class="PUNC">;</span><span class="NAME">hb</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">Ja.array</span><span class="PUNC">[</span><span class="NAME">hb</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">Ja.value</span><span class="PUNC">[</span><span class="NAME">hb</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NUMB">2</span><span class="PUNC">===</span><span class="NAME">Ja.size</span><span class="PUNC">)</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">hb</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">hb</span><span class="PUNC">&lt;</span><span class="NAME">ic</span><span class="PUNC">;</span><span class="NAME">hb</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">sb</span><span class="PUNC">=</span><span class="NAME">Ja.value</span><span class="PUNC">[</span><span class="NAME">hb</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">Ja.array</span><span class="PUNC">[</span><span class="NAME">Oa</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">sb.x</span><span class="PUNC">,</span><span class="NAME">Ja.array</span><span class="PUNC">[</span><span class="NAME">Oa</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">sb.y</span><span class="PUNC">,</span><span class="NAME">Oa</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NUMB">2</span><span class="PUNC">;</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NUMB">3</span><span class="PUNC">===</span><span class="NAME">Ja.size</span><span class="PUNC">)</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="STRN">"c"</span><span class="PUNC">===</span><span class="NAME">Ja.type</span><span class="PUNC">)</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">hb</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">hb</span><span class="PUNC">&lt;</span><span class="NAME">ic</span><span class="PUNC">;</span><span class="NAME">hb</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">sb</span><span class="PUNC">=</span><span class="NAME">Ja.value</span><span class="PUNC">[</span><span class="NAME">hb</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">Ja.array</span><span class="PUNC">[</span><span class="NAME">Oa</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">sb.r</span><span class="PUNC">,</span><span class="NAME">Ja.array</span><span class="PUNC">[</span><span class="NAME">Oa</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">sb.g</span><span class="PUNC">,</span><span class="NAME">Ja.array</span><span class="PUNC">[</span><span class="NAME">Oa</span><span class="PUNC">+</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">sb.b</span><span class="PUNC">,</span><span class="NAME">Oa</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NUMB">3</span><span class="PUNC">;</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">hb</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">hb</span><span class="PUNC">&lt;</span><span class="NAME">ic</span><span class="PUNC">;</span><span class="NAME">hb</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">sb</span><span class="PUNC">=</span><span class="NAME">Ja.value</span><span class="PUNC">[</span><span class="NAME">hb</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">Ja.array</span><span class="PUNC">[</span><span class="NAME">Oa</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">sb.x</span><span class="PUNC">,</span><span class="NAME">Ja.array</span><span class="PUNC">[</span><span class="NAME">Oa</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">sb.y</span><span class="PUNC">,</span><span class="NAME">Ja.array</span><span class="PUNC">[</span><span class="NAME">Oa</span><span class="PUNC">+</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">sb.z</span><span class="PUNC">,</span><span class="NAME">Oa</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NUMB">3</span><span class="PUNC">;</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NUMB">4</span><span class="PUNC">===</span><span class="NAME">Ja.size</span><span class="PUNC">)</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">hb</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">hb</span><span class="PUNC">&lt;</span><span class="NAME">ic</span><span class="PUNC">;</span><span class="NAME">hb</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">sb</span><span class="PUNC">=</span><span class="NAME">Ja.value</span><span class="PUNC">[</span><span class="NAME">hb</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">Ja.array</span><span class="PUNC">[</span><span class="NAME">Oa</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">sb.x</span><span class="PUNC">,</span><span class="NAME">Ja.array</span><span class="PUNC">[</span><span class="NAME">Oa</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">sb.y</span><span class="PUNC">,</span><span class="NAME">Ja.array</span><span class="PUNC">[</span><span class="NAME">Oa</span><span class="PUNC">+</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">sb.z</span><span class="PUNC">,</span><span class="NAME">Ja.array</span><span class="PUNC">[</span><span class="NAME">Oa</span><span class="PUNC">+</span><span class="WHIT">
<span class='line'>499</span> </span><span class="NUMB">3</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">sb.w</span><span class="PUNC">,</span><span class="NAME">Oa</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NUMB">4</span><span class="PUNC">;</span><span class="NAME">k.bindBuffer</span><span class="PUNC">(</span><span class="NAME">k.ARRAY_BUFFER</span><span class="PUNC">,</span><span class="NAME">Ja.buffer</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">k.bufferData</span><span class="PUNC">(</span><span class="NAME">k.ARRAY_BUFFER</span><span class="PUNC">,</span><span class="NAME">Ja.array</span><span class="PUNC">,</span><span class="NAME">Cc</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="NAME">j.verticesNeedUpdate</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">j.colorsNeedUpdate</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">j.lineDistancesNeedUpdate</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">p.attributes</span><span class="PUNC">&&</span><span class="NAME">s</span><span class="PUNC">(</span><span class="NAME">p</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">i</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">THREE.ParticleSystem</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">p</span><span class="PUNC">=</span><span class="NAME">e</span><span class="PUNC">(</span><span class="NAME">i</span><span class="PUNC">,</span><span class="NAME">j</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">n</span><span class="PUNC">=</span><span class="NAME">p.attributes</span><span class="PUNC">&&</span><span class="NAME">r</span><span class="PUNC">(</span><span class="NAME">p</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">j.verticesNeedUpdate</span><span class="PUNC">||</span><span class="NAME">j.colorsNeedUpdate</span><span class="PUNC">||</span><span class="NAME">i.sortParticles</span><span class="PUNC">||</span><span class="NAME">n</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">Nb</span><span class="PUNC">=</span><span class="NAME">j</span><span class="PUNC">,</span><span class="NAME">Nc</span><span class="PUNC">=</span><span class="NAME">k.DYNAMIC_DRAW</span><span class="PUNC">,</span><span class="NAME">tc</span><span class="PUNC">=</span><span class="NAME">i</span><span class="PUNC">,</span><span class="NAME">tb</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">Ob</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">Pb</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">ca</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">Qb</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">bc</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">Ic</span><span class="PUNC">=</span><span class="NAME">Nb.vertices</span><span class="PUNC">,</span><span class="NAME">Oc</span><span class="PUNC">=</span><span class="NAME">Ic.length</span><span class="PUNC">,</span><span class="NAME">Pc</span><span class="PUNC">=</span><span class="NAME">Nb.colors</span><span class="PUNC">,</span><span class="NAME">Vc</span><span class="PUNC">=</span><span class="NAME">Pc.length</span><span class="PUNC">,</span><span class="NAME">ec</span><span class="PUNC">=</span><span class="NAME">Nb.__vertexArray</span><span class="PUNC">,</span><span class="NAME">fc</span><span class="PUNC">=</span><span class="NAME">Nb.__colorArray</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>500</span> </span><span class="NAME">Vb</span><span class="PUNC">=</span><span class="NAME">Nb.__sortArray</span><span class="PUNC">,</span><span class="NAME">Wc</span><span class="PUNC">=</span><span class="NAME">Nb.verticesNeedUpdate</span><span class="PUNC">,</span><span class="NAME">Xc</span><span class="PUNC">=</span><span class="NAME">Nb.colorsNeedUpdate</span><span class="PUNC">,</span><span class="NAME">Wb</span><span class="PUNC">=</span><span class="NAME">Nb.__webglCustomAttributesList</span><span class="PUNC">,</span><span class="NAME">Eb</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">jc</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">ma</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">Fb</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">Ea</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">$</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">tc.sortParticles</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">lb.copy</span><span class="PUNC">(</span><span class="NAME">xb</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">lb.multiply</span><span class="PUNC">(</span><span class="NAME">tc.matrixWorld</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">tb</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">tb</span><span class="PUNC">&lt;</span><span class="NAME">Oc</span><span class="PUNC">;</span><span class="NAME">tb</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">Pb</span><span class="PUNC">=</span><span class="NAME">Ic</span><span class="PUNC">[</span><span class="NAME">tb</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">Ga.copy</span><span class="PUNC">(</span><span class="NAME">Pb</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">Ga.applyProjection</span><span class="PUNC">(</span><span class="NAME">lb</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">Vb</span><span class="PUNC">[</span><span class="NAME">tb</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="NAME">Ga.z</span><span class="PUNC">,</span><span class="NAME">tb</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">Vb.sort</span><span class="PUNC">(</span><span class="NAME">l</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">tb</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">tb</span><span class="PUNC">&lt;</span><span class="NAME">Oc</span><span class="PUNC">;</span><span class="NAME">tb</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">Pb</span><span class="PUNC">=</span><span class="NAME">Ic</span><span class="PUNC">[</span><span class="NAME">Vb</span><span class="PUNC">[</span><span class="NAME">tb</span><span class="PUNC">]</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">ca</span><span class="PUNC">=</span><span class="NUMB">3</span><span class="PUNC">*</span><span class="NAME">tb</span><span class="PUNC">,</span><span class="NAME">ec</span><span class="PUNC">[</span><span class="NAME">ca</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">Pb.x</span><span class="PUNC">,</span><span class="NAME">ec</span><span class="PUNC">[</span><span class="NAME">ca</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">Pb.y</span><span class="PUNC">,</span><span class="NAME">ec</span><span class="PUNC">[</span><span class="NAME">ca</span><span class="PUNC">+</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">Pb.z</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">Ob</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">Ob</span><span class="PUNC">&lt;</span><span class="NAME">Vc</span><span class="PUNC">;</span><span class="NAME">Ob</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">ca</span><span class="PUNC">=</span><span class="NUMB">3</span><span class="PUNC">*</span><span class="NAME">Ob</span><span class="PUNC">,</span><span class="NAME">bc</span><span class="PUNC">=</span><span class="NAME">Pc</span><span class="PUNC">[</span><span class="NAME">Vb</span><span class="PUNC">[</span><span class="NAME">Ob</span><span class="PUNC">]</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">fc</span><span class="PUNC">[</span><span class="NAME">ca</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">bc.r</span><span class="PUNC">,</span><span class="NAME">fc</span><span class="PUNC">[</span><span class="NAME">ca</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">bc.g</span><span class="PUNC">,</span><span class="NAME">fc</span><span class="PUNC">[</span><span class="NAME">ca</span><span class="PUNC">+</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">bc.b</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">Wb</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">Eb</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">jc</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>501</span> </span><span class="NAME">Wb.length</span><span class="PUNC">;</span><span class="NAME">Eb</span><span class="PUNC">&lt;</span><span class="NAME">jc</span><span class="PUNC">;</span><span class="NAME">Eb</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">$</span><span class="PUNC">=</span><span class="NAME">Wb</span><span class="PUNC">[</span><span class="NAME">Eb</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">===</span><span class="NAME">$.boundTo</span><span class="PUNC">||</span><span class="STRN">"vertices"</span><span class="PUNC">===</span><span class="NAME">$.boundTo</span><span class="PUNC">)</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">ca</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">Fb</span><span class="PUNC">=</span><span class="NAME">$.value.length</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">===</span><span class="NAME">$.size</span><span class="PUNC">)</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">ma</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">ma</span><span class="PUNC">&lt;</span><span class="NAME">Fb</span><span class="PUNC">;</span><span class="NAME">ma</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">Qb</span><span class="PUNC">=</span><span class="NAME">Vb</span><span class="PUNC">[</span><span class="NAME">ma</span><span class="PUNC">]</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">$.array</span><span class="PUNC">[</span><span class="NAME">ma</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">$.value</span><span class="PUNC">[</span><span class="NAME">Qb</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NUMB">2</span><span class="PUNC">===</span><span class="NAME">$.size</span><span class="PUNC">)</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">ma</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">ma</span><span class="PUNC">&lt;</span><span class="NAME">Fb</span><span class="PUNC">;</span><span class="NAME">ma</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">Qb</span><span class="PUNC">=</span><span class="NAME">Vb</span><span class="PUNC">[</span><span class="NAME">ma</span><span class="PUNC">]</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">Ea</span><span class="PUNC">=</span><span class="NAME">$.value</span><span class="PUNC">[</span><span class="NAME">Qb</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">$.array</span><span class="PUNC">[</span><span class="NAME">ca</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">Ea.x</span><span class="PUNC">,</span><span class="NAME">$.array</span><span class="PUNC">[</span><span class="NAME">ca</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">Ea.y</span><span class="PUNC">,</span><span class="NAME">ca</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NUMB">2</span><span class="PUNC">;</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NUMB">3</span><span class="PUNC">===</span><span class="NAME">$.size</span><span class="PUNC">)</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="STRN">"c"</span><span class="PUNC">===</span><span class="NAME">$.type</span><span class="PUNC">)</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">ma</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">ma</span><span class="PUNC">&lt;</span><span class="NAME">Fb</span><span class="PUNC">;</span><span class="NAME">ma</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">Qb</span><span class="PUNC">=</span><span class="NAME">Vb</span><span class="PUNC">[</span><span class="NAME">ma</span><span class="PUNC">]</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">Ea</span><span class="PUNC">=</span><span class="NAME">$.value</span><span class="PUNC">[</span><span class="NAME">Qb</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">$.array</span><span class="PUNC">[</span><span class="NAME">ca</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">Ea.r</span><span class="PUNC">,</span><span class="NAME">$.array</span><span class="PUNC">[</span><span class="NAME">ca</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">Ea.g</span><span class="PUNC">,</span><span class="NAME">$.array</span><span class="PUNC">[</span><span class="NAME">ca</span><span class="PUNC">+</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">Ea.b</span><span class="PUNC">,</span><span class="NAME">ca</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NUMB">3</span><span class="PUNC">;</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">ma</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">ma</span><span class="PUNC">&lt;</span><span class="NAME">Fb</span><span class="PUNC">;</span><span class="NAME">ma</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">Qb</span><span class="PUNC">=</span><span class="NAME">Vb</span><span class="PUNC">[</span><span class="NAME">ma</span><span class="PUNC">]</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">Ea</span><span class="PUNC">=</span><span class="NAME">$.value</span><span class="PUNC">[</span><span class="NAME">Qb</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">$.array</span><span class="PUNC">[</span><span class="NAME">ca</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">Ea.x</span><span class="PUNC">,</span><span class="NAME">$.array</span><span class="PUNC">[</span><span class="NAME">ca</span><span class="PUNC">+</span><span class="WHIT">
<span class='line'>502</span> </span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">Ea.y</span><span class="PUNC">,</span><span class="NAME">$.array</span><span class="PUNC">[</span><span class="NAME">ca</span><span class="PUNC">+</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">Ea.z</span><span class="PUNC">,</span><span class="NAME">ca</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NUMB">3</span><span class="PUNC">;</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NUMB">4</span><span class="PUNC">===</span><span class="NAME">$.size</span><span class="PUNC">)</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">ma</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">ma</span><span class="PUNC">&lt;</span><span class="NAME">Fb</span><span class="PUNC">;</span><span class="NAME">ma</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">Qb</span><span class="PUNC">=</span><span class="NAME">Vb</span><span class="PUNC">[</span><span class="NAME">ma</span><span class="PUNC">]</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">Ea</span><span class="PUNC">=</span><span class="NAME">$.value</span><span class="PUNC">[</span><span class="NAME">Qb</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">$.array</span><span class="PUNC">[</span><span class="NAME">ca</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">Ea.x</span><span class="PUNC">,</span><span class="NAME">$.array</span><span class="PUNC">[</span><span class="NAME">ca</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">Ea.y</span><span class="PUNC">,</span><span class="NAME">$.array</span><span class="PUNC">[</span><span class="NAME">ca</span><span class="PUNC">+</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">Ea.z</span><span class="PUNC">,</span><span class="NAME">$.array</span><span class="PUNC">[</span><span class="NAME">ca</span><span class="PUNC">+</span><span class="NUMB">3</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">Ea.w</span><span class="PUNC">,</span><span class="NAME">ca</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NUMB">4</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">Wc</span><span class="PUNC">)</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">tb</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">tb</span><span class="PUNC">&lt;</span><span class="NAME">Oc</span><span class="PUNC">;</span><span class="NAME">tb</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">Pb</span><span class="PUNC">=</span><span class="NAME">Ic</span><span class="PUNC">[</span><span class="NAME">tb</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">ca</span><span class="PUNC">=</span><span class="NUMB">3</span><span class="PUNC">*</span><span class="NAME">tb</span><span class="PUNC">,</span><span class="NAME">ec</span><span class="PUNC">[</span><span class="NAME">ca</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">Pb.x</span><span class="PUNC">,</span><span class="NAME">ec</span><span class="PUNC">[</span><span class="NAME">ca</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">Pb.y</span><span class="PUNC">,</span><span class="NAME">ec</span><span class="PUNC">[</span><span class="NAME">ca</span><span class="PUNC">+</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">Pb.z</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">Xc</span><span class="PUNC">)</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">Ob</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">Ob</span><span class="PUNC">&lt;</span><span class="NAME">Vc</span><span class="PUNC">;</span><span class="NAME">Ob</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">bc</span><span class="PUNC">=</span><span class="NAME">Pc</span><span class="PUNC">[</span><span class="NAME">Ob</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">ca</span><span class="PUNC">=</span><span class="NUMB">3</span><span class="PUNC">*</span><span class="NAME">Ob</span><span class="PUNC">,</span><span class="NAME">fc</span><span class="PUNC">[</span><span class="NAME">ca</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">bc.r</span><span class="PUNC">,</span><span class="NAME">fc</span><span class="PUNC">[</span><span class="NAME">ca</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">bc.g</span><span class="PUNC">,</span><span class="NAME">fc</span><span class="PUNC">[</span><span class="NAME">ca</span><span class="PUNC">+</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">bc.b</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">Wb</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">Eb</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">jc</span><span class="PUNC">=</span><span class="NAME">Wb.length</span><span class="PUNC">;</span><span class="NAME">Eb</span><span class="PUNC">&lt;</span><span class="NAME">jc</span><span class="PUNC">;</span><span class="NAME">Eb</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">$</span><span class="PUNC">=</span><span class="NAME">Wb</span><span class="PUNC">[</span><span class="NAME">Eb</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">$.needsUpdate</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">===</span><span class="NAME">$.boundTo</span><span class="PUNC">||</span><span class="STRN">"vertices"</span><span class="PUNC">===</span><span class="NAME">$.boundTo</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">Fb</span><span class="PUNC">=</span><span class="NAME">$.value.length</span><span class="PUNC">,</span><span class="NAME">ca</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">===</span><span class="NAME">$.size</span><span class="PUNC">)</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">ma</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>503</span> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">ma</span><span class="PUNC">&lt;</span><span class="NAME">Fb</span><span class="PUNC">;</span><span class="NAME">ma</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">$.array</span><span class="PUNC">[</span><span class="NAME">ma</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">$.value</span><span class="PUNC">[</span><span class="NAME">ma</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NUMB">2</span><span class="PUNC">===</span><span class="NAME">$.size</span><span class="PUNC">)</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">ma</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">ma</span><span class="PUNC">&lt;</span><span class="NAME">Fb</span><span class="PUNC">;</span><span class="NAME">ma</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">Ea</span><span class="PUNC">=</span><span class="NAME">$.value</span><span class="PUNC">[</span><span class="NAME">ma</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">$.array</span><span class="PUNC">[</span><span class="NAME">ca</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">Ea.x</span><span class="PUNC">,</span><span class="NAME">$.array</span><span class="PUNC">[</span><span class="NAME">ca</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">Ea.y</span><span class="PUNC">,</span><span class="NAME">ca</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NUMB">2</span><span class="PUNC">;</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NUMB">3</span><span class="PUNC">===</span><span class="NAME">$.size</span><span class="PUNC">)</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="STRN">"c"</span><span class="PUNC">===</span><span class="NAME">$.type</span><span class="PUNC">)</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">ma</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">ma</span><span class="PUNC">&lt;</span><span class="NAME">Fb</span><span class="PUNC">;</span><span class="NAME">ma</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">Ea</span><span class="PUNC">=</span><span class="NAME">$.value</span><span class="PUNC">[</span><span class="NAME">ma</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">$.array</span><span class="PUNC">[</span><span class="NAME">ca</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">Ea.r</span><span class="PUNC">,</span><span class="NAME">$.array</span><span class="PUNC">[</span><span class="NAME">ca</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">Ea.g</span><span class="PUNC">,</span><span class="NAME">$.array</span><span class="PUNC">[</span><span class="NAME">ca</span><span class="PUNC">+</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">Ea.b</span><span class="PUNC">,</span><span class="NAME">ca</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NUMB">3</span><span class="PUNC">;</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">ma</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">ma</span><span class="PUNC">&lt;</span><span class="NAME">Fb</span><span class="PUNC">;</span><span class="NAME">ma</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">Ea</span><span class="PUNC">=</span><span class="NAME">$.value</span><span class="PUNC">[</span><span class="NAME">ma</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">$.array</span><span class="PUNC">[</span><span class="NAME">ca</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">Ea.x</span><span class="PUNC">,</span><span class="NAME">$.array</span><span class="PUNC">[</span><span class="NAME">ca</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">Ea.y</span><span class="PUNC">,</span><span class="NAME">$.array</span><span class="PUNC">[</span><span class="NAME">ca</span><span class="PUNC">+</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">Ea.z</span><span class="PUNC">,</span><span class="NAME">ca</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NUMB">3</span><span class="PUNC">;</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NUMB">4</span><span class="PUNC">===</span><span class="NAME">$.size</span><span class="PUNC">)</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">ma</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">ma</span><span class="PUNC">&lt;</span><span class="NAME">Fb</span><span class="PUNC">;</span><span class="NAME">ma</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">Ea</span><span class="PUNC">=</span><span class="NAME">$.value</span><span class="PUNC">[</span><span class="NAME">ma</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">$.array</span><span class="PUNC">[</span><span class="NAME">ca</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">Ea.x</span><span class="PUNC">,</span><span class="NAME">$.array</span><span class="PUNC">[</span><span class="NAME">ca</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">Ea.y</span><span class="PUNC">,</span><span class="NAME">$.array</span><span class="PUNC">[</span><span class="NAME">ca</span><span class="PUNC">+</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">Ea.z</span><span class="PUNC">,</span><span class="NAME">$.array</span><span class="PUNC">[</span><span class="NAME">ca</span><span class="PUNC">+</span><span class="NUMB">3</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">Ea.w</span><span class="PUNC">,</span><span class="NAME">ca</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NUMB">4</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">Wc</span><span class="PUNC">||</span><span class="WHIT">
<span class='line'>504</span> </span><span class="NAME">tc.sortParticles</span><span class="PUNC">)</span><span class="NAME">k.bindBuffer</span><span class="PUNC">(</span><span class="NAME">k.ARRAY_BUFFER</span><span class="PUNC">,</span><span class="NAME">Nb.__webglVertexBuffer</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">k.bufferData</span><span class="PUNC">(</span><span class="NAME">k.ARRAY_BUFFER</span><span class="PUNC">,</span><span class="NAME">ec</span><span class="PUNC">,</span><span class="NAME">Nc</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">Xc</span><span class="PUNC">||</span><span class="NAME">tc.sortParticles</span><span class="PUNC">)</span><span class="NAME">k.bindBuffer</span><span class="PUNC">(</span><span class="NAME">k.ARRAY_BUFFER</span><span class="PUNC">,</span><span class="NAME">Nb.__webglColorBuffer</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">k.bufferData</span><span class="PUNC">(</span><span class="NAME">k.ARRAY_BUFFER</span><span class="PUNC">,</span><span class="NAME">fc</span><span class="PUNC">,</span><span class="NAME">Nc</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">Wb</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">Eb</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">jc</span><span class="PUNC">=</span><span class="NAME">Wb.length</span><span class="PUNC">;</span><span class="NAME">Eb</span><span class="PUNC">&lt;</span><span class="NAME">jc</span><span class="PUNC">;</span><span class="NAME">Eb</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">$</span><span class="PUNC">=</span><span class="NAME">Wb</span><span class="PUNC">[</span><span class="NAME">Eb</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">$.needsUpdate</span><span class="PUNC">||</span><span class="NAME">tc.sortParticles</span><span class="PUNC">)</span><span class="NAME">k.bindBuffer</span><span class="PUNC">(</span><span class="NAME">k.ARRAY_BUFFER</span><span class="PUNC">,</span><span class="NAME">$.buffer</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">k.bufferData</span><span class="PUNC">(</span><span class="NAME">k.ARRAY_BUFFER</span><span class="PUNC">,</span><span class="NAME">$.array</span><span class="PUNC">,</span><span class="NAME">Nc</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="NAME">j.verticesNeedUpdate</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">j.colorsNeedUpdate</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">p.attributes</span><span class="PUNC">&&</span><span class="NAME">s</span><span class="PUNC">(</span><span class="NAME">p</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">this.initMaterial</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">;</span><span class="NAME">a.addEventListener</span><span class="PUNC">(</span><span class="STRN">"dispose"</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>505</span> </span><span class="NAME">uc</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">,</span><span class="NAME">j</span><span class="PUNC">,</span><span class="NAME">l</span><span class="PUNC">,</span><span class="NAME">m</span><span class="PUNC">,</span><span class="NAME">n</span><span class="PUNC">;</span><span class="NAME">a</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">THREE.MeshDepthMaterial</span><span class="PUNC">?</span><span class="NAME">n</span><span class="PUNC">=</span><span class="STRN">"depth"</span><span class="PUNC">:</span><span class="NAME">a</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">THREE.MeshNormalMaterial</span><span class="PUNC">?</span><span class="NAME">n</span><span class="PUNC">=</span><span class="STRN">"normal"</span><span class="PUNC">:</span><span class="NAME">a</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">THREE.MeshBasicMaterial</span><span class="PUNC">?</span><span class="NAME">n</span><span class="PUNC">=</span><span class="STRN">"basic"</span><span class="PUNC">:</span><span class="NAME">a</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">THREE.MeshLambertMaterial</span><span class="PUNC">?</span><span class="NAME">n</span><span class="PUNC">=</span><span class="STRN">"lambert"</span><span class="PUNC">:</span><span class="NAME">a</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">THREE.MeshPhongMaterial</span><span class="PUNC">?</span><span class="NAME">n</span><span class="PUNC">=</span><span class="STRN">"phong"</span><span class="PUNC">:</span><span class="NAME">a</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">THREE.LineBasicMaterial</span><span class="PUNC">?</span><span class="NAME">n</span><span class="PUNC">=</span><span class="STRN">"basic"</span><span class="PUNC">:</span><span class="NAME">a</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">THREE.LineDashedMaterial</span><span class="PUNC">?</span><span class="NAME">n</span><span class="PUNC">=</span><span class="STRN">"dashed"</span><span class="PUNC">:</span><span class="NAME">a</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">THREE.ParticleBasicMaterial</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">n</span><span class="PUNC">=</span><span class="STRN">"particle_basic"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">n</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">p</span><span class="PUNC">=</span><span class="NAME">THREE.ShaderLib</span><span class="PUNC">[</span><span class="NAME">n</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">a.uniforms</span><span class="PUNC">=</span><span class="NAME">THREE.UniformsUtils.clone</span><span class="PUNC">(</span><span class="NAME">p.uniforms</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a.vertexShader</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>506</span> </span><span class="NAME">p.vertexShader</span><span class="PUNC">;</span><span class="NAME">a.fragmentShader</span><span class="PUNC">=</span><span class="NAME">p.fragmentShader</span><span class="PUNC">}</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">q</span><span class="PUNC">=</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">r</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">p</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">s</span><span class="PUNC">=</span><span class="NAME">b.length</span><span class="PUNC">;</span><span class="NAME">f</span><span class="PUNC">&lt;</span><span class="NAME">s</span><span class="PUNC">;</span><span class="NAME">f</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NAME">f</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">h.onlyShadow</span><span class="PUNC">||</span><span class="PUNC">(</span><span class="NAME">h</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">THREE.DirectionalLight</span><span class="PUNC">&&</span><span class="NAME">e</span><span class="PUNC">++</span><span class="PUNC">,</span><span class="NAME">h</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">THREE.PointLight</span><span class="PUNC">&&</span><span class="NAME">q</span><span class="PUNC">++</span><span class="PUNC">,</span><span class="NAME">h</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">THREE.SpotLight</span><span class="PUNC">&&</span><span class="NAME">r</span><span class="PUNC">++</span><span class="PUNC">,</span><span class="NAME">h</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">THREE.HemisphereLight</span><span class="PUNC">&&</span><span class="NAME">p</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">q</span><span class="PUNC">;</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">r</span><span class="PUNC">;</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">p</span><span class="PUNC">;</span><span class="NAME">r</span><span class="PUNC">=</span><span class="NAME">p</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">q</span><span class="PUNC">=</span><span class="NAME">b.length</span><span class="PUNC">;</span><span class="NAME">r</span><span class="PUNC">&lt;</span><span class="NAME">q</span><span class="PUNC">;</span><span class="NAME">r</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">s</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NAME">r</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">s.castShadow</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">s</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">THREE.SpotLight</span><span class="PUNC">&&</span><span class="NAME">p</span><span class="PUNC">++</span><span class="PUNC">,</span><span class="NAME">s</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">THREE.DirectionalLight</span><span class="PUNC">&&</span><span class="PUNC">!</span><span class="NAME">s.shadowCascade</span><span class="PUNC">&&</span><span class="NAME">p</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">m</span><span class="PUNC">=</span><span class="NAME">p</span><span class="PUNC">;</span><span class="NAME">Bb</span><span class="PUNC">&&</span><span class="NAME">d</span><span class="PUNC">&&</span><span class="NAME">d.useVertexTexture</span><span class="PUNC">?</span><span class="NAME">l</span><span class="PUNC">=</span><span class="NUMB">1024</span><span class="PUNC">:</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">k.getParameter</span><span class="PUNC">(</span><span class="NAME">k.MAX_VERTEX_UNIFORM_VECTORS</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>507</span> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">Math.floor</span><span class="PUNC">(</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">-</span><span class="NUMB">20</span><span class="PUNC">)</span><span class="PUNC">/</span><span class="NUMB">4</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">d</span><span class="PUNC">&&</span><span class="NAME">d</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">THREE.SkinnedMesh</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">Math.min</span><span class="PUNC">(</span><span class="NAME">d.bones.length</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">&lt;</span><span class="NAME">d.bones.length</span><span class="PUNC">&&</span><span class="NAME">console.warn</span><span class="PUNC">(</span><span class="STRN">"WebGLRenderer: too many bones - "</span><span class="PUNC">+</span><span class="NAME">d.bones.length</span><span class="PUNC">+</span><span class="STRN">", this GPU supports just "</span><span class="PUNC">+</span><span class="NAME">b</span><span class="PUNC">+</span><span class="STRN">" (try OpenGL instead of ANGLE)"</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">l</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">:</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">r</span><span class="PUNC">=</span><span class="NAME">a.fragmentShader</span><span class="PUNC">,</span><span class="NAME">q</span><span class="PUNC">=</span><span class="NAME">a.vertexShader</span><span class="PUNC">,</span><span class="NAME">p</span><span class="PUNC">=</span><span class="NAME">a.uniforms</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">a.attributes</span><span class="PUNC">,</span><span class="NAME">s</span><span class="PUNC">=</span><span class="NAME">a.defines</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="NAME">map</span><span class="PUNC">:</span><span class="PUNC">!</span><span class="PUNC">!</span><span class="NAME">a.map</span><span class="PUNC">,</span><span class="NAME">envMap</span><span class="PUNC">:</span><span class="PUNC">!</span><span class="PUNC">!</span><span class="NAME">a.envMap</span><span class="PUNC">,</span><span class="NAME">lightMap</span><span class="PUNC">:</span><span class="PUNC">!</span><span class="PUNC">!</span><span class="NAME">a.lightMap</span><span class="PUNC">,</span><span class="NAME">bumpMap</span><span class="PUNC">:</span><span class="PUNC">!</span><span class="PUNC">!</span><span class="NAME">a.bumpMap</span><span class="PUNC">,</span><span class="NAME">normalMap</span><span class="PUNC">:</span><span class="PUNC">!</span><span class="PUNC">!</span><span class="NAME">a.normalMap</span><span class="PUNC">,</span><span class="NAME">specularMap</span><span class="PUNC">:</span><span class="PUNC">!</span><span class="PUNC">!</span><span class="NAME">a.specularMap</span><span class="PUNC">,</span><span class="NAME">vertexColors</span><span class="PUNC">:</span><span class="NAME">a.vertexColors</span><span class="PUNC">,</span><span class="NAME">fog</span><span class="PUNC">:</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">useFog</span><span class="PUNC">:</span><span class="NAME">a.fog</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>508</span> </span><span class="NAME">fogExp</span><span class="PUNC">:</span><span class="NAME">c</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">THREE.FogExp2</span><span class="PUNC">,</span><span class="NAME">sizeAttenuation</span><span class="PUNC">:</span><span class="NAME">a.sizeAttenuation</span><span class="PUNC">,</span><span class="NAME">skinning</span><span class="PUNC">:</span><span class="NAME">a.skinning</span><span class="PUNC">,</span><span class="NAME">maxBones</span><span class="PUNC">:</span><span class="NAME">l</span><span class="PUNC">,</span><span class="NAME">useVertexTexture</span><span class="PUNC">:</span><span class="NAME">Bb</span><span class="PUNC">&&</span><span class="NAME">d</span><span class="PUNC">&&</span><span class="NAME">d.useVertexTexture</span><span class="PUNC">,</span><span class="NAME">boneTextureWidth</span><span class="PUNC">:</span><span class="NAME">d</span><span class="PUNC">&&</span><span class="NAME">d.boneTextureWidth</span><span class="PUNC">,</span><span class="NAME">boneTextureHeight</span><span class="PUNC">:</span><span class="NAME">d</span><span class="PUNC">&&</span><span class="NAME">d.boneTextureHeight</span><span class="PUNC">,</span><span class="NAME">morphTargets</span><span class="PUNC">:</span><span class="NAME">a.morphTargets</span><span class="PUNC">,</span><span class="NAME">morphNormals</span><span class="PUNC">:</span><span class="NAME">a.morphNormals</span><span class="PUNC">,</span><span class="NAME">maxMorphTargets</span><span class="PUNC">:</span><span class="NAME">this.maxMorphTargets</span><span class="PUNC">,</span><span class="NAME">maxMorphNormals</span><span class="PUNC">:</span><span class="NAME">this.maxMorphNormals</span><span class="PUNC">,</span><span class="NAME">maxDirLights</span><span class="PUNC">:</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">maxPointLights</span><span class="PUNC">:</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">maxSpotLights</span><span class="PUNC">:</span><span class="NAME">h</span><span class="PUNC">,</span><span class="NAME">maxHemiLights</span><span class="PUNC">:</span><span class="NAME">g</span><span class="PUNC">,</span><span class="NAME">maxShadows</span><span class="PUNC">:</span><span class="NAME">m</span><span class="PUNC">,</span><span class="NAME">shadowMapEnabled</span><span class="PUNC">:</span><span class="NAME">this.shadowMapEnabled</span><span class="PUNC">&&</span><span class="NAME">d.receiveShadow</span><span class="PUNC">,</span><span class="NAME">shadowMapType</span><span class="PUNC">:</span><span class="NAME">this.shadowMapType</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>509</span> </span><span class="NAME">shadowMapDebug</span><span class="PUNC">:</span><span class="NAME">this.shadowMapDebug</span><span class="PUNC">,</span><span class="NAME">shadowMapCascade</span><span class="PUNC">:</span><span class="NAME">this.shadowMapCascade</span><span class="PUNC">,</span><span class="NAME">alphaTest</span><span class="PUNC">:</span><span class="NAME">a.alphaTest</span><span class="PUNC">,</span><span class="NAME">metal</span><span class="PUNC">:</span><span class="NAME">a.metal</span><span class="PUNC">,</span><span class="NAME">perPixel</span><span class="PUNC">:</span><span class="NAME">a.perPixel</span><span class="PUNC">,</span><span class="NAME">wrapAround</span><span class="PUNC">:</span><span class="NAME">a.wrapAround</span><span class="PUNC">,</span><span class="NAME">doubleSided</span><span class="PUNC">:</span><span class="NAME">a.side</span><span class="PUNC">===</span><span class="NAME">THREE.DoubleSide</span><span class="PUNC">,</span><span class="NAME">flipSided</span><span class="PUNC">:</span><span class="NAME">a.side</span><span class="PUNC">===</span><span class="NAME">THREE.BackSide</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">t</span><span class="PUNC">,</span><span class="NAME">v</span><span class="PUNC">,</span><span class="NAME">w</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">n</span><span class="PUNC">?</span><span class="NAME">d.push</span><span class="PUNC">(</span><span class="NAME">n</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="PUNC">(</span><span class="NAME">d.push</span><span class="PUNC">(</span><span class="NAME">r</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">d.push</span><span class="PUNC">(</span><span class="NAME">q</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">v</span><span class="WHIT"> </span><span class="KEYW">in</span><span class="WHIT"> </span><span class="NAME">s</span><span class="PUNC">)</span><span class="NAME">d.push</span><span class="PUNC">(</span><span class="NAME">v</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">d.push</span><span class="PUNC">(</span><span class="NAME">s</span><span class="PUNC">[</span><span class="NAME">v</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">t</span><span class="WHIT"> </span><span class="KEYW">in</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">)</span><span class="NAME">d.push</span><span class="PUNC">(</span><span class="NAME">t</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">d.push</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NAME">t</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">n</span><span class="PUNC">=</span><span class="NAME">d.join</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">t</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">v</span><span class="PUNC">=</span><span class="NAME">V.length</span><span class="PUNC">;</span><span class="NAME">t</span><span class="PUNC">&lt;</span><span class="NAME">v</span><span class="PUNC">;</span><span class="NAME">t</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">V</span><span class="PUNC">[</span><span class="NAME">t</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">d.code</span><span class="PUNC">===</span><span class="NAME">n</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">d.usedTimes</span><span class="PUNC">++</span><span class="PUNC">;</span><span class="NAME">j</span><span class="PUNC">=</span><span class="NAME">d.program</span><span class="PUNC">;</span><span class="KEYW">break</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">}</span><span class="NAME">t</span><span class="PUNC">=</span><span class="STRN">"SHADOWMAP_TYPE_BASIC"</span><span class="PUNC">;</span><span class="NAME">c.shadowMapType</span><span class="PUNC">===</span><span class="NAME">THREE.PCFShadowMap</span><span class="PUNC">?</span><span class="NAME">t</span><span class="PUNC">=</span><span class="STRN">"SHADOWMAP_TYPE_PCF"</span><span class="PUNC">:</span><span class="WHIT">
<span class='line'>510</span> </span><span class="NAME">c.shadowMapType</span><span class="PUNC">===</span><span class="NAME">THREE.PCFSoftShadowMap</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">t</span><span class="PUNC">=</span><span class="STRN">"SHADOWMAP_TYPE_PCF_SOFT"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">v</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">w</span><span class="WHIT"> </span><span class="KEYW">in</span><span class="WHIT"> </span><span class="NAME">s</span><span class="PUNC">)</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">s</span><span class="PUNC">[</span><span class="NAME">w</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">!==</span><span class="NAME">d</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">=</span><span class="STRN">"#define "</span><span class="PUNC">+</span><span class="NAME">w</span><span class="PUNC">+</span><span class="STRN">" "</span><span class="PUNC">+</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">v.push</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">v.join</span><span class="PUNC">(</span><span class="STRN">"\n"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">w</span><span class="PUNC">=</span><span class="NAME">k.createProgram</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">v</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="STRN">"precision "</span><span class="PUNC">+</span><span class="NAME">L</span><span class="PUNC">+</span><span class="STRN">" float;"</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">Gb</span><span class="PUNC">?</span><span class="STRN">"#define VERTEX_TEXTURES"</span><span class="PUNC">:</span><span class="STRN">""</span><span class="PUNC">,</span><span class="NAME">D.gammaInput</span><span class="PUNC">?</span><span class="STRN">"#define GAMMA_INPUT"</span><span class="PUNC">:</span><span class="STRN">""</span><span class="PUNC">,</span><span class="NAME">D.gammaOutput</span><span class="PUNC">?</span><span class="STRN">"#define GAMMA_OUTPUT"</span><span class="PUNC">:</span><span class="STRN">""</span><span class="PUNC">,</span><span class="NAME">D.physicallyBasedShading</span><span class="PUNC">?</span><span class="STRN">"#define PHYSICALLY_BASED_SHADING"</span><span class="PUNC">:</span><span class="STRN">""</span><span class="PUNC">,</span><span class="STRN">"#define MAX_DIR_LIGHTS "</span><span class="PUNC">+</span><span class="NAME">c.maxDirLights</span><span class="PUNC">,</span><span class="STRN">"#define MAX_POINT_LIGHTS "</span><span class="PUNC">+</span><span class="NAME">c.maxPointLights</span><span class="PUNC">,</span><span class="STRN">"#define MAX_SPOT_LIGHTS "</span><span class="PUNC">+</span><span class="NAME">c.maxSpotLights</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>511</span> </span><span class="STRN">"#define MAX_HEMI_LIGHTS "</span><span class="PUNC">+</span><span class="NAME">c.maxHemiLights</span><span class="PUNC">,</span><span class="STRN">"#define MAX_SHADOWS "</span><span class="PUNC">+</span><span class="NAME">c.maxShadows</span><span class="PUNC">,</span><span class="STRN">"#define MAX_BONES "</span><span class="PUNC">+</span><span class="NAME">c.maxBones</span><span class="PUNC">,</span><span class="NAME">c.map</span><span class="PUNC">?</span><span class="STRN">"#define USE_MAP"</span><span class="PUNC">:</span><span class="STRN">""</span><span class="PUNC">,</span><span class="NAME">c.envMap</span><span class="PUNC">?</span><span class="STRN">"#define USE_ENVMAP"</span><span class="PUNC">:</span><span class="STRN">""</span><span class="PUNC">,</span><span class="NAME">c.lightMap</span><span class="PUNC">?</span><span class="STRN">"#define USE_LIGHTMAP"</span><span class="PUNC">:</span><span class="STRN">""</span><span class="PUNC">,</span><span class="NAME">c.bumpMap</span><span class="PUNC">?</span><span class="STRN">"#define USE_BUMPMAP"</span><span class="PUNC">:</span><span class="STRN">""</span><span class="PUNC">,</span><span class="NAME">c.normalMap</span><span class="PUNC">?</span><span class="STRN">"#define USE_NORMALMAP"</span><span class="PUNC">:</span><span class="STRN">""</span><span class="PUNC">,</span><span class="NAME">c.specularMap</span><span class="PUNC">?</span><span class="STRN">"#define USE_SPECULARMAP"</span><span class="PUNC">:</span><span class="STRN">""</span><span class="PUNC">,</span><span class="NAME">c.vertexColors</span><span class="PUNC">?</span><span class="STRN">"#define USE_COLOR"</span><span class="PUNC">:</span><span class="STRN">""</span><span class="PUNC">,</span><span class="NAME">c.skinning</span><span class="PUNC">?</span><span class="STRN">"#define USE_SKINNING"</span><span class="PUNC">:</span><span class="STRN">""</span><span class="PUNC">,</span><span class="NAME">c.useVertexTexture</span><span class="PUNC">?</span><span class="STRN">"#define BONE_TEXTURE"</span><span class="PUNC">:</span><span class="STRN">""</span><span class="PUNC">,</span><span class="NAME">c.boneTextureWidth</span><span class="PUNC">?</span><span class="STRN">"#define N_BONE_PIXEL_X "</span><span class="PUNC">+</span><span class="NAME">c.boneTextureWidth.toFixed</span><span class="PUNC">(</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="WHIT">
<span class='line'>512</span> </span><span class="STRN">""</span><span class="PUNC">,</span><span class="NAME">c.boneTextureHeight</span><span class="PUNC">?</span><span class="STRN">"#define N_BONE_PIXEL_Y "</span><span class="PUNC">+</span><span class="NAME">c.boneTextureHeight.toFixed</span><span class="PUNC">(</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="STRN">""</span><span class="PUNC">,</span><span class="NAME">c.morphTargets</span><span class="PUNC">?</span><span class="STRN">"#define USE_MORPHTARGETS"</span><span class="PUNC">:</span><span class="STRN">""</span><span class="PUNC">,</span><span class="NAME">c.morphNormals</span><span class="PUNC">?</span><span class="STRN">"#define USE_MORPHNORMALS"</span><span class="PUNC">:</span><span class="STRN">""</span><span class="PUNC">,</span><span class="NAME">c.perPixel</span><span class="PUNC">?</span><span class="STRN">"#define PHONG_PER_PIXEL"</span><span class="PUNC">:</span><span class="STRN">""</span><span class="PUNC">,</span><span class="NAME">c.wrapAround</span><span class="PUNC">?</span><span class="STRN">"#define WRAP_AROUND"</span><span class="PUNC">:</span><span class="STRN">""</span><span class="PUNC">,</span><span class="NAME">c.doubleSided</span><span class="PUNC">?</span><span class="STRN">"#define DOUBLE_SIDED"</span><span class="PUNC">:</span><span class="STRN">""</span><span class="PUNC">,</span><span class="NAME">c.flipSided</span><span class="PUNC">?</span><span class="STRN">"#define FLIP_SIDED"</span><span class="PUNC">:</span><span class="STRN">""</span><span class="PUNC">,</span><span class="NAME">c.shadowMapEnabled</span><span class="PUNC">?</span><span class="STRN">"#define USE_SHADOWMAP"</span><span class="PUNC">:</span><span class="STRN">""</span><span class="PUNC">,</span><span class="NAME">c.shadowMapEnabled</span><span class="PUNC">?</span><span class="STRN">"#define "</span><span class="PUNC">+</span><span class="NAME">t</span><span class="PUNC">:</span><span class="STRN">""</span><span class="PUNC">,</span><span class="NAME">c.shadowMapDebug</span><span class="PUNC">?</span><span class="STRN">"#define SHADOWMAP_DEBUG"</span><span class="PUNC">:</span><span class="STRN">""</span><span class="PUNC">,</span><span class="NAME">c.shadowMapCascade</span><span class="PUNC">?</span><span class="STRN">"#define SHADOWMAP_CASCADE"</span><span class="PUNC">:</span><span class="WHIT">
<span class='line'>513</span> </span><span class="STRN">""</span><span class="PUNC">,</span><span class="NAME">c.sizeAttenuation</span><span class="PUNC">?</span><span class="STRN">"#define USE_SIZEATTENUATION"</span><span class="PUNC">:</span><span class="STRN">""</span><span class="PUNC">,</span><span class="STRN">"uniform mat4 modelMatrix;\nuniform mat4 modelViewMatrix;\nuniform mat4 projectionMatrix;\nuniform mat4 viewMatrix;\nuniform mat3 normalMatrix;\nuniform vec3 cameraPosition;\nattribute vec3 position;\nattribute vec3 normal;\nattribute vec2 uv;\nattribute vec2 uv2;\n#ifdef USE_COLOR\nattribute vec3 color;\n#endif\n#ifdef USE_MORPHTARGETS\nattribute vec3 morphTarget0;\nattribute vec3 morphTarget1;\nattribute vec3 morphTarget2;\nattribute vec3 morphTarget3;\n#ifdef USE_MORPHNORMALS\nattribute vec3 morphNormal0;\nattribute vec3 morphNormal1;\nattribute vec3 morphNormal2;\nattribute vec3 morphNormal3;\n#else\nattribute vec3 morphTarget4;\nattribute vec3 morphTarget5;\nattribute vec3 morphTarget6;\nattribute vec3 morphTarget7;\n#endif\n#endif\n#ifdef USE_SKINNING\nattribute vec4 skinIndex;\nattribute vec4 skinWeight;\n#endif\n"</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">join</span><span class="PUNC">(</span><span class="STRN">"\n"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>514</span> </span><span class="NAME">t</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="STRN">"precision "</span><span class="PUNC">+</span><span class="NAME">L</span><span class="PUNC">+</span><span class="STRN">" float;"</span><span class="PUNC">,</span><span class="NAME">c.bumpMap</span><span class="PUNC">||</span><span class="NAME">c.normalMap</span><span class="PUNC">?</span><span class="STRN">"#extension GL_OES_standard_derivatives : enable"</span><span class="PUNC">:</span><span class="STRN">""</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">,</span><span class="STRN">"#define MAX_DIR_LIGHTS "</span><span class="PUNC">+</span><span class="NAME">c.maxDirLights</span><span class="PUNC">,</span><span class="STRN">"#define MAX_POINT_LIGHTS "</span><span class="PUNC">+</span><span class="NAME">c.maxPointLights</span><span class="PUNC">,</span><span class="STRN">"#define MAX_SPOT_LIGHTS "</span><span class="PUNC">+</span><span class="NAME">c.maxSpotLights</span><span class="PUNC">,</span><span class="STRN">"#define MAX_HEMI_LIGHTS "</span><span class="PUNC">+</span><span class="NAME">c.maxHemiLights</span><span class="PUNC">,</span><span class="STRN">"#define MAX_SHADOWS "</span><span class="PUNC">+</span><span class="NAME">c.maxShadows</span><span class="PUNC">,</span><span class="NAME">c.alphaTest</span><span class="PUNC">?</span><span class="STRN">"#define ALPHATEST "</span><span class="PUNC">+</span><span class="NAME">c.alphaTest</span><span class="PUNC">:</span><span class="STRN">""</span><span class="PUNC">,</span><span class="NAME">D.gammaInput</span><span class="PUNC">?</span><span class="STRN">"#define GAMMA_INPUT"</span><span class="PUNC">:</span><span class="STRN">""</span><span class="PUNC">,</span><span class="NAME">D.gammaOutput</span><span class="PUNC">?</span><span class="STRN">"#define GAMMA_OUTPUT"</span><span class="PUNC">:</span><span class="STRN">""</span><span class="PUNC">,</span><span class="NAME">D.physicallyBasedShading</span><span class="PUNC">?</span><span class="STRN">"#define PHYSICALLY_BASED_SHADING"</span><span class="PUNC">:</span><span class="STRN">""</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>515</span> </span><span class="NAME">c.useFog</span><span class="PUNC">&&</span><span class="NAME">c.fog</span><span class="PUNC">?</span><span class="STRN">"#define USE_FOG"</span><span class="PUNC">:</span><span class="STRN">""</span><span class="PUNC">,</span><span class="NAME">c.useFog</span><span class="PUNC">&&</span><span class="NAME">c.fogExp</span><span class="PUNC">?</span><span class="STRN">"#define FOG_EXP2"</span><span class="PUNC">:</span><span class="STRN">""</span><span class="PUNC">,</span><span class="NAME">c.map</span><span class="PUNC">?</span><span class="STRN">"#define USE_MAP"</span><span class="PUNC">:</span><span class="STRN">""</span><span class="PUNC">,</span><span class="NAME">c.envMap</span><span class="PUNC">?</span><span class="STRN">"#define USE_ENVMAP"</span><span class="PUNC">:</span><span class="STRN">""</span><span class="PUNC">,</span><span class="NAME">c.lightMap</span><span class="PUNC">?</span><span class="STRN">"#define USE_LIGHTMAP"</span><span class="PUNC">:</span><span class="STRN">""</span><span class="PUNC">,</span><span class="NAME">c.bumpMap</span><span class="PUNC">?</span><span class="STRN">"#define USE_BUMPMAP"</span><span class="PUNC">:</span><span class="STRN">""</span><span class="PUNC">,</span><span class="NAME">c.normalMap</span><span class="PUNC">?</span><span class="STRN">"#define USE_NORMALMAP"</span><span class="PUNC">:</span><span class="STRN">""</span><span class="PUNC">,</span><span class="NAME">c.specularMap</span><span class="PUNC">?</span><span class="STRN">"#define USE_SPECULARMAP"</span><span class="PUNC">:</span><span class="STRN">""</span><span class="PUNC">,</span><span class="NAME">c.vertexColors</span><span class="PUNC">?</span><span class="STRN">"#define USE_COLOR"</span><span class="PUNC">:</span><span class="STRN">""</span><span class="PUNC">,</span><span class="NAME">c.metal</span><span class="PUNC">?</span><span class="STRN">"#define METAL"</span><span class="PUNC">:</span><span class="STRN">""</span><span class="PUNC">,</span><span class="NAME">c.perPixel</span><span class="PUNC">?</span><span class="STRN">"#define PHONG_PER_PIXEL"</span><span class="PUNC">:</span><span class="STRN">""</span><span class="PUNC">,</span><span class="NAME">c.wrapAround</span><span class="PUNC">?</span><span class="STRN">"#define WRAP_AROUND"</span><span class="PUNC">:</span><span class="STRN">""</span><span class="PUNC">,</span><span class="NAME">c.doubleSided</span><span class="PUNC">?</span><span class="STRN">"#define DOUBLE_SIDED"</span><span class="PUNC">:</span><span class="STRN">""</span><span class="PUNC">,</span><span class="NAME">c.flipSided</span><span class="PUNC">?</span><span class="STRN">"#define FLIP_SIDED"</span><span class="PUNC">:</span><span class="WHIT">
<span class='line'>516</span> </span><span class="STRN">""</span><span class="PUNC">,</span><span class="NAME">c.shadowMapEnabled</span><span class="PUNC">?</span><span class="STRN">"#define USE_SHADOWMAP"</span><span class="PUNC">:</span><span class="STRN">""</span><span class="PUNC">,</span><span class="NAME">c.shadowMapEnabled</span><span class="PUNC">?</span><span class="STRN">"#define "</span><span class="PUNC">+</span><span class="NAME">t</span><span class="PUNC">:</span><span class="STRN">""</span><span class="PUNC">,</span><span class="NAME">c.shadowMapDebug</span><span class="PUNC">?</span><span class="STRN">"#define SHADOWMAP_DEBUG"</span><span class="PUNC">:</span><span class="STRN">""</span><span class="PUNC">,</span><span class="NAME">c.shadowMapCascade</span><span class="PUNC">?</span><span class="STRN">"#define SHADOWMAP_CASCADE"</span><span class="PUNC">:</span><span class="STRN">""</span><span class="PUNC">,</span><span class="STRN">"uniform mat4 viewMatrix;\nuniform vec3 cameraPosition;\n"</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">join</span><span class="PUNC">(</span><span class="STRN">"\n"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">v</span><span class="PUNC">=</span><span class="NAME">J</span><span class="PUNC">(</span><span class="STRN">"vertex"</span><span class="PUNC">,</span><span class="NAME">v</span><span class="PUNC">+</span><span class="NAME">q</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">t</span><span class="PUNC">=</span><span class="NAME">J</span><span class="PUNC">(</span><span class="STRN">"fragment"</span><span class="PUNC">,</span><span class="NAME">t</span><span class="PUNC">+</span><span class="NAME">r</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">k.attachShader</span><span class="PUNC">(</span><span class="NAME">w</span><span class="PUNC">,</span><span class="NAME">v</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">k.attachShader</span><span class="PUNC">(</span><span class="NAME">w</span><span class="PUNC">,</span><span class="NAME">t</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">k.linkProgram</span><span class="PUNC">(</span><span class="NAME">w</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">k.getProgramParameter</span><span class="PUNC">(</span><span class="NAME">w</span><span class="PUNC">,</span><span class="NAME">k.LINK_STATUS</span><span class="PUNC">)</span><span class="PUNC">||</span><span class="NAME">console.error</span><span class="PUNC">(</span><span class="STRN">"Could not initialise shader\nVALIDATE_STATUS: "</span><span class="PUNC">+</span><span class="NAME">k.getProgramParameter</span><span class="PUNC">(</span><span class="NAME">w</span><span class="PUNC">,</span><span class="NAME">k.VALIDATE_STATUS</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="STRN">", gl error ["</span><span class="PUNC">+</span><span class="WHIT">
<span class='line'>517</span> </span><span class="NAME">k.getError</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="STRN">"]"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">k.deleteShader</span><span class="PUNC">(</span><span class="NAME">t</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">k.deleteShader</span><span class="PUNC">(</span><span class="NAME">v</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">w.uniforms</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">w.attributes</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">z</span><span class="PUNC">;</span><span class="NAME">t</span><span class="PUNC">=</span><span class="STRN">"viewMatrix modelViewMatrix projectionMatrix normalMatrix modelMatrix cameraPosition morphTargetInfluences"</span><span class="PUNC">.</span><span class="NAME">split</span><span class="PUNC">(</span><span class="STRN">" "</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">c.useVertexTexture</span><span class="PUNC">?</span><span class="NAME">t.push</span><span class="PUNC">(</span><span class="STRN">"boneTexture"</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">t.push</span><span class="PUNC">(</span><span class="STRN">"boneGlobalMatrices"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">z</span><span class="WHIT"> </span><span class="KEYW">in</span><span class="WHIT"> </span><span class="NAME">p</span><span class="PUNC">)</span><span class="NAME">t.push</span><span class="PUNC">(</span><span class="NAME">z</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">z</span><span class="PUNC">=</span><span class="NAME">t</span><span class="PUNC">;</span><span class="NAME">t</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">v</span><span class="PUNC">=</span><span class="NAME">z.length</span><span class="PUNC">;</span><span class="NAME">t</span><span class="PUNC">&lt;</span><span class="NAME">v</span><span class="PUNC">;</span><span class="NAME">t</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">p</span><span class="PUNC">=</span><span class="NAME">z</span><span class="PUNC">[</span><span class="NAME">t</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">w.uniforms</span><span class="PUNC">[</span><span class="NAME">p</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">k.getUniformLocation</span><span class="PUNC">(</span><span class="NAME">w</span><span class="PUNC">,</span><span class="NAME">p</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">t</span><span class="PUNC">=</span><span class="STRN">"position normal uv uv2 tangent color skinIndex skinWeight lineDistance"</span><span class="PUNC">.</span><span class="NAME">split</span><span class="PUNC">(</span><span class="STRN">" "</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">z</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">z</span><span class="PUNC">&lt;</span><span class="NAME">c.maxMorphTargets</span><span class="PUNC">;</span><span class="NAME">z</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">t.push</span><span class="PUNC">(</span><span class="STRN">"morphTarget"</span><span class="PUNC">+</span><span class="WHIT">
<span class='line'>518</span> </span><span class="NAME">z</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">z</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">z</span><span class="PUNC">&lt;</span><span class="NAME">c.maxMorphNormals</span><span class="PUNC">;</span><span class="NAME">z</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">t.push</span><span class="PUNC">(</span><span class="STRN">"morphNormal"</span><span class="PUNC">+</span><span class="NAME">z</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">j</span><span class="WHIT"> </span><span class="KEYW">in</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">)</span><span class="NAME">t.push</span><span class="PUNC">(</span><span class="NAME">j</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">j</span><span class="PUNC">=</span><span class="NAME">t</span><span class="PUNC">;</span><span class="NAME">z</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">j.length</span><span class="PUNC">;</span><span class="NAME">z</span><span class="PUNC">&lt;</span><span class="NAME">b</span><span class="PUNC">;</span><span class="NAME">z</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">t</span><span class="PUNC">=</span><span class="NAME">j</span><span class="PUNC">[</span><span class="NAME">z</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">w.attributes</span><span class="PUNC">[</span><span class="NAME">t</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">k.getAttribLocation</span><span class="PUNC">(</span><span class="NAME">w</span><span class="PUNC">,</span><span class="NAME">t</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">w.id</span><span class="PUNC">=</span><span class="NAME">ea</span><span class="PUNC">++</span><span class="PUNC">;</span><span class="NAME">V.push</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">program</span><span class="PUNC">:</span><span class="NAME">w</span><span class="PUNC">,</span><span class="NAME">code</span><span class="PUNC">:</span><span class="NAME">n</span><span class="PUNC">,</span><span class="NAME">usedTimes</span><span class="PUNC">:</span><span class="NUMB">1</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">D.info.memory.programs</span><span class="PUNC">=</span><span class="NAME">V.length</span><span class="PUNC">;</span><span class="NAME">j</span><span class="PUNC">=</span><span class="NAME">w</span><span class="PUNC">}</span><span class="NAME">a.program</span><span class="PUNC">=</span><span class="NAME">j</span><span class="PUNC">;</span><span class="NAME">z</span><span class="PUNC">=</span><span class="NAME">a.program.attributes</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">a.morphTargets</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">a.numSupportedMorphTargets</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">=</span><span class="STRN">"morphTarget"</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">j</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">j</span><span class="PUNC">&lt;</span><span class="NAME">this.maxMorphTargets</span><span class="PUNC">;</span><span class="NAME">j</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">w</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">+</span><span class="NAME">j</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">&lt;=</span><span class="NAME">z</span><span class="PUNC">[</span><span class="NAME">w</span><span class="PUNC">]</span><span class="PUNC">&&</span><span class="NAME">a.numSupportedMorphTargets</span><span class="PUNC">++</span><span class="PUNC">}</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">a.morphNormals</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">a.numSupportedMorphNormals</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">=</span><span class="STRN">"morphNormal"</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">j</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">j</span><span class="PUNC">&lt;</span><span class="NAME">this.maxMorphNormals</span><span class="PUNC">;</span><span class="NAME">j</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">w</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>519</span> </span><span class="NAME">b</span><span class="PUNC">+</span><span class="NAME">j</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">&lt;=</span><span class="NAME">z</span><span class="PUNC">[</span><span class="NAME">w</span><span class="PUNC">]</span><span class="PUNC">&&</span><span class="NAME">a.numSupportedMorphNormals</span><span class="PUNC">++</span><span class="PUNC">}</span><span class="NAME">a.uniformsList</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">i</span><span class="WHIT"> </span><span class="KEYW">in</span><span class="WHIT"> </span><span class="NAME">a.uniforms</span><span class="PUNC">)</span><span class="NAME">a.uniformsList.push</span><span class="PUNC">(</span><span class="PUNC">[</span><span class="NAME">a.uniforms</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">this.setFaceCulling</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">a</span><span class="PUNC">===</span><span class="NAME">THREE.CullFaceNone</span><span class="PUNC">?</span><span class="NAME">k.disable</span><span class="PUNC">(</span><span class="NAME">k.CULL_FACE</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">===</span><span class="NAME">THREE.FrontFaceDirectionCW</span><span class="PUNC">?</span><span class="NAME">k.frontFace</span><span class="PUNC">(</span><span class="NAME">k.CW</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">k.frontFace</span><span class="PUNC">(</span><span class="NAME">k.CCW</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">===</span><span class="NAME">THREE.CullFaceBack</span><span class="PUNC">?</span><span class="NAME">k.cullFace</span><span class="PUNC">(</span><span class="NAME">k.BACK</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">a</span><span class="PUNC">===</span><span class="NAME">THREE.CullFaceFront</span><span class="PUNC">?</span><span class="NAME">k.cullFace</span><span class="PUNC">(</span><span class="NAME">k.FRONT</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">k.cullFace</span><span class="PUNC">(</span><span class="NAME">k.FRONT_AND_BACK</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">k.enable</span><span class="PUNC">(</span><span class="NAME">k.CULL_FACE</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">this.setMaterialFaces</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">a.side</span><span class="PUNC">===</span><span class="NAME">THREE.DoubleSide</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">a.side</span><span class="PUNC">===</span><span class="NAME">THREE.BackSide</span><span class="PUNC">;</span><span class="NAME">da</span><span class="PUNC">!==</span><span class="WHIT">
<span class='line'>520</span> </span><span class="NAME">b</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">?</span><span class="NAME">k.disable</span><span class="PUNC">(</span><span class="NAME">k.CULL_FACE</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">k.enable</span><span class="PUNC">(</span><span class="NAME">k.CULL_FACE</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">da</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">T</span><span class="PUNC">!==</span><span class="NAME">a</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">?</span><span class="NAME">k.frontFace</span><span class="PUNC">(</span><span class="NAME">k.CW</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">k.frontFace</span><span class="PUNC">(</span><span class="NAME">k.CCW</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">T</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">this.setDepthTest</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">xa</span><span class="PUNC">!==</span><span class="NAME">a</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">?</span><span class="NAME">k.enable</span><span class="PUNC">(</span><span class="NAME">k.DEPTH_TEST</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">k.disable</span><span class="PUNC">(</span><span class="NAME">k.DEPTH_TEST</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">xa</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">this.setDepthWrite</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">ab</span><span class="PUNC">!==</span><span class="NAME">a</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">k.depthMask</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">ab</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">this.setBlending</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">a</span><span class="PUNC">!==</span><span class="NAME">aa</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">===</span><span class="NAME">THREE.NoBlending</span><span class="PUNC">?</span><span class="NAME">k.disable</span><span class="PUNC">(</span><span class="NAME">k.BLEND</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">a</span><span class="PUNC">===</span><span class="NAME">THREE.AdditiveBlending</span><span class="PUNC">?</span><span class="PUNC">(</span><span class="NAME">k.enable</span><span class="PUNC">(</span><span class="NAME">k.BLEND</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">k.blendEquation</span><span class="PUNC">(</span><span class="NAME">k.FUNC_ADD</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">k.blendFunc</span><span class="PUNC">(</span><span class="NAME">k.SRC_ALPHA</span><span class="PUNC">,</span><span class="NAME">k.ONE</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">a</span><span class="PUNC">===</span><span class="NAME">THREE.SubtractiveBlending</span><span class="PUNC">?</span><span class="PUNC">(</span><span class="NAME">k.enable</span><span class="PUNC">(</span><span class="NAME">k.BLEND</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>521</span> </span><span class="NAME">k.blendEquation</span><span class="PUNC">(</span><span class="NAME">k.FUNC_ADD</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">k.blendFunc</span><span class="PUNC">(</span><span class="NAME">k.ZERO</span><span class="PUNC">,</span><span class="NAME">k.ONE_MINUS_SRC_COLOR</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">a</span><span class="PUNC">===</span><span class="NAME">THREE.MultiplyBlending</span><span class="PUNC">?</span><span class="PUNC">(</span><span class="NAME">k.enable</span><span class="PUNC">(</span><span class="NAME">k.BLEND</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">k.blendEquation</span><span class="PUNC">(</span><span class="NAME">k.FUNC_ADD</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">k.blendFunc</span><span class="PUNC">(</span><span class="NAME">k.ZERO</span><span class="PUNC">,</span><span class="NAME">k.SRC_COLOR</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">a</span><span class="PUNC">===</span><span class="NAME">THREE.CustomBlending</span><span class="PUNC">?</span><span class="NAME">k.enable</span><span class="PUNC">(</span><span class="NAME">k.BLEND</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="PUNC">(</span><span class="NAME">k.enable</span><span class="PUNC">(</span><span class="NAME">k.BLEND</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">k.blendEquationSeparate</span><span class="PUNC">(</span><span class="NAME">k.FUNC_ADD</span><span class="PUNC">,</span><span class="NAME">k.FUNC_ADD</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">k.blendFuncSeparate</span><span class="PUNC">(</span><span class="NAME">k.SRC_ALPHA</span><span class="PUNC">,</span><span class="NAME">k.ONE_MINUS_SRC_ALPHA</span><span class="PUNC">,</span><span class="NAME">k.ONE</span><span class="PUNC">,</span><span class="NAME">k.ONE_MINUS_SRC_ALPHA</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">aa</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">===</span><span class="NAME">THREE.CustomBlending</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">!==</span><span class="NAME">na</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">k.blendEquation</span><span class="PUNC">(</span><span class="NAME">w</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">na</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">!==</span><span class="NAME">ha</span><span class="PUNC">||</span><span class="NAME">d</span><span class="PUNC">!==</span><span class="NAME">X</span><span class="PUNC">)</span><span class="NAME">k.blendFunc</span><span class="PUNC">(</span><span class="NAME">w</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">w</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">ha</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">X</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="NAME">X</span><span class="PUNC">=</span><span class="NAME">ha</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>522</span> </span><span class="NAME">na</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">this.setTexture</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">a.needsUpdate</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">a.__webglInit</span><span class="PUNC">||</span><span class="PUNC">(</span><span class="NAME">a.__webglInit</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">a.addEventListener</span><span class="PUNC">(</span><span class="STRN">"dispose"</span><span class="PUNC">,</span><span class="NAME">gc</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">a.__webglTexture</span><span class="PUNC">=</span><span class="NAME">k.createTexture</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">D.info.memory.textures</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">k.activeTexture</span><span class="PUNC">(</span><span class="NAME">k.TEXTURE0</span><span class="PUNC">+</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">k.bindTexture</span><span class="PUNC">(</span><span class="NAME">k.TEXTURE_2D</span><span class="PUNC">,</span><span class="NAME">a.__webglTexture</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">k.pixelStorei</span><span class="PUNC">(</span><span class="NAME">k.UNPACK_FLIP_Y_WEBGL</span><span class="PUNC">,</span><span class="NAME">a.flipY</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">k.pixelStorei</span><span class="PUNC">(</span><span class="NAME">k.UNPACK_PREMULTIPLY_ALPHA_WEBGL</span><span class="PUNC">,</span><span class="NAME">a.premultiplyAlpha</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">k.pixelStorei</span><span class="PUNC">(</span><span class="NAME">k.UNPACK_ALIGNMENT</span><span class="PUNC">,</span><span class="NAME">a.unpackAlignment</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">a.image</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">===</span><span class="PUNC">(</span><span class="NAME">c.width</span><span class="PUNC">&</span><span class="NAME">c.width</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="NUMB">0</span><span class="PUNC">===</span><span class="PUNC">(</span><span class="NAME">c.height</span><span class="PUNC">&</span><span class="NAME">c.height</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">w</span><span class="PUNC">(</span><span class="NAME">a.format</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>523</span> </span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">w</span><span class="PUNC">(</span><span class="NAME">a.type</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">N</span><span class="PUNC">(</span><span class="NAME">k.TEXTURE_2D</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">a.mipmaps</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">a</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">THREE.DataTexture</span><span class="PUNC">)</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">&lt;</span><span class="NAME">h.length</span><span class="PUNC">&&</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">g</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">=</span><span class="NAME">h.length</span><span class="PUNC">;</span><span class="NAME">g</span><span class="PUNC">&lt;</span><span class="NAME">i</span><span class="PUNC">;</span><span class="NAME">g</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">h</span><span class="PUNC">[</span><span class="NAME">g</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">k.texImage2D</span><span class="PUNC">(</span><span class="NAME">k.TEXTURE_2D</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">c.width</span><span class="PUNC">,</span><span class="NAME">c.height</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">c.data</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a.generateMipmaps</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="NAME">k.texImage2D</span><span class="PUNC">(</span><span class="NAME">k.TEXTURE_2D</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">c.width</span><span class="PUNC">,</span><span class="NAME">c.height</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">c.data</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">a</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">THREE.CompressedTexture</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">i</span><span class="PUNC">=</span><span class="NAME">h.length</span><span class="PUNC">;</span><span class="NAME">g</span><span class="PUNC">&lt;</span><span class="NAME">i</span><span class="PUNC">;</span><span class="NAME">g</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">h</span><span class="PUNC">[</span><span class="NAME">g</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">k.compressedTexImage2D</span><span class="PUNC">(</span><span class="NAME">k.TEXTURE_2D</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">c.width</span><span class="PUNC">,</span><span class="NAME">c.height</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">c.data</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">&lt;</span><span class="NAME">h.length</span><span class="PUNC">&&</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">i</span><span class="PUNC">=</span><span class="NAME">h.length</span><span class="PUNC">;</span><span class="NAME">g</span><span class="PUNC">&lt;</span><span class="NAME">i</span><span class="PUNC">;</span><span class="NAME">g</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">h</span><span class="PUNC">[</span><span class="NAME">g</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">k.texImage2D</span><span class="PUNC">(</span><span class="NAME">k.TEXTURE_2D</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>524</span> </span><span class="NAME">g</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a.generateMipmaps</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="NAME">k.texImage2D</span><span class="PUNC">(</span><span class="NAME">k.TEXTURE_2D</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">a.image</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a.generateMipmaps</span><span class="PUNC">&&</span><span class="NAME">d</span><span class="PUNC">&&</span><span class="NAME">k.generateMipmap</span><span class="PUNC">(</span><span class="NAME">k.TEXTURE_2D</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a.needsUpdate</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">a.onUpdate</span><span class="PUNC">)</span><span class="NAME">a.onUpdate</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="NAME">k.activeTexture</span><span class="PUNC">(</span><span class="NAME">k.TEXTURE0</span><span class="PUNC">+</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">k.bindTexture</span><span class="PUNC">(</span><span class="NAME">k.TEXTURE_2D</span><span class="PUNC">,</span><span class="NAME">a.__webglTexture</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">this.setRenderTarget</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">a</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">THREE.WebGLRenderTargetCube</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">&&</span><span class="PUNC">!</span><span class="NAME">a.__webglFramebuffer</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">===</span><span class="NAME">a.depthBuffer</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">a.depthBuffer</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">===</span><span class="NAME">a.stencilBuffer</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">a.stencilBuffer</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a.addEventListener</span><span class="PUNC">(</span><span class="STRN">"dispose"</span><span class="PUNC">,</span><span class="NAME">mc</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a.__webglTexture</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>525</span> </span><span class="NAME">k.createTexture</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">D.info.memory.textures</span><span class="PUNC">++</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">===</span><span class="PUNC">(</span><span class="NAME">a.width</span><span class="PUNC">&</span><span class="NAME">a.width</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="NUMB">0</span><span class="PUNC">===</span><span class="PUNC">(</span><span class="NAME">a.height</span><span class="PUNC">&</span><span class="NAME">a.height</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">w</span><span class="PUNC">(</span><span class="NAME">a.format</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">w</span><span class="PUNC">(</span><span class="NAME">a.type</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">a.__webglFramebuffer</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">a.__webglRenderbuffer</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">k.bindTexture</span><span class="PUNC">(</span><span class="NAME">k.TEXTURE_CUBE_MAP</span><span class="PUNC">,</span><span class="NAME">a.__webglTexture</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">N</span><span class="PUNC">(</span><span class="NAME">k.TEXTURE_CUBE_MAP</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">f</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NUMB">6</span><span class="PUNC">></span><span class="NAME">f</span><span class="PUNC">;</span><span class="NAME">f</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">a.__webglFramebuffer</span><span class="PUNC">[</span><span class="NAME">f</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">k.createFramebuffer</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a.__webglRenderbuffer</span><span class="PUNC">[</span><span class="NAME">f</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">k.createRenderbuffer</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">k.texImage2D</span><span class="PUNC">(</span><span class="NAME">k.TEXTURE_CUBE_MAP_POSITIVE_X</span><span class="PUNC">+</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">a.width</span><span class="PUNC">,</span><span class="NAME">a.height</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">,</span><span class="KEYW">null</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">k.TEXTURE_CUBE_MAP_POSITIVE_X</span><span class="PUNC">+</span><span class="NAME">f</span><span class="PUNC">;</span><span class="NAME">k.bindFramebuffer</span><span class="PUNC">(</span><span class="NAME">k.FRAMEBUFFER</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>526</span> </span><span class="NAME">a.__webglFramebuffer</span><span class="PUNC">[</span><span class="NAME">f</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">k.framebufferTexture2D</span><span class="PUNC">(</span><span class="NAME">k.FRAMEBUFFER</span><span class="PUNC">,</span><span class="NAME">k.COLOR_ATTACHMENT0</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">,</span><span class="NAME">h.__webglTexture</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">y</span><span class="PUNC">(</span><span class="NAME">a.__webglRenderbuffer</span><span class="PUNC">[</span><span class="NAME">f</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="NAME">c</span><span class="PUNC">&&</span><span class="NAME">k.generateMipmap</span><span class="PUNC">(</span><span class="NAME">k.TEXTURE_CUBE_MAP</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="NAME">a.__webglFramebuffer</span><span class="PUNC">=</span><span class="NAME">k.createFramebuffer</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">a.__webglRenderbuffer</span><span class="PUNC">=</span><span class="NAME">a.shareDepthFrom</span><span class="PUNC">?</span><span class="NAME">a.shareDepthFrom.__webglRenderbuffer</span><span class="PUNC">:</span><span class="NAME">k.createRenderbuffer</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">k.bindTexture</span><span class="PUNC">(</span><span class="NAME">k.TEXTURE_2D</span><span class="PUNC">,</span><span class="NAME">a.__webglTexture</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">N</span><span class="PUNC">(</span><span class="NAME">k.TEXTURE_2D</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">k.texImage2D</span><span class="PUNC">(</span><span class="NAME">k.TEXTURE_2D</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">a.width</span><span class="PUNC">,</span><span class="NAME">a.height</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">,</span><span class="KEYW">null</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">k.TEXTURE_2D</span><span class="PUNC">,</span><span class="NAME">k.bindFramebuffer</span><span class="PUNC">(</span><span class="NAME">k.FRAMEBUFFER</span><span class="PUNC">,</span><span class="NAME">a.__webglFramebuffer</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>527</span> </span><span class="NAME">k.framebufferTexture2D</span><span class="PUNC">(</span><span class="NAME">k.FRAMEBUFFER</span><span class="PUNC">,</span><span class="NAME">k.COLOR_ATTACHMENT0</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">a.__webglTexture</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">a.shareDepthFrom</span><span class="PUNC">?</span><span class="NAME">a.depthBuffer</span><span class="PUNC">&&</span><span class="PUNC">!</span><span class="NAME">a.stencilBuffer</span><span class="PUNC">?</span><span class="NAME">k.framebufferRenderbuffer</span><span class="PUNC">(</span><span class="NAME">k.FRAMEBUFFER</span><span class="PUNC">,</span><span class="NAME">k.DEPTH_ATTACHMENT</span><span class="PUNC">,</span><span class="NAME">k.RENDERBUFFER</span><span class="PUNC">,</span><span class="NAME">a.__webglRenderbuffer</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">a.depthBuffer</span><span class="PUNC">&&</span><span class="NAME">a.stencilBuffer</span><span class="PUNC">&&</span><span class="NAME">k.framebufferRenderbuffer</span><span class="PUNC">(</span><span class="NAME">k.FRAMEBUFFER</span><span class="PUNC">,</span><span class="NAME">k.DEPTH_STENCIL_ATTACHMENT</span><span class="PUNC">,</span><span class="NAME">k.RENDERBUFFER</span><span class="PUNC">,</span><span class="NAME">a.__webglRenderbuffer</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">y</span><span class="PUNC">(</span><span class="NAME">a.__webglRenderbuffer</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">&&</span><span class="NAME">k.generateMipmap</span><span class="PUNC">(</span><span class="NAME">k.TEXTURE_2D</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">?</span><span class="NAME">k.bindTexture</span><span class="PUNC">(</span><span class="NAME">k.TEXTURE_CUBE_MAP</span><span class="PUNC">,</span><span class="KEYW">null</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">k.bindTexture</span><span class="PUNC">(</span><span class="NAME">k.TEXTURE_2D</span><span class="PUNC">,</span><span class="KEYW">null</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">k.bindRenderbuffer</span><span class="PUNC">(</span><span class="NAME">k.RENDERBUFFER</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>528</span> </span><span class="KEYW">null</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">k.bindFramebuffer</span><span class="PUNC">(</span><span class="NAME">k.FRAMEBUFFER</span><span class="PUNC">,</span><span class="KEYW">null</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="NAME">a</span><span class="PUNC">?</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">?</span><span class="NAME">a.__webglFramebuffer</span><span class="PUNC">[</span><span class="NAME">a.activeCubeFace</span><span class="PUNC">]</span><span class="PUNC">:</span><span class="NAME">a.__webglFramebuffer</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">a.width</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">a.height</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">Qa</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">Xa</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">ua</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">Ra</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">!==</span><span class="NAME">eb</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">k.bindFramebuffer</span><span class="PUNC">(</span><span class="NAME">k.FRAMEBUFFER</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">k.viewport</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">eb</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">Xb</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">;</span><span class="NAME">Jb</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">this.shadowMapPlugin</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.ShadowMapPlugin</span><span class="PUNC">;</span><span class="NAME">this.addPrePlugin</span><span class="PUNC">(</span><span class="NAME">this.shadowMapPlugin</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.addPostPlugin</span><span class="PUNC">(</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.SpritePlugin</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.addPostPlugin</span><span class="PUNC">(</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.LensFlarePlugin</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.WebGLRenderTarget</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.width</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">this.height</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">||</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">this.wrapS</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">c.wrapS</span><span class="PUNC">?</span><span class="NAME">c.wrapS</span><span class="PUNC">:</span><span class="NAME">THREE.ClampToEdgeWrapping</span><span class="PUNC">;</span><span class="NAME">this.wrapT</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">c.wrapT</span><span class="PUNC">?</span><span class="NAME">c.wrapT</span><span class="PUNC">:</span><span class="NAME">THREE.ClampToEdgeWrapping</span><span class="PUNC">;</span><span class="NAME">this.magFilter</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">c.magFilter</span><span class="PUNC">?</span><span class="NAME">c.magFilter</span><span class="PUNC">:</span><span class="NAME">THREE.LinearFilter</span><span class="PUNC">;</span><span class="NAME">this.minFilter</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">c.minFilter</span><span class="PUNC">?</span><span class="NAME">c.minFilter</span><span class="PUNC">:</span><span class="NAME">THREE.LinearMipMapLinearFilter</span><span class="PUNC">;</span><span class="NAME">this.anisotropy</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">c.anisotropy</span><span class="PUNC">?</span><span class="NAME">c.anisotropy</span><span class="PUNC">:</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">this.offset</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector2</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.repeat</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector2</span><span class="PUNC">(</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.format</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">c.format</span><span class="PUNC">?</span><span class="NAME">c.format</span><span class="PUNC">:</span><span class="WHIT">
<span class='line'>529</span> </span><span class="NAME">THREE.RGBAFormat</span><span class="PUNC">;</span><span class="NAME">this.type</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">c.type</span><span class="PUNC">?</span><span class="NAME">c.type</span><span class="PUNC">:</span><span class="NAME">THREE.UnsignedByteType</span><span class="PUNC">;</span><span class="NAME">this.depthBuffer</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">c.depthBuffer</span><span class="PUNC">?</span><span class="NAME">c.depthBuffer</span><span class="PUNC">:</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">this.stencilBuffer</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">c.stencilBuffer</span><span class="PUNC">?</span><span class="NAME">c.stencilBuffer</span><span class="PUNC">:</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">this.generateMipmaps</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">this.shareDepthFrom</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>530</span> </span><span class="NAME">THREE.WebGLRenderTarget.prototype</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="NAME">constructor</span><span class="PUNC">:</span><span class="NAME">THREE.WebGLRenderTarget</span><span class="PUNC">,</span><span class="NAME">clone</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.WebGLRenderTarget</span><span class="PUNC">(</span><span class="NAME">this.width</span><span class="PUNC">,</span><span class="NAME">this.height</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a.wrapS</span><span class="PUNC">=</span><span class="NAME">this.wrapS</span><span class="PUNC">;</span><span class="NAME">a.wrapT</span><span class="PUNC">=</span><span class="NAME">this.wrapT</span><span class="PUNC">;</span><span class="NAME">a.magFilter</span><span class="PUNC">=</span><span class="NAME">this.magFilter</span><span class="PUNC">;</span><span class="NAME">a.minFilter</span><span class="PUNC">=</span><span class="NAME">this.minFilter</span><span class="PUNC">;</span><span class="NAME">a.anisotropy</span><span class="PUNC">=</span><span class="NAME">this.anisotropy</span><span class="PUNC">;</span><span class="NAME">a.offset.copy</span><span class="PUNC">(</span><span class="NAME">this.offset</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a.repeat.copy</span><span class="PUNC">(</span><span class="NAME">this.repeat</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a.format</span><span class="PUNC">=</span><span class="NAME">this.format</span><span class="PUNC">;</span><span class="NAME">a.type</span><span class="PUNC">=</span><span class="NAME">this.type</span><span class="PUNC">;</span><span class="NAME">a.depthBuffer</span><span class="PUNC">=</span><span class="NAME">this.depthBuffer</span><span class="PUNC">;</span><span class="NAME">a.stencilBuffer</span><span class="PUNC">=</span><span class="NAME">this.stencilBuffer</span><span class="PUNC">;</span><span class="NAME">a.generateMipmaps</span><span class="PUNC">=</span><span class="NAME">this.generateMipmaps</span><span class="PUNC">;</span><span class="NAME">a.shareDepthFrom</span><span class="PUNC">=</span><span class="NAME">this.shareDepthFrom</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>531</span> </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">dispose</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.dispatchEvent</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">type</span><span class="PUNC">:</span><span class="STRN">"dispose"</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.EventDispatcher.prototype.apply</span><span class="PUNC">(</span><span class="NAME">THREE.WebGLRenderTarget.prototype</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">THREE.WebGLRenderTargetCube</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">THREE.WebGLRenderTarget.call</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.activeCubeFace</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.WebGLRenderTargetCube.prototype</span><span class="PUNC">=</span><span class="NAME">Object.create</span><span class="PUNC">(</span><span class="NAME">THREE.WebGLRenderTarget.prototype</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">THREE.RenderableVertex</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.positionWorld</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">;</span><span class="NAME">this.positionScreen</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector4</span><span class="PUNC">;</span><span class="NAME">this.visible</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.RenderableVertex.prototype.copy</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.positionWorld.copy</span><span class="PUNC">(</span><span class="NAME">a.positionWorld</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.positionScreen.copy</span><span class="PUNC">(</span><span class="NAME">a.positionScreen</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.RenderableFace3</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.id</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">this.v1</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.RenderableVertex</span><span class="PUNC">;</span><span class="NAME">this.v2</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.RenderableVertex</span><span class="PUNC">;</span><span class="NAME">this.v3</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.RenderableVertex</span><span class="PUNC">;</span><span class="NAME">this.centroidModel</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">;</span><span class="NAME">this.normalModel</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">;</span><span class="NAME">this.normalModelView</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">;</span><span class="NAME">this.vertexNormalsLength</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">this.vertexNormalsModel</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">,</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">,</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">this.vertexNormalsModelView</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">,</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">,</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">this.material</span><span class="PUNC">=</span><span class="NAME">this.color</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">;</span><span class="NAME">this.uvs</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">this.z</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>532</span> </span><span class="NUMB">0</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.RenderableFace4</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.id</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">this.v1</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.RenderableVertex</span><span class="PUNC">;</span><span class="NAME">this.v2</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.RenderableVertex</span><span class="PUNC">;</span><span class="NAME">this.v3</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.RenderableVertex</span><span class="PUNC">;</span><span class="NAME">this.v4</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.RenderableVertex</span><span class="PUNC">;</span><span class="NAME">this.centroidModel</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">;</span><span class="NAME">this.normalModel</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">;</span><span class="NAME">this.normalModelView</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">;</span><span class="NAME">this.vertexNormalsLength</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">this.vertexNormalsModel</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">,</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">,</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">,</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">this.vertexNormalsModelView</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">,</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">,</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>533</span> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">this.material</span><span class="PUNC">=</span><span class="NAME">this.color</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">;</span><span class="NAME">this.uvs</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">this.z</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.RenderableObject</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.id</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">this.object</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">;</span><span class="NAME">this.z</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.RenderableParticle</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.id</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">this.object</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">;</span><span class="NAME">this.z</span><span class="PUNC">=</span><span class="NAME">this.y</span><span class="PUNC">=</span><span class="NAME">this.x</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">this.rotation</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">;</span><span class="NAME">this.scale</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector2</span><span class="PUNC">;</span><span class="NAME">this.material</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.RenderableLine</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.id</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">this.v1</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.RenderableVertex</span><span class="PUNC">;</span><span class="NAME">this.v2</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.RenderableVertex</span><span class="PUNC">;</span><span class="NAME">this.vertexColors</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Color</span><span class="PUNC">,</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Color</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">this.material</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">;</span><span class="NAME">this.z</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.GeometryUtils</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="NAME">merge</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">a.vertices.length</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">b</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">THREE.Mesh</span><span class="PUNC">?</span><span class="NAME">b.geometry</span><span class="PUNC">:</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">a.vertices</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">=</span><span class="NAME">h.vertices</span><span class="PUNC">,</span><span class="NAME">j</span><span class="PUNC">=</span><span class="NAME">a.faces</span><span class="PUNC">,</span><span class="NAME">l</span><span class="PUNC">=</span><span class="NAME">h.faces</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">a.faceVertexUvs</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">h.faceVertexUvs</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">===</span><span class="NAME">c</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">THREE.Mesh</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">b.matrixAutoUpdate</span><span class="PUNC">&&</span><span class="NAME">b.updateMatrix</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">b.matrix</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="PUNC">(</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Matrix3</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">getNormalMatrix</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">m</span><span class="PUNC">=</span><span class="NAME">i.length</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">&lt;</span><span class="NAME">m</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">n</span><span class="PUNC">=</span><span class="NAME">i</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">clone</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">&&</span><span class="NAME">n.applyMatrix4</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">g.push</span><span class="PUNC">(</span><span class="NAME">n</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">m</span><span class="PUNC">=</span><span class="NAME">l.length</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">&lt;</span><span class="NAME">m</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">n</span><span class="PUNC">=</span><span class="NAME">l</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">p</span><span class="PUNC">,</span><span class="NAME">t</span><span class="PUNC">,</span><span class="NAME">q</span><span class="PUNC">=</span><span class="NAME">n.vertexNormals</span><span class="PUNC">,</span><span class="NAME">r</span><span class="PUNC">=</span><span class="NAME">n.vertexColors</span><span class="PUNC">;</span><span class="NAME">n</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT">
<span class='line'>534</span> </span><span class="NAME">THREE.Face3</span><span class="PUNC">?</span><span class="NAME">p</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Face3</span><span class="PUNC">(</span><span class="NAME">n.a</span><span class="PUNC">+</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">n.b</span><span class="PUNC">+</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">n.c</span><span class="PUNC">+</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">n</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">THREE.Face4</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">p</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Face4</span><span class="PUNC">(</span><span class="NAME">n.a</span><span class="PUNC">+</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">n.b</span><span class="PUNC">+</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">n.c</span><span class="PUNC">+</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">n.d</span><span class="PUNC">+</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">p.normal.copy</span><span class="PUNC">(</span><span class="NAME">n.normal</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">&&</span><span class="NAME">p.normal.applyMatrix3</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">normalize</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">i</span><span class="PUNC">=</span><span class="NAME">q.length</span><span class="PUNC">;</span><span class="NAME">g</span><span class="PUNC">&lt;</span><span class="NAME">i</span><span class="PUNC">;</span><span class="NAME">g</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">t</span><span class="PUNC">=</span><span class="NAME">q</span><span class="PUNC">[</span><span class="NAME">g</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">clone</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">&&</span><span class="NAME">t.applyMatrix3</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">normalize</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">p.vertexNormals.push</span><span class="PUNC">(</span><span class="NAME">t</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">p.color.copy</span><span class="PUNC">(</span><span class="NAME">n.color</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">i</span><span class="PUNC">=</span><span class="NAME">r.length</span><span class="PUNC">;</span><span class="NAME">g</span><span class="PUNC">&lt;</span><span class="NAME">i</span><span class="PUNC">;</span><span class="NAME">g</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">t</span><span class="PUNC">=</span><span class="NAME">r</span><span class="PUNC">[</span><span class="NAME">g</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">p.vertexColors.push</span><span class="PUNC">(</span><span class="NAME">t.clone</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">p.materialIndex</span><span class="PUNC">=</span><span class="NAME">n.materialIndex</span><span class="PUNC">+</span><span class="NAME">c</span><span class="PUNC">;</span><span class="NAME">p.centroid.copy</span><span class="PUNC">(</span><span class="NAME">n.centroid</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">&&</span><span class="NAME">p.centroid.applyMatrix4</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">j.push</span><span class="PUNC">(</span><span class="NAME">p</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">m</span><span class="PUNC">=</span><span class="NAME">h.length</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">&lt;</span><span class="NAME">m</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">c</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>535</span> </span><span class="NAME">h</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">i</span><span class="PUNC">=</span><span class="NAME">c.length</span><span class="PUNC">;</span><span class="NAME">g</span><span class="PUNC">&lt;</span><span class="NAME">i</span><span class="PUNC">;</span><span class="NAME">g</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">d.push</span><span class="PUNC">(</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector2</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NAME">g</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">x</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NAME">g</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">y</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a.push</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">removeMaterials</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">b.length</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">&lt;</span><span class="NAME">e</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NAME">d</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">a.faces.length</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">&lt;</span><span class="NAME">e</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">a.faces</span><span class="PUNC">[</span><span class="NAME">d</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">f.materialIndex</span><span class="WHIT"> </span><span class="KEYW">in</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">||</span><span class="NAME">h.push</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a.faces</span><span class="PUNC">=</span><span class="NAME">h</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">randomPointInTriangle</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">e</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">THREE.Math.random16</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">THREE.Math.random16</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NUMB">1</span><span class="PUNC">&lt;</span><span class="NAME">f</span><span class="PUNC">+</span><span class="NAME">h</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">-</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">-</span><span class="NAME">h</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">g</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">-</span><span class="NAME">f</span><span class="PUNC">-</span><span class="NAME">h</span><span class="PUNC">;</span><span class="NAME">e.copy</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">e.multiplyScalar</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a.copy</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a.multiplyScalar</span><span class="PUNC">(</span><span class="NAME">h</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>536</span> </span><span class="NAME">e.add</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a.copy</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a.multiplyScalar</span><span class="PUNC">(</span><span class="NAME">g</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">e.add</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">e</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">randomPointInFace</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">a</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">THREE.Face3</span><span class="PUNC">)</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">b.vertices</span><span class="PUNC">[</span><span class="NAME">a.a</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">b.vertices</span><span class="PUNC">[</span><span class="NAME">a.b</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">b.vertices</span><span class="PUNC">[</span><span class="NAME">a.c</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">THREE.GeometryUtils.randomPointInTriangle</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">a</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">THREE.Face4</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">b.vertices</span><span class="PUNC">[</span><span class="NAME">a.a</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">b.vertices</span><span class="PUNC">[</span><span class="NAME">a.b</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">b.vertices</span><span class="PUNC">[</span><span class="NAME">a.c</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">b.vertices</span><span class="PUNC">[</span><span class="NAME">a.d</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">?</span><span class="NAME">a._area1</span><span class="PUNC">&&</span><span class="NAME">a._area2</span><span class="PUNC">?</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">a._area1</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">a._area2</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">THREE.GeometryUtils.triangleArea</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">THREE.GeometryUtils.triangleArea</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">a._area1</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">a._area2</span><span class="PUNC">=</span><span class="NAME">h</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="WHIT">
<span class='line'>537</span> </span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">THREE.GeometryUtils.triangleArea</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">THREE.GeometryUtils.triangleArea</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">THREE.Math.random16</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">+</span><span class="NAME">h</span><span class="PUNC">)</span><span class="PUNC">&lt;</span><span class="NAME">c</span><span class="PUNC">?</span><span class="NAME">THREE.GeometryUtils.randomPointInTriangle</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">THREE.GeometryUtils.randomPointInTriangle</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">randomPointsInGeometry</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">&lt;</span><span class="NAME">c</span><span class="PUNC">)</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">+</span><span class="NAME">Math.floor</span><span class="PUNC">(</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">-</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">/</span><span class="NUMB">2</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">j</span><span class="PUNC">[</span><span class="NAME">e</span><span class="PUNC">]</span><span class="PUNC">></span><span class="NAME">a</span><span class="PUNC">?</span><span class="NAME">b</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">j</span><span class="PUNC">[</span><span class="NAME">e</span><span class="PUNC">]</span><span class="PUNC">&lt;</span><span class="NAME">a</span><span class="PUNC">?</span><span class="NAME">b</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">e</span><span class="PUNC">}</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">j.length</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">a.faces</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">a.vertices</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">f.length</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">j</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">l</span><span class="PUNC">,</span><span class="NAME">m</span><span class="PUNC">,</span><span class="NAME">n</span><span class="PUNC">,</span><span class="NAME">p</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">&lt;</span><span class="NAME">g</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">f</span><span class="PUNC">[</span><span class="NAME">e</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">d</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">THREE.Face3</span><span class="PUNC">?</span><span class="WHIT">
<span class='line'>538</span> </span><span class="PUNC">(</span><span class="NAME">l</span><span class="PUNC">=</span><span class="NAME">h</span><span class="PUNC">[</span><span class="NAME">d.a</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">m</span><span class="PUNC">=</span><span class="NAME">h</span><span class="PUNC">[</span><span class="NAME">d.b</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">n</span><span class="PUNC">=</span><span class="NAME">h</span><span class="PUNC">[</span><span class="NAME">d.c</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">d._area</span><span class="PUNC">=</span><span class="NAME">THREE.GeometryUtils.triangleArea</span><span class="PUNC">(</span><span class="NAME">l</span><span class="PUNC">,</span><span class="NAME">m</span><span class="PUNC">,</span><span class="NAME">n</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">d</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">THREE.Face4</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">l</span><span class="PUNC">=</span><span class="NAME">h</span><span class="PUNC">[</span><span class="NAME">d.a</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">m</span><span class="PUNC">=</span><span class="NAME">h</span><span class="PUNC">[</span><span class="NAME">d.b</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">n</span><span class="PUNC">=</span><span class="NAME">h</span><span class="PUNC">[</span><span class="NAME">d.c</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">p</span><span class="PUNC">=</span><span class="NAME">h</span><span class="PUNC">[</span><span class="NAME">d.d</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">d._area1</span><span class="PUNC">=</span><span class="NAME">THREE.GeometryUtils.triangleArea</span><span class="PUNC">(</span><span class="NAME">l</span><span class="PUNC">,</span><span class="NAME">m</span><span class="PUNC">,</span><span class="NAME">p</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">d._area2</span><span class="PUNC">=</span><span class="NAME">THREE.GeometryUtils.triangleArea</span><span class="PUNC">(</span><span class="NAME">m</span><span class="PUNC">,</span><span class="NAME">n</span><span class="PUNC">,</span><span class="NAME">p</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">d._area</span><span class="PUNC">=</span><span class="NAME">d._area1</span><span class="PUNC">+</span><span class="NAME">d._area2</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">d._area</span><span class="PUNC">,</span><span class="NAME">j</span><span class="PUNC">[</span><span class="NAME">e</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">i</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">&lt;</span><span class="NAME">b</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">THREE.Math.random16</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">i</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">(</span><span class="NAME">h</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">[</span><span class="NAME">e</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">THREE.GeometryUtils.randomPointInFace</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">[</span><span class="NAME">h</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">,</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">triangleArea</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">a.subVectors</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>539</span> </span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b.subVectors</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a.cross</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NUMB">0.5</span><span class="PUNC">*</span><span class="NAME">a.length</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">center</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">a.computeBoundingBox</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">a.boundingBox</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">;</span><span class="NAME">c.addVectors</span><span class="PUNC">(</span><span class="NAME">b.min</span><span class="PUNC">,</span><span class="NAME">b.max</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">c.multiplyScalar</span><span class="PUNC">(</span><span class="PUNC">-</span><span class="NUMB">0.5</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a.applyMatrix</span><span class="PUNC">(</span><span class="PUNC">(</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Matrix4</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">makeTranslation</span><span class="PUNC">(</span><span class="NAME">c.x</span><span class="PUNC">,</span><span class="NAME">c.y</span><span class="PUNC">,</span><span class="NAME">c.z</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a.computeBoundingBox</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">triangulateQuads</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">a.faceUvs.length</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">&lt;</span><span class="NAME">c</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">h</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">a.faceVertexUvs.length</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">&lt;</span><span class="NAME">c</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">g</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">a.faces.length</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">&lt;</span><span class="NAME">c</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">a.faces</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">d</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">THREE.Face4</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">e</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>540</span> </span><span class="NAME">d.a</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">=</span><span class="NAME">d.b</span><span class="PUNC">,</span><span class="NAME">j</span><span class="PUNC">=</span><span class="NAME">d.c</span><span class="PUNC">,</span><span class="NAME">l</span><span class="PUNC">=</span><span class="NAME">d.d</span><span class="PUNC">,</span><span class="NAME">m</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Face3</span><span class="PUNC">,</span><span class="NAME">n</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Face3</span><span class="PUNC">;</span><span class="NAME">m.color.copy</span><span class="PUNC">(</span><span class="NAME">d.color</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">n.color.copy</span><span class="PUNC">(</span><span class="NAME">d.color</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">m.materialIndex</span><span class="PUNC">=</span><span class="NAME">d.materialIndex</span><span class="PUNC">;</span><span class="NAME">n.materialIndex</span><span class="PUNC">=</span><span class="NAME">d.materialIndex</span><span class="PUNC">;</span><span class="NAME">m.a</span><span class="PUNC">=</span><span class="NAME">e</span><span class="PUNC">;</span><span class="NAME">m.b</span><span class="PUNC">=</span><span class="NAME">i</span><span class="PUNC">;</span><span class="NAME">m.c</span><span class="PUNC">=</span><span class="NAME">l</span><span class="PUNC">;</span><span class="NAME">n.a</span><span class="PUNC">=</span><span class="NAME">i</span><span class="PUNC">;</span><span class="NAME">n.b</span><span class="PUNC">=</span><span class="NAME">j</span><span class="PUNC">;</span><span class="NAME">n.c</span><span class="PUNC">=</span><span class="NAME">l</span><span class="PUNC">;</span><span class="NUMB">4</span><span class="PUNC">===</span><span class="NAME">d.vertexColors.length</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">m.vertexColors</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">d.vertexColors</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">clone</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">m.vertexColors</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">d.vertexColors</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">clone</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">m.vertexColors</span><span class="PUNC">[</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">d.vertexColors</span><span class="PUNC">[</span><span class="NUMB">3</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">clone</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">n.vertexColors</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">d.vertexColors</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">clone</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">n.vertexColors</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">d.vertexColors</span><span class="PUNC">[</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">clone</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">n.vertexColors</span><span class="PUNC">[</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">d.vertexColors</span><span class="PUNC">[</span><span class="NUMB">3</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">clone</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">f.push</span><span class="PUNC">(</span><span class="NAME">m</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>541</span> </span><span class="NAME">n</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">a.faceVertexUvs.length</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">&lt;</span><span class="NAME">e</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">a.faceVertexUvs</span><span class="PUNC">[</span><span class="NAME">d</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">length</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">m</span><span class="PUNC">=</span><span class="NAME">a.faceVertexUvs</span><span class="PUNC">[</span><span class="NAME">d</span><span class="PUNC">]</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">=</span><span class="NAME">m</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">j</span><span class="PUNC">=</span><span class="NAME">m</span><span class="PUNC">[</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">l</span><span class="PUNC">=</span><span class="NAME">m</span><span class="PUNC">[</span><span class="NUMB">3</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">m</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="NAME">m</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">clone</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">i.clone</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">l.clone</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="NAME">i.clone</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">j.clone</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">l.clone</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">[</span><span class="NAME">d</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">push</span><span class="PUNC">(</span><span class="NAME">m</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">a.faceUvs.length</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">&lt;</span><span class="NAME">e</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">a.faceUvs</span><span class="PUNC">[</span><span class="NAME">d</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">length</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">i</span><span class="PUNC">=</span><span class="NAME">a.faceUvs</span><span class="PUNC">[</span><span class="NAME">d</span><span class="PUNC">]</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">[</span><span class="NAME">d</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">push</span><span class="PUNC">(</span><span class="NAME">i</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="PUNC">{</span><span class="NAME">f.push</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">a.faceUvs.length</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">&lt;</span><span class="NAME">e</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">h</span><span class="PUNC">[</span><span class="NAME">d</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">push</span><span class="PUNC">(</span><span class="NAME">a.faceUvs</span><span class="PUNC">[</span><span class="NAME">d</span><span class="PUNC">]</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">a.faceVertexUvs.length</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">&lt;</span><span class="NAME">e</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">g</span><span class="PUNC">[</span><span class="NAME">d</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">push</span><span class="PUNC">(</span><span class="NAME">a.faceVertexUvs</span><span class="PUNC">[</span><span class="NAME">d</span><span class="PUNC">]</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="NAME">a.faces</span><span class="PUNC">=</span><span class="NAME">f</span><span class="PUNC">;</span><span class="NAME">a.faceUvs</span><span class="PUNC">=</span><span class="NAME">h</span><span class="PUNC">;</span><span class="NAME">a.faceVertexUvs</span><span class="PUNC">=</span><span class="NAME">g</span><span class="PUNC">;</span><span class="NAME">a.computeCentroids</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>542</span> </span><span class="NAME">a.computeFaceNormals</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a.computeVertexNormals</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a.hasTangents</span><span class="PUNC">&&</span><span class="NAME">a.computeTangents</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">setMaterialIndex</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">a.faces</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">||</span><span class="NAME">a.length</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">||</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">&lt;=</span><span class="NAME">d</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">materialIndex</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.ImageUtils</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="NAME">crossOrigin</span><span class="PUNC">:</span><span class="STRN">"anonymous"</span><span class="PUNC">,</span><span class="NAME">loadTexture</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Image</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Texture</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.ImageLoader</span><span class="PUNC">;</span><span class="NAME">b.crossOrigin</span><span class="PUNC">=</span><span class="NAME">this.crossOrigin</span><span class="PUNC">;</span><span class="NAME">b.load</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">e.image</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">e.needsUpdate</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">&&</span><span class="NAME">c</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">e.sourceFile</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">e</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">loadCompressedTexture</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">e</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.CompressedTexture</span><span class="PUNC">;</span><span class="NAME">e.mapping</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">f</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">XMLHttpRequest</span><span class="PUNC">;</span><span class="NAME">f.onload</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">THREE.ImageUtils.parseDDS</span><span class="PUNC">(</span><span class="NAME">f.response</span><span class="PUNC">,</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">e.format</span><span class="PUNC">=</span><span class="NAME">a.format</span><span class="PUNC">;</span><span class="NAME">e.mipmaps</span><span class="PUNC">=</span><span class="NAME">a.mipmaps</span><span class="PUNC">;</span><span class="NAME">e.image.width</span><span class="PUNC">=</span><span class="NAME">a.width</span><span class="PUNC">;</span><span class="NAME">e.image.height</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>543</span> </span><span class="NAME">a.height</span><span class="PUNC">;</span><span class="NAME">e.generateMipmaps</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">e.needsUpdate</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">&&</span><span class="NAME">c</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">f.onerror</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">;</span><span class="NAME">f.open</span><span class="PUNC">(</span><span class="STRN">"GET"</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">,</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">f.responseType</span><span class="PUNC">=</span><span class="STRN">"arraybuffer"</span><span class="PUNC">;</span><span class="NAME">f.send</span><span class="PUNC">(</span><span class="KEYW">null</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">e</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">loadTextureCube</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">e</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">e.loadCount</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">f</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Texture</span><span class="PUNC">;</span><span class="NAME">f.image</span><span class="PUNC">=</span><span class="NAME">e</span><span class="PUNC">;</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">b</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">f.mapping</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">f.flipY</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">a.length</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">&lt;</span><span class="NAME">h</span><span class="PUNC">;</span><span class="PUNC">++</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">g</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Image</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">g</span><span class="PUNC">;</span><span class="NAME">g.onload</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">e.loadCount</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NUMB">6</span><span class="PUNC">===</span><span class="NAME">e.loadCount</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">f.needsUpdate</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">&&</span><span class="NAME">c</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">g.onerror</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">;</span><span class="NAME">g.crossOrigin</span><span class="PUNC">=</span><span class="NAME">this.crossOrigin</span><span class="PUNC">;</span><span class="NAME">g.src</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">]</span><span class="PUNC">}</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">f</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">loadCompressedTextureCube</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>544</span> </span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">e</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">e.loadCount</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">f</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.CompressedTexture</span><span class="PUNC">;</span><span class="NAME">f.image</span><span class="PUNC">=</span><span class="NAME">e</span><span class="PUNC">;</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">b</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">f.mapping</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">f.flipY</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">f.generateMipmaps</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">THREE.ImageUtils.parseDDS</span><span class="PUNC">(</span><span class="NAME">a.response</span><span class="PUNC">,</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b.format</span><span class="PUNC">=</span><span class="NAME">d.format</span><span class="PUNC">;</span><span class="NAME">b.mipmaps</span><span class="PUNC">=</span><span class="NAME">d.mipmaps</span><span class="PUNC">;</span><span class="NAME">b.width</span><span class="PUNC">=</span><span class="NAME">d.width</span><span class="PUNC">;</span><span class="NAME">b.height</span><span class="PUNC">=</span><span class="NAME">d.height</span><span class="PUNC">;</span><span class="NAME">e.loadCount</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NUMB">6</span><span class="PUNC">===</span><span class="NAME">e.loadCount</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">f.format</span><span class="PUNC">=</span><span class="NAME">d.format</span><span class="PUNC">,</span><span class="NAME">f.needsUpdate</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">&&</span><span class="NAME">c</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">a</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">Array</span><span class="PUNC">)</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">h</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">a.length</span><span class="PUNC">;</span><span class="NAME">h</span><span class="PUNC">&lt;</span><span class="NAME">g</span><span class="PUNC">;</span><span class="PUNC">++</span><span class="NAME">h</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">[</span><span class="NAME">h</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">i</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">j</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">XMLHttpRequest</span><span class="PUNC">;</span><span class="NAME">j.onload</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">(</span><span class="NAME">j</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">j.onerror</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">;</span><span class="NAME">i</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NAME">h</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">j.open</span><span class="PUNC">(</span><span class="STRN">"GET"</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>545</span> </span><span class="NAME">i</span><span class="PUNC">,</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">j.responseType</span><span class="PUNC">=</span><span class="STRN">"arraybuffer"</span><span class="PUNC">;</span><span class="NAME">j.send</span><span class="PUNC">(</span><span class="KEYW">null</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="NAME">j</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">XMLHttpRequest</span><span class="PUNC">,</span><span class="NAME">j.onload</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">THREE.ImageUtils.parseDDS</span><span class="PUNC">(</span><span class="NAME">j.response</span><span class="PUNC">,</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">a.isCubemap</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">a.mipmaps.length</span><span class="PUNC">/</span><span class="NAME">a.mipmapCount</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">&lt;</span><span class="NAME">b</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">e</span><span class="PUNC">[</span><span class="NAME">d</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="NAME">mipmaps</span><span class="PUNC">:</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">h</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">h</span><span class="PUNC">&lt;</span><span class="NAME">a.mipmapCount</span><span class="PUNC">;</span><span class="NAME">h</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">e</span><span class="PUNC">[</span><span class="NAME">d</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">mipmaps.push</span><span class="PUNC">(</span><span class="NAME">a.mipmaps</span><span class="PUNC">[</span><span class="NAME">d</span><span class="PUNC">*</span><span class="NAME">a.mipmapCount</span><span class="PUNC">+</span><span class="NAME">h</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">[</span><span class="NAME">d</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">format</span><span class="PUNC">=</span><span class="NAME">a.format</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">[</span><span class="NAME">d</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">width</span><span class="PUNC">=</span><span class="NAME">a.width</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">[</span><span class="NAME">d</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">height</span><span class="PUNC">=</span><span class="NAME">a.height</span><span class="PUNC">}</span><span class="NAME">f.format</span><span class="PUNC">=</span><span class="NAME">a.format</span><span class="PUNC">;</span><span class="NAME">f.needsUpdate</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">&&</span><span class="NAME">c</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">j.onerror</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">j.open</span><span class="PUNC">(</span><span class="STRN">"GET"</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">,</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">j.responseType</span><span class="PUNC">=</span><span class="STRN">"arraybuffer"</span><span class="PUNC">,</span><span class="NAME">j.send</span><span class="PUNC">(</span><span class="KEYW">null</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">f</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">parseDDS</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>546</span> </span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a.charCodeAt</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="PUNC">(</span><span class="NAME">a.charCodeAt</span><span class="PUNC">(</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">&lt;&lt;</span><span class="NUMB">8</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="PUNC">(</span><span class="NAME">a.charCodeAt</span><span class="PUNC">(</span><span class="NUMB">2</span><span class="PUNC">)</span><span class="PUNC">&lt;&lt;</span><span class="NUMB">16</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="PUNC">(</span><span class="NAME">a.charCodeAt</span><span class="PUNC">(</span><span class="NUMB">3</span><span class="PUNC">)</span><span class="PUNC">&lt;&lt;</span><span class="NUMB">24</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="NAME">mipmaps</span><span class="PUNC">:</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">width</span><span class="PUNC">:</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">height</span><span class="PUNC">:</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">format</span><span class="PUNC">:</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">mipmapCount</span><span class="PUNC">:</span><span class="NUMB">1</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">(</span><span class="STRN">"DXT1"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">(</span><span class="STRN">"DXT3"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">(</span><span class="STRN">"DXT5"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Int32Array</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">31</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NUMB">542327876</span><span class="PUNC">!==</span><span class="NAME">g</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">console.error</span><span class="PUNC">(</span><span class="STRN">"ImageUtils.parseDDS(): Invalid magic number in DDS header"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">g</span><span class="PUNC">[</span><span class="NUMB">20</span><span class="PUNC">]</span><span class="PUNC">&</span><span class="NUMB">4</span><span class="PUNC">)</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">console.error</span><span class="PUNC">(</span><span class="STRN">"ImageUtils.parseDDS(): Unsupported format, must contain a FourCC code"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">=</span><span class="NAME">g</span><span class="PUNC">[</span><span class="NUMB">21</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="KEYW">switch</span><span class="PUNC">(</span><span class="NAME">i</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="NAME">e</span><span class="PUNC">:</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NUMB">8</span><span class="PUNC">;</span><span class="NAME">d.format</span><span class="PUNC">=</span><span class="NAME">THREE.RGB_S3TC_DXT1_Format</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>547</span> </span><span class="KEYW">break</span><span class="PUNC">;</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="NAME">f</span><span class="PUNC">:</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NUMB">16</span><span class="PUNC">;</span><span class="NAME">d.format</span><span class="PUNC">=</span><span class="NAME">THREE.RGBA_S3TC_DXT3_Format</span><span class="PUNC">;</span><span class="KEYW">break</span><span class="PUNC">;</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="NAME">h</span><span class="PUNC">:</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NUMB">16</span><span class="PUNC">;</span><span class="NAME">d.format</span><span class="PUNC">=</span><span class="NAME">THREE.RGBA_S3TC_DXT5_Format</span><span class="PUNC">;</span><span class="KEYW">break</span><span class="PUNC">;</span><span class="KEYW">default</span><span class="PUNC">:</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">console.error</span><span class="PUNC">(</span><span class="STRN">"ImageUtils.parseDDS(): Unsupported FourCC code: "</span><span class="PUNC">,</span><span class="NAME">String.fromCharCode</span><span class="PUNC">(</span><span class="NAME">i</span><span class="PUNC">&</span><span class="NUMB">255</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">>></span><span class="NUMB">8</span><span class="PUNC">&</span><span class="NUMB">255</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">>></span><span class="NUMB">16</span><span class="PUNC">&</span><span class="NUMB">255</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">>></span><span class="NUMB">24</span><span class="PUNC">&</span><span class="NUMB">255</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">}</span><span class="NAME">d.mipmapCount</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">g</span><span class="PUNC">[</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">&</span><span class="NUMB">131072</span><span class="PUNC">&&</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">!==</span><span class="NAME">b</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">d.mipmapCount</span><span class="PUNC">=</span><span class="NAME">Math.max</span><span class="PUNC">(</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">[</span><span class="NUMB">7</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">d.isCubemap</span><span class="PUNC">=</span><span class="NAME">g</span><span class="PUNC">[</span><span class="NUMB">28</span><span class="PUNC">]</span><span class="PUNC">&</span><span class="NUMB">512</span><span class="PUNC">?</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">:</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">d.width</span><span class="PUNC">=</span><span class="NAME">g</span><span class="PUNC">[</span><span class="NUMB">4</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">d.height</span><span class="PUNC">=</span><span class="NAME">g</span><span class="PUNC">[</span><span class="NUMB">3</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">g</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">+</span><span class="NUMB">4</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">d.width</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">d.height</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">=</span><span class="NAME">d.isCubemap</span><span class="PUNC">?</span><span class="NUMB">6</span><span class="PUNC">:</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">j</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">j</span><span class="PUNC">&lt;</span><span class="NAME">i</span><span class="PUNC">;</span><span class="NAME">j</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">l</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">l</span><span class="PUNC">&lt;</span><span class="NAME">d.mipmapCount</span><span class="PUNC">;</span><span class="NAME">l</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">m</span><span class="PUNC">=</span><span class="NAME">Math.max</span><span class="PUNC">(</span><span class="NUMB">4</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">/</span><span class="WHIT">
<span class='line'>548</span> </span><span class="NUMB">4</span><span class="PUNC">*</span><span class="NAME">Math.max</span><span class="PUNC">(</span><span class="NUMB">4</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">)</span><span class="PUNC">/</span><span class="NUMB">4</span><span class="PUNC">*</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">n</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="NAME">data</span><span class="PUNC">:</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Uint8Array</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">,</span><span class="NAME">m</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">width</span><span class="PUNC">:</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">height</span><span class="PUNC">:</span><span class="NAME">h</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">d.mipmaps.push</span><span class="PUNC">(</span><span class="NAME">n</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">g</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">m</span><span class="PUNC">;</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">Math.max</span><span class="PUNC">(</span><span class="NUMB">0.5</span><span class="PUNC">*</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">Math.max</span><span class="PUNC">(</span><span class="NUMB">0.5</span><span class="PUNC">*</span><span class="NAME">h</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">d.width</span><span class="PUNC">;</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">d.height</span><span class="PUNC">}</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">getNormalMap</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">Math.sqrt</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">*</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">+</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">*</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">+</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">*</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">/</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">/</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">/</span><span class="NAME">b</span><span class="PUNC">]</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">|</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">a.width</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">a.height</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">document.createElement</span><span class="PUNC">(</span><span class="STRN">"canvas"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">f.width</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">;</span><span class="NAME">f.height</span><span class="PUNC">=</span><span class="NAME">e</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">f.getContext</span><span class="PUNC">(</span><span class="STRN">"2d"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">h.drawImage</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">h.getImageData</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">data</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">=</span><span class="NAME">h.createImageData</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">j</span><span class="PUNC">=</span><span class="NAME">i.data</span><span class="PUNC">,</span><span class="NAME">l</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">l</span><span class="PUNC">&lt;</span><span class="NAME">d</span><span class="PUNC">;</span><span class="NAME">l</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">m</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>549</span> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">m</span><span class="PUNC">&lt;</span><span class="NAME">e</span><span class="PUNC">;</span><span class="NAME">m</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">n</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">></span><span class="NAME">m</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">?</span><span class="NUMB">0</span><span class="PUNC">:</span><span class="NAME">m</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">p</span><span class="PUNC">=</span><span class="NAME">m</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">></span><span class="NAME">e</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">?</span><span class="NAME">e</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">:</span><span class="NAME">m</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">t</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">></span><span class="NAME">l</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">?</span><span class="NUMB">0</span><span class="PUNC">:</span><span class="NAME">l</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">q</span><span class="PUNC">=</span><span class="NAME">l</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">></span><span class="NAME">d</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">?</span><span class="NAME">d</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">:</span><span class="NAME">l</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">r</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">s</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">[</span><span class="NUMB">4</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">m</span><span class="PUNC">*</span><span class="NAME">d</span><span class="PUNC">+</span><span class="NAME">l</span><span class="PUNC">)</span><span class="PUNC">]</span><span class="PUNC">/</span><span class="NUMB">255</span><span class="PUNC">*</span><span class="NAME">b</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">r.push</span><span class="PUNC">(</span><span class="PUNC">[</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">[</span><span class="NUMB">4</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">m</span><span class="PUNC">*</span><span class="NAME">d</span><span class="PUNC">+</span><span class="NAME">t</span><span class="PUNC">)</span><span class="PUNC">]</span><span class="PUNC">/</span><span class="NUMB">255</span><span class="PUNC">*</span><span class="NAME">b</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">r.push</span><span class="PUNC">(</span><span class="PUNC">[</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">[</span><span class="NUMB">4</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">n</span><span class="PUNC">*</span><span class="NAME">d</span><span class="PUNC">+</span><span class="NAME">t</span><span class="PUNC">)</span><span class="PUNC">]</span><span class="PUNC">/</span><span class="NUMB">255</span><span class="PUNC">*</span><span class="NAME">b</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">r.push</span><span class="PUNC">(</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">[</span><span class="NUMB">4</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">n</span><span class="PUNC">*</span><span class="NAME">d</span><span class="PUNC">+</span><span class="NAME">l</span><span class="PUNC">)</span><span class="PUNC">]</span><span class="PUNC">/</span><span class="NUMB">255</span><span class="PUNC">*</span><span class="NAME">b</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">r.push</span><span class="PUNC">(</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">[</span><span class="NUMB">4</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">n</span><span class="PUNC">*</span><span class="NAME">d</span><span class="PUNC">+</span><span class="NAME">q</span><span class="PUNC">)</span><span class="PUNC">]</span><span class="PUNC">/</span><span class="NUMB">255</span><span class="PUNC">*</span><span class="NAME">b</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">r.push</span><span class="PUNC">(</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">[</span><span class="NUMB">4</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">m</span><span class="PUNC">*</span><span class="NAME">d</span><span class="PUNC">+</span><span class="NAME">q</span><span class="PUNC">)</span><span class="PUNC">]</span><span class="PUNC">/</span><span class="NUMB">255</span><span class="PUNC">*</span><span class="NAME">b</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">r.push</span><span class="PUNC">(</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">[</span><span class="NUMB">4</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">p</span><span class="PUNC">*</span><span class="NAME">d</span><span class="PUNC">+</span><span class="NAME">q</span><span class="PUNC">)</span><span class="PUNC">]</span><span class="PUNC">/</span><span class="NUMB">255</span><span class="PUNC">*</span><span class="NAME">b</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">r.push</span><span class="PUNC">(</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">[</span><span class="NUMB">4</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">p</span><span class="PUNC">*</span><span class="NAME">d</span><span class="PUNC">+</span><span class="NAME">l</span><span class="PUNC">)</span><span class="PUNC">]</span><span class="PUNC">/</span><span class="NUMB">255</span><span class="PUNC">*</span><span class="NAME">b</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">r.push</span><span class="PUNC">(</span><span class="PUNC">[</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">[</span><span class="NUMB">4</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">p</span><span class="PUNC">*</span><span class="NAME">d</span><span class="PUNC">+</span><span class="NAME">t</span><span class="PUNC">)</span><span class="PUNC">]</span><span class="PUNC">/</span><span class="NUMB">255</span><span class="PUNC">*</span><span class="NAME">b</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">n</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">t</span><span class="PUNC">=</span><span class="NAME">r.length</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">p</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">p</span><span class="PUNC">&lt;</span><span class="NAME">t</span><span class="PUNC">;</span><span class="NAME">p</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">q</span><span class="PUNC">=</span><span class="NAME">r</span><span class="PUNC">[</span><span class="NAME">p</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">v</span><span class="PUNC">=</span><span class="NAME">r</span><span class="PUNC">[</span><span class="PUNC">(</span><span class="NAME">p</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">%</span><span class="NAME">t</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">q</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="NAME">q</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">-</span><span class="NAME">s</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">q</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">-</span><span class="NAME">s</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">q</span><span class="PUNC">[</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">-</span><span class="NAME">s</span><span class="PUNC">[</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">v</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="NAME">v</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">-</span><span class="NAME">s</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">v</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">-</span><span class="NAME">s</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">v</span><span class="PUNC">[</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">-</span><span class="NAME">s</span><span class="PUNC">[</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>550</span> </span><span class="NAME">n.push</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">(</span><span class="PUNC">[</span><span class="NAME">q</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">*</span><span class="NAME">v</span><span class="PUNC">[</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">-</span><span class="NAME">q</span><span class="PUNC">[</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">*</span><span class="NAME">v</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">q</span><span class="PUNC">[</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">*</span><span class="NAME">v</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">-</span><span class="NAME">q</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">*</span><span class="NAME">v</span><span class="PUNC">[</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">q</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">*</span><span class="NAME">v</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">-</span><span class="NAME">q</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">*</span><span class="NAME">v</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="NAME">r</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">p</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">p</span><span class="PUNC">&lt;</span><span class="NAME">n.length</span><span class="PUNC">;</span><span class="NAME">p</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">r</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">n</span><span class="PUNC">[</span><span class="NAME">p</span><span class="PUNC">]</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">r</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">n</span><span class="PUNC">[</span><span class="NAME">p</span><span class="PUNC">]</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">r</span><span class="PUNC">[</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">n</span><span class="PUNC">[</span><span class="NAME">p</span><span class="PUNC">]</span><span class="PUNC">[</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">r</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">/</span><span class="PUNC">=</span><span class="NAME">n.length</span><span class="PUNC">;</span><span class="NAME">r</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">/</span><span class="PUNC">=</span><span class="NAME">n.length</span><span class="PUNC">;</span><span class="NAME">r</span><span class="PUNC">[</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">/</span><span class="PUNC">=</span><span class="NAME">n.length</span><span class="PUNC">;</span><span class="NAME">s</span><span class="PUNC">=</span><span class="NUMB">4</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">m</span><span class="PUNC">*</span><span class="NAME">d</span><span class="PUNC">+</span><span class="NAME">l</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">j</span><span class="PUNC">[</span><span class="NAME">s</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NUMB">255</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="PUNC">(</span><span class="NAME">r</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">/</span><span class="NUMB">2</span><span class="PUNC">)</span><span class="PUNC">|</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">j</span><span class="PUNC">[</span><span class="NAME">s</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NUMB">255</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="PUNC">(</span><span class="NAME">r</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">/</span><span class="NUMB">2</span><span class="PUNC">)</span><span class="PUNC">|</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">j</span><span class="PUNC">[</span><span class="NAME">s</span><span class="PUNC">+</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NUMB">255</span><span class="PUNC">*</span><span class="NAME">r</span><span class="PUNC">[</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">|</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">j</span><span class="PUNC">[</span><span class="NAME">s</span><span class="PUNC">+</span><span class="NUMB">3</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NUMB">255</span><span class="PUNC">}</span><span class="NAME">h.putImageData</span><span class="PUNC">(</span><span class="NAME">i</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">f</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">generateDataTexture</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">*</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Uint8Array</span><span class="PUNC">(</span><span class="NUMB">3</span><span class="PUNC">*</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">Math.floor</span><span class="PUNC">(</span><span class="NUMB">255</span><span class="PUNC">*</span><span class="NAME">c.r</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">Math.floor</span><span class="PUNC">(</span><span class="NUMB">255</span><span class="PUNC">*</span><span class="NAME">c.g</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">Math.floor</span><span class="PUNC">(</span><span class="NUMB">255</span><span class="PUNC">*</span><span class="NAME">c.b</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">g</span><span class="PUNC">&lt;</span><span class="NAME">d</span><span class="PUNC">;</span><span class="NAME">g</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">e</span><span class="PUNC">[</span><span class="NUMB">3</span><span class="PUNC">*</span><span class="NAME">g</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">[</span><span class="NUMB">3</span><span class="PUNC">*</span><span class="NAME">g</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">h</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">[</span><span class="NUMB">3</span><span class="PUNC">*</span><span class="NAME">g</span><span class="PUNC">+</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.DataTexture</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>551</span> </span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">THREE.RGBFormat</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a.needsUpdate</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.SceneUtils</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="NAME">createMultiMaterialObject</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Object3D</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">b.length</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">&lt;</span><span class="NAME">e</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">c.add</span><span class="PUNC">(</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Mesh</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NAME">d</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">detach</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">a.applyMatrix</span><span class="PUNC">(</span><span class="NAME">b.matrixWorld</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b.remove</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">c.add</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">attach</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Matrix4</span><span class="PUNC">;</span><span class="NAME">d.getInverse</span><span class="PUNC">(</span><span class="NAME">c.matrixWorld</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a.applyMatrix</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b.remove</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">c.add</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.FontUtils</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="NAME">faces</span><span class="PUNC">:</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">face</span><span class="PUNC">:</span><span class="STRN">"helvetiker"</span><span class="PUNC">,</span><span class="NAME">weight</span><span class="PUNC">:</span><span class="STRN">"normal"</span><span class="PUNC">,</span><span class="NAME">style</span><span class="PUNC">:</span><span class="STRN">"normal"</span><span class="PUNC">,</span><span class="NAME">size</span><span class="PUNC">:</span><span class="NUMB">150</span><span class="PUNC">,</span><span class="NAME">divisions</span><span class="PUNC">:</span><span class="NUMB">10</span><span class="PUNC">,</span><span class="NAME">getFace</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.faces</span><span class="PUNC">[</span><span class="NAME">this.face</span><span class="PUNC">]</span><span class="PUNC">[</span><span class="NAME">this.weight</span><span class="PUNC">]</span><span class="PUNC">[</span><span class="NAME">this.style</span><span class="PUNC">]</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">loadFace</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">a.familyName.toLowerCase</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.faces</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">this.faces</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">]</span><span class="PUNC">||</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">this.faces</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">]</span><span class="PUNC">[</span><span class="NAME">a.cssFontWeight</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">this.faces</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">]</span><span class="PUNC">[</span><span class="NAME">a.cssFontWeight</span><span class="PUNC">]</span><span class="PUNC">||</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">this.faces</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">]</span><span class="PUNC">[</span><span class="NAME">a.cssFontWeight</span><span class="PUNC">]</span><span class="PUNC">[</span><span class="NAME">a.cssFontStyle</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.faces</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">]</span><span class="PUNC">[</span><span class="NAME">a.cssFontWeight</span><span class="PUNC">]</span><span class="PUNC">[</span><span class="NAME">a.cssFontStyle</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">drawText</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.getFace</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.size</span><span class="PUNC">/</span><span class="NAME">b.resolution</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>552</span> </span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">String</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">split</span><span class="PUNC">(</span><span class="STRN">""</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">e.length</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">&lt;</span><span class="NAME">f</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">g</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Path</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">this.extractGlyphPoints</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">+</span><span class="NAME">g.offset</span><span class="PUNC">;</span><span class="NAME">h.push</span><span class="PUNC">(</span><span class="NAME">g.path</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">return</span><span class="PUNC">{</span><span class="NAME">paths</span><span class="PUNC">:</span><span class="NAME">h</span><span class="PUNC">,</span><span class="NAME">offset</span><span class="PUNC">:</span><span class="NAME">d</span><span class="PUNC">/</span><span class="NUMB">2</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">extractGlyphPoints</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">f</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">,</span><span class="NAME">j</span><span class="PUNC">,</span><span class="NAME">l</span><span class="PUNC">,</span><span class="NAME">m</span><span class="PUNC">,</span><span class="NAME">n</span><span class="PUNC">,</span><span class="NAME">p</span><span class="PUNC">,</span><span class="NAME">t</span><span class="PUNC">,</span><span class="NAME">q</span><span class="PUNC">,</span><span class="NAME">r</span><span class="PUNC">,</span><span class="NAME">s</span><span class="PUNC">=</span><span class="NAME">b.glyphs</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">]</span><span class="PUNC">||</span><span class="NAME">b.glyphs</span><span class="PUNC">[</span><span class="STRN">"?"</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">s</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">s.o</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">s._cachedOutline</span><span class="PUNC">||</span><span class="PUNC">(</span><span class="NAME">s._cachedOutline</span><span class="PUNC">=</span><span class="NAME">s.o.split</span><span class="PUNC">(</span><span class="STRN">" "</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">j</span><span class="PUNC">=</span><span class="NAME">b.length</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">&lt;</span><span class="NAME">j</span><span class="PUNC">;</span><span class="PUNC">)</span><span class="KEYW">switch</span><span class="PUNC">(</span><span class="NAME">i</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">++</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"m"</span><span class="PUNC">:</span><span class="NAME">i</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">++</span><span class="PUNC">]</span><span class="PUNC">*</span><span class="NAME">c</span><span class="PUNC">+</span><span class="NAME">d</span><span class="PUNC">;</span><span class="NAME">l</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">++</span><span class="PUNC">]</span><span class="PUNC">*</span><span class="NAME">c</span><span class="PUNC">;</span><span class="NAME">e.moveTo</span><span class="PUNC">(</span><span class="NAME">i</span><span class="PUNC">,</span><span class="NAME">l</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">break</span><span class="PUNC">;</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"l"</span><span class="PUNC">:</span><span class="NAME">i</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">++</span><span class="PUNC">]</span><span class="PUNC">*</span><span class="NAME">c</span><span class="PUNC">+</span><span class="NAME">d</span><span class="PUNC">;</span><span class="NAME">l</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">++</span><span class="PUNC">]</span><span class="PUNC">*</span><span class="NAME">c</span><span class="PUNC">;</span><span class="NAME">e.lineTo</span><span class="PUNC">(</span><span class="NAME">i</span><span class="PUNC">,</span><span class="NAME">l</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">break</span><span class="PUNC">;</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"q"</span><span class="PUNC">:</span><span class="NAME">i</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">++</span><span class="PUNC">]</span><span class="PUNC">*</span><span class="WHIT">
<span class='line'>553</span> </span><span class="NAME">c</span><span class="PUNC">+</span><span class="NAME">d</span><span class="PUNC">;</span><span class="NAME">l</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">++</span><span class="PUNC">]</span><span class="PUNC">*</span><span class="NAME">c</span><span class="PUNC">;</span><span class="NAME">p</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">++</span><span class="PUNC">]</span><span class="PUNC">*</span><span class="NAME">c</span><span class="PUNC">+</span><span class="NAME">d</span><span class="PUNC">;</span><span class="NAME">t</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">++</span><span class="PUNC">]</span><span class="PUNC">*</span><span class="NAME">c</span><span class="PUNC">;</span><span class="NAME">e.quadraticCurveTo</span><span class="PUNC">(</span><span class="NAME">p</span><span class="PUNC">,</span><span class="NAME">t</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">,</span><span class="NAME">l</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">f</span><span class="PUNC">[</span><span class="NAME">f.length</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">m</span><span class="PUNC">=</span><span class="NAME">h.x</span><span class="PUNC">;</span><span class="NAME">n</span><span class="PUNC">=</span><span class="NAME">h.y</span><span class="PUNC">;</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">this.divisions</span><span class="PUNC">;</span><span class="NAME">h</span><span class="PUNC">&lt;=</span><span class="NAME">g</span><span class="PUNC">;</span><span class="NAME">h</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">v</span><span class="PUNC">=</span><span class="NAME">h</span><span class="PUNC">/</span><span class="NAME">g</span><span class="PUNC">;</span><span class="NAME">THREE.Shape.Utils.b2</span><span class="PUNC">(</span><span class="NAME">v</span><span class="PUNC">,</span><span class="NAME">m</span><span class="PUNC">,</span><span class="NAME">p</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">THREE.Shape.Utils.b2</span><span class="PUNC">(</span><span class="NAME">v</span><span class="PUNC">,</span><span class="NAME">n</span><span class="PUNC">,</span><span class="NAME">t</span><span class="PUNC">,</span><span class="NAME">l</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="KEYW">break</span><span class="PUNC">;</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="STRN">"b"</span><span class="PUNC">:</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">i</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">++</span><span class="PUNC">]</span><span class="PUNC">*</span><span class="NAME">c</span><span class="PUNC">+</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">l</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">++</span><span class="PUNC">]</span><span class="PUNC">*</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">p</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">++</span><span class="PUNC">]</span><span class="PUNC">*</span><span class="NAME">c</span><span class="PUNC">+</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">t</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">++</span><span class="PUNC">]</span><span class="PUNC">*</span><span class="PUNC">-</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">q</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">++</span><span class="PUNC">]</span><span class="PUNC">*</span><span class="NAME">c</span><span class="PUNC">+</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">r</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">++</span><span class="PUNC">]</span><span class="PUNC">*</span><span class="PUNC">-</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">e.bezierCurveTo</span><span class="PUNC">(</span><span class="NAME">i</span><span class="PUNC">,</span><span class="NAME">l</span><span class="PUNC">,</span><span class="NAME">p</span><span class="PUNC">,</span><span class="NAME">t</span><span class="PUNC">,</span><span class="NAME">q</span><span class="PUNC">,</span><span class="NAME">r</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">f</span><span class="PUNC">[</span><span class="NAME">f.length</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">m</span><span class="PUNC">=</span><span class="NAME">h.x</span><span class="PUNC">;</span><span class="NAME">n</span><span class="PUNC">=</span><span class="NAME">h.y</span><span class="PUNC">;</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">this.divisions</span><span class="PUNC">;</span><span class="NAME">h</span><span class="PUNC">&lt;=</span><span class="NAME">g</span><span class="PUNC">;</span><span class="NAME">h</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">v</span><span class="PUNC">=</span><span class="NAME">h</span><span class="PUNC">/</span><span class="NAME">g</span><span class="PUNC">,</span><span class="NAME">THREE.Shape.Utils.b3</span><span class="PUNC">(</span><span class="NAME">v</span><span class="PUNC">,</span><span class="NAME">m</span><span class="PUNC">,</span><span class="NAME">p</span><span class="PUNC">,</span><span class="NAME">q</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">THREE.Shape.Utils.b3</span><span class="PUNC">(</span><span class="NAME">v</span><span class="PUNC">,</span><span class="NAME">n</span><span class="PUNC">,</span><span class="NAME">t</span><span class="PUNC">,</span><span class="NAME">r</span><span class="PUNC">,</span><span class="NAME">l</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="KEYW">return</span><span class="PUNC">{</span><span class="NAME">offset</span><span class="PUNC">:</span><span class="NAME">s.ha</span><span class="PUNC">*</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">path</span><span class="PUNC">:</span><span class="NAME">e</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>554</span> </span><span class="NAME">THREE.FontUtils.generateShapes</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">||</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">b.curveSegments</span><span class="PUNC">?</span><span class="NAME">b.curveSegments</span><span class="PUNC">:</span><span class="NUMB">4</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">b.font</span><span class="PUNC">?</span><span class="NAME">b.font</span><span class="PUNC">:</span><span class="STRN">"helvetiker"</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">b.weight</span><span class="PUNC">?</span><span class="NAME">b.weight</span><span class="PUNC">:</span><span class="STRN">"normal"</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">b.style</span><span class="PUNC">?</span><span class="NAME">b.style</span><span class="PUNC">:</span><span class="STRN">"normal"</span><span class="PUNC">;</span><span class="NAME">THREE.FontUtils.size</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">b.size</span><span class="PUNC">?</span><span class="NAME">b.size</span><span class="PUNC">:</span><span class="NUMB">100</span><span class="PUNC">;</span><span class="NAME">THREE.FontUtils.divisions</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">;</span><span class="NAME">THREE.FontUtils.face</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">;</span><span class="NAME">THREE.FontUtils.weight</span><span class="PUNC">=</span><span class="NAME">e</span><span class="PUNC">;</span><span class="NAME">THREE.FontUtils.style</span><span class="PUNC">=</span><span class="NAME">f</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">THREE.FontUtils.drawText</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">paths</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">c.length</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">&lt;</span><span class="NAME">f</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">Array.prototype.push.apply</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NAME">e</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">toShapes</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>555</span> </span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">a.length</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">h</span><span class="PUNC">&lt;</span><span class="NAME">b</span><span class="PUNC">;</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">h</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">e</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NAME">f</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">x</span><span class="PUNC">*</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NAME">h</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">y</span><span class="PUNC">-</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NAME">h</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">x</span><span class="PUNC">*</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NAME">f</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">y</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NUMB">0.5</span><span class="PUNC">*</span><span class="NAME">e</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">a.Triangulate</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">a.length</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NUMB">3</span><span class="PUNC">></span><span class="NAME">e</span><span class="PUNC">)</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">f</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">,</span><span class="NAME">j</span><span class="PUNC">,</span><span class="NAME">l</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">&lt;</span><span class="NAME">b</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">j</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">j</span><span class="PUNC">&lt;</span><span class="NAME">e</span><span class="PUNC">;</span><span class="NAME">j</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">h</span><span class="PUNC">[</span><span class="NAME">j</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">j</span><span class="PUNC">;</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">j</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">j</span><span class="PUNC">&lt;</span><span class="NAME">e</span><span class="PUNC">;</span><span class="NAME">j</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">h</span><span class="PUNC">[</span><span class="NAME">j</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">e</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">-</span><span class="NAME">j</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">m</span><span class="PUNC">=</span><span class="NUMB">2</span><span class="PUNC">*</span><span class="NAME">e</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">j</span><span class="PUNC">=</span><span class="NAME">e</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NUMB">2</span><span class="PUNC">&lt;</span><span class="NAME">e</span><span class="PUNC">;</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">>=</span><span class="NAME">m</span><span class="PUNC">--</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">console.log</span><span class="PUNC">(</span><span class="STRN">"Warning, unable to triangulate polygon!"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">break</span><span class="PUNC">}</span><span class="NAME">i</span><span class="PUNC">=</span><span class="NAME">j</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">&lt;=</span><span class="NAME">i</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">i</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">j</span><span class="PUNC">=</span><span class="NAME">i</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">&lt;=</span><span class="NAME">j</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">j</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">l</span><span class="PUNC">=</span><span class="NAME">j</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">&lt;=</span><span class="NAME">l</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">l</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">n</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">:</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">p</span><span class="PUNC">=</span><span class="NAME">n</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">t</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">q</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">r</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">s</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">v</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">z</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">C</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>556</span> </span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">p</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NAME">h</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">x</span><span class="PUNC">,</span><span class="NAME">t</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NAME">h</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">y</span><span class="PUNC">,</span><span class="NAME">q</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NAME">h</span><span class="PUNC">[</span><span class="NAME">j</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">x</span><span class="PUNC">,</span><span class="NAME">r</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NAME">h</span><span class="PUNC">[</span><span class="NAME">j</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">y</span><span class="PUNC">,</span><span class="NAME">s</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NAME">h</span><span class="PUNC">[</span><span class="NAME">l</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">x</span><span class="PUNC">,</span><span class="NAME">v</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NAME">h</span><span class="PUNC">[</span><span class="NAME">l</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">y</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NUMB">1</span><span class="NAME">E</span><span class="PUNC">-</span><span class="NUMB">10</span><span class="PUNC">></span><span class="PUNC">(</span><span class="NAME">q</span><span class="PUNC">-</span><span class="NAME">p</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">v</span><span class="PUNC">-</span><span class="NAME">t</span><span class="PUNC">)</span><span class="PUNC">-</span><span class="PUNC">(</span><span class="NAME">r</span><span class="PUNC">-</span><span class="NAME">t</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">s</span><span class="PUNC">-</span><span class="NAME">p</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="NAME">n</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="KEYW">else</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">F</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">H</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">I</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">G</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">A</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">K</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">B</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">J</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">N</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">y</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">N</span><span class="PUNC">=</span><span class="NAME">J</span><span class="PUNC">=</span><span class="NAME">B</span><span class="PUNC">=</span><span class="NAME">C</span><span class="PUNC">=</span><span class="NAME">z</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">F</span><span class="PUNC">=</span><span class="NAME">s</span><span class="PUNC">-</span><span class="NAME">q</span><span class="PUNC">,</span><span class="NAME">H</span><span class="PUNC">=</span><span class="NAME">v</span><span class="PUNC">-</span><span class="NAME">r</span><span class="PUNC">,</span><span class="NAME">I</span><span class="PUNC">=</span><span class="NAME">p</span><span class="PUNC">-</span><span class="NAME">s</span><span class="PUNC">,</span><span class="NAME">G</span><span class="PUNC">=</span><span class="NAME">t</span><span class="PUNC">-</span><span class="NAME">v</span><span class="PUNC">,</span><span class="NAME">A</span><span class="PUNC">=</span><span class="NAME">q</span><span class="PUNC">-</span><span class="NAME">p</span><span class="PUNC">,</span><span class="NAME">K</span><span class="PUNC">=</span><span class="NAME">r</span><span class="PUNC">-</span><span class="NAME">t</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">n</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">n</span><span class="PUNC">&lt;</span><span class="NAME">e</span><span class="PUNC">;</span><span class="NAME">n</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="PUNC">(</span><span class="NAME">n</span><span class="PUNC">===</span><span class="NAME">i</span><span class="PUNC">||</span><span class="NAME">n</span><span class="PUNC">===</span><span class="NAME">j</span><span class="PUNC">||</span><span class="NAME">n</span><span class="PUNC">===</span><span class="NAME">l</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">z</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NAME">h</span><span class="PUNC">[</span><span class="NAME">n</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">x</span><span class="PUNC">,</span><span class="NAME">C</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NAME">h</span><span class="PUNC">[</span><span class="NAME">n</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">y</span><span class="PUNC">,</span><span class="NAME">B</span><span class="PUNC">=</span><span class="NAME">z</span><span class="PUNC">-</span><span class="NAME">p</span><span class="PUNC">,</span><span class="NAME">J</span><span class="PUNC">=</span><span class="NAME">C</span><span class="PUNC">-</span><span class="NAME">t</span><span class="PUNC">,</span><span class="NAME">N</span><span class="PUNC">=</span><span class="NAME">z</span><span class="PUNC">-</span><span class="NAME">q</span><span class="PUNC">,</span><span class="NAME">y</span><span class="PUNC">=</span><span class="NAME">C</span><span class="PUNC">-</span><span class="NAME">r</span><span class="PUNC">,</span><span class="NAME">z</span><span class="PUNC">-</span><span class="PUNC">=</span><span class="NAME">s</span><span class="PUNC">,</span><span class="NAME">C</span><span class="PUNC">-</span><span class="PUNC">=</span><span class="NAME">v</span><span class="PUNC">,</span><span class="NAME">N</span><span class="PUNC">=</span><span class="NAME">F</span><span class="PUNC">*</span><span class="NAME">y</span><span class="PUNC">-</span><span class="NAME">H</span><span class="PUNC">*</span><span class="NAME">N</span><span class="PUNC">,</span><span class="NAME">B</span><span class="PUNC">=</span><span class="NAME">A</span><span class="PUNC">*</span><span class="NAME">J</span><span class="PUNC">-</span><span class="NAME">K</span><span class="PUNC">*</span><span class="NAME">B</span><span class="PUNC">,</span><span class="NAME">J</span><span class="PUNC">=</span><span class="NAME">I</span><span class="PUNC">*</span><span class="NAME">C</span><span class="PUNC">-</span><span class="NAME">G</span><span class="PUNC">*</span><span class="NAME">z</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">&lt;=</span><span class="NAME">N</span><span class="PUNC">&&</span><span class="NUMB">0</span><span class="PUNC">&lt;=</span><span class="NAME">J</span><span class="PUNC">&&</span><span class="NUMB">0</span><span class="PUNC">&lt;=</span><span class="NAME">B</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">n</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="KEYW">break</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">}</span><span class="NAME">n</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">n</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">f.push</span><span class="PUNC">(</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NAME">h</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NAME">h</span><span class="PUNC">[</span><span class="NAME">j</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NAME">h</span><span class="PUNC">[</span><span class="NAME">l</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">g.push</span><span class="PUNC">(</span><span class="PUNC">[</span><span class="NAME">h</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">[</span><span class="NAME">j</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">[</span><span class="NAME">l</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>557</span> </span><span class="NAME">i</span><span class="PUNC">=</span><span class="NAME">j</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">l</span><span class="PUNC">=</span><span class="NAME">j</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">l</span><span class="PUNC">&lt;</span><span class="NAME">e</span><span class="PUNC">;</span><span class="NAME">i</span><span class="PUNC">++</span><span class="PUNC">,</span><span class="NAME">l</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">h</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">h</span><span class="PUNC">[</span><span class="NAME">l</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">--</span><span class="PUNC">;</span><span class="NAME">m</span><span class="PUNC">=</span><span class="NUMB">2</span><span class="PUNC">*</span><span class="NAME">e</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">?</span><span class="NAME">g</span><span class="PUNC">:</span><span class="NAME">f</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">a.Triangulate.area</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">(</span><span class="NAME">THREE.FontUtils</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">self._typeface_js</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="NAME">faces</span><span class="PUNC">:</span><span class="NAME">THREE.FontUtils.faces</span><span class="PUNC">,</span><span class="NAME">loadFace</span><span class="PUNC">:</span><span class="NAME">THREE.FontUtils.loadFace</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.typeface_js</span><span class="PUNC">=</span><span class="NAME">self._typeface_js</span><span class="PUNC">;</span><span class="NAME">THREE.Curve</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.Curve.prototype.getPoint</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">console.log</span><span class="PUNC">(</span><span class="STRN">"Warning, getPoint() not implemented!"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.Curve.prototype.getPointAt</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">this.getUtoTmapping</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.getPoint</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.Curve.prototype.getPoints</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">a</span><span class="PUNC">||</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NUMB">5</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">&lt;=</span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">c.push</span><span class="PUNC">(</span><span class="NAME">this.getPoint</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">/</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.Curve.prototype.getSpacedPoints</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">a</span><span class="PUNC">||</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NUMB">5</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">&lt;=</span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">c.push</span><span class="PUNC">(</span><span class="NAME">this.getPointAt</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">/</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>558</span> </span><span class="NAME">THREE.Curve.prototype.getLength</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">this.getLengths</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">[</span><span class="NAME">a.length</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.Curve.prototype.getLengths</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">a</span><span class="PUNC">||</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">this.__arcLengthDivisions</span><span class="PUNC">?</span><span class="NAME">this.__arcLengthDivisions</span><span class="PUNC">:</span><span class="NUMB">200</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.cacheArcLengths</span><span class="PUNC">&&</span><span class="NAME">this.cacheArcLengths.length</span><span class="PUNC">==</span><span class="NAME">a</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">&&</span><span class="PUNC">!</span><span class="NAME">this.needsUpdate</span><span class="PUNC">)</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.cacheArcLengths</span><span class="PUNC">;</span><span class="NAME">this.needsUpdate</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">this.getPoint</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">b.push</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">&lt;=</span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.getPoint</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">/</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">c.distanceTo</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">b.push</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.cacheArcLengths</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>559</span> </span><span class="NAME">THREE.Curve.prototype.updateArcLengths</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.needsUpdate</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">this.getLengths</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.Curve.prototype.getUtoTmapping</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.getLengths</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">c.length</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">;</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">?</span><span class="NAME">b</span><span class="PUNC">:</span><span class="NAME">a</span><span class="PUNC">*</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NAME">e</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">h</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">e</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">;</span><span class="NAME">h</span><span class="PUNC">&lt;=</span><span class="NAME">g</span><span class="PUNC">;</span><span class="PUNC">)</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">Math.floor</span><span class="PUNC">(</span><span class="NAME">h</span><span class="PUNC">+</span><span class="PUNC">(</span><span class="NAME">g</span><span class="PUNC">-</span><span class="NAME">h</span><span class="PUNC">)</span><span class="PUNC">/</span><span class="NUMB">2</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NAME">d</span><span class="PUNC">]</span><span class="PUNC">-</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">></span><span class="NAME">i</span><span class="PUNC">)</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">&lt;</span><span class="NAME">i</span><span class="PUNC">)</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="KEYW">else</span><span class="PUNC">{</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">;</span><span class="KEYW">break</span><span class="PUNC">}</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">g</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NAME">d</span><span class="PUNC">]</span><span class="PUNC">==</span><span class="NAME">f</span><span class="PUNC">)</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">/</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NAME">d</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">+</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">-</span><span class="NAME">h</span><span class="PUNC">)</span><span class="PUNC">/</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NAME">d</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">-</span><span class="NAME">h</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">/</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.Curve.prototype.getTangent</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="NAME">E</span><span class="PUNC">-</span><span class="NUMB">4</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="NAME">E</span><span class="PUNC">-</span><span class="NUMB">4</span><span class="PUNC">;</span><span class="NUMB">0</span><span class="PUNC">></span><span class="NAME">b</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NUMB">1</span><span class="PUNC">&lt;</span><span class="NAME">a</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.getPoint</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.getPoint</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">clone</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">sub</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">normalize</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>560</span> </span><span class="NAME">THREE.Curve.prototype.getTangentAt</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">this.getUtoTmapping</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.getTangent</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>561</span> </span><span class="NAME">THREE.Curve.Utils</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="NAME">tangentQuadraticBezier</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NUMB">2</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NUMB">1</span><span class="PUNC">-</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">-</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="NUMB">2</span><span class="PUNC">*</span><span class="NAME">a</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">-</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">tangentCubicBezier</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="PUNC">-</span><span class="NUMB">3</span><span class="PUNC">*</span><span class="NAME">b</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NUMB">1</span><span class="PUNC">-</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NUMB">1</span><span class="PUNC">-</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="NUMB">3</span><span class="PUNC">*</span><span class="NAME">c</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NUMB">1</span><span class="PUNC">-</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NUMB">1</span><span class="PUNC">-</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">-</span><span class="NUMB">6</span><span class="PUNC">*</span><span class="NAME">a</span><span class="PUNC">*</span><span class="NAME">c</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NUMB">1</span><span class="PUNC">-</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="NUMB">6</span><span class="PUNC">*</span><span class="NAME">a</span><span class="PUNC">*</span><span class="NAME">d</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NUMB">1</span><span class="PUNC">-</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">-</span><span class="NUMB">3</span><span class="PUNC">*</span><span class="NAME">a</span><span class="PUNC">*</span><span class="NAME">a</span><span class="PUNC">*</span><span class="NAME">d</span><span class="PUNC">+</span><span class="NUMB">3</span><span class="PUNC">*</span><span class="NAME">a</span><span class="PUNC">*</span><span class="NAME">a</span><span class="PUNC">*</span><span class="NAME">e</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">tangentSpline</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NUMB">6</span><span class="PUNC">*</span><span class="NAME">a</span><span class="PUNC">*</span><span class="NAME">a</span><span class="PUNC">-</span><span class="NUMB">6</span><span class="PUNC">*</span><span class="NAME">a</span><span class="PUNC">+</span><span class="PUNC">(</span><span class="NUMB">3</span><span class="PUNC">*</span><span class="NAME">a</span><span class="PUNC">*</span><span class="NAME">a</span><span class="PUNC">-</span><span class="NUMB">4</span><span class="PUNC">*</span><span class="NAME">a</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="PUNC">(</span><span class="PUNC">-</span><span class="NUMB">6</span><span class="PUNC">*</span><span class="NAME">a</span><span class="PUNC">*</span><span class="NAME">a</span><span class="PUNC">+</span><span class="NUMB">6</span><span class="PUNC">*</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="PUNC">(</span><span class="NUMB">3</span><span class="PUNC">*</span><span class="NAME">a</span><span class="PUNC">*</span><span class="NAME">a</span><span class="PUNC">-</span><span class="NUMB">2</span><span class="PUNC">*</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">interpolate</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="NUMB">0.5</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">-</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NUMB">0.5</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">-</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">e</span><span class="PUNC">*</span><span class="NAME">e</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="PUNC">(</span><span class="NUMB">2</span><span class="PUNC">*</span><span class="NAME">b</span><span class="PUNC">-</span><span class="NUMB">2</span><span class="PUNC">*</span><span class="NAME">c</span><span class="PUNC">+</span><span class="NAME">a</span><span class="PUNC">+</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">e</span><span class="PUNC">*</span><span class="NAME">f</span><span class="PUNC">+</span><span class="PUNC">(</span><span class="PUNC">-</span><span class="NUMB">3</span><span class="PUNC">*</span><span class="NAME">b</span><span class="PUNC">+</span><span class="NUMB">3</span><span class="PUNC">*</span><span class="NAME">c</span><span class="PUNC">-</span><span class="NUMB">2</span><span class="PUNC">*</span><span class="NAME">a</span><span class="PUNC">-</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">f</span><span class="PUNC">+</span><span class="NAME">a</span><span class="PUNC">*</span><span class="NAME">e</span><span class="PUNC">+</span><span class="NAME">b</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>562</span> </span><span class="NAME">THREE.Curve.create</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">a.prototype</span><span class="PUNC">=</span><span class="NAME">Object.create</span><span class="PUNC">(</span><span class="NAME">THREE.Curve.prototype</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a.prototype.getPoint</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.CurvePath</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.curves</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">this.bends</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">this.autoClose</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.CurvePath.prototype</span><span class="PUNC">=</span><span class="NAME">Object.create</span><span class="PUNC">(</span><span class="NAME">THREE.Curve.prototype</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">THREE.CurvePath.prototype.add</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.curves.push</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.CurvePath.prototype.checkConnection</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.CurvePath.prototype.closePath</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">this.curves</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">getPoint</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.curves</span><span class="PUNC">[</span><span class="NAME">this.curves.length</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">getPoint</span><span class="PUNC">(</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a.equals</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">||</span><span class="NAME">this.curves.push</span><span class="PUNC">(</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.LineCurve</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>563</span> </span><span class="NAME">THREE.CurvePath.prototype.getPoint</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">*</span><span class="NAME">this.getLength</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.getCurveLengths</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">&lt;</span><span class="NAME">c.length</span><span class="PUNC">;</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">]</span><span class="PUNC">>=</span><span class="NAME">b</span><span class="PUNC">)</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">]</span><span class="PUNC">-</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">this.curves</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">-</span><span class="NAME">b</span><span class="PUNC">/</span><span class="NAME">a.getLength</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">a.getPointAt</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">++</span><span class="PUNC">}</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.CurvePath.prototype.getLength</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">this.getCurveLengths</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">[</span><span class="NAME">a.length</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>564</span> </span><span class="NAME">THREE.CurvePath.prototype.getCurveLengths</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.cacheLengths</span><span class="PUNC">&&</span><span class="NAME">this.cacheLengths.length</span><span class="PUNC">==</span><span class="NAME">this.curves.length</span><span class="PUNC">)</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.cacheLengths</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">this.curves.length</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">&lt;</span><span class="NAME">d</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">b</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">this.curves</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">getLength</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">a.push</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.cacheLengths</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>565</span> </span><span class="NAME">THREE.CurvePath.prototype.getBoundingBox</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">this.getPoints</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">Number.NEGATIVE_INFINITY</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">Number.POSITIVE_INFINITY</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">g</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">,</span><span class="NAME">j</span><span class="PUNC">,</span><span class="NAME">l</span><span class="PUNC">,</span><span class="NAME">m</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">;</span><span class="NAME">l</span><span class="PUNC">=</span><span class="NAME">m</span><span class="PUNC">?</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">:</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector2</span><span class="PUNC">;</span><span class="NAME">i</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">j</span><span class="PUNC">=</span><span class="NAME">a.length</span><span class="PUNC">;</span><span class="NAME">i</span><span class="PUNC">&lt;</span><span class="NAME">j</span><span class="PUNC">;</span><span class="NAME">i</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">g.x</span><span class="PUNC">></span><span class="NAME">b</span><span class="PUNC">?</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">g.x</span><span class="PUNC">:</span><span class="NAME">g.x</span><span class="PUNC">&lt;</span><span class="NAME">e</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">g.x</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">g.y</span><span class="PUNC">></span><span class="NAME">c</span><span class="PUNC">?</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">g.y</span><span class="PUNC">:</span><span class="NAME">g.y</span><span class="PUNC">&lt;</span><span class="NAME">f</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">g.y</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">m</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">g.z</span><span class="PUNC">></span><span class="NAME">d</span><span class="PUNC">?</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">g.z</span><span class="PUNC">:</span><span class="NAME">g.z</span><span class="PUNC">&lt;</span><span class="NAME">h</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">g.z</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">l.add</span><span class="PUNC">(</span><span class="NAME">g</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="NAME">minX</span><span class="PUNC">:</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">minY</span><span class="PUNC">:</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">maxX</span><span class="PUNC">:</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">maxY</span><span class="PUNC">:</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">centroid</span><span class="PUNC">:</span><span class="NAME">l.divideScalar</span><span class="PUNC">(</span><span class="NAME">j</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">m</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">a.maxZ</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">a.minZ</span><span class="PUNC">=</span><span class="NAME">h</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>566</span> </span><span class="NAME">THREE.CurvePath.prototype.createPointsGeometry</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">this.getPoints</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.createGeometry</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.CurvePath.prototype.createSpacedPointsGeometry</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">this.getSpacedPoints</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.createGeometry</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.CurvePath.prototype.createGeometry</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Geometry</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">&lt;</span><span class="NAME">a.length</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">b.vertices.push</span><span class="PUNC">(</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">x</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">y</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">z</span><span class="PUNC">||</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.CurvePath.prototype.addWrapPath</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.bends.push</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>567</span> </span><span class="NAME">THREE.CurvePath.prototype.getTransformedPoints</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.getPoints</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">||</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.bends</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">b.length</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">&lt;</span><span class="NAME">e</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.getWrapPoints</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NAME">d</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.CurvePath.prototype.getTransformedSpacedPoints</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.getSpacedPoints</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">||</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.bends</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">b.length</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">&lt;</span><span class="NAME">e</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.getWrapPoints</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NAME">d</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>568</span> </span><span class="NAME">THREE.CurvePath.prototype.getWrapPoints</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.getBoundingBox</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">a.length</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">&lt;</span><span class="NAME">e</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NAME">d</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">f.x</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">f.y</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">=</span><span class="NAME">h</span><span class="PUNC">/</span><span class="NAME">c.maxX</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">=</span><span class="NAME">b.getUtoTmapping</span><span class="PUNC">(</span><span class="NAME">i</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">b.getPoint</span><span class="PUNC">(</span><span class="NAME">i</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">b.getNormalVector</span><span class="PUNC">(</span><span class="NAME">i</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">multiplyScalar</span><span class="PUNC">(</span><span class="NAME">g</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">f.x</span><span class="PUNC">=</span><span class="NAME">h.x</span><span class="PUNC">+</span><span class="NAME">g.x</span><span class="PUNC">,</span><span class="NAME">f.y</span><span class="PUNC">=</span><span class="NAME">h.y</span><span class="PUNC">+</span><span class="NAME">g.y</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.Gyroscope</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">THREE.Object3D.call</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.Gyroscope.prototype</span><span class="PUNC">=</span><span class="NAME">Object.create</span><span class="PUNC">(</span><span class="NAME">THREE.Object3D.prototype</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>569</span> </span><span class="NAME">THREE.Gyroscope.prototype.updateMatrixWorld</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.matrixAutoUpdate</span><span class="PUNC">&&</span><span class="NAME">this.updateMatrix</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.matrixWorldNeedsUpdate</span><span class="PUNC">||</span><span class="NAME">a</span><span class="PUNC">)</span><span class="NAME">this.parent</span><span class="PUNC">?</span><span class="PUNC">(</span><span class="NAME">this.matrixWorld.multiplyMatrices</span><span class="PUNC">(</span><span class="NAME">this.parent.matrixWorld</span><span class="PUNC">,</span><span class="NAME">this.matrix</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this.matrixWorld.decompose</span><span class="PUNC">(</span><span class="NAME">this.translationWorld</span><span class="PUNC">,</span><span class="NAME">this.quaternionWorld</span><span class="PUNC">,</span><span class="NAME">this.scaleWorld</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this.matrix.decompose</span><span class="PUNC">(</span><span class="NAME">this.translationObject</span><span class="PUNC">,</span><span class="NAME">this.quaternionObject</span><span class="PUNC">,</span><span class="NAME">this.scaleObject</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this.matrixWorld.compose</span><span class="PUNC">(</span><span class="NAME">this.translationWorld</span><span class="PUNC">,</span><span class="NAME">this.quaternionObject</span><span class="PUNC">,</span><span class="NAME">this.scaleWorld</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">this.matrixWorld.copy</span><span class="PUNC">(</span><span class="NAME">this.matrix</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>570</span> </span><span class="NAME">this.matrixWorldNeedsUpdate</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.children.length</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">&lt;</span><span class="NAME">c</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">this.children</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">updateMatrixWorld</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.Gyroscope.prototype.translationWorld</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">;</span><span class="NAME">THREE.Gyroscope.prototype.translationObject</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">;</span><span class="NAME">THREE.Gyroscope.prototype.quaternionWorld</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Quaternion</span><span class="PUNC">;</span><span class="NAME">THREE.Gyroscope.prototype.quaternionObject</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Quaternion</span><span class="PUNC">;</span><span class="NAME">THREE.Gyroscope.prototype.scaleWorld</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">;</span><span class="NAME">THREE.Gyroscope.prototype.scaleObject</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">;</span><span class="NAME">THREE.Path</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">THREE.CurvePath.call</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.actions</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">&&</span><span class="NAME">this.fromPoints</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.Path.prototype</span><span class="PUNC">=</span><span class="NAME">Object.create</span><span class="PUNC">(</span><span class="NAME">THREE.CurvePath.prototype</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">THREE.PathActions</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="NAME">MOVE_TO</span><span class="PUNC">:</span><span class="STRN">"moveTo"</span><span class="PUNC">,</span><span class="NAME">LINE_TO</span><span class="PUNC">:</span><span class="STRN">"lineTo"</span><span class="PUNC">,</span><span class="NAME">QUADRATIC_CURVE_TO</span><span class="PUNC">:</span><span class="STRN">"quadraticCurveTo"</span><span class="PUNC">,</span><span class="NAME">BEZIER_CURVE_TO</span><span class="PUNC">:</span><span class="STRN">"bezierCurveTo"</span><span class="PUNC">,</span><span class="NAME">CSPLINE_THRU</span><span class="PUNC">:</span><span class="STRN">"splineThru"</span><span class="PUNC">,</span><span class="NAME">ARC</span><span class="PUNC">:</span><span class="STRN">"arc"</span><span class="PUNC">,</span><span class="NAME">ELLIPSE</span><span class="PUNC">:</span><span class="STRN">"ellipse"</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.Path.prototype.fromPoints</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.moveTo</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">x</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">y</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">a.length</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">&lt;</span><span class="NAME">c</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">this.lineTo</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">x</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">y</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>571</span> </span><span class="NAME">THREE.Path.prototype.moveTo</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">Array.prototype.slice.call</span><span class="PUNC">(</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.actions.push</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">action</span><span class="PUNC">:</span><span class="NAME">THREE.PathActions.MOVE_TO</span><span class="PUNC">,</span><span class="NAME">args</span><span class="PUNC">:</span><span class="NAME">c</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.Path.prototype.lineTo</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">Array.prototype.slice.call</span><span class="PUNC">(</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">this.actions</span><span class="PUNC">[</span><span class="NAME">this.actions.length</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">args</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.LineCurve</span><span class="PUNC">(</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector2</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">[</span><span class="NAME">d.length</span><span class="PUNC">-</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">[</span><span class="NAME">d.length</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector2</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.curves.push</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.actions.push</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">action</span><span class="PUNC">:</span><span class="NAME">THREE.PathActions.LINE_TO</span><span class="PUNC">,</span><span class="NAME">args</span><span class="PUNC">:</span><span class="NAME">c</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>572</span> </span><span class="NAME">THREE.Path.prototype.quadraticCurveTo</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">Array.prototype.slice.call</span><span class="PUNC">(</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">this.actions</span><span class="PUNC">[</span><span class="NAME">this.actions.length</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">args</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.QuadraticBezierCurve</span><span class="PUNC">(</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector2</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">[</span><span class="NAME">f.length</span><span class="PUNC">-</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">[</span><span class="NAME">f.length</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector2</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector2</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.curves.push</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.actions.push</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">action</span><span class="PUNC">:</span><span class="NAME">THREE.PathActions.QUADRATIC_CURVE_TO</span><span class="PUNC">,</span><span class="NAME">args</span><span class="PUNC">:</span><span class="NAME">e</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>573</span> </span><span class="NAME">THREE.Path.prototype.bezierCurveTo</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">Array.prototype.slice.call</span><span class="PUNC">(</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">this.actions</span><span class="PUNC">[</span><span class="NAME">this.actions.length</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">args</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.CubicBezierCurve</span><span class="PUNC">(</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector2</span><span class="PUNC">(</span><span class="NAME">g</span><span class="PUNC">[</span><span class="NAME">g.length</span><span class="PUNC">-</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">[</span><span class="NAME">g.length</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector2</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector2</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector2</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.curves.push</span><span class="PUNC">(</span><span class="NAME">g</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.actions.push</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">action</span><span class="PUNC">:</span><span class="NAME">THREE.PathActions.BEZIER_CURVE_TO</span><span class="PUNC">,</span><span class="NAME">args</span><span class="PUNC">:</span><span class="NAME">h</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>574</span> </span><span class="NAME">THREE.Path.prototype.splineThru</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">Array.prototype.slice.call</span><span class="PUNC">(</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.actions</span><span class="PUNC">[</span><span class="NAME">this.actions.length</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">args</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector2</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NAME">c.length</span><span class="PUNC">-</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NAME">c.length</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">Array.prototype.push.apply</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.SplineCurve</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.curves.push</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.actions.push</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">action</span><span class="PUNC">:</span><span class="NAME">THREE.PathActions.CSPLINE_THRU</span><span class="PUNC">,</span><span class="NAME">args</span><span class="PUNC">:</span><span class="NAME">b</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.Path.prototype.arc</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">this.actions</span><span class="PUNC">[</span><span class="NAME">this.actions.length</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">args</span><span class="PUNC">;</span><span class="NAME">this.absarc</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">+</span><span class="NAME">h</span><span class="PUNC">[</span><span class="NAME">h.length</span><span class="PUNC">-</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">+</span><span class="NAME">h</span><span class="PUNC">[</span><span class="NAME">h.length</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>575</span> </span><span class="NAME">THREE.Path.prototype.absarc</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.absellipse</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.Path.prototype.ellipse</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">this.actions</span><span class="PUNC">[</span><span class="NAME">this.actions.length</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">args</span><span class="PUNC">;</span><span class="NAME">this.absellipse</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">+</span><span class="NAME">g</span><span class="PUNC">[</span><span class="NAME">g.length</span><span class="PUNC">-</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">+</span><span class="NAME">g</span><span class="PUNC">[</span><span class="NAME">g.length</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.Path.prototype.absellipse</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">Array.prototype.slice.call</span><span class="PUNC">(</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.EllipseCurve</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.curves.push</span><span class="PUNC">(</span><span class="NAME">i</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">i</span><span class="PUNC">=</span><span class="NAME">i.getPoint</span><span class="PUNC">(</span><span class="NAME">h</span><span class="PUNC">?</span><span class="NUMB">1</span><span class="PUNC">:</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">g.push</span><span class="PUNC">(</span><span class="NAME">i.x</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">g.push</span><span class="PUNC">(</span><span class="NAME">i.y</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.actions.push</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">action</span><span class="PUNC">:</span><span class="NAME">THREE.PathActions.ELLIPSE</span><span class="PUNC">,</span><span class="NAME">args</span><span class="PUNC">:</span><span class="NAME">g</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>576</span> </span><span class="NAME">THREE.Path.prototype.getSpacedPoints</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">a</span><span class="PUNC">||</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NUMB">40</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">&lt;</span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">b.push</span><span class="PUNC">(</span><span class="NAME">this.getPoint</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">/</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>577</span> </span><span class="NAME">THREE.Path.prototype.getPoints</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.useSpacedPoints</span><span class="PUNC">)</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">console.log</span><span class="PUNC">(</span><span class="STRN">"tata"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this.getSpacedPoints</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">||</span><span class="NUMB">12</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">,</span><span class="NAME">j</span><span class="PUNC">,</span><span class="NAME">l</span><span class="PUNC">,</span><span class="NAME">m</span><span class="PUNC">,</span><span class="NAME">n</span><span class="PUNC">,</span><span class="NAME">p</span><span class="PUNC">,</span><span class="NAME">t</span><span class="PUNC">,</span><span class="NAME">q</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">this.actions.length</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">&lt;</span><span class="NAME">e</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="KEYW">switch</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">this.actions</span><span class="PUNC">[</span><span class="NAME">d</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">f.action</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">f.args</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="NAME">THREE.PathActions.MOVE_TO</span><span class="PUNC">:</span><span class="NAME">c.push</span><span class="PUNC">(</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector2</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">break</span><span class="PUNC">;</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="NAME">THREE.PathActions.LINE_TO</span><span class="PUNC">:</span><span class="NAME">c.push</span><span class="PUNC">(</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector2</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">break</span><span class="PUNC">;</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="NAME">THREE.PathActions.QUADRATIC_CURVE_TO</span><span class="PUNC">:</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">f</span><span class="PUNC">[</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">i</span><span class="PUNC">=</span><span class="NAME">f</span><span class="PUNC">[</span><span class="NUMB">3</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">m</span><span class="PUNC">=</span><span class="NAME">f</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">n</span><span class="PUNC">=</span><span class="NAME">f</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NUMB">0</span><span class="PUNC">&lt;</span><span class="NAME">c.length</span><span class="PUNC">?</span><span class="PUNC">(</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NAME">c.length</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">p</span><span class="PUNC">=</span><span class="NAME">h.x</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>578</span> </span><span class="NAME">t</span><span class="PUNC">=</span><span class="NAME">h.y</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="PUNC">(</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">this.actions</span><span class="PUNC">[</span><span class="NAME">d</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">args</span><span class="PUNC">,</span><span class="NAME">p</span><span class="PUNC">=</span><span class="NAME">h</span><span class="PUNC">[</span><span class="NAME">h.length</span><span class="PUNC">-</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">t</span><span class="PUNC">=</span><span class="NAME">h</span><span class="PUNC">[</span><span class="NAME">h.length</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">f</span><span class="PUNC">&lt;=</span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">f</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">q</span><span class="PUNC">=</span><span class="NAME">f</span><span class="PUNC">/</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">THREE.Shape.Utils.b2</span><span class="PUNC">(</span><span class="NAME">q</span><span class="PUNC">,</span><span class="NAME">p</span><span class="PUNC">,</span><span class="NAME">m</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">q</span><span class="PUNC">=</span><span class="NAME">THREE.Shape.Utils.b2</span><span class="PUNC">(</span><span class="NAME">q</span><span class="PUNC">,</span><span class="NAME">t</span><span class="PUNC">,</span><span class="NAME">n</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">c.push</span><span class="PUNC">(</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector2</span><span class="PUNC">(</span><span class="NAME">h</span><span class="PUNC">,</span><span class="NAME">q</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">break</span><span class="PUNC">;</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="NAME">THREE.PathActions.BEZIER_CURVE_TO</span><span class="PUNC">:</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">f</span><span class="PUNC">[</span><span class="NUMB">4</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">i</span><span class="PUNC">=</span><span class="NAME">f</span><span class="PUNC">[</span><span class="NUMB">5</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">m</span><span class="PUNC">=</span><span class="NAME">f</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">n</span><span class="PUNC">=</span><span class="NAME">f</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">j</span><span class="PUNC">=</span><span class="NAME">f</span><span class="PUNC">[</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">l</span><span class="PUNC">=</span><span class="NAME">f</span><span class="PUNC">[</span><span class="NUMB">3</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NUMB">0</span><span class="PUNC">&lt;</span><span class="NAME">c.length</span><span class="PUNC">?</span><span class="PUNC">(</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NAME">c.length</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">p</span><span class="PUNC">=</span><span class="NAME">h.x</span><span class="PUNC">,</span><span class="NAME">t</span><span class="PUNC">=</span><span class="NAME">h.y</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="PUNC">(</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">this.actions</span><span class="PUNC">[</span><span class="NAME">d</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">args</span><span class="PUNC">,</span><span class="NAME">p</span><span class="PUNC">=</span><span class="NAME">h</span><span class="PUNC">[</span><span class="NAME">h.length</span><span class="PUNC">-</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">t</span><span class="PUNC">=</span><span class="NAME">h</span><span class="PUNC">[</span><span class="NAME">h.length</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">f</span><span class="PUNC">&lt;=</span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">f</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">q</span><span class="PUNC">=</span><span class="NAME">f</span><span class="PUNC">/</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">THREE.Shape.Utils.b3</span><span class="PUNC">(</span><span class="NAME">q</span><span class="PUNC">,</span><span class="NAME">p</span><span class="PUNC">,</span><span class="NAME">m</span><span class="PUNC">,</span><span class="NAME">j</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">q</span><span class="PUNC">=</span><span class="NAME">THREE.Shape.Utils.b3</span><span class="PUNC">(</span><span class="NAME">q</span><span class="PUNC">,</span><span class="NAME">t</span><span class="PUNC">,</span><span class="NAME">n</span><span class="PUNC">,</span><span class="NAME">l</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">c.push</span><span class="PUNC">(</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector2</span><span class="PUNC">(</span><span class="NAME">h</span><span class="PUNC">,</span><span class="NAME">q</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">break</span><span class="PUNC">;</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="NAME">THREE.PathActions.CSPLINE_THRU</span><span class="PUNC">:</span><span class="NAME">h</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>579</span> </span><span class="NAME">this.actions</span><span class="PUNC">[</span><span class="NAME">d</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">args</span><span class="PUNC">;</span><span class="NAME">q</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector2</span><span class="PUNC">(</span><span class="NAME">h</span><span class="PUNC">[</span><span class="NAME">h.length</span><span class="PUNC">-</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">[</span><span class="NAME">h.length</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">*</span><span class="NAME">f</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">length</span><span class="PUNC">;</span><span class="NAME">q</span><span class="PUNC">=</span><span class="NAME">q.concat</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">q</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.SplineCurve</span><span class="PUNC">(</span><span class="NAME">q</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">f</span><span class="PUNC">&lt;=</span><span class="NAME">h</span><span class="PUNC">;</span><span class="NAME">f</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">c.push</span><span class="PUNC">(</span><span class="NAME">q.getPointAt</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">/</span><span class="NAME">h</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">break</span><span class="PUNC">;</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="NAME">THREE.PathActions.ARC</span><span class="PUNC">:</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">f</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">i</span><span class="PUNC">=</span><span class="NAME">f</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">n</span><span class="PUNC">=</span><span class="NAME">f</span><span class="PUNC">[</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">j</span><span class="PUNC">=</span><span class="NAME">f</span><span class="PUNC">[</span><span class="NUMB">3</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">f</span><span class="PUNC">[</span><span class="NUMB">4</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">m</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="PUNC">!</span><span class="NAME">f</span><span class="PUNC">[</span><span class="NUMB">5</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">p</span><span class="PUNC">=</span><span class="NAME">h</span><span class="PUNC">-</span><span class="NAME">j</span><span class="PUNC">;</span><span class="NAME">t</span><span class="PUNC">=</span><span class="NUMB">2</span><span class="PUNC">*</span><span class="NAME">a</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">f</span><span class="PUNC">&lt;=</span><span class="NAME">t</span><span class="PUNC">;</span><span class="NAME">f</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">q</span><span class="PUNC">=</span><span class="NAME">f</span><span class="PUNC">/</span><span class="NAME">t</span><span class="PUNC">,</span><span class="NAME">m</span><span class="PUNC">||</span><span class="PUNC">(</span><span class="NAME">q</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">-</span><span class="NAME">q</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">q</span><span class="PUNC">=</span><span class="NAME">j</span><span class="PUNC">+</span><span class="NAME">q</span><span class="PUNC">*</span><span class="NAME">p</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">g</span><span class="PUNC">+</span><span class="NAME">n</span><span class="PUNC">*</span><span class="NAME">Math.cos</span><span class="PUNC">(</span><span class="NAME">q</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">q</span><span class="PUNC">=</span><span class="NAME">i</span><span class="PUNC">+</span><span class="NAME">n</span><span class="PUNC">*</span><span class="NAME">Math.sin</span><span class="PUNC">(</span><span class="NAME">q</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">c.push</span><span class="PUNC">(</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector2</span><span class="PUNC">(</span><span class="NAME">h</span><span class="PUNC">,</span><span class="NAME">q</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">break</span><span class="PUNC">;</span><span class="KEYW">case</span><span class="WHIT"> </span><span class="NAME">THREE.PathActions.ELLIPSE</span><span class="PUNC">:</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">f</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">i</span><span class="PUNC">=</span><span class="NAME">f</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">n</span><span class="PUNC">=</span><span class="NAME">f</span><span class="PUNC">[</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">l</span><span class="PUNC">=</span><span class="NAME">f</span><span class="PUNC">[</span><span class="NUMB">3</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">j</span><span class="PUNC">=</span><span class="NAME">f</span><span class="PUNC">[</span><span class="NUMB">4</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">f</span><span class="PUNC">[</span><span class="NUMB">5</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">m</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="PUNC">!</span><span class="NAME">f</span><span class="PUNC">[</span><span class="NUMB">6</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">p</span><span class="PUNC">=</span><span class="NAME">h</span><span class="PUNC">-</span><span class="NAME">j</span><span class="PUNC">;</span><span class="NAME">t</span><span class="PUNC">=</span><span class="NUMB">2</span><span class="PUNC">*</span><span class="NAME">a</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">f</span><span class="PUNC">&lt;=</span><span class="NAME">t</span><span class="PUNC">;</span><span class="NAME">f</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">q</span><span class="PUNC">=</span><span class="NAME">f</span><span class="PUNC">/</span><span class="NAME">t</span><span class="PUNC">,</span><span class="NAME">m</span><span class="PUNC">||</span><span class="WHIT">
<span class='line'>580</span> </span><span class="PUNC">(</span><span class="NAME">q</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">-</span><span class="NAME">q</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">q</span><span class="PUNC">=</span><span class="NAME">j</span><span class="PUNC">+</span><span class="NAME">q</span><span class="PUNC">*</span><span class="NAME">p</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">g</span><span class="PUNC">+</span><span class="NAME">n</span><span class="PUNC">*</span><span class="NAME">Math.cos</span><span class="PUNC">(</span><span class="NAME">q</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">q</span><span class="PUNC">=</span><span class="NAME">i</span><span class="PUNC">+</span><span class="NAME">l</span><span class="PUNC">*</span><span class="NAME">Math.sin</span><span class="PUNC">(</span><span class="NAME">q</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">c.push</span><span class="PUNC">(</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector2</span><span class="PUNC">(</span><span class="NAME">h</span><span class="PUNC">,</span><span class="NAME">q</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NAME">c.length</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NUMB">1</span><span class="NAME">E</span><span class="PUNC">-</span><span class="NUMB">10</span><span class="PUNC">></span><span class="NAME">Math.abs</span><span class="PUNC">(</span><span class="NAME">d.x</span><span class="PUNC">-</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">x</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="NUMB">1</span><span class="NAME">E</span><span class="PUNC">-</span><span class="NUMB">10</span><span class="PUNC">></span><span class="NAME">Math.abs</span><span class="PUNC">(</span><span class="NAME">d.y</span><span class="PUNC">-</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">y</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="NAME">c.splice</span><span class="PUNC">(</span><span class="NAME">c.length</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">&&</span><span class="NAME">c.push</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>581</span> </span><span class="NAME">THREE.Path.prototype.toShapes</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Path</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.actions.length</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">&lt;</span><span class="NAME">c</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">this.actions</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">d.args</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">d.action</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">==</span><span class="NAME">THREE.PathActions.MOVE_TO</span><span class="PUNC">&&</span><span class="NUMB">0</span><span class="PUNC">!=</span><span class="NAME">h.actions.length</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">f.push</span><span class="PUNC">(</span><span class="NAME">h</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Path</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">[</span><span class="NAME">d</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">apply</span><span class="PUNC">(</span><span class="NAME">h</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NUMB">0</span><span class="PUNC">!=</span><span class="NAME">h.actions.length</span><span class="PUNC">&&</span><span class="NAME">f.push</span><span class="PUNC">(</span><span class="NAME">h</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">==</span><span class="NAME">f.length</span><span class="PUNC">)</span><span class="KEYW">return</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">g</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NUMB">1</span><span class="PUNC">==</span><span class="NAME">f.length</span><span class="PUNC">)</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">f</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Shape</span><span class="PUNC">,</span><span class="NAME">g.actions</span><span class="PUNC">=</span><span class="NAME">d.actions</span><span class="PUNC">,</span><span class="NAME">g.curves</span><span class="PUNC">=</span><span class="NAME">d.curves</span><span class="PUNC">,</span><span class="NAME">e.push</span><span class="PUNC">(</span><span class="NAME">g</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NAME">THREE.Shape.Utils.isClockWise</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">getPoints</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">?</span><span class="PUNC">!</span><span class="NAME">b</span><span class="PUNC">:</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">g</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Shape</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>582</span> </span><span class="NAME">f.length</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">&lt;</span><span class="NAME">c</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">f</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">THREE.Shape.Utils.isClockWise</span><span class="PUNC">(</span><span class="NAME">d.getPoints</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="PUNC">(</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">?</span><span class="PUNC">!</span><span class="NAME">h</span><span class="PUNC">:</span><span class="NAME">h</span><span class="PUNC">)</span><span class="PUNC">?</span><span class="PUNC">(</span><span class="NAME">g.actions</span><span class="PUNC">=</span><span class="NAME">d.actions</span><span class="PUNC">,</span><span class="NAME">g.curves</span><span class="PUNC">=</span><span class="NAME">d.curves</span><span class="PUNC">,</span><span class="NAME">e.push</span><span class="PUNC">(</span><span class="NAME">g</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Shape</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">g.holes.push</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="PUNC">{</span><span class="NAME">g</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">f.length</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">&lt;</span><span class="NAME">c</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">f</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">THREE.Shape.Utils.isClockWise</span><span class="PUNC">(</span><span class="NAME">d.getPoints</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="PUNC">(</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">?</span><span class="PUNC">!</span><span class="NAME">h</span><span class="PUNC">:</span><span class="NAME">h</span><span class="PUNC">)</span><span class="PUNC">?</span><span class="PUNC">(</span><span class="NAME">g</span><span class="PUNC">&&</span><span class="NAME">e.push</span><span class="PUNC">(</span><span class="NAME">g</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Shape</span><span class="PUNC">,</span><span class="NAME">g.actions</span><span class="PUNC">=</span><span class="NAME">d.actions</span><span class="PUNC">,</span><span class="NAME">g.curves</span><span class="PUNC">=</span><span class="NAME">d.curves</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">g.holes.push</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">e.push</span><span class="PUNC">(</span><span class="NAME">g</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">e</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.Shape</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">THREE.Path.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.holes</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.Shape.prototype</span><span class="PUNC">=</span><span class="NAME">Object.create</span><span class="PUNC">(</span><span class="NAME">THREE.Path.prototype</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">THREE.Shape.prototype.extrude</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.ExtrudeGeometry</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.Shape.prototype.makeGeometry</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.ShapeGeometry</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.Shape.prototype.getPointsHoles</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.holes.length</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">&lt;</span><span class="NAME">c</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">d</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">this.holes</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">getTransformedPoints</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">this.bends</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>583</span> </span><span class="NAME">THREE.Shape.prototype.getSpacedPointsHoles</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.holes.length</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">&lt;</span><span class="NAME">c</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">d</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">this.holes</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">getTransformedSpacedPoints</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">this.bends</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.Shape.prototype.extractAllPoints</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="PUNC">{</span><span class="NAME">shape</span><span class="PUNC">:</span><span class="NAME">this.getTransformedPoints</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">holes</span><span class="PUNC">:</span><span class="NAME">this.getPointsHoles</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.Shape.prototype.extractPoints</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.useSpacedPoints</span><span class="PUNC">?</span><span class="NAME">this.extractAllSpacedPoints</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">this.extractAllPoints</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>584</span> </span><span class="NAME">THREE.Shape.prototype.extractAllSpacedPoints</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="PUNC">{</span><span class="NAME">shape</span><span class="PUNC">:</span><span class="NAME">this.getTransformedSpacedPoints</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">holes</span><span class="PUNC">:</span><span class="NAME">this.getSpacedPointsHoles</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>585</span> </span><span class="NAME">THREE.Shape.Utils</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="NAME">removeHoles</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">a.concat</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">c.concat</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">,</span><span class="NAME">j</span><span class="PUNC">,</span><span class="NAME">l</span><span class="PUNC">,</span><span class="NAME">m</span><span class="PUNC">,</span><span class="NAME">n</span><span class="PUNC">,</span><span class="NAME">p</span><span class="PUNC">,</span><span class="NAME">t</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">i</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">i</span><span class="PUNC">&lt;</span><span class="NAME">b.length</span><span class="PUNC">;</span><span class="NAME">i</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">j</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">Array.prototype.push.apply</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">j</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">Number.POSITIVE_INFINITY</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">&lt;</span><span class="NAME">j.length</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">n</span><span class="PUNC">=</span><span class="NAME">j</span><span class="PUNC">[</span><span class="NAME">e</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">p</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">m</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">m</span><span class="PUNC">&lt;</span><span class="NAME">c.length</span><span class="PUNC">;</span><span class="NAME">m</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">l</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NAME">m</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">l</span><span class="PUNC">=</span><span class="NAME">n.distanceToSquared</span><span class="PUNC">(</span><span class="NAME">l</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">p.push</span><span class="PUNC">(</span><span class="NAME">l</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">l</span><span class="PUNC">&lt;</span><span class="NAME">f</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">l</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">m</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">&lt;=</span><span class="NAME">g</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">?</span><span class="NAME">g</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">:</span><span class="NAME">c.length</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">&lt;=</span><span class="NAME">h</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">?</span><span class="NAME">h</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">:</span><span class="NAME">j.length</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">q</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="NAME">j</span><span class="PUNC">[</span><span class="NAME">h</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NAME">g</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NAME">e</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">m</span><span class="PUNC">=</span><span class="NAME">THREE.FontUtils.Triangulate.area</span><span class="PUNC">(</span><span class="NAME">q</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">r</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="NAME">j</span><span class="PUNC">[</span><span class="NAME">h</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">j</span><span class="PUNC">[</span><span class="NAME">f</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NAME">g</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">n</span><span class="PUNC">=</span><span class="NAME">THREE.FontUtils.Triangulate.area</span><span class="PUNC">(</span><span class="NAME">r</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">p</span><span class="PUNC">=</span><span class="NAME">g</span><span class="PUNC">;</span><span class="NAME">l</span><span class="PUNC">=</span><span class="NAME">h</span><span class="PUNC">;</span><span class="NAME">g</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">h</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NUMB">0</span><span class="PUNC">></span><span class="WHIT">
<span class='line'>586</span> </span><span class="NAME">g</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">g</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">c.length</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">g</span><span class="PUNC">%</span><span class="PUNC">=</span><span class="NAME">c.length</span><span class="PUNC">;</span><span class="NUMB">0</span><span class="PUNC">></span><span class="NAME">h</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">h</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">j.length</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">h</span><span class="PUNC">%</span><span class="PUNC">=</span><span class="NAME">j.length</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">&lt;=</span><span class="NAME">g</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">?</span><span class="NAME">g</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">:</span><span class="NAME">c.length</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">&lt;=</span><span class="NAME">h</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">?</span><span class="NAME">h</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">:</span><span class="NAME">j.length</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">q</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="NAME">j</span><span class="PUNC">[</span><span class="NAME">h</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NAME">g</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NAME">e</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">q</span><span class="PUNC">=</span><span class="NAME">THREE.FontUtils.Triangulate.area</span><span class="PUNC">(</span><span class="NAME">q</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">r</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="NAME">j</span><span class="PUNC">[</span><span class="NAME">h</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">j</span><span class="PUNC">[</span><span class="NAME">f</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NAME">g</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">r</span><span class="PUNC">=</span><span class="NAME">THREE.FontUtils.Triangulate.area</span><span class="PUNC">(</span><span class="NAME">r</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">m</span><span class="PUNC">+</span><span class="NAME">n</span><span class="PUNC">></span><span class="NAME">q</span><span class="PUNC">+</span><span class="NAME">r</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">p</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">l</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">></span><span class="NAME">g</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">g</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">c.length</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">%</span><span class="PUNC">=</span><span class="NAME">c.length</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">></span><span class="NAME">h</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">h</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">j.length</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">%</span><span class="PUNC">=</span><span class="NAME">j.length</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">&lt;=</span><span class="NAME">g</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">?</span><span class="NAME">g</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">:</span><span class="NAME">c.length</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">&lt;=</span><span class="NAME">h</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">?</span><span class="NAME">h</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">:</span><span class="NAME">j.length</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">m</span><span class="PUNC">=</span><span class="NAME">c.slice</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">n</span><span class="PUNC">=</span><span class="NAME">c.slice</span><span class="PUNC">(</span><span class="NAME">g</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">p</span><span class="PUNC">=</span><span class="NAME">j.slice</span><span class="PUNC">(</span><span class="NAME">h</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">l</span><span class="PUNC">=</span><span class="NAME">j.slice</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">f</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="NAME">j</span><span class="PUNC">[</span><span class="NAME">h</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">j</span><span class="PUNC">[</span><span class="NAME">f</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NAME">g</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">t.push</span><span class="PUNC">(</span><span class="PUNC">[</span><span class="NAME">j</span><span class="PUNC">[</span><span class="NAME">h</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NAME">g</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NAME">e</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">t.push</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">m.concat</span><span class="PUNC">(</span><span class="NAME">p</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">concat</span><span class="PUNC">(</span><span class="NAME">l</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">concat</span><span class="PUNC">(</span><span class="NAME">n</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">return</span><span class="PUNC">{</span><span class="NAME">shape</span><span class="PUNC">:</span><span class="NAME">c</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>587</span> </span><span class="NAME">isolatedPts</span><span class="PUNC">:</span><span class="NAME">t</span><span class="PUNC">,</span><span class="NAME">allpoints</span><span class="PUNC">:</span><span class="NAME">d</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">triangulateShape</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">THREE.Shape.Utils.removeHoles</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">c.allpoints</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">c.isolatedPts</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">THREE.FontUtils.Triangulate</span><span class="PUNC">(</span><span class="NAME">c.shape</span><span class="PUNC">,</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">,</span><span class="NAME">j</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">d.length</span><span class="PUNC">;</span><span class="NAME">f</span><span class="PUNC">&lt;</span><span class="NAME">h</span><span class="PUNC">;</span><span class="NAME">f</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">i</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">[</span><span class="NAME">f</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">x</span><span class="PUNC">+</span><span class="STRN">":"</span><span class="PUNC">+</span><span class="NAME">d</span><span class="PUNC">[</span><span class="NAME">f</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">y</span><span class="PUNC">,</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">j</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">&&</span><span class="NAME">console.log</span><span class="PUNC">(</span><span class="STRN">"Duplicate point"</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">j</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">f</span><span class="PUNC">;</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">c.length</span><span class="PUNC">;</span><span class="NAME">f</span><span class="PUNC">&lt;</span><span class="NAME">h</span><span class="PUNC">;</span><span class="NAME">f</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NAME">f</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NUMB">3</span><span class="PUNC">></span><span class="NAME">d</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">i</span><span class="PUNC">=</span><span class="NAME">g</span><span class="PUNC">[</span><span class="NAME">d</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">x</span><span class="PUNC">+</span><span class="STRN">":"</span><span class="PUNC">+</span><span class="NAME">g</span><span class="PUNC">[</span><span class="NAME">d</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">y</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">=</span><span class="NAME">j</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">i</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">g</span><span class="PUNC">[</span><span class="NAME">d</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">i</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">e.length</span><span class="PUNC">;</span><span class="NAME">f</span><span class="PUNC">&lt;</span><span class="NAME">h</span><span class="PUNC">;</span><span class="NAME">f</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">e</span><span class="PUNC">[</span><span class="NAME">f</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NUMB">3</span><span class="PUNC">></span><span class="NAME">d</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">i</span><span class="PUNC">=</span><span class="NAME">g</span><span class="PUNC">[</span><span class="NAME">d</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">x</span><span class="PUNC">+</span><span class="STRN">":"</span><span class="PUNC">+</span><span class="NAME">g</span><span class="PUNC">[</span><span class="NAME">d</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">y</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">=</span><span class="NAME">j</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">i</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">g</span><span class="PUNC">[</span><span class="NAME">d</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">i</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">c.concat</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>588</span> </span><span class="NAME">isClockWise</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">></span><span class="NAME">THREE.FontUtils.Triangulate.area</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">b2p0</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">-</span><span class="NAME">a</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">*</span><span class="NAME">c</span><span class="PUNC">*</span><span class="NAME">b</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">b2p1</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NUMB">2</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NUMB">1</span><span class="PUNC">-</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">a</span><span class="PUNC">*</span><span class="NAME">b</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">b2p2</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">*</span><span class="NAME">a</span><span class="PUNC">*</span><span class="NAME">b</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">b2</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.b2p0</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="NAME">this.b2p1</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="NAME">this.b2p2</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">b3p0</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">-</span><span class="NAME">a</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">*</span><span class="NAME">c</span><span class="PUNC">*</span><span class="NAME">c</span><span class="PUNC">*</span><span class="NAME">b</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">b3p1</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">-</span><span class="NAME">a</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NUMB">3</span><span class="PUNC">*</span><span class="NAME">c</span><span class="PUNC">*</span><span class="NAME">c</span><span class="PUNC">*</span><span class="NAME">a</span><span class="PUNC">*</span><span class="NAME">b</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">b3p2</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NUMB">3</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NUMB">1</span><span class="PUNC">-</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">a</span><span class="PUNC">*</span><span class="NAME">a</span><span class="PUNC">*</span><span class="NAME">b</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">b3p3</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">*</span><span class="NAME">a</span><span class="PUNC">*</span><span class="NAME">a</span><span class="PUNC">*</span><span class="NAME">b</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">b3</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.b3p0</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="NAME">this.b3p1</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="NAME">this.b3p2</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="WHIT">
<span class='line'>589</span> </span><span class="NAME">this.b3p3</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.LineCurve</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.v1</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">this.v2</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.LineCurve.prototype</span><span class="PUNC">=</span><span class="NAME">Object.create</span><span class="PUNC">(</span><span class="NAME">THREE.Curve.prototype</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">THREE.LineCurve.prototype.getPoint</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.v2.clone</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">sub</span><span class="PUNC">(</span><span class="NAME">this.v1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b.multiplyScalar</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">add</span><span class="PUNC">(</span><span class="NAME">this.v1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.LineCurve.prototype.getPointAt</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.getPoint</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.LineCurve.prototype.getTangent</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.v2.clone</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">sub</span><span class="PUNC">(</span><span class="NAME">this.v1</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">normalize</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.QuadraticBezierCurve</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.v0</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">this.v1</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">;</span><span class="NAME">this.v2</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.QuadraticBezierCurve.prototype</span><span class="PUNC">=</span><span class="NAME">Object.create</span><span class="PUNC">(</span><span class="NAME">THREE.Curve.prototype</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">THREE.QuadraticBezierCurve.prototype.getPoint</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">THREE.Shape.Utils.b2</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">this.v0.x</span><span class="PUNC">,</span><span class="NAME">this.v1.x</span><span class="PUNC">,</span><span class="NAME">this.v2.x</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">THREE.Shape.Utils.b2</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">this.v0.y</span><span class="PUNC">,</span><span class="NAME">this.v1.y</span><span class="PUNC">,</span><span class="NAME">this.v2.y</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector2</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>590</span> </span><span class="NAME">THREE.QuadraticBezierCurve.prototype.getTangent</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">THREE.Curve.Utils.tangentQuadraticBezier</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">this.v0.x</span><span class="PUNC">,</span><span class="NAME">this.v1.x</span><span class="PUNC">,</span><span class="NAME">this.v2.x</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">THREE.Curve.Utils.tangentQuadraticBezier</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">this.v0.y</span><span class="PUNC">,</span><span class="NAME">this.v1.y</span><span class="PUNC">,</span><span class="NAME">this.v2.y</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector2</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b.normalize</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.CubicBezierCurve</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.v0</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">this.v1</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">;</span><span class="NAME">this.v2</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">;</span><span class="NAME">this.v3</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.CubicBezierCurve.prototype</span><span class="PUNC">=</span><span class="NAME">Object.create</span><span class="PUNC">(</span><span class="NAME">THREE.Curve.prototype</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">THREE.CubicBezierCurve.prototype.getPoint</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">THREE.Shape.Utils.b3</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">this.v0.x</span><span class="PUNC">,</span><span class="NAME">this.v1.x</span><span class="PUNC">,</span><span class="NAME">this.v2.x</span><span class="PUNC">,</span><span class="NAME">this.v3.x</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">THREE.Shape.Utils.b3</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">this.v0.y</span><span class="PUNC">,</span><span class="NAME">this.v1.y</span><span class="PUNC">,</span><span class="NAME">this.v2.y</span><span class="PUNC">,</span><span class="NAME">this.v3.y</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector2</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>591</span> </span><span class="NAME">THREE.CubicBezierCurve.prototype.getTangent</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">THREE.Curve.Utils.tangentCubicBezier</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">this.v0.x</span><span class="PUNC">,</span><span class="NAME">this.v1.x</span><span class="PUNC">,</span><span class="NAME">this.v2.x</span><span class="PUNC">,</span><span class="NAME">this.v3.x</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">THREE.Curve.Utils.tangentCubicBezier</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">this.v0.y</span><span class="PUNC">,</span><span class="NAME">this.v1.y</span><span class="PUNC">,</span><span class="NAME">this.v2.y</span><span class="PUNC">,</span><span class="NAME">this.v3.y</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector2</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b.normalize</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.SplineCurve</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.points</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">==</span><span class="NAME">a</span><span class="PUNC">?</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">:</span><span class="NAME">a</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.SplineCurve.prototype</span><span class="PUNC">=</span><span class="NAME">Object.create</span><span class="PUNC">(</span><span class="NAME">THREE.Curve.prototype</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">THREE.SplineCurve.prototype.getPoint</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector2</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">this.points</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">=</span><span class="PUNC">(</span><span class="NAME">d.length</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">Math.floor</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">-</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">==</span><span class="NAME">a</span><span class="PUNC">?</span><span class="NAME">a</span><span class="PUNC">:</span><span class="NAME">a</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">></span><span class="NAME">d.length</span><span class="PUNC">-</span><span class="NUMB">2</span><span class="PUNC">?</span><span class="NAME">d.length</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">:</span><span class="NAME">a</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NUMB">3</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">></span><span class="NAME">d.length</span><span class="PUNC">-</span><span class="NUMB">3</span><span class="PUNC">?</span><span class="NAME">d.length</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">:</span><span class="NAME">a</span><span class="PUNC">+</span><span class="NUMB">2</span><span class="PUNC">;</span><span class="NAME">b.x</span><span class="PUNC">=</span><span class="NAME">THREE.Curve.Utils.interpolate</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">x</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">x</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">x</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NUMB">3</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">x</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b.y</span><span class="PUNC">=</span><span class="NAME">THREE.Curve.Utils.interpolate</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">y</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">y</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">y</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NUMB">3</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">y</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.EllipseCurve</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.aX</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">this.aY</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">;</span><span class="NAME">this.xRadius</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">;</span><span class="NAME">this.yRadius</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">;</span><span class="NAME">this.aStartAngle</span><span class="PUNC">=</span><span class="NAME">e</span><span class="PUNC">;</span><span class="NAME">this.aEndAngle</span><span class="PUNC">=</span><span class="NAME">f</span><span class="PUNC">;</span><span class="NAME">this.aClockwise</span><span class="PUNC">=</span><span class="NAME">h</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.EllipseCurve.prototype</span><span class="PUNC">=</span><span class="NAME">Object.create</span><span class="PUNC">(</span><span class="NAME">THREE.Curve.prototype</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">THREE.EllipseCurve.prototype.getPoint</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.aEndAngle</span><span class="PUNC">-</span><span class="NAME">this.aStartAngle</span><span class="PUNC">;</span><span class="NAME">this.aClockwise</span><span class="PUNC">||</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">-</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.aStartAngle</span><span class="PUNC">+</span><span class="NAME">a</span><span class="PUNC">*</span><span class="NAME">b</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">this.aX</span><span class="PUNC">+</span><span class="NAME">this.xRadius</span><span class="PUNC">*</span><span class="NAME">Math.cos</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.aY</span><span class="PUNC">+</span><span class="NAME">this.yRadius</span><span class="PUNC">*</span><span class="NAME">Math.sin</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector2</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.ArcCurve</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">THREE.EllipseCurve.call</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.ArcCurve.prototype</span><span class="PUNC">=</span><span class="NAME">Object.create</span><span class="PUNC">(</span><span class="NAME">THREE.EllipseCurve.prototype</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">THREE.LineCurve3</span><span class="PUNC">=</span><span class="NAME">THREE.Curve.create</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.v1</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">this.v2</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">;</span><span class="NAME">b.subVectors</span><span class="PUNC">(</span><span class="NAME">this.v2</span><span class="PUNC">,</span><span class="NAME">this.v1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b.multiplyScalar</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b.add</span><span class="PUNC">(</span><span class="NAME">this.v1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">THREE.QuadraticBezierCurve3</span><span class="PUNC">=</span><span class="NAME">THREE.Curve.create</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.v0</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">this.v1</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">;</span><span class="NAME">this.v2</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">THREE.Shape.Utils.b2</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">this.v0.x</span><span class="PUNC">,</span><span class="NAME">this.v1.x</span><span class="PUNC">,</span><span class="NAME">this.v2.x</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">THREE.Shape.Utils.b2</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">this.v0.y</span><span class="PUNC">,</span><span class="NAME">this.v1.y</span><span class="PUNC">,</span><span class="NAME">this.v2.y</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">THREE.Shape.Utils.b2</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">this.v0.z</span><span class="PUNC">,</span><span class="NAME">this.v1.z</span><span class="PUNC">,</span><span class="NAME">this.v2.z</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">THREE.CubicBezierCurve3</span><span class="PUNC">=</span><span class="NAME">THREE.Curve.create</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.v0</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">this.v1</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">;</span><span class="NAME">this.v2</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">;</span><span class="NAME">this.v3</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">THREE.Shape.Utils.b3</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">this.v0.x</span><span class="PUNC">,</span><span class="NAME">this.v1.x</span><span class="PUNC">,</span><span class="NAME">this.v2.x</span><span class="PUNC">,</span><span class="NAME">this.v3.x</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">THREE.Shape.Utils.b3</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">this.v0.y</span><span class="PUNC">,</span><span class="NAME">this.v1.y</span><span class="PUNC">,</span><span class="NAME">this.v2.y</span><span class="PUNC">,</span><span class="NAME">this.v3.y</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">THREE.Shape.Utils.b3</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">this.v0.z</span><span class="PUNC">,</span><span class="NAME">this.v1.z</span><span class="PUNC">,</span><span class="NAME">this.v2.z</span><span class="PUNC">,</span><span class="NAME">this.v3.z</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">THREE.SplineCurve3</span><span class="PUNC">=</span><span class="NAME">THREE.Curve.create</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.points</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">==</span><span class="NAME">a</span><span class="PUNC">?</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">:</span><span class="NAME">a</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">this.points</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">=</span><span class="PUNC">(</span><span class="NAME">d.length</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">Math.floor</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">-</span><span class="PUNC">=</span><span class="NAME">e</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">==</span><span class="NAME">e</span><span class="PUNC">?</span><span class="NAME">e</span><span class="PUNC">:</span><span class="NAME">e</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">e</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">e</span><span class="PUNC">></span><span class="NAME">d.length</span><span class="PUNC">-</span><span class="NUMB">2</span><span class="PUNC">?</span><span class="NAME">d.length</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">:</span><span class="NAME">e</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NUMB">3</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">e</span><span class="PUNC">></span><span class="NAME">d.length</span><span class="PUNC">-</span><span class="NUMB">3</span><span class="PUNC">?</span><span class="NAME">d.length</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">:</span><span class="NAME">e</span><span class="PUNC">+</span><span class="NUMB">2</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NUMB">3</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">b.x</span><span class="PUNC">=</span><span class="NAME">THREE.Curve.Utils.interpolate</span><span class="PUNC">(</span><span class="NAME">e.x</span><span class="PUNC">,</span><span class="NAME">f.x</span><span class="PUNC">,</span><span class="NAME">h.x</span><span class="PUNC">,</span><span class="NAME">c.x</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b.y</span><span class="PUNC">=</span><span class="NAME">THREE.Curve.Utils.interpolate</span><span class="PUNC">(</span><span class="NAME">e.y</span><span class="PUNC">,</span><span class="NAME">f.y</span><span class="PUNC">,</span><span class="NAME">h.y</span><span class="PUNC">,</span><span class="NAME">c.y</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b.z</span><span class="PUNC">=</span><span class="NAME">THREE.Curve.Utils.interpolate</span><span class="PUNC">(</span><span class="NAME">e.z</span><span class="PUNC">,</span><span class="NAME">f.z</span><span class="PUNC">,</span><span class="NAME">h.z</span><span class="PUNC">,</span><span class="NAME">c.z</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">THREE.ClosedSplineCurve3</span><span class="PUNC">=</span><span class="NAME">THREE.Curve.create</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.points</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">==</span><span class="NAME">a</span><span class="PUNC">?</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">:</span><span class="NAME">a</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">this.points</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">=</span><span class="PUNC">(</span><span class="NAME">d.length</span><span class="PUNC">-</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">Math.floor</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">-</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">&lt;</span><span class="NAME">a</span><span class="PUNC">?</span><span class="NUMB">0</span><span class="PUNC">:</span><span class="PUNC">(</span><span class="NAME">Math.floor</span><span class="PUNC">(</span><span class="NAME">Math.abs</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">/</span><span class="NAME">d.length</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">d.length</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">%</span><span class="NAME">d.length</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">%</span><span class="NAME">d.length</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">%</span><span class="NAME">d.length</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NUMB">3</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">+</span><span class="NUMB">2</span><span class="PUNC">)</span><span class="PUNC">%</span><span class="NAME">d.length</span><span class="PUNC">;</span><span class="NAME">b.x</span><span class="PUNC">=</span><span class="NAME">THREE.Curve.Utils.interpolate</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">x</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">x</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">x</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NUMB">3</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">x</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b.y</span><span class="PUNC">=</span><span class="NAME">THREE.Curve.Utils.interpolate</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">y</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">y</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">y</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NUMB">3</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">y</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b.z</span><span class="PUNC">=</span><span class="NAME">THREE.Curve.Utils.interpolate</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">z</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>592</span> </span><span class="NAME">d</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">z</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">z</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NUMB">3</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">z</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">THREE.AnimationHandler</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="NAME">update</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">&lt;</span><span class="NAME">a.length</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">update</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">addToUpdate</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">===</span><span class="NAME">a.indexOf</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="NAME">a.push</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">removeFromUpdate</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">a.indexOf</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">!==</span><span class="NAME">b</span><span class="PUNC">&&</span><span class="NAME">a.splice</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">add</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NAME">a.name</span><span class="PUNC">]</span><span class="PUNC">&&</span><span class="NAME">console.log</span><span class="PUNC">(</span><span class="STRN">"THREE.AnimationHandler.add: Warning! "</span><span class="PUNC">+</span><span class="NAME">a.name</span><span class="PUNC">+</span><span class="STRN">" already exists in library. Overwriting."</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NAME">a.name</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">a.initialized</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">&lt;</span><span class="NAME">a.hierarchy.length</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">&lt;</span><span class="NAME">a.hierarchy</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">keys.length</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">></span><span class="NAME">a.hierarchy</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">keys</span><span class="PUNC">[</span><span class="NAME">d</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">time</span><span class="PUNC">&&</span><span class="WHIT">
<span class='line'>593</span> </span><span class="PUNC">(</span><span class="NAME">a.hierarchy</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">keys</span><span class="PUNC">[</span><span class="NAME">d</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">time</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">a.hierarchy</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">keys</span><span class="PUNC">[</span><span class="NAME">d</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">rot</span><span class="PUNC">&&</span><span class="PUNC">!</span><span class="PUNC">(</span><span class="NAME">a.hierarchy</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">keys</span><span class="PUNC">[</span><span class="NAME">d</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">rot</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">THREE.Quaternion</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">a.hierarchy</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">keys</span><span class="PUNC">[</span><span class="NAME">d</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">rot</span><span class="PUNC">;</span><span class="NAME">a.hierarchy</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">keys</span><span class="PUNC">[</span><span class="NAME">d</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">rot</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Quaternion</span><span class="PUNC">(</span><span class="NAME">g</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">[</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">[</span><span class="NUMB">3</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">a.hierarchy</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">keys.length</span><span class="PUNC">&&</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">a.hierarchy</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">keys</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">morphTargets</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">g</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">&lt;</span><span class="NAME">a.hierarchy</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">keys.length</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">i</span><span class="PUNC">&lt;</span><span class="NAME">a.hierarchy</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">keys</span><span class="PUNC">[</span><span class="NAME">d</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">morphTargets.length</span><span class="PUNC">;</span><span class="NAME">i</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">j</span><span class="PUNC">=</span><span class="NAME">a.hierarchy</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">keys</span><span class="PUNC">[</span><span class="NAME">d</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">morphTargets</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">g</span><span class="PUNC">[</span><span class="NAME">j</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">}</span><span class="NAME">a.hierarchy</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">usedMorphTargets</span><span class="PUNC">=</span><span class="NAME">g</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>594</span> </span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">&lt;</span><span class="NAME">a.hierarchy</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">keys.length</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">l</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">j</span><span class="WHIT"> </span><span class="KEYW">in</span><span class="WHIT"> </span><span class="NAME">g</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">i</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">i</span><span class="PUNC">&lt;</span><span class="NAME">a.hierarchy</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">keys</span><span class="PUNC">[</span><span class="NAME">d</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">morphTargets.length</span><span class="PUNC">;</span><span class="NAME">i</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">a.hierarchy</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">keys</span><span class="PUNC">[</span><span class="NAME">d</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">morphTargets</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">===</span><span class="NAME">j</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">l</span><span class="PUNC">[</span><span class="NAME">j</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">a.hierarchy</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">keys</span><span class="PUNC">[</span><span class="NAME">d</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">morphTargetsInfluences</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="KEYW">break</span><span class="PUNC">}</span><span class="NAME">i</span><span class="PUNC">===</span><span class="NAME">a.hierarchy</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">keys</span><span class="PUNC">[</span><span class="NAME">d</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">morphTargets.length</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">l</span><span class="PUNC">[</span><span class="NAME">j</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="NAME">a.hierarchy</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">keys</span><span class="PUNC">[</span><span class="NAME">d</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">morphTargetsInfluences</span><span class="PUNC">=</span><span class="NAME">l</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">&lt;</span><span class="NAME">a.hierarchy</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">keys.length</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">a.hierarchy</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">keys</span><span class="PUNC">[</span><span class="NAME">d</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">time</span><span class="PUNC">===</span><span class="NAME">a.hierarchy</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">keys</span><span class="PUNC">[</span><span class="NAME">d</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">time</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">a.hierarchy</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">keys.splice</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">--</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">&lt;</span><span class="NAME">a.hierarchy</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">keys.length</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">a.hierarchy</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">keys</span><span class="PUNC">[</span><span class="NAME">d</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">index</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>595</span> </span><span class="NAME">d</span><span class="PUNC">}</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">parseInt</span><span class="PUNC">(</span><span class="NAME">a.length</span><span class="PUNC">*</span><span class="NAME">a.fps</span><span class="PUNC">,</span><span class="NUMB">10</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a.JIT</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">a.JIT.hierarchy</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">&lt;</span><span class="NAME">a.hierarchy.length</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">a.JIT.hierarchy.push</span><span class="PUNC">(</span><span class="NAME">Array</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a.initialized</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">get</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="STRN">"string"</span><span class="PUNC">===</span><span class="KEYW">typeof</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">console.log</span><span class="PUNC">(</span><span class="STRN">"THREE.AnimationHandler.get: Couldn't find animation "</span><span class="PUNC">+</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">parse</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">a</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">THREE.SkinnedMesh</span><span class="PUNC">)</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">&lt;</span><span class="NAME">a.bones.length</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">b.push</span><span class="PUNC">(</span><span class="NAME">a.bones</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">b.push</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">&lt;</span><span class="NAME">a.children.length</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">d</span><span class="PUNC">(</span><span class="NAME">a.children</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>596</span> </span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">c.LINEAR</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">c.CATMULLROM</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">c.CATMULLROM_FORWARD</span><span class="PUNC">=</span><span class="NUMB">2</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">}</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">THREE.Animation</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.root</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">this.data</span><span class="PUNC">=</span><span class="NAME">THREE.AnimationHandler.get</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.hierarchy</span><span class="PUNC">=</span><span class="NAME">THREE.AnimationHandler.parse</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.currentTime</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">this.timeScale</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">this.isPlaying</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">this.loop</span><span class="PUNC">=</span><span class="NAME">this.isPaused</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">this.interpolationType</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">c</span><span class="PUNC">?</span><span class="NAME">c</span><span class="PUNC">:</span><span class="NAME">THREE.AnimationHandler.LINEAR</span><span class="PUNC">;</span><span class="NAME">this.points</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">this.target</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>597</span> </span><span class="NAME">THREE.Animation.prototype.play</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">===</span><span class="NAME">this.isPlaying</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.isPlaying</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">this.loop</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">a</span><span class="PUNC">?</span><span class="NAME">a</span><span class="PUNC">:</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">this.currentTime</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">b</span><span class="PUNC">?</span><span class="NAME">b</span><span class="PUNC">:</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">this.hierarchy.length</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">&lt;</span><span class="NAME">d</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">this.hierarchy</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">e.matrixAutoUpdate</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">===</span><span class="NAME">e.animationCache</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">e.animationCache</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">e.animationCache.prevKey</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="NAME">pos</span><span class="PUNC">:</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">rot</span><span class="PUNC">:</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">scl</span><span class="PUNC">:</span><span class="NUMB">0</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">e.animationCache.nextKey</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="NAME">pos</span><span class="PUNC">:</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">rot</span><span class="PUNC">:</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">scl</span><span class="PUNC">:</span><span class="NUMB">0</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">e.animationCache.originalMatrix</span><span class="PUNC">=</span><span class="NAME">e</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">THREE.Bone</span><span class="PUNC">?</span><span class="NAME">e.skinMatrix</span><span class="PUNC">:</span><span class="NAME">e.matrix</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">e.animationCache.prevKey</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">e.animationCache.nextKey</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>598</span> </span><span class="NAME">f.pos</span><span class="PUNC">=</span><span class="NAME">this.data.hierarchy</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">keys</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">f.rot</span><span class="PUNC">=</span><span class="NAME">this.data.hierarchy</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">keys</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">f.scl</span><span class="PUNC">=</span><span class="NAME">this.data.hierarchy</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">keys</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">e.pos</span><span class="PUNC">=</span><span class="NAME">this.getNextKeyWith</span><span class="PUNC">(</span><span class="STRN">"pos"</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">e.rot</span><span class="PUNC">=</span><span class="NAME">this.getNextKeyWith</span><span class="PUNC">(</span><span class="STRN">"rot"</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">e.scl</span><span class="PUNC">=</span><span class="NAME">this.getNextKeyWith</span><span class="PUNC">(</span><span class="STRN">"scl"</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="NAME">this.update</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="NAME">this.isPaused</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">THREE.AnimationHandler.addToUpdate</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.Animation.prototype.pause</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">===</span><span class="NAME">this.isPaused</span><span class="PUNC">?</span><span class="NAME">THREE.AnimationHandler.addToUpdate</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">THREE.AnimationHandler.removeFromUpdate</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.isPaused</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NAME">this.isPaused</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>599</span> </span><span class="NAME">THREE.Animation.prototype.stop</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.isPaused</span><span class="PUNC">=</span><span class="NAME">this.isPlaying</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">THREE.AnimationHandler.removeFromUpdate</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>600</span> </span><span class="NAME">THREE.Animation.prototype.update</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">!==</span><span class="NAME">this.isPlaying</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="STRN">"pos"</span><span class="PUNC">,</span><span class="STRN">"rot"</span><span class="PUNC">,</span><span class="STRN">"scl"</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">,</span><span class="NAME">j</span><span class="PUNC">,</span><span class="NAME">l</span><span class="PUNC">;</span><span class="NAME">l</span><span class="PUNC">=</span><span class="NAME">this.currentTime</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">*</span><span class="NAME">this.timeScale</span><span class="PUNC">;</span><span class="NAME">j</span><span class="PUNC">=</span><span class="NAME">this.currentTime</span><span class="PUNC">%</span><span class="PUNC">=</span><span class="NAME">this.data.length</span><span class="PUNC">;</span><span class="NAME">parseInt</span><span class="PUNC">(</span><span class="NAME">Math.min</span><span class="PUNC">(</span><span class="NAME">j</span><span class="PUNC">*</span><span class="NAME">this.data.fps</span><span class="PUNC">,</span><span class="NAME">this.data.length</span><span class="PUNC">*</span><span class="NAME">this.data.fps</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NUMB">10</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">m</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">n</span><span class="PUNC">=</span><span class="NAME">this.hierarchy.length</span><span class="PUNC">;</span><span class="NAME">m</span><span class="PUNC">&lt;</span><span class="NAME">n</span><span class="PUNC">;</span><span class="NAME">m</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">this.hierarchy</span><span class="PUNC">[</span><span class="NAME">m</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">i</span><span class="PUNC">=</span><span class="NAME">a.animationCache</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">p</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NUMB">3</span><span class="PUNC">></span><span class="NAME">p</span><span class="PUNC">;</span><span class="NAME">p</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NAME">p</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">i.prevKey</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">i.nextKey</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">g.time</span><span class="PUNC">&lt;=</span><span class="NAME">l</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">j</span><span class="PUNC">&lt;</span><span class="NAME">l</span><span class="PUNC">)</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.loop</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">this.data.hierarchy</span><span class="PUNC">[</span><span class="NAME">m</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">keys</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">this.getNextKeyWith</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">m</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">g.time</span><span class="PUNC">&lt;</span><span class="WHIT">
<span class='line'>601</span> </span><span class="NAME">j</span><span class="PUNC">;</span><span class="PUNC">)</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">g</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">this.getNextKeyWith</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">m</span><span class="PUNC">,</span><span class="NAME">g.index</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="PUNC">{</span><span class="NAME">this.stop</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="PUNC">{</span><span class="KEYW">do</span><span class="WHIT"> </span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">g</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">this.getNextKeyWith</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">m</span><span class="PUNC">,</span><span class="NAME">g.index</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">while</span><span class="PUNC">(</span><span class="NAME">g.time</span><span class="PUNC">&lt;</span><span class="NAME">j</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="NAME">i.prevKey</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">h</span><span class="PUNC">;</span><span class="NAME">i.nextKey</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">g</span><span class="PUNC">}</span><span class="NAME">a.matrixAutoUpdate</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">a.matrixWorldNeedsUpdate</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">=</span><span class="PUNC">(</span><span class="NAME">j</span><span class="PUNC">-</span><span class="NAME">h.time</span><span class="PUNC">)</span><span class="PUNC">/</span><span class="PUNC">(</span><span class="NAME">g.time</span><span class="PUNC">-</span><span class="NAME">h.time</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">h</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">g</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">></span><span class="NAME">d</span><span class="PUNC">||</span><span class="NUMB">1</span><span class="PUNC">&lt;</span><span class="NAME">d</span><span class="PUNC">)</span><span class="NAME">console.log</span><span class="PUNC">(</span><span class="STRN">"THREE.Animation.update: Warning! Scale out of bounds:"</span><span class="PUNC">+</span><span class="NAME">d</span><span class="PUNC">+</span><span class="STRN">" on bone "</span><span class="PUNC">+</span><span class="NAME">m</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">></span><span class="NAME">d</span><span class="PUNC">?</span><span class="NUMB">0</span><span class="PUNC">:</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="STRN">"pos"</span><span class="PUNC">===</span><span class="NAME">c</span><span class="PUNC">)</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">a.position</span><span class="PUNC">,</span><span class="NAME">this.interpolationType</span><span class="PUNC">===</span><span class="NAME">THREE.AnimationHandler.LINEAR</span><span class="PUNC">)</span><span class="NAME">c.x</span><span class="PUNC">=</span><span class="NAME">e</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">+</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">-</span><span class="NAME">e</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">c.y</span><span class="PUNC">=</span><span class="NAME">e</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">+</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">-</span><span class="NAME">e</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">c.z</span><span class="PUNC">=</span><span class="NAME">e</span><span class="PUNC">[</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">+</span><span class="WHIT">
<span class='line'>602</span> </span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">[</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">-</span><span class="NAME">e</span><span class="PUNC">[</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">d</span><span class="PUNC">;</span><span class="KEYW">else</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.interpolationType</span><span class="PUNC">===</span><span class="NAME">THREE.AnimationHandler.CATMULLROM</span><span class="PUNC">||</span><span class="NAME">this.interpolationType</span><span class="PUNC">===</span><span class="NAME">THREE.AnimationHandler.CATMULLROM_FORWARD</span><span class="PUNC">)</span><span class="NAME">this.points</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">this.getPrevKeyWith</span><span class="PUNC">(</span><span class="STRN">"pos"</span><span class="PUNC">,</span><span class="NAME">m</span><span class="PUNC">,</span><span class="NAME">h.index</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">pos</span><span class="PUNC">,</span><span class="NAME">this.points</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">this.points</span><span class="PUNC">[</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">this.points</span><span class="PUNC">[</span><span class="NUMB">3</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">this.getNextKeyWith</span><span class="PUNC">(</span><span class="STRN">"pos"</span><span class="PUNC">,</span><span class="NAME">m</span><span class="PUNC">,</span><span class="NAME">g.index</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">pos</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NUMB">0.33</span><span class="PUNC">*</span><span class="NAME">d</span><span class="PUNC">+</span><span class="NUMB">0.33</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">this.interpolateCatmullRom</span><span class="PUNC">(</span><span class="NAME">this.points</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">c.x</span><span class="PUNC">=</span><span class="NAME">e</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">c.y</span><span class="PUNC">=</span><span class="NAME">e</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">c.z</span><span class="PUNC">=</span><span class="NAME">e</span><span class="PUNC">[</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">this.interpolationType</span><span class="PUNC">===</span><span class="NAME">THREE.AnimationHandler.CATMULLROM_FORWARD</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">this.interpolateCatmullRom</span><span class="PUNC">(</span><span class="NAME">this.points</span><span class="PUNC">,</span><span class="NUMB">1.01</span><span class="PUNC">*</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>603</span> </span><span class="NAME">this.target.set</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">[</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this.target.sub</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this.target.y</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">this.target.normalize</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">Math.atan2</span><span class="PUNC">(</span><span class="NAME">this.target.x</span><span class="PUNC">,</span><span class="NAME">this.target.z</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">a.rotation.set</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="STRN">"rot"</span><span class="PUNC">===</span><span class="NAME">c</span><span class="PUNC">?</span><span class="NAME">THREE.Quaternion.slerp</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">a.quaternion</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="STRN">"scl"</span><span class="PUNC">===</span><span class="NAME">c</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">a.scale</span><span class="PUNC">,</span><span class="NAME">c.x</span><span class="PUNC">=</span><span class="NAME">e</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">+</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">-</span><span class="NAME">e</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">c.y</span><span class="PUNC">=</span><span class="NAME">e</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">+</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">-</span><span class="NAME">e</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">c.z</span><span class="PUNC">=</span><span class="NAME">e</span><span class="PUNC">[</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">+</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">[</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">-</span><span class="NAME">e</span><span class="PUNC">[</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>604</span> </span><span class="NAME">THREE.Animation.prototype.interpolateCatmullRom</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">,</span><span class="NAME">j</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">=</span><span class="PUNC">(</span><span class="NAME">a.length</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">b</span><span class="PUNC">;</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">Math.floor</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">-</span><span class="PUNC">=</span><span class="NAME">f</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">===</span><span class="NAME">f</span><span class="PUNC">?</span><span class="NAME">f</span><span class="PUNC">:</span><span class="NAME">f</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">f</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">f</span><span class="PUNC">></span><span class="NAME">a.length</span><span class="PUNC">-</span><span class="NUMB">2</span><span class="PUNC">?</span><span class="NAME">f</span><span class="PUNC">:</span><span class="NAME">f</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NUMB">3</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">f</span><span class="PUNC">></span><span class="NAME">a.length</span><span class="PUNC">-</span><span class="NUMB">3</span><span class="PUNC">?</span><span class="NAME">f</span><span class="PUNC">:</span><span class="NAME">f</span><span class="PUNC">+</span><span class="NUMB">2</span><span class="PUNC">;</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">i</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">j</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NUMB">3</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">e</span><span class="PUNC">*</span><span class="NAME">e</span><span class="PUNC">;</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">e</span><span class="PUNC">*</span><span class="NAME">c</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">this.interpolate</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">j</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">this.interpolate</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">j</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">[</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">this.interpolate</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">[</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">[</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">[</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">j</span><span class="PUNC">[</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>605</span> </span><span class="NAME">THREE.Animation.prototype.interpolate</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NUMB">0.5</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">-</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NUMB">0.5</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">-</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="PUNC">(</span><span class="NUMB">2</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">-</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="NAME">a</span><span class="PUNC">+</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">h</span><span class="PUNC">+</span><span class="PUNC">(</span><span class="PUNC">-</span><span class="NUMB">3</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">-</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">-</span><span class="NUMB">2</span><span class="PUNC">*</span><span class="NAME">a</span><span class="PUNC">-</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">f</span><span class="PUNC">+</span><span class="NAME">a</span><span class="PUNC">*</span><span class="NAME">e</span><span class="PUNC">+</span><span class="NAME">b</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.Animation.prototype.getNextKeyWith</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">this.data.hierarchy</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">keys</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.interpolationType</span><span class="PUNC">===</span><span class="NAME">THREE.AnimationHandler.CATMULLROM</span><span class="PUNC">||</span><span class="NAME">this.interpolationType</span><span class="PUNC">===</span><span class="NAME">THREE.AnimationHandler.CATMULLROM_FORWARD</span><span class="PUNC">?</span><span class="NAME">c</span><span class="PUNC">&lt;</span><span class="NAME">d.length</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">?</span><span class="NAME">c</span><span class="PUNC">:</span><span class="NAME">d.length</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">:</span><span class="NAME">c</span><span class="PUNC">%</span><span class="NAME">d.length</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">&lt;</span><span class="NAME">d.length</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">d</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">]</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.data.hierarchy</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">keys</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>606</span> </span><span class="NAME">THREE.Animation.prototype.getPrevKeyWith</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">this.data.hierarchy</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">keys</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.interpolationType</span><span class="PUNC">===</span><span class="NAME">THREE.AnimationHandler.CATMULLROM</span><span class="PUNC">||</span><span class="NAME">this.interpolationType</span><span class="PUNC">===</span><span class="NAME">THREE.AnimationHandler.CATMULLROM_FORWARD</span><span class="PUNC">?</span><span class="NUMB">0</span><span class="PUNC">&lt;</span><span class="NAME">c</span><span class="PUNC">?</span><span class="NAME">c</span><span class="PUNC">:</span><span class="NUMB">0</span><span class="PUNC">:</span><span class="NUMB">0</span><span class="PUNC">&lt;=</span><span class="NAME">c</span><span class="PUNC">?</span><span class="NAME">c</span><span class="PUNC">:</span><span class="NAME">c</span><span class="PUNC">+</span><span class="NAME">d.length</span><span class="PUNC">;</span><span class="NUMB">0</span><span class="PUNC">&lt;=</span><span class="NAME">c</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">--</span><span class="PUNC">)</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">d</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">]</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.data.hierarchy</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">keys</span><span class="PUNC">[</span><span class="NAME">d.length</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.KeyFrameAnimation</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.root</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">this.data</span><span class="PUNC">=</span><span class="NAME">THREE.AnimationHandler.get</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.hierarchy</span><span class="PUNC">=</span><span class="NAME">THREE.AnimationHandler.parse</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.currentTime</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">this.timeScale</span><span class="PUNC">=</span><span class="NUMB">0.001</span><span class="PUNC">;</span><span class="NAME">this.isPlaying</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">this.loop</span><span class="PUNC">=</span><span class="NAME">this.isPaused</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">this.JITCompile</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">c</span><span class="PUNC">?</span><span class="NAME">c</span><span class="PUNC">:</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.hierarchy.length</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">&lt;</span><span class="NAME">b</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.data.hierarchy</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">sids</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">this.hierarchy</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.data.hierarchy</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">keys.length</span><span class="PUNC">&&</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">e</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">&lt;</span><span class="NAME">c.length</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NAME">e</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">this.getNextKeyWith</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">h</span><span class="PUNC">&&</span><span class="NAME">h.apply</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="NAME">d.matrixAutoUpdate</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">this.data.hierarchy</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">node.updateMatrix</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>607</span> </span><span class="NAME">d.matrixWorldNeedsUpdate</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>608</span> </span><span class="NAME">THREE.KeyFrameAnimation.prototype.play</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">this.isPlaying</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.isPlaying</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">this.loop</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">a</span><span class="PUNC">?</span><span class="NAME">a</span><span class="PUNC">:</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">this.currentTime</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">b</span><span class="PUNC">?</span><span class="NAME">b</span><span class="PUNC">:</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">this.startTimeMs</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">;</span><span class="NAME">this.startTime</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="NAME">E7</span><span class="PUNC">;</span><span class="NAME">this.endTime</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="NAME">this.startTime</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">this.hierarchy.length</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">&lt;</span><span class="NAME">d</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">this.hierarchy</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">this.data.hierarchy</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">===</span><span class="NAME">f.animationCache</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">f.animationCache</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">f.animationCache.prevKey</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">f.animationCache.nextKey</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">f.animationCache.originalMatrix</span><span class="PUNC">=</span><span class="NAME">e</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">THREE.Bone</span><span class="PUNC">?</span><span class="NAME">e.skinMatrix</span><span class="PUNC">:</span><span class="NAME">e.matrix</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">this.data.hierarchy</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">keys</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>609</span> </span><span class="NAME">e.length</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">f.animationCache.prevKey</span><span class="PUNC">=</span><span class="NAME">e</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">f.animationCache.nextKey</span><span class="PUNC">=</span><span class="NAME">e</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">this.startTime</span><span class="PUNC">=</span><span class="NAME">Math.min</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">time</span><span class="PUNC">,</span><span class="NAME">this.startTime</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this.endTime</span><span class="PUNC">=</span><span class="NAME">Math.max</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">[</span><span class="NAME">e.length</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">time</span><span class="PUNC">,</span><span class="NAME">this.endTime</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.update</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="NAME">this.isPaused</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">THREE.AnimationHandler.addToUpdate</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.KeyFrameAnimation.prototype.pause</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.isPaused</span><span class="PUNC">?</span><span class="NAME">THREE.AnimationHandler.addToUpdate</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">THREE.AnimationHandler.removeFromUpdate</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.isPaused</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NAME">this.isPaused</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>610</span> </span><span class="NAME">THREE.KeyFrameAnimation.prototype.stop</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.isPaused</span><span class="PUNC">=</span><span class="NAME">this.isPlaying</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">THREE.AnimationHandler.removeFromUpdate</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">&lt;</span><span class="NAME">this.data.hierarchy.length</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.hierarchy</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.data.hierarchy</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">c.animationCache</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">c.animationCache.originalMatrix</span><span class="PUNC">;</span><span class="NAME">b</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">THREE.Bone</span><span class="PUNC">?</span><span class="PUNC">(</span><span class="NAME">d.copy</span><span class="PUNC">(</span><span class="NAME">b.skinMatrix</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">b.skinMatrix</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="PUNC">(</span><span class="NAME">d.copy</span><span class="PUNC">(</span><span class="NAME">b.matrix</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">b.matrix</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">delete</span><span class="WHIT"> </span><span class="NAME">c.animationCache</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>611</span> </span><span class="NAME">THREE.KeyFrameAnimation.prototype.update</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.isPlaying</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">this.data.JIT.hierarchy</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">;</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">this.currentTime</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">*</span><span class="NAME">this.timeScale</span><span class="PUNC">;</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">this.currentTime</span><span class="PUNC">%</span><span class="PUNC">=</span><span class="NAME">this.data.length</span><span class="PUNC">;</span><span class="NAME">h</span><span class="PUNC">&lt;</span><span class="NAME">this.startTimeMs</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">this.currentTime</span><span class="PUNC">=</span><span class="NAME">this.startTimeMs</span><span class="PUNC">+</span><span class="NAME">h</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">parseInt</span><span class="PUNC">(</span><span class="NAME">Math.min</span><span class="PUNC">(</span><span class="NAME">h</span><span class="PUNC">*</span><span class="NAME">this.data.fps</span><span class="PUNC">,</span><span class="NAME">this.data.length</span><span class="PUNC">*</span><span class="NAME">this.data.fps</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NUMB">10</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">(</span><span class="NAME">i</span><span class="PUNC">=</span><span class="NAME">h</span><span class="PUNC">&lt;</span><span class="NAME">g</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="PUNC">!</span><span class="NAME">this.loop</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">j</span><span class="PUNC">=</span><span class="NAME">this.hierarchy.length</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">&lt;</span><span class="NAME">j</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">l</span><span class="PUNC">=</span><span class="NAME">this.data.hierarchy</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">keys</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">this.data.hierarchy</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">sids</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">l.length</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">this.hierarchy</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">l.length</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">l</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>612</span> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">l</span><span class="PUNC">&lt;</span><span class="NAME">f.length</span><span class="PUNC">;</span><span class="NAME">l</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">f</span><span class="PUNC">[</span><span class="NAME">l</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="PUNC">(</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">this.getPrevKeyWith</span><span class="PUNC">(</span><span class="NAME">h</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="NAME">g.apply</span><span class="PUNC">(</span><span class="NAME">h</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.data.hierarchy</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">node.updateMatrix</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">e.matrixWorldNeedsUpdate</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="NAME">this.stop</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="PUNC">(</span><span class="NAME">h</span><span class="PUNC">&lt;</span><span class="NAME">this.startTime</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">j</span><span class="PUNC">=</span><span class="NAME">this.hierarchy.length</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">&lt;</span><span class="NAME">j</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">this.hierarchy</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.data.hierarchy</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">l</span><span class="PUNC">=</span><span class="NAME">b.keys</span><span class="PUNC">,</span><span class="NAME">m</span><span class="PUNC">=</span><span class="NAME">b.animationCache</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.JITCompile</span><span class="PUNC">&&</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">f</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">]</span><span class="PUNC">[</span><span class="NAME">e</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="NAME">d</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">THREE.Bone</span><span class="PUNC">?</span><span class="PUNC">(</span><span class="NAME">d.skinMatrix</span><span class="PUNC">=</span><span class="NAME">f</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">]</span><span class="PUNC">[</span><span class="NAME">e</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">d.matrixWorldNeedsUpdate</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="PUNC">(</span><span class="NAME">d.matrix</span><span class="PUNC">=</span><span class="NAME">f</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">]</span><span class="PUNC">[</span><span class="NAME">e</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">d.matrixWorldNeedsUpdate</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">l.length</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.JITCompile</span><span class="PUNC">&&</span><span class="NAME">m</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">d</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT">
<span class='line'>613</span> </span><span class="NAME">THREE.Bone</span><span class="PUNC">?</span><span class="NAME">d.skinMatrix</span><span class="PUNC">=</span><span class="NAME">m.originalMatrix</span><span class="PUNC">:</span><span class="NAME">d.matrix</span><span class="PUNC">=</span><span class="NAME">m.originalMatrix</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">m.prevKey</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">m.nextKey</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">&&</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">c.time</span><span class="PUNC">&lt;=</span><span class="NAME">g</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">i</span><span class="PUNC">&&</span><span class="NAME">this.loop</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">l</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">l</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">c.time</span><span class="PUNC">&lt;</span><span class="NAME">h</span><span class="PUNC">;</span><span class="PUNC">)</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">l</span><span class="PUNC">[</span><span class="NAME">b.index</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">i</span><span class="PUNC">)</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">n</span><span class="PUNC">=</span><span class="NAME">l.length</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">c.time</span><span class="PUNC">&lt;</span><span class="NAME">h</span><span class="PUNC">&&</span><span class="NAME">c.index</span><span class="PUNC">!==</span><span class="NAME">n</span><span class="PUNC">;</span><span class="PUNC">)</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">l</span><span class="PUNC">[</span><span class="NAME">b.index</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">m.prevKey</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">;</span><span class="NAME">m.nextKey</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">}</span><span class="NAME">c.time</span><span class="PUNC">>=</span><span class="NAME">h</span><span class="PUNC">?</span><span class="NAME">b.interpolate</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">b.interpolate</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">c.time</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="NAME">this.data.hierarchy</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">node.updateMatrix</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">d.matrixWorldNeedsUpdate</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">this.JITCompile</span><span class="PUNC">&&</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">===</span><span class="NAME">f</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">[</span><span class="NAME">e</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.hierarchy</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">updateMatrixWorld</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">&lt;</span><span class="NAME">this.hierarchy.length</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">f</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">]</span><span class="PUNC">[</span><span class="NAME">e</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>614</span> </span><span class="NAME">this.hierarchy</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">]</span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">THREE.Bone</span><span class="PUNC">?</span><span class="NAME">this.hierarchy</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">skinMatrix.clone</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">this.hierarchy</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">matrix.clone</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.KeyFrameAnimation.prototype.getNextKeyWith</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.data.hierarchy</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">keys</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">%</span><span class="PUNC">=</span><span class="NAME">b.length</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">&lt;</span><span class="NAME">b.length</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">hasTarget</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.KeyFrameAnimation.prototype.getPrevKeyWith</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.data.hierarchy</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">keys</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">&lt;=</span><span class="NAME">c</span><span class="PUNC">?</span><span class="NAME">c</span><span class="PUNC">:</span><span class="NAME">c</span><span class="PUNC">+</span><span class="NAME">b.length</span><span class="PUNC">;</span><span class="NUMB">0</span><span class="PUNC">&lt;=</span><span class="NAME">c</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">--</span><span class="PUNC">)</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">hasTarget</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">[</span><span class="NAME">b.length</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.CubeCamera</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">THREE.Object3D.call</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.PerspectiveCamera</span><span class="PUNC">(</span><span class="NUMB">90</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">d.up.set</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">d.lookAt</span><span class="PUNC">(</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">(</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.add</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">e</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.PerspectiveCamera</span><span class="PUNC">(</span><span class="NUMB">90</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">e.up.set</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">e.lookAt</span><span class="PUNC">(</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">(</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.add</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">f</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.PerspectiveCamera</span><span class="PUNC">(</span><span class="NUMB">90</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">f.up.set</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">f.lookAt</span><span class="PUNC">(</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.add</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">h</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.PerspectiveCamera</span><span class="PUNC">(</span><span class="NUMB">90</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">h.up.set</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">h.lookAt</span><span class="PUNC">(</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.add</span><span class="PUNC">(</span><span class="NAME">h</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">g</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.PerspectiveCamera</span><span class="PUNC">(</span><span class="NUMB">90</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>615</span> </span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">g.up.set</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">g.lookAt</span><span class="PUNC">(</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.add</span><span class="PUNC">(</span><span class="NAME">g</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.PerspectiveCamera</span><span class="PUNC">(</span><span class="NUMB">90</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">i.up.set</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">i.lookAt</span><span class="PUNC">(</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.add</span><span class="PUNC">(</span><span class="NAME">i</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.renderTarget</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.WebGLRenderTargetCube</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="PUNC">{</span><span class="NAME">format</span><span class="PUNC">:</span><span class="NAME">THREE.RGBFormat</span><span class="PUNC">,</span><span class="NAME">magFilter</span><span class="PUNC">:</span><span class="NAME">THREE.LinearFilter</span><span class="PUNC">,</span><span class="NAME">minFilter</span><span class="PUNC">:</span><span class="NAME">THREE.LinearFilter</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.updateCubeMap</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.renderTarget</span><span class="PUNC">,</span><span class="NAME">n</span><span class="PUNC">=</span><span class="NAME">c.generateMipmaps</span><span class="PUNC">;</span><span class="NAME">c.generateMipmaps</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">c.activeCubeFace</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">a.render</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">c.activeCubeFace</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">a.render</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">c.activeCubeFace</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>616</span> </span><span class="NUMB">2</span><span class="PUNC">;</span><span class="NAME">a.render</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">c.activeCubeFace</span><span class="PUNC">=</span><span class="NUMB">3</span><span class="PUNC">;</span><span class="NAME">a.render</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">c.activeCubeFace</span><span class="PUNC">=</span><span class="NUMB">4</span><span class="PUNC">;</span><span class="NAME">a.render</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">c.generateMipmaps</span><span class="PUNC">=</span><span class="NAME">n</span><span class="PUNC">;</span><span class="NAME">c.activeCubeFace</span><span class="PUNC">=</span><span class="NUMB">5</span><span class="PUNC">;</span><span class="NAME">a.render</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.CubeCamera.prototype</span><span class="PUNC">=</span><span class="NAME">Object.create</span><span class="PUNC">(</span><span class="NAME">THREE.Object3D.prototype</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">THREE.CombinedCamera</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">THREE.Camera.call</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.fov</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">;</span><span class="NAME">this.left</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="NAME">a</span><span class="PUNC">/</span><span class="NUMB">2</span><span class="PUNC">;</span><span class="NAME">this.right</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">/</span><span class="NUMB">2</span><span class="PUNC">;</span><span class="NAME">this.top</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">/</span><span class="NUMB">2</span><span class="PUNC">;</span><span class="NAME">this.bottom</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="NAME">b</span><span class="PUNC">/</span><span class="NUMB">2</span><span class="PUNC">;</span><span class="NAME">this.cameraO</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.OrthographicCamera</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">/</span><span class="PUNC">-</span><span class="NUMB">2</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">/</span><span class="NUMB">2</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">/</span><span class="NUMB">2</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">/</span><span class="PUNC">-</span><span class="NUMB">2</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.cameraP</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.PerspectiveCamera</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">/</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.zoom</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">this.toPerspective</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.CombinedCamera.prototype</span><span class="PUNC">=</span><span class="NAME">Object.create</span><span class="PUNC">(</span><span class="NAME">THREE.Camera.prototype</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>617</span> </span><span class="NAME">THREE.CombinedCamera.prototype.toPerspective</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.near</span><span class="PUNC">=</span><span class="NAME">this.cameraP.near</span><span class="PUNC">;</span><span class="NAME">this.far</span><span class="PUNC">=</span><span class="NAME">this.cameraP.far</span><span class="PUNC">;</span><span class="NAME">this.cameraP.fov</span><span class="PUNC">=</span><span class="NAME">this.fov</span><span class="PUNC">/</span><span class="NAME">this.zoom</span><span class="PUNC">;</span><span class="NAME">this.cameraP.updateProjectionMatrix</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.projectionMatrix</span><span class="PUNC">=</span><span class="NAME">this.cameraP.projectionMatrix</span><span class="PUNC">;</span><span class="NAME">this.inPerspectiveMode</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">this.inOrthographicMode</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>618</span> </span><span class="NAME">THREE.CombinedCamera.prototype.toOrthographic</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">this.cameraP.aspect</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">=</span><span class="PUNC">(</span><span class="NAME">this.cameraP.near</span><span class="PUNC">+</span><span class="NAME">this.cameraP.far</span><span class="PUNC">)</span><span class="PUNC">/</span><span class="NUMB">2</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">Math.tan</span><span class="PUNC">(</span><span class="NAME">this.fov</span><span class="PUNC">/</span><span class="NUMB">2</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NUMB">2</span><span class="PUNC">*</span><span class="NAME">b</span><span class="PUNC">*</span><span class="NAME">a</span><span class="PUNC">/</span><span class="NUMB">2</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">/</span><span class="NAME">this.zoom</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">/</span><span class="NAME">this.zoom</span><span class="PUNC">;</span><span class="NAME">this.cameraO.left</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">this.cameraO.right</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">this.cameraO.top</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">;</span><span class="NAME">this.cameraO.bottom</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="NAME">b</span><span class="PUNC">;</span><span class="NAME">this.cameraO.updateProjectionMatrix</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.near</span><span class="PUNC">=</span><span class="NAME">this.cameraO.near</span><span class="PUNC">;</span><span class="NAME">this.far</span><span class="PUNC">=</span><span class="NAME">this.cameraO.far</span><span class="PUNC">;</span><span class="NAME">this.projectionMatrix</span><span class="PUNC">=</span><span class="NAME">this.cameraO.projectionMatrix</span><span class="PUNC">;</span><span class="NAME">this.inPerspectiveMode</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">this.inOrthographicMode</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>619</span> </span><span class="NAME">THREE.CombinedCamera.prototype.setSize</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.cameraP.aspect</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">/</span><span class="NAME">b</span><span class="PUNC">;</span><span class="NAME">this.left</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="NAME">a</span><span class="PUNC">/</span><span class="NUMB">2</span><span class="PUNC">;</span><span class="NAME">this.right</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">/</span><span class="NUMB">2</span><span class="PUNC">;</span><span class="NAME">this.top</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">/</span><span class="NUMB">2</span><span class="PUNC">;</span><span class="NAME">this.bottom</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="NAME">b</span><span class="PUNC">/</span><span class="NUMB">2</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.CombinedCamera.prototype.setFov</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.fov</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">this.inPerspectiveMode</span><span class="PUNC">?</span><span class="NAME">this.toPerspective</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">this.toOrthographic</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.CombinedCamera.prototype.updateProjectionMatrix</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.inPerspectiveMode</span><span class="PUNC">?</span><span class="NAME">this.toPerspective</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="PUNC">(</span><span class="NAME">this.toPerspective</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this.toOrthographic</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>620</span> </span><span class="NAME">THREE.CombinedCamera.prototype.setLens</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">===</span><span class="NAME">b</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NUMB">24</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="NUMB">2</span><span class="PUNC">*</span><span class="NAME">THREE.Math.radToDeg</span><span class="PUNC">(</span><span class="NAME">Math.atan</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">/</span><span class="PUNC">(</span><span class="NUMB">2</span><span class="PUNC">*</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.setFov</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.CombinedCamera.prototype.setZoom</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.zoom</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">this.inPerspectiveMode</span><span class="PUNC">?</span><span class="NAME">this.toPerspective</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">this.toOrthographic</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.CombinedCamera.prototype.toFrontView</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.rotation.x</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">this.rotation.y</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">this.rotation.z</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">this.rotationAutoUpdate</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>621</span> </span><span class="NAME">THREE.CombinedCamera.prototype.toBackView</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.rotation.x</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">this.rotation.y</span><span class="PUNC">=</span><span class="NAME">Math.PI</span><span class="PUNC">;</span><span class="NAME">this.rotation.z</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">this.rotationAutoUpdate</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.CombinedCamera.prototype.toLeftView</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.rotation.x</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">this.rotation.y</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="NAME">Math.PI</span><span class="PUNC">/</span><span class="NUMB">2</span><span class="PUNC">;</span><span class="NAME">this.rotation.z</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">this.rotationAutoUpdate</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.CombinedCamera.prototype.toRightView</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.rotation.x</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">this.rotation.y</span><span class="PUNC">=</span><span class="NAME">Math.PI</span><span class="PUNC">/</span><span class="NUMB">2</span><span class="PUNC">;</span><span class="NAME">this.rotation.z</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">this.rotationAutoUpdate</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>622</span> </span><span class="NAME">THREE.CombinedCamera.prototype.toTopView</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.rotation.x</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="NAME">Math.PI</span><span class="PUNC">/</span><span class="NUMB">2</span><span class="PUNC">;</span><span class="NAME">this.rotation.y</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">this.rotation.z</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">this.rotationAutoUpdate</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.CombinedCamera.prototype.toBottomView</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.rotation.x</span><span class="PUNC">=</span><span class="NAME">Math.PI</span><span class="PUNC">/</span><span class="NUMB">2</span><span class="PUNC">;</span><span class="NAME">this.rotation.y</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">this.rotation.z</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">this.rotationAutoUpdate</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.CircleGeometry</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">THREE.Geometry.call</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">||</span><span class="NUMB">50</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">c</span><span class="PUNC">?</span><span class="NAME">c</span><span class="PUNC">:</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">d</span><span class="PUNC">?</span><span class="NAME">d</span><span class="PUNC">:</span><span class="NUMB">2</span><span class="PUNC">*</span><span class="NAME">Math.PI</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">b</span><span class="PUNC">?</span><span class="NAME">Math.max</span><span class="PUNC">(</span><span class="NUMB">3</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NUMB">8</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">h</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector2</span><span class="PUNC">(</span><span class="NUMB">0.5</span><span class="PUNC">,</span><span class="NUMB">0.5</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.vertices.push</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">f.push</span><span class="PUNC">(</span><span class="NAME">h</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">&lt;=</span><span class="NAME">b</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">g</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">+</span><span class="NAME">e</span><span class="PUNC">/</span><span class="NAME">b</span><span class="PUNC">*</span><span class="NAME">d</span><span class="PUNC">;</span><span class="NAME">g.x</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">*</span><span class="NAME">Math.cos</span><span class="PUNC">(</span><span class="NAME">i</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">g.y</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">*</span><span class="NAME">Math.sin</span><span class="PUNC">(</span><span class="NAME">i</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.vertices.push</span><span class="PUNC">(</span><span class="NAME">g</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">f.push</span><span class="PUNC">(</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector2</span><span class="PUNC">(</span><span class="PUNC">(</span><span class="NAME">g.x</span><span class="PUNC">/</span><span class="NAME">a</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">/</span><span class="NUMB">2</span><span class="PUNC">,</span><span class="PUNC">(</span><span class="NAME">g.y</span><span class="PUNC">/</span><span class="NAME">a</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">/</span><span class="NUMB">2</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="NAME">c</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">&lt;=</span><span class="NAME">b</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">this.faces.push</span><span class="PUNC">(</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Face3</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this.faceVertexUvs</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">push</span><span class="PUNC">(</span><span class="PUNC">[</span><span class="NAME">f</span><span class="PUNC">[</span><span class="NAME">e</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>623</span> </span><span class="NAME">f</span><span class="PUNC">[</span><span class="NAME">e</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.computeCentroids</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.computeFaceNormals</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.boundingSphere</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Sphere</span><span class="PUNC">(</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.CircleGeometry.prototype</span><span class="PUNC">=</span><span class="NAME">Object.create</span><span class="PUNC">(</span><span class="NAME">THREE.Geometry.prototype</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">THREE.CubeGeometry</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">h</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">,</span><span class="NAME">q</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">r</span><span class="PUNC">,</span><span class="NAME">s</span><span class="PUNC">=</span><span class="NAME">g.widthSegments</span><span class="PUNC">,</span><span class="NAME">v</span><span class="PUNC">=</span><span class="NAME">g.heightSegments</span><span class="PUNC">,</span><span class="NAME">z</span><span class="PUNC">=</span><span class="NAME">e</span><span class="PUNC">/</span><span class="NUMB">2</span><span class="PUNC">,</span><span class="NAME">C</span><span class="PUNC">=</span><span class="NAME">f</span><span class="PUNC">/</span><span class="NUMB">2</span><span class="PUNC">,</span><span class="NAME">F</span><span class="PUNC">=</span><span class="NAME">g.vertices.length</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="STRN">"x"</span><span class="PUNC">===</span><span class="NAME">a</span><span class="PUNC">&&</span><span class="STRN">"y"</span><span class="PUNC">===</span><span class="NAME">b</span><span class="PUNC">||</span><span class="STRN">"y"</span><span class="PUNC">===</span><span class="NAME">a</span><span class="PUNC">&&</span><span class="STRN">"x"</span><span class="PUNC">===</span><span class="NAME">b</span><span class="PUNC">)</span><span class="NAME">r</span><span class="PUNC">=</span><span class="STRN">"z"</span><span class="PUNC">;</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="STRN">"x"</span><span class="PUNC">===</span><span class="NAME">a</span><span class="PUNC">&&</span><span class="STRN">"z"</span><span class="PUNC">===</span><span class="NAME">b</span><span class="PUNC">||</span><span class="STRN">"z"</span><span class="PUNC">===</span><span class="NAME">a</span><span class="PUNC">&&</span><span class="STRN">"x"</span><span class="PUNC">===</span><span class="NAME">b</span><span class="PUNC">)</span><span class="NAME">r</span><span class="PUNC">=</span><span class="STRN">"y"</span><span class="PUNC">,</span><span class="NAME">v</span><span class="PUNC">=</span><span class="NAME">g.depthSegments</span><span class="PUNC">;</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="STRN">"z"</span><span class="PUNC">===</span><span class="NAME">a</span><span class="PUNC">&&</span><span class="STRN">"y"</span><span class="PUNC">===</span><span class="NAME">b</span><span class="PUNC">||</span><span class="STRN">"y"</span><span class="PUNC">===</span><span class="NAME">a</span><span class="PUNC">&&</span><span class="STRN">"z"</span><span class="PUNC">===</span><span class="NAME">b</span><span class="PUNC">)</span><span class="NAME">r</span><span class="PUNC">=</span><span class="STRN">"x"</span><span class="PUNC">,</span><span class="NAME">s</span><span class="PUNC">=</span><span class="NAME">g.depthSegments</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">H</span><span class="PUNC">=</span><span class="NAME">s</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">I</span><span class="PUNC">=</span><span class="NAME">v</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">G</span><span class="PUNC">=</span><span class="NAME">e</span><span class="PUNC">/</span><span class="NAME">s</span><span class="PUNC">,</span><span class="NAME">A</span><span class="PUNC">=</span><span class="NAME">f</span><span class="PUNC">/</span><span class="NAME">v</span><span class="PUNC">,</span><span class="NAME">K</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">;</span><span class="NAME">K</span><span class="PUNC">[</span><span class="NAME">r</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">&lt;</span><span class="NAME">h</span><span class="PUNC">?</span><span class="NUMB">1</span><span class="PUNC">:</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">&lt;</span><span class="NAME">I</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">f</span><span class="PUNC">&lt;</span><span class="NAME">H</span><span class="PUNC">;</span><span class="NAME">f</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">B</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">;</span><span class="NAME">B</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">*</span><span class="NAME">G</span><span class="PUNC">-</span><span class="NAME">z</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">c</span><span class="PUNC">;</span><span class="NAME">B</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">*</span><span class="NAME">A</span><span class="PUNC">-</span><span class="NAME">C</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">d</span><span class="PUNC">;</span><span class="NAME">B</span><span class="PUNC">[</span><span class="NAME">r</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">h</span><span class="PUNC">;</span><span class="NAME">g.vertices.push</span><span class="PUNC">(</span><span class="NAME">B</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>624</span> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">&lt;</span><span class="NAME">v</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">f</span><span class="PUNC">&lt;</span><span class="NAME">s</span><span class="PUNC">;</span><span class="NAME">f</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">a</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Face4</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">+</span><span class="NAME">H</span><span class="PUNC">*</span><span class="NAME">e</span><span class="PUNC">+</span><span class="NAME">F</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">+</span><span class="NAME">H</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="NAME">F</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">+</span><span class="NAME">H</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="NAME">F</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">+</span><span class="NAME">H</span><span class="PUNC">*</span><span class="NAME">e</span><span class="PUNC">+</span><span class="NAME">F</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">a.normal.copy</span><span class="PUNC">(</span><span class="NAME">K</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">a.vertexNormals.push</span><span class="PUNC">(</span><span class="NAME">K.clone</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">K.clone</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">K.clone</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">K.clone</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">a.materialIndex</span><span class="PUNC">=</span><span class="NAME">q</span><span class="PUNC">,</span><span class="NAME">g.faces.push</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">g.faceVertexUvs</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">push</span><span class="PUNC">(</span><span class="PUNC">[</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector2</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">/</span><span class="NAME">s</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">-</span><span class="NAME">e</span><span class="PUNC">/</span><span class="NAME">v</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector2</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">/</span><span class="NAME">s</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">-</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">/</span><span class="NAME">v</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector2</span><span class="PUNC">(</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">/</span><span class="NAME">s</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">-</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">/</span><span class="NAME">v</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector2</span><span class="PUNC">(</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">/</span><span class="NAME">s</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">-</span><span class="NAME">e</span><span class="PUNC">/</span><span class="NAME">v</span><span class="PUNC">)</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="NAME">THREE.Geometry.call</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">g</span><span class="PUNC">=</span><span class="KEYW">this</span><span class="PUNC">;</span><span class="NAME">this.width</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">this.height</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">;</span><span class="NAME">this.depth</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">;</span><span class="NAME">this.widthSegments</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">||</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">this.heightSegments</span><span class="PUNC">=</span><span class="NAME">e</span><span class="PUNC">||</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">this.depthSegments</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>625</span> </span><span class="NAME">f</span><span class="PUNC">||</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">this.width</span><span class="PUNC">/</span><span class="NUMB">2</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.height</span><span class="PUNC">/</span><span class="NUMB">2</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.depth</span><span class="PUNC">/</span><span class="NUMB">2</span><span class="PUNC">;</span><span class="NAME">h</span><span class="PUNC">(</span><span class="STRN">"z"</span><span class="PUNC">,</span><span class="STRN">"y"</span><span class="PUNC">,</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">this.depth</span><span class="PUNC">,</span><span class="NAME">this.height</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">h</span><span class="PUNC">(</span><span class="STRN">"z"</span><span class="PUNC">,</span><span class="STRN">"y"</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">this.depth</span><span class="PUNC">,</span><span class="NAME">this.height</span><span class="PUNC">,</span><span class="PUNC">-</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">h</span><span class="PUNC">(</span><span class="STRN">"x"</span><span class="PUNC">,</span><span class="STRN">"z"</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">this.width</span><span class="PUNC">,</span><span class="NAME">this.depth</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NUMB">2</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">h</span><span class="PUNC">(</span><span class="STRN">"x"</span><span class="PUNC">,</span><span class="STRN">"z"</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">this.width</span><span class="PUNC">,</span><span class="NAME">this.depth</span><span class="PUNC">,</span><span class="PUNC">-</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NUMB">3</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">h</span><span class="PUNC">(</span><span class="STRN">"x"</span><span class="PUNC">,</span><span class="STRN">"y"</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">this.width</span><span class="PUNC">,</span><span class="NAME">this.height</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NUMB">4</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">h</span><span class="PUNC">(</span><span class="STRN">"x"</span><span class="PUNC">,</span><span class="STRN">"y"</span><span class="PUNC">,</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">this.width</span><span class="PUNC">,</span><span class="NAME">this.height</span><span class="PUNC">,</span><span class="PUNC">-</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NUMB">5</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.computeCentroids</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.mergeVertices</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.CubeGeometry.prototype</span><span class="PUNC">=</span><span class="NAME">Object.create</span><span class="PUNC">(</span><span class="NAME">THREE.Geometry.prototype</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">THREE.CylinderGeometry</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">THREE.Geometry.call</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.radiusTop</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">a</span><span class="PUNC">?</span><span class="NAME">a</span><span class="PUNC">:</span><span class="NUMB">20</span><span class="PUNC">;</span><span class="NAME">this.radiusBottom</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">b</span><span class="PUNC">?</span><span class="NAME">b</span><span class="PUNC">:</span><span class="NUMB">20</span><span class="PUNC">;</span><span class="NAME">this.height</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">c</span><span class="PUNC">?</span><span class="NAME">c</span><span class="PUNC">:</span><span class="NUMB">100</span><span class="PUNC">;</span><span class="NAME">this.radialSegments</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">||</span><span class="NUMB">8</span><span class="PUNC">;</span><span class="NAME">this.heightSegments</span><span class="PUNC">=</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">e</span><span class="PUNC">||</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">this.openEnded</span><span class="PUNC">=</span><span class="NAME">f</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">f</span><span class="PUNC">?</span><span class="NAME">f</span><span class="PUNC">:</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">/</span><span class="NUMB">2</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">,</span><span class="NAME">j</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">l</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">i</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">i</span><span class="PUNC">&lt;=</span><span class="NAME">e</span><span class="PUNC">;</span><span class="NAME">i</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">m</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">n</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">p</span><span class="PUNC">=</span><span class="NAME">i</span><span class="PUNC">/</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">t</span><span class="PUNC">=</span><span class="NAME">p</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">-</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="NAME">a</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">g</span><span class="PUNC">&lt;=</span><span class="NAME">d</span><span class="PUNC">;</span><span class="NAME">g</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">q</span><span class="PUNC">=</span><span class="NAME">g</span><span class="PUNC">/</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">r</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">;</span><span class="NAME">r.x</span><span class="PUNC">=</span><span class="NAME">t</span><span class="PUNC">*</span><span class="NAME">Math.sin</span><span class="PUNC">(</span><span class="NUMB">2</span><span class="PUNC">*</span><span class="NAME">q</span><span class="PUNC">*</span><span class="NAME">Math.PI</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">r.y</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="NAME">p</span><span class="PUNC">*</span><span class="NAME">c</span><span class="PUNC">+</span><span class="NAME">h</span><span class="PUNC">;</span><span class="NAME">r.z</span><span class="PUNC">=</span><span class="NAME">t</span><span class="PUNC">*</span><span class="NAME">Math.cos</span><span class="PUNC">(</span><span class="NUMB">2</span><span class="PUNC">*</span><span class="NAME">q</span><span class="PUNC">*</span><span class="NAME">Math.PI</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.vertices.push</span><span class="PUNC">(</span><span class="NAME">r</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">m.push</span><span class="PUNC">(</span><span class="NAME">this.vertices.length</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">n.push</span><span class="PUNC">(</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector2</span><span class="PUNC">(</span><span class="NAME">q</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>626</span> </span><span class="NUMB">1</span><span class="PUNC">-</span><span class="NAME">p</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="NAME">j.push</span><span class="PUNC">(</span><span class="NAME">m</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">l.push</span><span class="PUNC">(</span><span class="NAME">n</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="NAME">c</span><span class="PUNC">=</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">-</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">/</span><span class="NAME">c</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">g</span><span class="PUNC">&lt;</span><span class="NAME">d</span><span class="PUNC">;</span><span class="NAME">g</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">a</span><span class="PUNC">?</span><span class="PUNC">(</span><span class="NAME">m</span><span class="PUNC">=</span><span class="NAME">this.vertices</span><span class="PUNC">[</span><span class="NAME">j</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">[</span><span class="NAME">g</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">clone</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">n</span><span class="PUNC">=</span><span class="NAME">this.vertices</span><span class="PUNC">[</span><span class="NAME">j</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">[</span><span class="NAME">g</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">clone</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="PUNC">(</span><span class="NAME">m</span><span class="PUNC">=</span><span class="NAME">this.vertices</span><span class="PUNC">[</span><span class="NAME">j</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">[</span><span class="NAME">g</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">clone</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">n</span><span class="PUNC">=</span><span class="NAME">this.vertices</span><span class="PUNC">[</span><span class="NAME">j</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">[</span><span class="NAME">g</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">clone</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">m.setY</span><span class="PUNC">(</span><span class="NAME">Math.sqrt</span><span class="PUNC">(</span><span class="NAME">m.x</span><span class="PUNC">*</span><span class="NAME">m.x</span><span class="PUNC">+</span><span class="NAME">m.z</span><span class="PUNC">*</span><span class="NAME">m.z</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">normalize</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">n.setY</span><span class="PUNC">(</span><span class="NAME">Math.sqrt</span><span class="PUNC">(</span><span class="NAME">n.x</span><span class="PUNC">*</span><span class="NAME">n.x</span><span class="PUNC">+</span><span class="NAME">n.z</span><span class="PUNC">*</span><span class="NAME">n.z</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">normalize</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">i</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">i</span><span class="PUNC">&lt;</span><span class="NAME">e</span><span class="PUNC">;</span><span class="NAME">i</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">p</span><span class="PUNC">=</span><span class="NAME">j</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">[</span><span class="NAME">g</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">t</span><span class="PUNC">=</span><span class="NAME">j</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">[</span><span class="NAME">g</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">q</span><span class="PUNC">=</span><span class="NAME">j</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">[</span><span class="NAME">g</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">r</span><span class="PUNC">=</span><span class="NAME">j</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">[</span><span class="NAME">g</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">s</span><span class="PUNC">=</span><span class="NAME">m.clone</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">v</span><span class="PUNC">=</span><span class="NAME">m.clone</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">z</span><span class="PUNC">=</span><span class="NAME">n.clone</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">C</span><span class="PUNC">=</span><span class="NAME">n.clone</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">F</span><span class="PUNC">=</span><span class="NAME">l</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">[</span><span class="NAME">g</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">clone</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">H</span><span class="PUNC">=</span><span class="NAME">l</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">[</span><span class="NAME">g</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">clone</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">I</span><span class="PUNC">=</span><span class="NAME">l</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">[</span><span class="NAME">g</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">clone</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">G</span><span class="PUNC">=</span><span class="NAME">l</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">[</span><span class="NAME">g</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">clone</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.faces.push</span><span class="PUNC">(</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Face4</span><span class="PUNC">(</span><span class="NAME">p</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>627</span> </span><span class="NAME">t</span><span class="PUNC">,</span><span class="NAME">q</span><span class="PUNC">,</span><span class="NAME">r</span><span class="PUNC">,</span><span class="PUNC">[</span><span class="NAME">s</span><span class="PUNC">,</span><span class="NAME">v</span><span class="PUNC">,</span><span class="NAME">z</span><span class="PUNC">,</span><span class="NAME">C</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.faceVertexUvs</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">push</span><span class="PUNC">(</span><span class="PUNC">[</span><span class="NAME">F</span><span class="PUNC">,</span><span class="NAME">H</span><span class="PUNC">,</span><span class="NAME">I</span><span class="PUNC">,</span><span class="NAME">G</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">===</span><span class="NAME">f</span><span class="PUNC">&&</span><span class="NUMB">0</span><span class="PUNC">&lt;</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.vertices.push</span><span class="PUNC">(</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">g</span><span class="PUNC">&lt;</span><span class="NAME">d</span><span class="PUNC">;</span><span class="NAME">g</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">p</span><span class="PUNC">=</span><span class="NAME">j</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">[</span><span class="NAME">g</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">t</span><span class="PUNC">=</span><span class="NAME">j</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">[</span><span class="NAME">g</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">q</span><span class="PUNC">=</span><span class="NAME">this.vertices.length</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">s</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">v</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">z</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">F</span><span class="PUNC">=</span><span class="NAME">l</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">[</span><span class="NAME">g</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">clone</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">H</span><span class="PUNC">=</span><span class="NAME">l</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">[</span><span class="NAME">g</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">clone</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">I</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector2</span><span class="PUNC">(</span><span class="NAME">H.u</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this.faces.push</span><span class="PUNC">(</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Face3</span><span class="PUNC">(</span><span class="NAME">p</span><span class="PUNC">,</span><span class="NAME">t</span><span class="PUNC">,</span><span class="NAME">q</span><span class="PUNC">,</span><span class="PUNC">[</span><span class="NAME">s</span><span class="PUNC">,</span><span class="NAME">v</span><span class="PUNC">,</span><span class="NAME">z</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this.faceVertexUvs</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">push</span><span class="PUNC">(</span><span class="PUNC">[</span><span class="NAME">F</span><span class="PUNC">,</span><span class="NAME">H</span><span class="PUNC">,</span><span class="NAME">I</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">===</span><span class="NAME">f</span><span class="PUNC">&&</span><span class="NUMB">0</span><span class="PUNC">&lt;</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.vertices.push</span><span class="PUNC">(</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="PUNC">-</span><span class="NAME">h</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">g</span><span class="PUNC">&lt;</span><span class="NAME">d</span><span class="PUNC">;</span><span class="NAME">g</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">p</span><span class="PUNC">=</span><span class="NAME">j</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">[</span><span class="NAME">g</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>628</span> </span><span class="NAME">t</span><span class="PUNC">=</span><span class="NAME">j</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">[</span><span class="NAME">g</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">q</span><span class="PUNC">=</span><span class="NAME">this.vertices.length</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">s</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">v</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">z</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">F</span><span class="PUNC">=</span><span class="NAME">l</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">[</span><span class="NAME">g</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">clone</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">H</span><span class="PUNC">=</span><span class="NAME">l</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">[</span><span class="NAME">g</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">clone</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">I</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector2</span><span class="PUNC">(</span><span class="NAME">H.u</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this.faces.push</span><span class="PUNC">(</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Face3</span><span class="PUNC">(</span><span class="NAME">p</span><span class="PUNC">,</span><span class="NAME">t</span><span class="PUNC">,</span><span class="NAME">q</span><span class="PUNC">,</span><span class="PUNC">[</span><span class="NAME">s</span><span class="PUNC">,</span><span class="NAME">v</span><span class="PUNC">,</span><span class="NAME">z</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this.faceVertexUvs</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">push</span><span class="PUNC">(</span><span class="PUNC">[</span><span class="NAME">F</span><span class="PUNC">,</span><span class="NAME">H</span><span class="PUNC">,</span><span class="NAME">I</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="NAME">this.computeCentroids</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.computeFaceNormals</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.CylinderGeometry.prototype</span><span class="PUNC">=</span><span class="NAME">Object.create</span><span class="PUNC">(</span><span class="NAME">THREE.Geometry.prototype</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">THREE.ExtrudeGeometry</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="STRN">"undefined"</span><span class="PUNC">!==</span><span class="KEYW">typeof</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">THREE.Geometry.call</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">a</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">Array</span><span class="PUNC">?</span><span class="NAME">a</span><span class="PUNC">:</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">this.shapebb</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NAME">a.length</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">getBoundingBox</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this.addShapeList</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this.computeCentroids</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this.computeFaceNormals</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.ExtrudeGeometry.prototype</span><span class="PUNC">=</span><span class="NAME">Object.create</span><span class="PUNC">(</span><span class="NAME">THREE.Geometry.prototype</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">THREE.ExtrudeGeometry.prototype.addShapeList</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">a.length</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">&lt;</span><span class="NAME">c</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">this.addShape</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NAME">d</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>629</span> </span><span class="NAME">THREE.ExtrudeGeometry.prototype.addShape</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">b</span><span class="PUNC">||</span><span class="NAME">console.log</span><span class="PUNC">(</span><span class="STRN">"die"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">b.clone</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">multiplyScalar</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">add</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">THREE.ExtrudeGeometry.__v1</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">THREE.ExtrudeGeometry.__v2</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">THREE.ExtrudeGeometry.__v3</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">THREE.ExtrudeGeometry.__v4</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">THREE.ExtrudeGeometry.__v5</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">=</span><span class="NAME">THREE.ExtrudeGeometry.__v6</span><span class="PUNC">;</span><span class="NAME">d.set</span><span class="PUNC">(</span><span class="NAME">a.x</span><span class="PUNC">-</span><span class="NAME">b.x</span><span class="PUNC">,</span><span class="NAME">a.y</span><span class="PUNC">-</span><span class="NAME">b.y</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">e.set</span><span class="PUNC">(</span><span class="NAME">a.x</span><span class="PUNC">-</span><span class="NAME">c.x</span><span class="PUNC">,</span><span class="NAME">a.y</span><span class="PUNC">-</span><span class="NAME">c.y</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">d.normalize</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">e.normalize</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">f.set</span><span class="PUNC">(</span><span class="PUNC">-</span><span class="NAME">d.y</span><span class="PUNC">,</span><span class="NAME">d.x</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">g.set</span><span class="PUNC">(</span><span class="NAME">e.y</span><span class="PUNC">,</span><span class="PUNC">-</span><span class="NAME">e.x</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">h.copy</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">add</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">i.copy</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">add</span><span class="PUNC">(</span><span class="NAME">g</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">h.equals</span><span class="PUNC">(</span><span class="NAME">i</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">g.clone</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>630</span> </span><span class="NAME">h.copy</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">add</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">i.copy</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">add</span><span class="PUNC">(</span><span class="NAME">g</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">d.dot</span><span class="PUNC">(</span><span class="NAME">g</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">i.sub</span><span class="PUNC">(</span><span class="NAME">h</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">dot</span><span class="PUNC">(</span><span class="NAME">g</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NUMB">0</span><span class="PUNC">===</span><span class="NAME">f</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">console.log</span><span class="PUNC">(</span><span class="STRN">"Either infinite or no solutions!"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">===</span><span class="NAME">g</span><span class="PUNC">?</span><span class="NAME">console.log</span><span class="PUNC">(</span><span class="STRN">"Its finite solutions."</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">console.log</span><span class="PUNC">(</span><span class="STRN">"Too bad, no solutions."</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">g</span><span class="PUNC">/</span><span class="PUNC">=</span><span class="NAME">f</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">></span><span class="NAME">g</span><span class="PUNC">?</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">Math.atan2</span><span class="PUNC">(</span><span class="NAME">b.y</span><span class="PUNC">-</span><span class="NAME">a.y</span><span class="PUNC">,</span><span class="NAME">b.x</span><span class="PUNC">-</span><span class="NAME">a.x</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">Math.atan2</span><span class="PUNC">(</span><span class="NAME">c.y</span><span class="PUNC">-</span><span class="NAME">a.y</span><span class="PUNC">,</span><span class="NAME">c.x</span><span class="PUNC">-</span><span class="NAME">a.x</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">></span><span class="NAME">a</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NUMB">2</span><span class="PUNC">*</span><span class="NAME">Math.PI</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">+</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">/</span><span class="NUMB">2</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="NAME">Math.cos</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="NAME">Math.sin</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector2</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">d.multiplyScalar</span><span class="PUNC">(</span><span class="NAME">g</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">add</span><span class="PUNC">(</span><span class="NAME">h</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">sub</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">clone</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">e</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">O</span><span class="PUNC">=</span><span class="NAME">c.length</span><span class="PUNC">;</span><span class="NUMB">0</span><span class="PUNC">&lt;=</span><span class="PUNC">--</span><span class="NAME">O</span><span class="PUNC">;</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">O</span><span class="PUNC">;</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">O</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NUMB">0</span><span class="PUNC">></span><span class="NAME">f</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">c.length</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">g</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">p</span><span class="PUNC">+</span><span class="NUMB">2</span><span class="PUNC">*</span><span class="NAME">l</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>631</span> </span><span class="NAME">g</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">g</span><span class="PUNC">&lt;</span><span class="NAME">h</span><span class="PUNC">;</span><span class="NAME">g</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">=</span><span class="NAME">pa</span><span class="PUNC">*</span><span class="NAME">g</span><span class="PUNC">,</span><span class="NAME">j</span><span class="PUNC">=</span><span class="NAME">pa</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">g</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">m</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">+</span><span class="NAME">e</span><span class="PUNC">+</span><span class="NAME">i</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">+</span><span class="NAME">f</span><span class="PUNC">+</span><span class="NAME">i</span><span class="PUNC">,</span><span class="NAME">n</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">+</span><span class="NAME">f</span><span class="PUNC">+</span><span class="NAME">j</span><span class="PUNC">,</span><span class="NAME">j</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">+</span><span class="NAME">e</span><span class="PUNC">+</span><span class="NAME">j</span><span class="PUNC">,</span><span class="NAME">q</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">r</span><span class="PUNC">=</span><span class="NAME">g</span><span class="PUNC">,</span><span class="NAME">s</span><span class="PUNC">=</span><span class="NAME">h</span><span class="PUNC">,</span><span class="NAME">t</span><span class="PUNC">=</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">w</span><span class="PUNC">=</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">m</span><span class="PUNC">=</span><span class="NAME">m</span><span class="PUNC">+</span><span class="NAME">J</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">=</span><span class="NAME">i</span><span class="PUNC">+</span><span class="NAME">J</span><span class="PUNC">,</span><span class="NAME">n</span><span class="PUNC">=</span><span class="NAME">n</span><span class="PUNC">+</span><span class="NAME">J</span><span class="PUNC">,</span><span class="NAME">j</span><span class="PUNC">=</span><span class="NAME">j</span><span class="PUNC">+</span><span class="NAME">J</span><span class="PUNC">;</span><span class="NAME">B.faces.push</span><span class="PUNC">(</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Face4</span><span class="PUNC">(</span><span class="NAME">m</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">,</span><span class="NAME">n</span><span class="PUNC">,</span><span class="NAME">j</span><span class="PUNC">,</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">v</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">m</span><span class="PUNC">=</span><span class="NAME">z.generateSideWallUV</span><span class="PUNC">(</span><span class="NAME">B</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">q</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">m</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">,</span><span class="NAME">n</span><span class="PUNC">,</span><span class="NAME">j</span><span class="PUNC">,</span><span class="NAME">r</span><span class="PUNC">,</span><span class="NAME">s</span><span class="PUNC">,</span><span class="NAME">t</span><span class="PUNC">,</span><span class="NAME">w</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">B.faceVertexUvs</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">push</span><span class="PUNC">(</span><span class="NAME">m</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">f</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">B.vertices.push</span><span class="PUNC">(</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">h</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">c</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">J</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">J</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">J</span><span class="PUNC">;</span><span class="NAME">B.faces.push</span><span class="PUNC">(</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Face3</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">,</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">s</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">f</span><span class="PUNC">?</span><span class="NAME">z.generateBottomUV</span><span class="PUNC">(</span><span class="NAME">B</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">z.generateTopUV</span><span class="PUNC">(</span><span class="NAME">B</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">B.faceVertexUvs</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">push</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">g</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">b.amount</span><span class="PUNC">?</span><span class="NAME">b.amount</span><span class="PUNC">:</span><span class="WHIT">
<span class='line'>632</span> </span><span class="NUMB">100</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">b.bevelThickness</span><span class="PUNC">?</span><span class="NAME">b.bevelThickness</span><span class="PUNC">:</span><span class="NUMB">6</span><span class="PUNC">,</span><span class="NAME">j</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">b.bevelSize</span><span class="PUNC">?</span><span class="NAME">b.bevelSize</span><span class="PUNC">:</span><span class="NAME">i</span><span class="PUNC">-</span><span class="NUMB">2</span><span class="PUNC">,</span><span class="NAME">l</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">b.bevelSegments</span><span class="PUNC">?</span><span class="NAME">b.bevelSegments</span><span class="PUNC">:</span><span class="NUMB">3</span><span class="PUNC">,</span><span class="NAME">m</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">b.bevelEnabled</span><span class="PUNC">?</span><span class="NAME">b.bevelEnabled</span><span class="PUNC">:</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">n</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">b.curveSegments</span><span class="PUNC">?</span><span class="NAME">b.curveSegments</span><span class="PUNC">:</span><span class="NUMB">12</span><span class="PUNC">,</span><span class="NAME">p</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">b.steps</span><span class="PUNC">?</span><span class="NAME">b.steps</span><span class="PUNC">:</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">t</span><span class="PUNC">=</span><span class="NAME">b.extrudePath</span><span class="PUNC">,</span><span class="NAME">q</span><span class="PUNC">,</span><span class="NAME">r</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">s</span><span class="PUNC">=</span><span class="NAME">b.material</span><span class="PUNC">,</span><span class="NAME">v</span><span class="PUNC">=</span><span class="NAME">b.extrudeMaterial</span><span class="PUNC">,</span><span class="NAME">z</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">b.UVGenerator</span><span class="PUNC">?</span><span class="NAME">b.UVGenerator</span><span class="PUNC">:</span><span class="NAME">THREE.ExtrudeGeometry.WorldUVGenerator</span><span class="PUNC">,</span><span class="NAME">C</span><span class="PUNC">,</span><span class="NAME">F</span><span class="PUNC">,</span><span class="NAME">H</span><span class="PUNC">,</span><span class="NAME">I</span><span class="PUNC">;</span><span class="NAME">t</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">q</span><span class="PUNC">=</span><span class="NAME">t.getSpacedPoints</span><span class="PUNC">(</span><span class="NAME">p</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">r</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">m</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">C</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">b.frames</span><span class="PUNC">?</span><span class="NAME">b.frames</span><span class="PUNC">:</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.TubeGeometry.FrenetFrames</span><span class="PUNC">(</span><span class="NAME">t</span><span class="PUNC">,</span><span class="NAME">p</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>633</span> </span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">F</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">,</span><span class="NAME">H</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">,</span><span class="NAME">I</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">m</span><span class="PUNC">||</span><span class="PUNC">(</span><span class="NAME">j</span><span class="PUNC">=</span><span class="NAME">i</span><span class="PUNC">=</span><span class="NAME">l</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">G</span><span class="PUNC">,</span><span class="NAME">A</span><span class="PUNC">,</span><span class="NAME">K</span><span class="PUNC">,</span><span class="NAME">B</span><span class="PUNC">=</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">J</span><span class="PUNC">=</span><span class="NAME">this.vertices.length</span><span class="PUNC">,</span><span class="NAME">n</span><span class="PUNC">=</span><span class="NAME">a.extractPoints</span><span class="PUNC">(</span><span class="NAME">n</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">N</span><span class="PUNC">=</span><span class="NAME">n.shape</span><span class="PUNC">,</span><span class="NAME">n</span><span class="PUNC">=</span><span class="NAME">n.holes</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">t</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NAME">THREE.Shape.Utils.isClockWise</span><span class="PUNC">(</span><span class="NAME">N</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">N</span><span class="PUNC">=</span><span class="NAME">N.reverse</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">A</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">K</span><span class="PUNC">=</span><span class="NAME">n.length</span><span class="PUNC">;</span><span class="NAME">A</span><span class="PUNC">&lt;</span><span class="NAME">K</span><span class="PUNC">;</span><span class="NAME">A</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">G</span><span class="PUNC">=</span><span class="NAME">n</span><span class="PUNC">[</span><span class="NAME">A</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">THREE.Shape.Utils.isClockWise</span><span class="PUNC">(</span><span class="NAME">G</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">n</span><span class="PUNC">[</span><span class="NAME">A</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">G.reverse</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">t</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">}</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">y</span><span class="PUNC">=</span><span class="NAME">THREE.Shape.Utils.triangulateShape</span><span class="PUNC">(</span><span class="NAME">N</span><span class="PUNC">,</span><span class="NAME">n</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">t</span><span class="PUNC">=</span><span class="NAME">N</span><span class="PUNC">;</span><span class="NAME">A</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">K</span><span class="PUNC">=</span><span class="NAME">n.length</span><span class="PUNC">;</span><span class="NAME">A</span><span class="PUNC">&lt;</span><span class="NAME">K</span><span class="PUNC">;</span><span class="NAME">A</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">G</span><span class="PUNC">=</span><span class="NAME">n</span><span class="PUNC">[</span><span class="NAME">A</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">N</span><span class="PUNC">=</span><span class="NAME">N.concat</span><span class="PUNC">(</span><span class="NAME">G</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">M</span><span class="PUNC">,</span><span class="NAME">w</span><span class="PUNC">,</span><span class="NAME">Z</span><span class="PUNC">,</span><span class="NAME">L</span><span class="PUNC">,</span><span class="NAME">pa</span><span class="PUNC">=</span><span class="NAME">N.length</span><span class="PUNC">,</span><span class="NAME">Pa</span><span class="PUNC">=</span><span class="NAME">y.length</span><span class="PUNC">,</span><span class="NAME">Ua</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">O</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">ka</span><span class="PUNC">=</span><span class="NAME">t.length</span><span class="PUNC">;</span><span class="NAME">M</span><span class="PUNC">=</span><span class="NAME">ka</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">w</span><span class="PUNC">=</span><span class="NAME">O</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">O</span><span class="PUNC">&lt;</span><span class="NAME">ka</span><span class="PUNC">;</span><span class="NAME">O</span><span class="PUNC">++</span><span class="PUNC">,</span><span class="NAME">M</span><span class="PUNC">++</span><span class="PUNC">,</span><span class="NAME">w</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">M</span><span class="PUNC">===</span><span class="NAME">ka</span><span class="PUNC">&&</span><span class="WHIT">
<span class='line'>634</span> </span><span class="PUNC">(</span><span class="NAME">M</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">w</span><span class="PUNC">===</span><span class="NAME">ka</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">w</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">Ua</span><span class="PUNC">[</span><span class="NAME">O</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">(</span><span class="NAME">t</span><span class="PUNC">[</span><span class="NAME">O</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">t</span><span class="PUNC">[</span><span class="NAME">M</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">t</span><span class="PUNC">[</span><span class="NAME">w</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">Fa</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">wa</span><span class="PUNC">,</span><span class="NAME">D</span><span class="PUNC">=</span><span class="NAME">Ua.concat</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">A</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">K</span><span class="PUNC">=</span><span class="NAME">n.length</span><span class="PUNC">;</span><span class="NAME">A</span><span class="PUNC">&lt;</span><span class="NAME">K</span><span class="PUNC">;</span><span class="NAME">A</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">G</span><span class="PUNC">=</span><span class="NAME">n</span><span class="PUNC">[</span><span class="NAME">A</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">wa</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">O</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">ka</span><span class="PUNC">=</span><span class="NAME">G.length</span><span class="PUNC">;</span><span class="NAME">M</span><span class="PUNC">=</span><span class="NAME">ka</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">w</span><span class="PUNC">=</span><span class="NAME">O</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">O</span><span class="PUNC">&lt;</span><span class="NAME">ka</span><span class="PUNC">;</span><span class="NAME">O</span><span class="PUNC">++</span><span class="PUNC">,</span><span class="NAME">M</span><span class="PUNC">++</span><span class="PUNC">,</span><span class="NAME">w</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">M</span><span class="PUNC">===</span><span class="NAME">ka</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">M</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">w</span><span class="PUNC">===</span><span class="NAME">ka</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">w</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">wa</span><span class="PUNC">[</span><span class="NAME">O</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">(</span><span class="NAME">G</span><span class="PUNC">[</span><span class="NAME">O</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">G</span><span class="PUNC">[</span><span class="NAME">M</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">G</span><span class="PUNC">[</span><span class="NAME">w</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">Fa.push</span><span class="PUNC">(</span><span class="NAME">wa</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">D</span><span class="PUNC">=</span><span class="NAME">D.concat</span><span class="PUNC">(</span><span class="NAME">wa</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">M</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">M</span><span class="PUNC">&lt;</span><span class="NAME">l</span><span class="PUNC">;</span><span class="NAME">M</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">G</span><span class="PUNC">=</span><span class="NAME">M</span><span class="PUNC">/</span><span class="NAME">l</span><span class="PUNC">;</span><span class="NAME">Z</span><span class="PUNC">=</span><span class="NAME">i</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NUMB">1</span><span class="PUNC">-</span><span class="NAME">G</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">w</span><span class="PUNC">=</span><span class="NAME">j</span><span class="PUNC">*</span><span class="NAME">Math.sin</span><span class="PUNC">(</span><span class="NAME">G</span><span class="PUNC">*</span><span class="NAME">Math.PI</span><span class="PUNC">/</span><span class="NUMB">2</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">O</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">ka</span><span class="PUNC">=</span><span class="NAME">t.length</span><span class="PUNC">;</span><span class="NAME">O</span><span class="PUNC">&lt;</span><span class="NAME">ka</span><span class="PUNC">;</span><span class="NAME">O</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">L</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">(</span><span class="NAME">t</span><span class="PUNC">[</span><span class="NAME">O</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">Ua</span><span class="PUNC">[</span><span class="NAME">O</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">w</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">(</span><span class="NAME">L.x</span><span class="PUNC">,</span><span class="NAME">L.y</span><span class="PUNC">,</span><span class="PUNC">-</span><span class="NAME">Z</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">A</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">K</span><span class="PUNC">=</span><span class="NAME">n.length</span><span class="PUNC">;</span><span class="NAME">A</span><span class="PUNC">&lt;</span><span class="NAME">K</span><span class="PUNC">;</span><span class="NAME">A</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">G</span><span class="PUNC">=</span><span class="NAME">n</span><span class="PUNC">[</span><span class="NAME">A</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">wa</span><span class="PUNC">=</span><span class="NAME">Fa</span><span class="PUNC">[</span><span class="NAME">A</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">O</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">ka</span><span class="PUNC">=</span><span class="NAME">G.length</span><span class="PUNC">;</span><span class="NAME">O</span><span class="PUNC">&lt;</span><span class="NAME">ka</span><span class="PUNC">;</span><span class="NAME">O</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">L</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">(</span><span class="NAME">G</span><span class="PUNC">[</span><span class="NAME">O</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">wa</span><span class="PUNC">[</span><span class="NAME">O</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">w</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">(</span><span class="NAME">L.x</span><span class="PUNC">,</span><span class="NAME">L.y</span><span class="PUNC">,</span><span class="PUNC">-</span><span class="NAME">Z</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="NAME">w</span><span class="PUNC">=</span><span class="NAME">j</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">O</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">O</span><span class="PUNC">&lt;</span><span class="NAME">pa</span><span class="PUNC">;</span><span class="NAME">O</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">L</span><span class="PUNC">=</span><span class="NAME">m</span><span class="PUNC">?</span><span class="NAME">c</span><span class="PUNC">(</span><span class="NAME">N</span><span class="PUNC">[</span><span class="NAME">O</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">D</span><span class="PUNC">[</span><span class="NAME">O</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>635</span> </span><span class="NAME">w</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">N</span><span class="PUNC">[</span><span class="NAME">O</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">r</span><span class="PUNC">?</span><span class="PUNC">(</span><span class="NAME">H.copy</span><span class="PUNC">(</span><span class="NAME">C.normals</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">multiplyScalar</span><span class="PUNC">(</span><span class="NAME">L.x</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">F.copy</span><span class="PUNC">(</span><span class="NAME">C.binormals</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">multiplyScalar</span><span class="PUNC">(</span><span class="NAME">L.y</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">I.copy</span><span class="PUNC">(</span><span class="NAME">q</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">add</span><span class="PUNC">(</span><span class="NAME">H</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">add</span><span class="PUNC">(</span><span class="NAME">F</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">(</span><span class="NAME">I.x</span><span class="PUNC">,</span><span class="NAME">I.y</span><span class="PUNC">,</span><span class="NAME">I.z</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">f</span><span class="PUNC">(</span><span class="NAME">L.x</span><span class="PUNC">,</span><span class="NAME">L.y</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">G</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">G</span><span class="PUNC">&lt;=</span><span class="NAME">p</span><span class="PUNC">;</span><span class="NAME">G</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">O</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">O</span><span class="PUNC">&lt;</span><span class="NAME">pa</span><span class="PUNC">;</span><span class="NAME">O</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">L</span><span class="PUNC">=</span><span class="NAME">m</span><span class="PUNC">?</span><span class="NAME">c</span><span class="PUNC">(</span><span class="NAME">N</span><span class="PUNC">[</span><span class="NAME">O</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">D</span><span class="PUNC">[</span><span class="NAME">O</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">w</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">N</span><span class="PUNC">[</span><span class="NAME">O</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">r</span><span class="PUNC">?</span><span class="PUNC">(</span><span class="NAME">H.copy</span><span class="PUNC">(</span><span class="NAME">C.normals</span><span class="PUNC">[</span><span class="NAME">G</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">multiplyScalar</span><span class="PUNC">(</span><span class="NAME">L.x</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">F.copy</span><span class="PUNC">(</span><span class="NAME">C.binormals</span><span class="PUNC">[</span><span class="NAME">G</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">multiplyScalar</span><span class="PUNC">(</span><span class="NAME">L.y</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">I.copy</span><span class="PUNC">(</span><span class="NAME">q</span><span class="PUNC">[</span><span class="NAME">G</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">add</span><span class="PUNC">(</span><span class="NAME">H</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">add</span><span class="PUNC">(</span><span class="NAME">F</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">(</span><span class="NAME">I.x</span><span class="PUNC">,</span><span class="NAME">I.y</span><span class="PUNC">,</span><span class="NAME">I.z</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">f</span><span class="PUNC">(</span><span class="NAME">L.x</span><span class="PUNC">,</span><span class="NAME">L.y</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">/</span><span class="NAME">p</span><span class="PUNC">*</span><span class="NAME">G</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">M</span><span class="PUNC">=</span><span class="NAME">l</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NUMB">0</span><span class="PUNC">&lt;=</span><span class="NAME">M</span><span class="PUNC">;</span><span class="NAME">M</span><span class="PUNC">--</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">G</span><span class="PUNC">=</span><span class="NAME">M</span><span class="PUNC">/</span><span class="NAME">l</span><span class="PUNC">;</span><span class="NAME">Z</span><span class="PUNC">=</span><span class="NAME">i</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NUMB">1</span><span class="PUNC">-</span><span class="NAME">G</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">w</span><span class="PUNC">=</span><span class="NAME">j</span><span class="PUNC">*</span><span class="NAME">Math.sin</span><span class="PUNC">(</span><span class="NAME">G</span><span class="PUNC">*</span><span class="NAME">Math.PI</span><span class="PUNC">/</span><span class="NUMB">2</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">O</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">ka</span><span class="PUNC">=</span><span class="NAME">t.length</span><span class="PUNC">;</span><span class="NAME">O</span><span class="PUNC">&lt;</span><span class="NAME">ka</span><span class="PUNC">;</span><span class="NAME">O</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">L</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">(</span><span class="NAME">t</span><span class="PUNC">[</span><span class="NAME">O</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">Ua</span><span class="PUNC">[</span><span class="NAME">O</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">w</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">(</span><span class="NAME">L.x</span><span class="PUNC">,</span><span class="NAME">L.y</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">+</span><span class="NAME">Z</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">A</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">K</span><span class="PUNC">=</span><span class="NAME">n.length</span><span class="PUNC">;</span><span class="NAME">A</span><span class="PUNC">&lt;</span><span class="WHIT">
<span class='line'>636</span> </span><span class="NAME">K</span><span class="PUNC">;</span><span class="NAME">A</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">G</span><span class="PUNC">=</span><span class="NAME">n</span><span class="PUNC">[</span><span class="NAME">A</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">wa</span><span class="PUNC">=</span><span class="NAME">Fa</span><span class="PUNC">[</span><span class="NAME">A</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">O</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">ka</span><span class="PUNC">=</span><span class="NAME">G.length</span><span class="PUNC">;</span><span class="NAME">O</span><span class="PUNC">&lt;</span><span class="NAME">ka</span><span class="PUNC">;</span><span class="NAME">O</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">L</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">(</span><span class="NAME">G</span><span class="PUNC">[</span><span class="NAME">O</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">wa</span><span class="PUNC">[</span><span class="NAME">O</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">w</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">r</span><span class="PUNC">?</span><span class="NAME">f</span><span class="PUNC">(</span><span class="NAME">L.x</span><span class="PUNC">,</span><span class="NAME">L.y</span><span class="PUNC">+</span><span class="NAME">q</span><span class="PUNC">[</span><span class="NAME">p</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">y</span><span class="PUNC">,</span><span class="NAME">q</span><span class="PUNC">[</span><span class="NAME">p</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">x</span><span class="PUNC">+</span><span class="NAME">Z</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">f</span><span class="PUNC">(</span><span class="NAME">L.x</span><span class="PUNC">,</span><span class="NAME">L.y</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">+</span><span class="NAME">Z</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">m</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">i</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">*</span><span class="NAME">pa</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">O</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">O</span><span class="PUNC">&lt;</span><span class="NAME">Pa</span><span class="PUNC">;</span><span class="NAME">O</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">y</span><span class="PUNC">[</span><span class="NAME">O</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">(</span><span class="NAME">g</span><span class="PUNC">[</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">+</span><span class="NAME">i</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">+</span><span class="NAME">i</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">+</span><span class="NAME">i</span><span class="PUNC">,</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">i</span><span class="PUNC">=</span><span class="NAME">pa</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">p</span><span class="PUNC">+</span><span class="NUMB">2</span><span class="PUNC">*</span><span class="NAME">l</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">O</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">O</span><span class="PUNC">&lt;</span><span class="NAME">Pa</span><span class="PUNC">;</span><span class="NAME">O</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">y</span><span class="PUNC">[</span><span class="NAME">O</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">(</span><span class="NAME">g</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">+</span><span class="NAME">i</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">+</span><span class="NAME">i</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">[</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">+</span><span class="NAME">i</span><span class="PUNC">,</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="PUNC">{</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">O</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">O</span><span class="PUNC">&lt;</span><span class="NAME">Pa</span><span class="PUNC">;</span><span class="NAME">O</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">y</span><span class="PUNC">[</span><span class="NAME">O</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">(</span><span class="NAME">g</span><span class="PUNC">[</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">O</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">O</span><span class="PUNC">&lt;</span><span class="NAME">Pa</span><span class="PUNC">;</span><span class="NAME">O</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">y</span><span class="PUNC">[</span><span class="NAME">O</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">(</span><span class="NAME">g</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">+</span><span class="NAME">pa</span><span class="PUNC">*</span><span class="NAME">p</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">+</span><span class="NAME">pa</span><span class="PUNC">*</span><span class="NAME">p</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">[</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">+</span><span class="NAME">pa</span><span class="PUNC">*</span><span class="NAME">p</span><span class="PUNC">,</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">(</span><span class="NAME">t</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">g</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">t.length</span><span class="PUNC">;</span><span class="NAME">A</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">K</span><span class="PUNC">=</span><span class="NAME">n.length</span><span class="PUNC">;</span><span class="NAME">A</span><span class="PUNC">&lt;</span><span class="NAME">K</span><span class="PUNC">;</span><span class="NAME">A</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">G</span><span class="PUNC">=</span><span class="NAME">n</span><span class="PUNC">[</span><span class="NAME">A</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">(</span><span class="NAME">G</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">G.length</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>637</span> </span><span class="NAME">THREE.ExtrudeGeometry.WorldUVGenerator</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="NAME">generateTopUV</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">a.vertices</span><span class="PUNC">[</span><span class="NAME">e</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">x</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">a.vertices</span><span class="PUNC">[</span><span class="NAME">e</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">y</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">a.vertices</span><span class="PUNC">[</span><span class="NAME">f</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">x</span><span class="PUNC">;</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">a.vertices</span><span class="PUNC">[</span><span class="NAME">f</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">y</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="PUNC">[</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector2</span><span class="PUNC">(</span><span class="NAME">a.vertices</span><span class="PUNC">[</span><span class="NAME">d</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">x</span><span class="PUNC">,</span><span class="NAME">a.vertices</span><span class="PUNC">[</span><span class="NAME">d</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">y</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector2</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector2</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">]</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">generateBottomUV</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.generateTopUV</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">generateSideWallUV</span><span class="PUNC">:</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">a.vertices</span><span class="PUNC">[</span><span class="NAME">e</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">x</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">a.vertices</span><span class="PUNC">[</span><span class="NAME">e</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">y</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">a.vertices</span><span class="PUNC">[</span><span class="NAME">e</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">z</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">a.vertices</span><span class="PUNC">[</span><span class="NAME">f</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">x</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">=</span><span class="NAME">a.vertices</span><span class="PUNC">[</span><span class="NAME">f</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">y</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">a.vertices</span><span class="PUNC">[</span><span class="NAME">f</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">z</span><span class="PUNC">,</span><span class="NAME">j</span><span class="PUNC">=</span><span class="NAME">a.vertices</span><span class="PUNC">[</span><span class="NAME">h</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">x</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>638</span> </span><span class="NAME">l</span><span class="PUNC">=</span><span class="NAME">a.vertices</span><span class="PUNC">[</span><span class="NAME">h</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">y</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">a.vertices</span><span class="PUNC">[</span><span class="NAME">h</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">z</span><span class="PUNC">,</span><span class="NAME">m</span><span class="PUNC">=</span><span class="NAME">a.vertices</span><span class="PUNC">[</span><span class="NAME">g</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">x</span><span class="PUNC">,</span><span class="NAME">n</span><span class="PUNC">=</span><span class="NAME">a.vertices</span><span class="PUNC">[</span><span class="NAME">g</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">y</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">a.vertices</span><span class="PUNC">[</span><span class="NAME">g</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">z</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NUMB">0.01</span><span class="PUNC">></span><span class="NAME">Math.abs</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">-</span><span class="NAME">i</span><span class="PUNC">)</span><span class="PUNC">?</span><span class="PUNC">[</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector2</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">-</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector2</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">-</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector2</span><span class="PUNC">(</span><span class="NAME">j</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">-</span><span class="NAME">h</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector2</span><span class="PUNC">(</span><span class="NAME">m</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">-</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">]</span><span class="PUNC">:</span><span class="PUNC">[</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector2</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">-</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector2</span><span class="PUNC">(</span><span class="NAME">i</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">-</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector2</span><span class="PUNC">(</span><span class="NAME">l</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">-</span><span class="NAME">h</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector2</span><span class="PUNC">(</span><span class="NAME">n</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">-</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">]</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.ExtrudeGeometry.__v1</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector2</span><span class="PUNC">;</span><span class="NAME">THREE.ExtrudeGeometry.__v2</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector2</span><span class="PUNC">;</span><span class="NAME">THREE.ExtrudeGeometry.__v3</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector2</span><span class="PUNC">;</span><span class="NAME">THREE.ExtrudeGeometry.__v4</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector2</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>639</span> </span><span class="NAME">THREE.ExtrudeGeometry.__v5</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector2</span><span class="PUNC">;</span><span class="NAME">THREE.ExtrudeGeometry.__v6</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector2</span><span class="PUNC">;</span><span class="NAME">THREE.ShapeGeometry</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">THREE.Geometry.call</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">===</span><span class="NAME">a</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">Array</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.shapebb</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NAME">a.length</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">getBoundingBox</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.addShapeList</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.computeCentroids</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.computeFaceNormals</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.ShapeGeometry.prototype</span><span class="PUNC">=</span><span class="NAME">Object.create</span><span class="PUNC">(</span><span class="NAME">THREE.Geometry.prototype</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">THREE.ShapeGeometry.prototype.addShapeList</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">a.length</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">&lt;</span><span class="NAME">d</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">this.addShape</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>640</span> </span><span class="NAME">THREE.ShapeGeometry.prototype.addShape</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">===</span><span class="NAME">b</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">b.material</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">===</span><span class="NAME">b.UVGenerator</span><span class="PUNC">?</span><span class="NAME">THREE.ExtrudeGeometry.WorldUVGenerator</span><span class="PUNC">:</span><span class="NAME">b.UVGenerator</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">this.vertices.length</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">a.extractPoints</span><span class="PUNC">(</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">b.curveSegments</span><span class="PUNC">?</span><span class="NAME">b.curveSegments</span><span class="PUNC">:</span><span class="NUMB">12</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">=</span><span class="NAME">e.shape</span><span class="PUNC">,</span><span class="NAME">j</span><span class="PUNC">=</span><span class="NAME">e.holes</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">THREE.Shape.Utils.isClockWise</span><span class="PUNC">(</span><span class="NAME">i</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">i</span><span class="PUNC">=</span><span class="NAME">i.reverse</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">j.length</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">&lt;</span><span class="NAME">f</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">j</span><span class="PUNC">[</span><span class="NAME">e</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">THREE.Shape.Utils.isClockWise</span><span class="PUNC">(</span><span class="NAME">h</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">j</span><span class="PUNC">[</span><span class="NAME">e</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">h.reverse</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">l</span><span class="PUNC">=</span><span class="NAME">THREE.Shape.Utils.triangulateShape</span><span class="PUNC">(</span><span class="NAME">i</span><span class="PUNC">,</span><span class="NAME">j</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">j.length</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">&lt;</span><span class="NAME">f</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">j</span><span class="PUNC">[</span><span class="NAME">e</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>641</span> </span><span class="NAME">i</span><span class="PUNC">=</span><span class="NAME">i.concat</span><span class="PUNC">(</span><span class="NAME">h</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">j</span><span class="PUNC">=</span><span class="NAME">i.length</span><span class="PUNC">;</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">l.length</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">&lt;</span><span class="NAME">j</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">i</span><span class="PUNC">[</span><span class="NAME">e</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">this.vertices.push</span><span class="PUNC">(</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">(</span><span class="NAME">h.x</span><span class="PUNC">,</span><span class="NAME">h.y</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">&lt;</span><span class="NAME">f</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">j</span><span class="PUNC">=</span><span class="NAME">l</span><span class="PUNC">[</span><span class="NAME">e</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">=</span><span class="NAME">j</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">+</span><span class="NAME">g</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">j</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">+</span><span class="NAME">g</span><span class="PUNC">,</span><span class="NAME">j</span><span class="PUNC">=</span><span class="NAME">j</span><span class="PUNC">[</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">+</span><span class="NAME">g</span><span class="PUNC">,</span><span class="NAME">this.faces.push</span><span class="PUNC">(</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Face3</span><span class="PUNC">(</span><span class="NAME">i</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">,</span><span class="NAME">j</span><span class="PUNC">,</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this.faceVertexUvs</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">push</span><span class="PUNC">(</span><span class="NAME">d.generateBottomUV</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">,</span><span class="NAME">j</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.LatheGeometry</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">THREE.Geometry.call</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">||</span><span class="NUMB">12</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">||</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">||</span><span class="NUMB">2</span><span class="PUNC">*</span><span class="NAME">Math.PI</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">/</span><span class="PUNC">(</span><span class="NAME">a.length</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">/</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">;</span><span class="NAME">h</span><span class="PUNC">&lt;=</span><span class="NAME">g</span><span class="PUNC">;</span><span class="NAME">h</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">+</span><span class="NAME">h</span><span class="PUNC">*</span><span class="NAME">f</span><span class="PUNC">*</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">j</span><span class="PUNC">=</span><span class="NAME">Math.cos</span><span class="PUNC">(</span><span class="NAME">i</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">l</span><span class="PUNC">=</span><span class="NAME">Math.sin</span><span class="PUNC">(</span><span class="NAME">i</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">m</span><span class="PUNC">=</span><span class="NAME">a.length</span><span class="PUNC">;</span><span class="NAME">i</span><span class="PUNC">&lt;</span><span class="NAME">m</span><span class="PUNC">;</span><span class="NAME">i</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">n</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">p</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">;</span><span class="NAME">p.x</span><span class="PUNC">=</span><span class="NAME">j</span><span class="PUNC">*</span><span class="NAME">n.x</span><span class="PUNC">-</span><span class="NAME">l</span><span class="PUNC">*</span><span class="NAME">n.y</span><span class="PUNC">;</span><span class="NAME">p.y</span><span class="PUNC">=</span><span class="NAME">l</span><span class="PUNC">*</span><span class="NAME">n.x</span><span class="PUNC">+</span><span class="NAME">j</span><span class="PUNC">*</span><span class="NAME">n.y</span><span class="PUNC">;</span><span class="NAME">p.z</span><span class="PUNC">=</span><span class="NAME">n.z</span><span class="PUNC">;</span><span class="NAME">this.vertices.push</span><span class="PUNC">(</span><span class="NAME">p</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">a.length</span><span class="PUNC">;</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">;</span><span class="NAME">h</span><span class="PUNC">&lt;</span><span class="NAME">g</span><span class="PUNC">;</span><span class="NAME">h</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">i</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">m</span><span class="PUNC">=</span><span class="NAME">a.length</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">i</span><span class="PUNC">&lt;</span><span class="NAME">m</span><span class="PUNC">;</span><span class="NAME">i</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">i</span><span class="PUNC">+</span><span class="NAME">c</span><span class="PUNC">*</span><span class="NAME">h</span><span class="PUNC">,</span><span class="NAME">l</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">+</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">j</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">+</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">this.faces.push</span><span class="PUNC">(</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Face4</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">l</span><span class="PUNC">,</span><span class="NAME">j</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">j</span><span class="PUNC">=</span><span class="NAME">h</span><span class="PUNC">*</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">i</span><span class="PUNC">*</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">j</span><span class="PUNC">+</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">l</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">+</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">this.faceVertexUvs</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">push</span><span class="PUNC">(</span><span class="PUNC">[</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector2</span><span class="PUNC">(</span><span class="NAME">j</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>642</span> </span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector2</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector2</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">l</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector2</span><span class="PUNC">(</span><span class="NAME">j</span><span class="PUNC">,</span><span class="NAME">l</span><span class="PUNC">)</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="NAME">this.mergeVertices</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.computeCentroids</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.computeFaceNormals</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.computeVertexNormals</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.LatheGeometry.prototype</span><span class="PUNC">=</span><span class="NAME">Object.create</span><span class="PUNC">(</span><span class="NAME">THREE.Geometry.prototype</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">THREE.PlaneGeometry</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">THREE.Geometry.call</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.width</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">this.height</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">;</span><span class="NAME">this.widthSegments</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">||</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">this.heightSegments</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">||</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">/</span><span class="NUMB">2</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">/</span><span class="NUMB">2</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">this.widthSegments</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">this.heightSegments</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">f</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">=</span><span class="NAME">this.width</span><span class="PUNC">/</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">j</span><span class="PUNC">=</span><span class="NAME">this.height</span><span class="PUNC">/</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">l</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">&lt;</span><span class="NAME">g</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">&lt;</span><span class="NAME">h</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">this.vertices.push</span><span class="PUNC">(</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">*</span><span class="NAME">i</span><span class="PUNC">-</span><span class="NAME">c</span><span class="PUNC">,</span><span class="PUNC">-</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">*</span><span class="NAME">j</span><span class="PUNC">-</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">&lt;</span><span class="NAME">f</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">&lt;</span><span class="NAME">d</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">c</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Face4</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">+</span><span class="NAME">h</span><span class="PUNC">*</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">+</span><span class="NAME">h</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">+</span><span class="NAME">h</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">+</span><span class="NAME">h</span><span class="PUNC">*</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">c.normal.copy</span><span class="PUNC">(</span><span class="NAME">l</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">c.vertexNormals.push</span><span class="PUNC">(</span><span class="NAME">l.clone</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">l.clone</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>643</span> </span><span class="NAME">l.clone</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">l.clone</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this.faces.push</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this.faceVertexUvs</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">push</span><span class="PUNC">(</span><span class="PUNC">[</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector2</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">/</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">-</span><span class="NAME">a</span><span class="PUNC">/</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector2</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">/</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">-</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">/</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector2</span><span class="PUNC">(</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">/</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">-</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">/</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector2</span><span class="PUNC">(</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">/</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">-</span><span class="NAME">a</span><span class="PUNC">/</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.computeCentroids</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.PlaneGeometry.prototype</span><span class="PUNC">=</span><span class="NAME">Object.create</span><span class="PUNC">(</span><span class="NAME">THREE.Geometry.prototype</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">THREE.RingGeometry</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">THREE.Geometry.call</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">||</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">||</span><span class="NUMB">50</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">e</span><span class="PUNC">?</span><span class="NAME">e</span><span class="PUNC">:</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">f</span><span class="PUNC">?</span><span class="NAME">f</span><span class="PUNC">:</span><span class="NUMB">2</span><span class="PUNC">*</span><span class="NAME">Math.PI</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">c</span><span class="PUNC">?</span><span class="NAME">Math.max</span><span class="PUNC">(</span><span class="NUMB">3</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NUMB">8</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">d</span><span class="PUNC">?</span><span class="NAME">Math.max</span><span class="PUNC">(</span><span class="NUMB">3</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NUMB">8</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">=</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">-</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">/</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">&lt;=</span><span class="NAME">d</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">&lt;=</span><span class="NAME">c</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">j</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">,</span><span class="NAME">l</span><span class="PUNC">=</span><span class="NAME">e</span><span class="PUNC">+</span><span class="NAME">b</span><span class="PUNC">/</span><span class="NAME">c</span><span class="PUNC">*</span><span class="NAME">f</span><span class="PUNC">;</span><span class="NAME">j.x</span><span class="PUNC">=</span><span class="NAME">g</span><span class="PUNC">*</span><span class="NAME">Math.cos</span><span class="PUNC">(</span><span class="NAME">l</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">j.y</span><span class="PUNC">=</span><span class="NAME">g</span><span class="PUNC">*</span><span class="NAME">Math.sin</span><span class="PUNC">(</span><span class="NAME">l</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.vertices.push</span><span class="PUNC">(</span><span class="NAME">j</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">h.push</span><span class="PUNC">(</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector2</span><span class="PUNC">(</span><span class="PUNC">(</span><span class="NAME">j.x</span><span class="PUNC">/</span><span class="NAME">g</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">/</span><span class="NUMB">2</span><span class="PUNC">,</span><span class="PUNC">-</span><span class="PUNC">(</span><span class="NAME">j.y</span><span class="PUNC">/</span><span class="NAME">g</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">/</span><span class="NUMB">2</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="NAME">g</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">i</span><span class="PUNC">}</span><span class="NAME">e</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">&lt;</span><span class="NAME">d</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">*</span><span class="NAME">c</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">&lt;=</span><span class="NAME">c</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">l</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">+</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">=</span><span class="NAME">l</span><span class="PUNC">+</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">j</span><span class="PUNC">=</span><span class="NAME">l</span><span class="PUNC">+</span><span class="NAME">c</span><span class="PUNC">+</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">m</span><span class="PUNC">=</span><span class="NAME">l</span><span class="PUNC">+</span><span class="NAME">c</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">+</span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">this.faces.push</span><span class="PUNC">(</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Face3</span><span class="PUNC">(</span><span class="NAME">i</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>644</span> </span><span class="NAME">j</span><span class="PUNC">,</span><span class="NAME">m</span><span class="PUNC">,</span><span class="PUNC">[</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.faceVertexUvs</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">push</span><span class="PUNC">(</span><span class="PUNC">[</span><span class="NAME">h</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">[</span><span class="NAME">j</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">[</span><span class="NAME">m</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">i</span><span class="PUNC">=</span><span class="NAME">l</span><span class="PUNC">+</span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">j</span><span class="PUNC">=</span><span class="NAME">l</span><span class="PUNC">+</span><span class="NAME">c</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">+</span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">m</span><span class="PUNC">=</span><span class="NAME">l</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">+</span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">this.faces.push</span><span class="PUNC">(</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Face3</span><span class="PUNC">(</span><span class="NAME">i</span><span class="PUNC">,</span><span class="NAME">j</span><span class="PUNC">,</span><span class="NAME">m</span><span class="PUNC">,</span><span class="PUNC">[</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.faceVertexUvs</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">push</span><span class="PUNC">(</span><span class="PUNC">[</span><span class="NAME">h</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">[</span><span class="NAME">j</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">[</span><span class="NAME">m</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="NAME">this.computeCentroids</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.computeFaceNormals</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.boundingSphere</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Sphere</span><span class="PUNC">(</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.RingGeometry.prototype</span><span class="PUNC">=</span><span class="NAME">Object.create</span><span class="PUNC">(</span><span class="NAME">THREE.Geometry.prototype</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">THREE.SphereGeometry</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">THREE.Geometry.call</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.radius</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">||</span><span class="NUMB">50</span><span class="PUNC">;</span><span class="NAME">this.widthSegments</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">Math.max</span><span class="PUNC">(</span><span class="NUMB">3</span><span class="PUNC">,</span><span class="NAME">Math.floor</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">||</span><span class="NUMB">8</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.heightSegments</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">Math.max</span><span class="PUNC">(</span><span class="NUMB">2</span><span class="PUNC">,</span><span class="NAME">Math.floor</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">||</span><span class="NUMB">6</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.phiStart</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">d</span><span class="PUNC">?</span><span class="NAME">d</span><span class="PUNC">:</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">this.phiLength</span><span class="PUNC">=</span><span class="NAME">e</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">e</span><span class="PUNC">?</span><span class="NAME">e</span><span class="PUNC">:</span><span class="NUMB">2</span><span class="PUNC">*</span><span class="NAME">Math.PI</span><span class="PUNC">;</span><span class="NAME">this.thetaStart</span><span class="PUNC">=</span><span class="NAME">f</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">f</span><span class="PUNC">?</span><span class="NAME">f</span><span class="PUNC">:</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">this.thetaLength</span><span class="PUNC">=</span><span class="NAME">h</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">h</span><span class="PUNC">?</span><span class="NAME">h</span><span class="PUNC">:</span><span class="NAME">Math.PI</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">g</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">,</span><span class="NAME">j</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">l</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">i</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">i</span><span class="PUNC">&lt;=</span><span class="NAME">c</span><span class="PUNC">;</span><span class="NAME">i</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">m</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">n</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">g</span><span class="PUNC">&lt;=</span><span class="NAME">b</span><span class="PUNC">;</span><span class="NAME">g</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">p</span><span class="PUNC">=</span><span class="NAME">g</span><span class="PUNC">/</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">t</span><span class="PUNC">=</span><span class="NAME">i</span><span class="PUNC">/</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">q</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">;</span><span class="NAME">q.x</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="NAME">a</span><span class="PUNC">*</span><span class="NAME">Math.cos</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">+</span><span class="NAME">p</span><span class="PUNC">*</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">Math.sin</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">+</span><span class="NAME">t</span><span class="PUNC">*</span><span class="NAME">h</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">q.y</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">*</span><span class="NAME">Math.cos</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">+</span><span class="NAME">t</span><span class="PUNC">*</span><span class="NAME">h</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>645</span> </span><span class="NAME">q.z</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">*</span><span class="NAME">Math.sin</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">+</span><span class="NAME">p</span><span class="PUNC">*</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">Math.sin</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">+</span><span class="NAME">t</span><span class="PUNC">*</span><span class="NAME">h</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.vertices.push</span><span class="PUNC">(</span><span class="NAME">q</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">m.push</span><span class="PUNC">(</span><span class="NAME">this.vertices.length</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">n.push</span><span class="PUNC">(</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector2</span><span class="PUNC">(</span><span class="NAME">p</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">-</span><span class="NAME">t</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="NAME">j.push</span><span class="PUNC">(</span><span class="NAME">m</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">l.push</span><span class="PUNC">(</span><span class="NAME">n</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">i</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">i</span><span class="PUNC">&lt;</span><span class="NAME">this.heightSegments</span><span class="PUNC">;</span><span class="NAME">i</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">g</span><span class="PUNC">&lt;</span><span class="NAME">this.widthSegments</span><span class="PUNC">;</span><span class="NAME">g</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">j</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">[</span><span class="NAME">g</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">j</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">[</span><span class="NAME">g</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">j</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">[</span><span class="NAME">g</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">j</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">[</span><span class="NAME">g</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">this.vertices</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">clone</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">normalize</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">this.vertices</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">clone</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">normalize</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">m</span><span class="PUNC">=</span><span class="NAME">this.vertices</span><span class="PUNC">[</span><span class="NAME">d</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">clone</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">normalize</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">n</span><span class="PUNC">=</span><span class="NAME">this.vertices</span><span class="PUNC">[</span><span class="NAME">e</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">clone</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">normalize</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">p</span><span class="PUNC">=</span><span class="NAME">l</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">[</span><span class="NAME">g</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">clone</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">t</span><span class="PUNC">=</span><span class="NAME">l</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">[</span><span class="NAME">g</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">clone</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">q</span><span class="PUNC">=</span><span class="NAME">l</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">[</span><span class="NAME">g</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">clone</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">r</span><span class="PUNC">=</span><span class="NAME">l</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">[</span><span class="NAME">g</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">clone</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">Math.abs</span><span class="PUNC">(</span><span class="NAME">this.vertices</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">y</span><span class="PUNC">)</span><span class="PUNC">===</span><span class="WHIT">
<span class='line'>646</span> </span><span class="NAME">this.radius</span><span class="PUNC">?</span><span class="PUNC">(</span><span class="NAME">this.faces.push</span><span class="PUNC">(</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Face3</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">,</span><span class="PUNC">[</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">m</span><span class="PUNC">,</span><span class="NAME">n</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this.faceVertexUvs</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">push</span><span class="PUNC">(</span><span class="PUNC">[</span><span class="NAME">p</span><span class="PUNC">,</span><span class="NAME">q</span><span class="PUNC">,</span><span class="NAME">r</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">Math.abs</span><span class="PUNC">(</span><span class="NAME">this.vertices</span><span class="PUNC">[</span><span class="NAME">d</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">y</span><span class="PUNC">)</span><span class="PUNC">===</span><span class="NAME">this.radius</span><span class="PUNC">?</span><span class="PUNC">(</span><span class="NAME">this.faces.push</span><span class="PUNC">(</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Face3</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">,</span><span class="PUNC">[</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">,</span><span class="NAME">m</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this.faceVertexUvs</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">push</span><span class="PUNC">(</span><span class="PUNC">[</span><span class="NAME">p</span><span class="PUNC">,</span><span class="NAME">t</span><span class="PUNC">,</span><span class="NAME">q</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="PUNC">(</span><span class="NAME">this.faces.push</span><span class="PUNC">(</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Face4</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">,</span><span class="PUNC">[</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">,</span><span class="NAME">m</span><span class="PUNC">,</span><span class="NAME">n</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this.faceVertexUvs</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">push</span><span class="PUNC">(</span><span class="PUNC">[</span><span class="NAME">p</span><span class="PUNC">,</span><span class="NAME">t</span><span class="PUNC">,</span><span class="NAME">q</span><span class="PUNC">,</span><span class="NAME">r</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="NAME">this.computeCentroids</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.computeFaceNormals</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.boundingSphere</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Sphere</span><span class="PUNC">(</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.SphereGeometry.prototype</span><span class="PUNC">=</span><span class="NAME">Object.create</span><span class="PUNC">(</span><span class="NAME">THREE.Geometry.prototype</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">THREE.TextGeometry</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">||</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">THREE.FontUtils.generateShapes</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b.amount</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">b.height</span><span class="PUNC">?</span><span class="NAME">b.height</span><span class="PUNC">:</span><span class="NUMB">50</span><span class="PUNC">;</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">===</span><span class="NAME">b.bevelThickness</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">b.bevelThickness</span><span class="PUNC">=</span><span class="NUMB">10</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">===</span><span class="NAME">b.bevelSize</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">b.bevelSize</span><span class="PUNC">=</span><span class="NUMB">8</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">===</span><span class="NAME">b.bevelEnabled</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">b.bevelEnabled</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">THREE.ExtrudeGeometry.call</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.TextGeometry.prototype</span><span class="PUNC">=</span><span class="NAME">Object.create</span><span class="PUNC">(</span><span class="NAME">THREE.ExtrudeGeometry.prototype</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">THREE.TorusGeometry</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">THREE.Geometry.call</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.radius</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">||</span><span class="NUMB">100</span><span class="PUNC">;</span><span class="NAME">this.tube</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">||</span><span class="NUMB">40</span><span class="PUNC">;</span><span class="NAME">this.radialSegments</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">||</span><span class="NUMB">8</span><span class="PUNC">;</span><span class="NAME">this.tubularSegments</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">||</span><span class="NUMB">6</span><span class="PUNC">;</span><span class="NAME">this.arc</span><span class="PUNC">=</span><span class="NAME">e</span><span class="PUNC">||</span><span class="NUMB">2</span><span class="PUNC">*</span><span class="NAME">Math.PI</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">&lt;=</span><span class="NAME">this.radialSegments</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">&lt;=</span><span class="NAME">this.tubularSegments</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">/</span><span class="NAME">this.tubularSegments</span><span class="PUNC">*</span><span class="NAME">this.arc</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NUMB">2</span><span class="PUNC">*</span><span class="NAME">c</span><span class="PUNC">/</span><span class="NAME">this.radialSegments</span><span class="PUNC">*</span><span class="NAME">Math.PI</span><span class="PUNC">;</span><span class="NAME">e.x</span><span class="PUNC">=</span><span class="NAME">this.radius</span><span class="PUNC">*</span><span class="NAME">Math.cos</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">e.y</span><span class="PUNC">=</span><span class="NAME">this.radius</span><span class="PUNC">*</span><span class="NAME">Math.sin</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">g</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">;</span><span class="NAME">g.x</span><span class="PUNC">=</span><span class="PUNC">(</span><span class="NAME">this.radius</span><span class="PUNC">+</span><span class="NAME">this.tube</span><span class="PUNC">*</span><span class="NAME">Math.cos</span><span class="PUNC">(</span><span class="NAME">h</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">Math.cos</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">g.y</span><span class="PUNC">=</span><span class="PUNC">(</span><span class="NAME">this.radius</span><span class="PUNC">+</span><span class="NAME">this.tube</span><span class="PUNC">*</span><span class="WHIT">
<span class='line'>647</span> </span><span class="NAME">Math.cos</span><span class="PUNC">(</span><span class="NAME">h</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">Math.sin</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">g.z</span><span class="PUNC">=</span><span class="NAME">this.tube</span><span class="PUNC">*</span><span class="NAME">Math.sin</span><span class="PUNC">(</span><span class="NAME">h</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.vertices.push</span><span class="PUNC">(</span><span class="NAME">g</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a.push</span><span class="PUNC">(</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector2</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">/</span><span class="NAME">this.tubularSegments</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">/</span><span class="NAME">this.radialSegments</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b.push</span><span class="PUNC">(</span><span class="NAME">g.clone</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">sub</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">normalize</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">&lt;=</span><span class="NAME">this.radialSegments</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">&lt;=</span><span class="NAME">this.tubularSegments</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">e</span><span class="PUNC">=</span><span class="PUNC">(</span><span class="NAME">this.tubularSegments</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">c</span><span class="PUNC">+</span><span class="NAME">d</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">=</span><span class="PUNC">(</span><span class="NAME">this.tubularSegments</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="NAME">d</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">=</span><span class="PUNC">(</span><span class="NAME">this.tubularSegments</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">=</span><span class="PUNC">(</span><span class="NAME">this.tubularSegments</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">c</span><span class="PUNC">+</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Face4</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">,</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NAME">e</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NAME">f</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NAME">h</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NAME">g</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">i.normal.add</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NAME">e</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">i.normal.add</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NAME">f</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">i.normal.add</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NAME">h</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">i.normal.add</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NAME">g</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>648</span> </span><span class="NAME">i.normal.normalize</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.faces.push</span><span class="PUNC">(</span><span class="NAME">i</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.faceVertexUvs</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">push</span><span class="PUNC">(</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NAME">e</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">clone</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NAME">f</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">clone</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NAME">h</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">clone</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NAME">g</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">clone</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="NAME">this.computeCentroids</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.TorusGeometry.prototype</span><span class="PUNC">=</span><span class="NAME">Object.create</span><span class="PUNC">(</span><span class="NAME">THREE.Geometry.prototype</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">THREE.TorusKnotGeometry</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">g</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">Math.cos</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">Math.sin</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">/</span><span class="NAME">c</span><span class="PUNC">*</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">Math.cos</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NUMB">0.5</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NUMB">2</span><span class="PUNC">+</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NUMB">0.5</span><span class="PUNC">*</span><span class="NAME">d</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NUMB">2</span><span class="PUNC">+</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">g</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NUMB">0.5</span><span class="PUNC">*</span><span class="NAME">e</span><span class="PUNC">*</span><span class="NAME">d</span><span class="PUNC">*</span><span class="NAME">Math.sin</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="NAME">THREE.Geometry.call</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.radius</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">||</span><span class="NUMB">100</span><span class="PUNC">;</span><span class="NAME">this.tube</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">||</span><span class="NUMB">40</span><span class="PUNC">;</span><span class="NAME">this.radialSegments</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">||</span><span class="NUMB">64</span><span class="PUNC">;</span><span class="NAME">this.tubularSegments</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">||</span><span class="NUMB">8</span><span class="PUNC">;</span><span class="NAME">this.p</span><span class="PUNC">=</span><span class="NAME">e</span><span class="PUNC">||</span><span class="NUMB">2</span><span class="PUNC">;</span><span class="NAME">this.q</span><span class="PUNC">=</span><span class="NAME">f</span><span class="PUNC">||</span><span class="NUMB">3</span><span class="PUNC">;</span><span class="NAME">this.heightScale</span><span class="PUNC">=</span><span class="NAME">h</span><span class="PUNC">||</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">this.grid</span><span class="PUNC">=</span><span class="NAME">Array</span><span class="PUNC">(</span><span class="NAME">this.radialSegments</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">&lt;</span><span class="NAME">this.radialSegments</span><span class="PUNC">;</span><span class="PUNC">++</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.grid</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>649</span> </span><span class="NAME">Array</span><span class="PUNC">(</span><span class="NAME">this.tubularSegments</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NUMB">2</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">/</span><span class="NAME">this.radialSegments</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">this.p</span><span class="PUNC">*</span><span class="NAME">Math.PI</span><span class="PUNC">;</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">g</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">this.q</span><span class="PUNC">,</span><span class="NAME">this.p</span><span class="PUNC">,</span><span class="NAME">this.radius</span><span class="PUNC">,</span><span class="NAME">this.heightScale</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">g</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">+</span><span class="NUMB">0.01</span><span class="PUNC">,</span><span class="NAME">this.q</span><span class="PUNC">,</span><span class="NAME">this.p</span><span class="PUNC">,</span><span class="NAME">this.radius</span><span class="PUNC">,</span><span class="NAME">this.heightScale</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">c.subVectors</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">d.addVectors</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">e.crossVectors</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">d.crossVectors</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">e.normalize</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">d.normalize</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">&lt;</span><span class="NAME">this.tubularSegments</span><span class="PUNC">;</span><span class="PUNC">++</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">=</span><span class="NUMB">2</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">/</span><span class="NAME">this.tubularSegments</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">Math.PI</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="NAME">this.tube</span><span class="PUNC">*</span><span class="NAME">Math.cos</span><span class="PUNC">(</span><span class="NAME">i</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">=</span><span class="NAME">this.tube</span><span class="PUNC">*</span><span class="NAME">Math.sin</span><span class="PUNC">(</span><span class="NAME">i</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">j</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">;</span><span class="NAME">j.x</span><span class="PUNC">=</span><span class="NAME">f.x</span><span class="PUNC">+</span><span class="NAME">h</span><span class="PUNC">*</span><span class="NAME">d.x</span><span class="PUNC">+</span><span class="NAME">i</span><span class="PUNC">*</span><span class="NAME">e.x</span><span class="PUNC">;</span><span class="NAME">j.y</span><span class="PUNC">=</span><span class="NAME">f.y</span><span class="PUNC">+</span><span class="NAME">h</span><span class="PUNC">*</span><span class="NAME">d.y</span><span class="PUNC">+</span><span class="NAME">i</span><span class="PUNC">*</span><span class="NAME">e.y</span><span class="PUNC">;</span><span class="NAME">j.z</span><span class="PUNC">=</span><span class="NAME">f.z</span><span class="PUNC">+</span><span class="NAME">h</span><span class="PUNC">*</span><span class="NAME">d.z</span><span class="PUNC">+</span><span class="NAME">i</span><span class="PUNC">*</span><span class="NAME">e.z</span><span class="PUNC">;</span><span class="NAME">this.grid</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">]</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>650</span> </span><span class="NAME">this.vertices.push</span><span class="PUNC">(</span><span class="NAME">j</span><span class="PUNC">)</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">&lt;</span><span class="NAME">this.radialSegments</span><span class="PUNC">;</span><span class="PUNC">++</span><span class="NAME">a</span><span class="PUNC">)</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">&lt;</span><span class="NAME">this.tubularSegments</span><span class="PUNC">;</span><span class="PUNC">++</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">e</span><span class="PUNC">=</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">%</span><span class="NAME">this.radialSegments</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">=</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">%</span><span class="NAME">this.tubularSegments</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.grid</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">]</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">this.grid</span><span class="PUNC">[</span><span class="NAME">e</span><span class="PUNC">]</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">this.grid</span><span class="PUNC">[</span><span class="NAME">e</span><span class="PUNC">]</span><span class="PUNC">[</span><span class="NAME">f</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">this.grid</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">]</span><span class="PUNC">[</span><span class="NAME">f</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector2</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">/</span><span class="NAME">this.radialSegments</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">/</span><span class="NAME">this.tubularSegments</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector2</span><span class="PUNC">(</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">/</span><span class="NAME">this.radialSegments</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">/</span><span class="NAME">this.tubularSegments</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">j</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector2</span><span class="PUNC">(</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">/</span><span class="NAME">this.radialSegments</span><span class="PUNC">,</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">/</span><span class="NAME">this.tubularSegments</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">l</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector2</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">/</span><span class="NAME">this.radialSegments</span><span class="PUNC">,</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">/</span><span class="NAME">this.tubularSegments</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>651</span> </span><span class="NAME">this.faces.push</span><span class="PUNC">(</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Face4</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.faceVertexUvs</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">push</span><span class="PUNC">(</span><span class="PUNC">[</span><span class="NAME">h</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">,</span><span class="NAME">j</span><span class="PUNC">,</span><span class="NAME">l</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="NAME">this.computeCentroids</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.computeFaceNormals</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.computeVertexNormals</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.TorusKnotGeometry.prototype</span><span class="PUNC">=</span><span class="NAME">Object.create</span><span class="PUNC">(</span><span class="NAME">THREE.Geometry.prototype</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">THREE.TubeGeometry</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">THREE.Geometry.call</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.path</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">this.segments</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">||</span><span class="NUMB">64</span><span class="PUNC">;</span><span class="NAME">this.radius</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">||</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">this.radialSegments</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">||</span><span class="NUMB">8</span><span class="PUNC">;</span><span class="NAME">this.closed</span><span class="PUNC">=</span><span class="NAME">e</span><span class="PUNC">||</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">this.grid</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">this.segments</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">,</span><span class="NAME">j</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">,</span><span class="NAME">l</span><span class="PUNC">,</span><span class="NAME">m</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.TubeGeometry.FrenetFrames</span><span class="PUNC">(</span><span class="NAME">this.path</span><span class="PUNC">,</span><span class="NAME">this.segments</span><span class="PUNC">,</span><span class="NAME">this.closed</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">l</span><span class="PUNC">=</span><span class="NAME">b.normals</span><span class="PUNC">;</span><span class="NAME">m</span><span class="PUNC">=</span><span class="NAME">b.binormals</span><span class="PUNC">;</span><span class="NAME">this.tangents</span><span class="PUNC">=</span><span class="NAME">b.tangents</span><span class="PUNC">;</span><span class="NAME">this.normals</span><span class="PUNC">=</span><span class="NAME">l</span><span class="PUNC">;</span><span class="NAME">this.binormals</span><span class="PUNC">=</span><span class="NAME">m</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">&lt;</span><span class="NAME">d</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.grid</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">/</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">j</span><span class="PUNC">=</span><span class="NAME">a.getPointAt</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">l</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">m</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">&lt;</span><span class="NAME">this.radialSegments</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NUMB">2</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">/</span><span class="NAME">this.radialSegments</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="WHIT">
<span class='line'>652</span> </span><span class="NAME">Math.PI</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="NAME">this.radius</span><span class="PUNC">*</span><span class="NAME">Math.cos</span><span class="PUNC">(</span><span class="NAME">g</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">this.radius</span><span class="PUNC">*</span><span class="NAME">Math.sin</span><span class="PUNC">(</span><span class="NAME">g</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">e.copy</span><span class="PUNC">(</span><span class="NAME">j</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">e.x</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">i</span><span class="PUNC">*</span><span class="NAME">f.x</span><span class="PUNC">+</span><span class="NAME">g</span><span class="PUNC">*</span><span class="NAME">h.x</span><span class="PUNC">,</span><span class="NAME">e.y</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">i</span><span class="PUNC">*</span><span class="NAME">f.y</span><span class="PUNC">+</span><span class="NAME">g</span><span class="PUNC">*</span><span class="NAME">h.y</span><span class="PUNC">,</span><span class="NAME">e.z</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">i</span><span class="PUNC">*</span><span class="NAME">f.z</span><span class="PUNC">+</span><span class="NAME">g</span><span class="PUNC">*</span><span class="NAME">h.z</span><span class="PUNC">,</span><span class="NAME">this.grid</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">]</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">this.vertices.push</span><span class="PUNC">(</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">(</span><span class="NAME">e.x</span><span class="PUNC">,</span><span class="NAME">e.y</span><span class="PUNC">,</span><span class="NAME">e.z</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">}</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">&lt;</span><span class="NAME">this.segments</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">&lt;</span><span class="NAME">this.radialSegments</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">this.closed</span><span class="PUNC">?</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">%</span><span class="NAME">this.segments</span><span class="PUNC">:</span><span class="NAME">b</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">l</span><span class="PUNC">=</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">%</span><span class="NAME">this.radialSegments</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">this.grid</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">]</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">this.grid</span><span class="PUNC">[</span><span class="NAME">e</span><span class="PUNC">]</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">this.grid</span><span class="PUNC">[</span><span class="NAME">e</span><span class="PUNC">]</span><span class="PUNC">[</span><span class="NAME">l</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">l</span><span class="PUNC">=</span><span class="NAME">this.grid</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">]</span><span class="PUNC">[</span><span class="NAME">l</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">m</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector2</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">/</span><span class="NAME">this.segments</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">/</span><span class="NAME">this.radialSegments</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector2</span><span class="PUNC">(</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">/</span><span class="NAME">this.segments</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">/</span><span class="NAME">this.radialSegments</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>653</span> </span><span class="NAME">h</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector2</span><span class="PUNC">(</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">/</span><span class="NAME">this.segments</span><span class="PUNC">,</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">/</span><span class="NAME">this.radialSegments</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector2</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">/</span><span class="NAME">this.segments</span><span class="PUNC">,</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">/</span><span class="NAME">this.radialSegments</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this.faces.push</span><span class="PUNC">(</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Face4</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">l</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this.faceVertexUvs</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">push</span><span class="PUNC">(</span><span class="PUNC">[</span><span class="NAME">m</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.computeCentroids</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.computeFaceNormals</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.computeVertexNormals</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.TubeGeometry.prototype</span><span class="PUNC">=</span><span class="NAME">Object.create</span><span class="PUNC">(</span><span class="NAME">THREE.Geometry.prototype</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>654</span> </span><span class="NAME">THREE.TubeGeometry.FrenetFrames</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">;</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">e</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Matrix4</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">j</span><span class="PUNC">,</span><span class="NAME">l</span><span class="PUNC">,</span><span class="NAME">m</span><span class="PUNC">;</span><span class="NAME">this.tangents</span><span class="PUNC">=</span><span class="NAME">e</span><span class="PUNC">;</span><span class="NAME">this.normals</span><span class="PUNC">=</span><span class="NAME">f</span><span class="PUNC">;</span><span class="NAME">this.binormals</span><span class="PUNC">=</span><span class="NAME">h</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">j</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">j</span><span class="PUNC">&lt;</span><span class="NAME">b</span><span class="PUNC">;</span><span class="NAME">j</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">l</span><span class="PUNC">=</span><span class="NAME">j</span><span class="PUNC">/</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">[</span><span class="NAME">j</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">a.getTangentAt</span><span class="PUNC">(</span><span class="NAME">l</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">[</span><span class="NAME">j</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">normalize</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">f</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">;</span><span class="NAME">h</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">Number.MAX_VALUE</span><span class="PUNC">;</span><span class="NAME">j</span><span class="PUNC">=</span><span class="NAME">Math.abs</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">x</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">l</span><span class="PUNC">=</span><span class="NAME">Math.abs</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">y</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">m</span><span class="PUNC">=</span><span class="NAME">Math.abs</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">z</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">j</span><span class="PUNC">&lt;=</span><span class="NAME">a</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">j</span><span class="PUNC">,</span><span class="NAME">d.set</span><span class="PUNC">(</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">l</span><span class="PUNC">&lt;=</span><span class="NAME">a</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">l</span><span class="PUNC">,</span><span class="NAME">d.set</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">m</span><span class="PUNC">&lt;=</span><span class="NAME">a</span><span class="PUNC">&&</span><span class="NAME">d.set</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">g.crossVectors</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>655</span> </span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">normalize</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">f</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">crossVectors</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">h</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">crossVectors</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">j</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">j</span><span class="PUNC">&lt;</span><span class="NAME">b</span><span class="PUNC">;</span><span class="NAME">j</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">f</span><span class="PUNC">[</span><span class="NAME">j</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">f</span><span class="PUNC">[</span><span class="NAME">j</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">clone</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">[</span><span class="NAME">j</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">h</span><span class="PUNC">[</span><span class="NAME">j</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">clone</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">g.crossVectors</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">[</span><span class="NAME">j</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">[</span><span class="NAME">j</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="NAME">E</span><span class="PUNC">-</span><span class="NUMB">4</span><span class="PUNC">&lt;</span><span class="NAME">g.length</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">g.normalize</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">Math.acos</span><span class="PUNC">(</span><span class="NAME">THREE.Math.clamp</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">[</span><span class="NAME">j</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">dot</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">[</span><span class="NAME">j</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">[</span><span class="NAME">j</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">applyMatrix4</span><span class="PUNC">(</span><span class="NAME">i.makeRotationAxis</span><span class="PUNC">(</span><span class="NAME">g</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">[</span><span class="NAME">j</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">crossVectors</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">[</span><span class="NAME">j</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">[</span><span class="NAME">j</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">Math.acos</span><span class="PUNC">(</span><span class="NAME">THREE.Math.clamp</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">dot</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">/</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NUMB">0</span><span class="PUNC">&lt;</span><span class="NAME">e</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">dot</span><span class="PUNC">(</span><span class="NAME">g.crossVectors</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">j</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">j</span><span class="PUNC">&lt;</span><span class="NAME">b</span><span class="PUNC">;</span><span class="NAME">j</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">f</span><span class="PUNC">[</span><span class="NAME">j</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">applyMatrix4</span><span class="PUNC">(</span><span class="NAME">i.makeRotationAxis</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">[</span><span class="NAME">j</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">*</span><span class="NAME">j</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">[</span><span class="NAME">j</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">crossVectors</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">[</span><span class="NAME">j</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>656</span> </span><span class="NAME">f</span><span class="PUNC">[</span><span class="NAME">j</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.PolyhedronGeometry</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">e</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">a.normalize</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">clone</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b.index</span><span class="PUNC">=</span><span class="NAME">g.vertices.push</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">Math.atan2</span><span class="PUNC">(</span><span class="NAME">a.z</span><span class="PUNC">,</span><span class="PUNC">-</span><span class="NAME">a.x</span><span class="PUNC">)</span><span class="PUNC">/</span><span class="NUMB">2</span><span class="PUNC">/</span><span class="NAME">Math.PI</span><span class="PUNC">+</span><span class="NUMB">0.5</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">Math.atan2</span><span class="PUNC">(</span><span class="PUNC">-</span><span class="NAME">a.y</span><span class="PUNC">,</span><span class="NAME">Math.sqrt</span><span class="PUNC">(</span><span class="NAME">a.x</span><span class="PUNC">*</span><span class="NAME">a.x</span><span class="PUNC">+</span><span class="NAME">a.z</span><span class="PUNC">*</span><span class="NAME">a.z</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">/</span><span class="NAME">Math.PI</span><span class="PUNC">+</span><span class="NUMB">0.5</span><span class="PUNC">;</span><span class="NAME">b.uv</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector2</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">-</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">}</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">f</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Face3</span><span class="PUNC">(</span><span class="NAME">a.index</span><span class="PUNC">,</span><span class="NAME">b.index</span><span class="PUNC">,</span><span class="NAME">c.index</span><span class="PUNC">,</span><span class="PUNC">[</span><span class="NAME">a.clone</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">b.clone</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">c.clone</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">d.centroid.add</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">add</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">add</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">divideScalar</span><span class="PUNC">(</span><span class="NUMB">3</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">g.faces.push</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">Math.atan2</span><span class="PUNC">(</span><span class="NAME">d.centroid.z</span><span class="PUNC">,</span><span class="PUNC">-</span><span class="NAME">d.centroid.x</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">g.faceVertexUvs</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">push</span><span class="PUNC">(</span><span class="PUNC">[</span><span class="NAME">h</span><span class="PUNC">(</span><span class="NAME">a.uv</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">(</span><span class="NAME">b.uv</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>657</span> </span><span class="NAME">h</span><span class="PUNC">(</span><span class="NAME">c.uv</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">h</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NUMB">0</span><span class="PUNC">></span><span class="NAME">c</span><span class="PUNC">&&</span><span class="NUMB">1</span><span class="PUNC">===</span><span class="NAME">a.x</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector2</span><span class="PUNC">(</span><span class="NAME">a.x</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">a.y</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NUMB">0</span><span class="PUNC">===</span><span class="NAME">b.x</span><span class="PUNC">&&</span><span class="NUMB">0</span><span class="PUNC">===</span><span class="NAME">b.z</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector2</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">/</span><span class="NUMB">2</span><span class="PUNC">/</span><span class="NAME">Math.PI</span><span class="PUNC">+</span><span class="NUMB">0.5</span><span class="PUNC">,</span><span class="NAME">a.y</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a.clone</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="NAME">THREE.Geometry.call</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">||</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">||</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">=</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">j</span><span class="PUNC">=</span><span class="NAME">a.length</span><span class="PUNC">;</span><span class="NAME">i</span><span class="PUNC">&lt;</span><span class="NAME">j</span><span class="PUNC">;</span><span class="NAME">i</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">e</span><span class="PUNC">(</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">[</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">l</span><span class="PUNC">=</span><span class="NAME">this.vertices</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">j</span><span class="PUNC">=</span><span class="NAME">b.length</span><span class="PUNC">;</span><span class="NAME">i</span><span class="PUNC">&lt;</span><span class="NAME">j</span><span class="PUNC">;</span><span class="NAME">i</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">m</span><span class="PUNC">=</span><span class="NAME">l</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">n</span><span class="PUNC">=</span><span class="NAME">l</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">p</span><span class="PUNC">=</span><span class="NAME">l</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">[</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Face3</span><span class="PUNC">(</span><span class="NAME">m.index</span><span class="PUNC">,</span><span class="NAME">n.index</span><span class="PUNC">,</span><span class="NAME">p.index</span><span class="PUNC">,</span><span class="PUNC">[</span><span class="NAME">m.clone</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">n.clone</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">p.clone</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="NAME">i</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">j</span><span class="PUNC">=</span><span class="NAME">a.length</span><span class="PUNC">;</span><span class="NAME">i</span><span class="PUNC">&lt;</span><span class="NAME">j</span><span class="PUNC">;</span><span class="NAME">i</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">n</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">l</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">Math.pow</span><span class="PUNC">(</span><span class="NUMB">2</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>658</span> </span><span class="NAME">l</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">Math.pow</span><span class="PUNC">(</span><span class="NUMB">4</span><span class="PUNC">,</span><span class="NAME">l</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">l</span><span class="PUNC">=</span><span class="NAME">e</span><span class="PUNC">(</span><span class="NAME">g.vertices</span><span class="PUNC">[</span><span class="NAME">n.a</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">m</span><span class="PUNC">=</span><span class="NAME">e</span><span class="PUNC">(</span><span class="NAME">g.vertices</span><span class="PUNC">[</span><span class="NAME">n.b</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">t</span><span class="PUNC">=</span><span class="NAME">e</span><span class="PUNC">(</span><span class="NAME">g.vertices</span><span class="PUNC">[</span><span class="NAME">n.c</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">n</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">p</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">p</span><span class="PUNC">&lt;=</span><span class="NAME">b</span><span class="PUNC">;</span><span class="NAME">p</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">n</span><span class="PUNC">[</span><span class="NAME">p</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">q</span><span class="PUNC">=</span><span class="NAME">e</span><span class="PUNC">(</span><span class="NAME">l.clone</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">lerp</span><span class="PUNC">(</span><span class="NAME">t</span><span class="PUNC">,</span><span class="NAME">p</span><span class="PUNC">/</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">r</span><span class="PUNC">=</span><span class="NAME">e</span><span class="PUNC">(</span><span class="NAME">m.clone</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">lerp</span><span class="PUNC">(</span><span class="NAME">t</span><span class="PUNC">,</span><span class="NAME">p</span><span class="PUNC">/</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">s</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">-</span><span class="NAME">p</span><span class="PUNC">,</span><span class="NAME">v</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">v</span><span class="PUNC">&lt;=</span><span class="NAME">s</span><span class="PUNC">;</span><span class="NAME">v</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">n</span><span class="PUNC">[</span><span class="NAME">p</span><span class="PUNC">]</span><span class="PUNC">[</span><span class="NAME">v</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">==</span><span class="NAME">v</span><span class="PUNC">&&</span><span class="NAME">p</span><span class="PUNC">==</span><span class="NAME">b</span><span class="PUNC">?</span><span class="NAME">q</span><span class="PUNC">:</span><span class="NAME">e</span><span class="PUNC">(</span><span class="NAME">q.clone</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">lerp</span><span class="PUNC">(</span><span class="NAME">r</span><span class="PUNC">,</span><span class="NAME">v</span><span class="PUNC">/</span><span class="NAME">s</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">p</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">p</span><span class="PUNC">&lt;</span><span class="NAME">b</span><span class="PUNC">;</span><span class="NAME">p</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">v</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">v</span><span class="PUNC">&lt;</span><span class="NUMB">2</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">-</span><span class="NAME">p</span><span class="PUNC">)</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">v</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">l</span><span class="PUNC">=</span><span class="NAME">Math.floor</span><span class="PUNC">(</span><span class="NAME">v</span><span class="PUNC">/</span><span class="NUMB">2</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">==</span><span class="NAME">v</span><span class="PUNC">%</span><span class="NUMB">2</span><span class="PUNC">?</span><span class="NAME">f</span><span class="PUNC">(</span><span class="NAME">n</span><span class="PUNC">[</span><span class="NAME">p</span><span class="PUNC">]</span><span class="PUNC">[</span><span class="NAME">l</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">n</span><span class="PUNC">[</span><span class="NAME">p</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">[</span><span class="NAME">l</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">n</span><span class="PUNC">[</span><span class="NAME">p</span><span class="PUNC">]</span><span class="PUNC">[</span><span class="NAME">l</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">f</span><span class="PUNC">(</span><span class="NAME">n</span><span class="PUNC">[</span><span class="NAME">p</span><span class="PUNC">]</span><span class="PUNC">[</span><span class="NAME">l</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">n</span><span class="PUNC">[</span><span class="NAME">p</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">[</span><span class="NAME">l</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">n</span><span class="PUNC">[</span><span class="NAME">p</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">[</span><span class="NAME">l</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="NAME">i</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">j</span><span class="PUNC">=</span><span class="NAME">this.faceVertexUvs</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">length</span><span class="PUNC">;</span><span class="NAME">i</span><span class="PUNC">&lt;</span><span class="NAME">j</span><span class="PUNC">;</span><span class="NAME">i</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">this.faceVertexUvs</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">x</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">x</span><span class="PUNC">,</span><span class="NAME">l</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">[</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">x</span><span class="PUNC">,</span><span class="NAME">m</span><span class="PUNC">=</span><span class="NAME">Math.max</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">Math.max</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">l</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>659</span> </span><span class="NAME">n</span><span class="PUNC">=</span><span class="NAME">Math.min</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">Math.min</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">l</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NUMB">0.9</span><span class="PUNC">&lt;</span><span class="NAME">m</span><span class="PUNC">&&</span><span class="NUMB">0.1</span><span class="PUNC">></span><span class="NAME">n</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NUMB">0.2</span><span class="PUNC">></span><span class="NAME">a</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">x</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NUMB">0.2</span><span class="PUNC">></span><span class="NAME">b</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">x</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NUMB">0.2</span><span class="PUNC">></span><span class="NAME">l</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">[</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">x</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">i</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">j</span><span class="PUNC">=</span><span class="NAME">this.vertices.length</span><span class="PUNC">;</span><span class="NAME">i</span><span class="PUNC">&lt;</span><span class="NAME">j</span><span class="PUNC">;</span><span class="NAME">i</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">this.vertices</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">multiplyScalar</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.mergeVertices</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.computeCentroids</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.computeFaceNormals</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.boundingSphere</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Sphere</span><span class="PUNC">(</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.PolyhedronGeometry.prototype</span><span class="PUNC">=</span><span class="NAME">Object.create</span><span class="PUNC">(</span><span class="NAME">THREE.Geometry.prototype</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">THREE.IcosahedronGeometry</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.radius</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">this.detail</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="PUNC">(</span><span class="NUMB">1</span><span class="PUNC">+</span><span class="NAME">Math.sqrt</span><span class="PUNC">(</span><span class="NUMB">5</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">/</span><span class="NUMB">2</span><span class="PUNC">;</span><span class="NAME">THREE.PolyhedronGeometry.call</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="PUNC">[</span><span class="PUNC">[</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="PUNC">[</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="PUNC">-</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="PUNC">-</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="PUNC">-</span><span class="NAME">c</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="PUNC">-</span><span class="NAME">c</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="PUNC">[</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="PUNC">[</span><span class="PUNC">-</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="PUNC">[</span><span class="PUNC">-</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="PUNC">[</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">11</span><span class="PUNC">,</span><span class="NUMB">5</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">5</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NUMB">7</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">7</span><span class="PUNC">,</span><span class="NUMB">10</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">10</span><span class="PUNC">,</span><span class="NUMB">11</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NUMB">5</span><span class="PUNC">,</span><span class="NUMB">9</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="PUNC">[</span><span class="NUMB">5</span><span class="PUNC">,</span><span class="NUMB">11</span><span class="PUNC">,</span><span class="NUMB">4</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="PUNC">[</span><span class="NUMB">11</span><span class="PUNC">,</span><span class="NUMB">10</span><span class="PUNC">,</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="PUNC">[</span><span class="NUMB">10</span><span class="PUNC">,</span><span class="NUMB">7</span><span class="PUNC">,</span><span class="NUMB">6</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="PUNC">[</span><span class="NUMB">7</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NUMB">8</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="PUNC">[</span><span class="NUMB">3</span><span class="PUNC">,</span><span class="NUMB">9</span><span class="PUNC">,</span><span class="NUMB">4</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="PUNC">[</span><span class="NUMB">3</span><span class="PUNC">,</span><span class="NUMB">4</span><span class="PUNC">,</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="PUNC">[</span><span class="NUMB">3</span><span class="PUNC">,</span><span class="NUMB">2</span><span class="PUNC">,</span><span class="NUMB">6</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="PUNC">[</span><span class="NUMB">3</span><span class="PUNC">,</span><span class="NUMB">6</span><span class="PUNC">,</span><span class="NUMB">8</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="PUNC">[</span><span class="NUMB">3</span><span class="PUNC">,</span><span class="NUMB">8</span><span class="PUNC">,</span><span class="NUMB">9</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="PUNC">[</span><span class="NUMB">4</span><span class="PUNC">,</span><span class="NUMB">9</span><span class="PUNC">,</span><span class="NUMB">5</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="PUNC">[</span><span class="NUMB">2</span><span class="PUNC">,</span><span class="NUMB">4</span><span class="PUNC">,</span><span class="NUMB">11</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="PUNC">[</span><span class="NUMB">6</span><span class="PUNC">,</span><span class="NUMB">2</span><span class="PUNC">,</span><span class="NUMB">10</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="PUNC">[</span><span class="NUMB">8</span><span class="PUNC">,</span><span class="NUMB">6</span><span class="PUNC">,</span><span class="NUMB">7</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="PUNC">[</span><span class="NUMB">9</span><span class="PUNC">,</span><span class="NUMB">8</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.IcosahedronGeometry.prototype</span><span class="PUNC">=</span><span class="NAME">Object.create</span><span class="PUNC">(</span><span class="NAME">THREE.Geometry.prototype</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">THREE.OctahedronGeometry</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">THREE.PolyhedronGeometry.call</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="PUNC">[</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="PUNC">[</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="PUNC">[</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">2</span><span class="PUNC">,</span><span class="NUMB">4</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">4</span><span class="PUNC">,</span><span class="NUMB">3</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">3</span><span class="PUNC">,</span><span class="NUMB">5</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">5</span><span class="PUNC">,</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NUMB">2</span><span class="PUNC">,</span><span class="NUMB">5</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NUMB">5</span><span class="PUNC">,</span><span class="NUMB">3</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NUMB">3</span><span class="PUNC">,</span><span class="NUMB">4</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NUMB">4</span><span class="PUNC">,</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.OctahedronGeometry.prototype</span><span class="PUNC">=</span><span class="NAME">Object.create</span><span class="PUNC">(</span><span class="NAME">THREE.Geometry.prototype</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">THREE.TetrahedronGeometry</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">THREE.PolyhedronGeometry.call</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="PUNC">[</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="PUNC">[</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="PUNC">[</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="PUNC">[</span><span class="PUNC">[</span><span class="NUMB">2</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">3</span><span class="PUNC">,</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NUMB">3</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="PUNC">[</span><span class="NUMB">2</span><span class="PUNC">,</span><span class="NUMB">3</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.TetrahedronGeometry.prototype</span><span class="PUNC">=</span><span class="NAME">Object.create</span><span class="PUNC">(</span><span class="NAME">THREE.Geometry.prototype</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">THREE.ParametricGeometry</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">THREE.Geometry.call</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">this.vertices</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">this.faces</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">this.faceVertexUvs</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">===</span><span class="NAME">d</span><span class="PUNC">?</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">:</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">,</span><span class="NAME">j</span><span class="PUNC">,</span><span class="NAME">l</span><span class="PUNC">,</span><span class="NAME">m</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">g</span><span class="PUNC">&lt;=</span><span class="NAME">c</span><span class="PUNC">;</span><span class="NAME">g</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">l</span><span class="PUNC">=</span><span class="NAME">g</span><span class="PUNC">/</span><span class="NAME">c</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">i</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">i</span><span class="PUNC">&lt;=</span><span class="NAME">b</span><span class="PUNC">;</span><span class="NAME">i</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">j</span><span class="PUNC">=</span><span class="NAME">i</span><span class="PUNC">/</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">j</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">(</span><span class="NAME">j</span><span class="PUNC">,</span><span class="NAME">l</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">e.push</span><span class="PUNC">(</span><span class="NAME">j</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">n</span><span class="PUNC">,</span><span class="NAME">p</span><span class="PUNC">,</span><span class="NAME">t</span><span class="PUNC">,</span><span class="NAME">q</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">g</span><span class="PUNC">&lt;</span><span class="NAME">c</span><span class="PUNC">;</span><span class="NAME">g</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">i</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">i</span><span class="PUNC">&lt;</span><span class="NAME">b</span><span class="PUNC">;</span><span class="NAME">i</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">g</span><span class="PUNC">*</span><span class="NAME">m</span><span class="PUNC">+</span><span class="NAME">i</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">g</span><span class="PUNC">*</span><span class="NAME">m</span><span class="PUNC">+</span><span class="NAME">i</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">l</span><span class="PUNC">=</span><span class="PUNC">(</span><span class="NAME">g</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">m</span><span class="PUNC">+</span><span class="NAME">i</span><span class="PUNC">,</span><span class="NAME">j</span><span class="PUNC">=</span><span class="PUNC">(</span><span class="NAME">g</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">m</span><span class="PUNC">+</span><span class="NAME">i</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">n</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector2</span><span class="PUNC">(</span><span class="NAME">i</span><span class="PUNC">/</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">/</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">p</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector2</span><span class="PUNC">(</span><span class="PUNC">(</span><span class="NAME">i</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">/</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">/</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">t</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector2</span><span class="PUNC">(</span><span class="NAME">i</span><span class="PUNC">/</span><span class="NAME">b</span><span class="PUNC">,</span><span class="PUNC">(</span><span class="NAME">g</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">/</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">q</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector2</span><span class="PUNC">(</span><span class="PUNC">(</span><span class="NAME">i</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">/</span><span class="NAME">b</span><span class="PUNC">,</span><span class="PUNC">(</span><span class="NAME">g</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">/</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">?</span><span class="PUNC">(</span><span class="NAME">f.push</span><span class="PUNC">(</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Face3</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">l</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">f.push</span><span class="PUNC">(</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Face3</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>660</span> </span><span class="NAME">j</span><span class="PUNC">,</span><span class="NAME">l</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">h.push</span><span class="PUNC">(</span><span class="PUNC">[</span><span class="NAME">n</span><span class="PUNC">,</span><span class="NAME">p</span><span class="PUNC">,</span><span class="NAME">t</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">h.push</span><span class="PUNC">(</span><span class="PUNC">[</span><span class="NAME">p</span><span class="PUNC">,</span><span class="NAME">q</span><span class="PUNC">,</span><span class="NAME">t</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="PUNC">(</span><span class="NAME">f.push</span><span class="PUNC">(</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Face4</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">j</span><span class="PUNC">,</span><span class="NAME">l</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">h.push</span><span class="PUNC">(</span><span class="PUNC">[</span><span class="NAME">n</span><span class="PUNC">,</span><span class="NAME">p</span><span class="PUNC">,</span><span class="NAME">q</span><span class="PUNC">,</span><span class="NAME">t</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.computeCentroids</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.computeFaceNormals</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.computeVertexNormals</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.ParametricGeometry.prototype</span><span class="PUNC">=</span><span class="NAME">Object.create</span><span class="PUNC">(</span><span class="NAME">THREE.Geometry.prototype</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">THREE.AxisHelper</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">||</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Geometry</span><span class="PUNC">;</span><span class="NAME">b.vertices.push</span><span class="PUNC">(</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">,</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">,</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">,</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b.colors.push</span><span class="PUNC">(</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Color</span><span class="PUNC">(</span><span class="NUMB">16711680</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Color</span><span class="PUNC">(</span><span class="NUMB">16755200</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Color</span><span class="PUNC">(</span><span class="NUMB">65280</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Color</span><span class="PUNC">(</span><span class="NUMB">11206400</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Color</span><span class="PUNC">(</span><span class="NUMB">255</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Color</span><span class="PUNC">(</span><span class="NUMB">43775</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.LineBasicMaterial</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">vertexColors</span><span class="PUNC">:</span><span class="NAME">THREE.VertexColors</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">THREE.Line.call</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">THREE.LinePieces</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>661</span> </span><span class="NAME">THREE.AxisHelper.prototype</span><span class="PUNC">=</span><span class="NAME">Object.create</span><span class="PUNC">(</span><span class="NAME">THREE.Line.prototype</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">THREE.ArrowHelper</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">THREE.Object3D.call</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">===</span><span class="NAME">d</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NUMB">16776960</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">===</span><span class="NAME">c</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.position</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Geometry</span><span class="PUNC">;</span><span class="NAME">b.vertices.push</span><span class="PUNC">(</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b.vertices.push</span><span class="PUNC">(</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.line</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Line</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">,</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.LineBasicMaterial</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">color</span><span class="PUNC">:</span><span class="NAME">d</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.line.matrixAutoUpdate</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">this.add</span><span class="PUNC">(</span><span class="NAME">this.line</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.CylinderGeometry</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0.05</span><span class="PUNC">,</span><span class="NUMB">0.25</span><span class="PUNC">,</span><span class="NUMB">5</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b.applyMatrix</span><span class="PUNC">(</span><span class="PUNC">(</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Matrix4</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">makeTranslation</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0.875</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.cone</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Mesh</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">,</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.MeshBasicMaterial</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">color</span><span class="PUNC">:</span><span class="NAME">d</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>662</span> </span><span class="NAME">this.cone.matrixAutoUpdate</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">this.add</span><span class="PUNC">(</span><span class="NAME">this.cone</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.setDirection</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.setLength</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.ArrowHelper.prototype</span><span class="PUNC">=</span><span class="NAME">Object.create</span><span class="PUNC">(</span><span class="NAME">THREE.Object3D.prototype</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">THREE.ArrowHelper.prototype.setDirection</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NUMB">0.99999</span><span class="PUNC">&lt;</span><span class="NAME">c.y</span><span class="PUNC">?</span><span class="NAME">this.quaternion.set</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="PUNC">-</span><span class="NUMB">0.99999</span><span class="PUNC">></span><span class="NAME">c.y</span><span class="PUNC">?</span><span class="NAME">this.quaternion.set</span><span class="PUNC">(</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="PUNC">(</span><span class="NAME">a.set</span><span class="PUNC">(</span><span class="NAME">c.z</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="PUNC">-</span><span class="NAME">c.x</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">normalize</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">Math.acos</span><span class="PUNC">(</span><span class="NAME">c.y</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this.quaternion.setFromAxisAngle</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">THREE.ArrowHelper.prototype.setLength</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.scale.set</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>663</span> </span><span class="NAME">THREE.ArrowHelper.prototype.setColor</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.line.material.color.setHex</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.cone.material.color.setHex</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.BoxHelper</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">(</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">(</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">(</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">(</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">(</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">(</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">(</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">(</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">this.vertices</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Geometry</span><span class="PUNC">;</span><span class="NAME">c.vertices.push</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">3</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">3</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">4</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">5</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">5</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">6</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">6</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">7</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">7</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">4</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">4</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">5</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">6</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">3</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">7</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">THREE.Line.call</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.LineBasicMaterial</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">color</span><span class="PUNC">:</span><span class="NUMB">16776960</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">THREE.LinePieces</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>664</span> </span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">a</span><span class="PUNC">&&</span><span class="NAME">this.update</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.BoxHelper.prototype</span><span class="PUNC">=</span><span class="NAME">Object.create</span><span class="PUNC">(</span><span class="NAME">THREE.Line.prototype</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>665</span> </span><span class="NAME">THREE.BoxHelper.prototype.update</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">a.geometry</span><span class="PUNC">;</span><span class="KEYW">null</span><span class="PUNC">===</span><span class="NAME">b.boundingBox</span><span class="PUNC">&&</span><span class="NAME">b.computeBoundingBox</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">b.boundingBox.min</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">b.boundingBox.max</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">this.vertices</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">set</span><span class="PUNC">(</span><span class="NAME">b.x</span><span class="PUNC">,</span><span class="NAME">b.y</span><span class="PUNC">,</span><span class="NAME">b.z</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">set</span><span class="PUNC">(</span><span class="NAME">c.x</span><span class="PUNC">,</span><span class="NAME">b.y</span><span class="PUNC">,</span><span class="NAME">b.z</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">[</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">set</span><span class="PUNC">(</span><span class="NAME">c.x</span><span class="PUNC">,</span><span class="NAME">c.y</span><span class="PUNC">,</span><span class="NAME">b.z</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">[</span><span class="NUMB">3</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">set</span><span class="PUNC">(</span><span class="NAME">b.x</span><span class="PUNC">,</span><span class="NAME">c.y</span><span class="PUNC">,</span><span class="NAME">b.z</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">[</span><span class="NUMB">4</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">set</span><span class="PUNC">(</span><span class="NAME">b.x</span><span class="PUNC">,</span><span class="NAME">b.y</span><span class="PUNC">,</span><span class="NAME">c.z</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">[</span><span class="NUMB">5</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">set</span><span class="PUNC">(</span><span class="NAME">c.x</span><span class="PUNC">,</span><span class="NAME">b.y</span><span class="PUNC">,</span><span class="NAME">c.z</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">[</span><span class="NUMB">6</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">set</span><span class="PUNC">(</span><span class="NAME">c.x</span><span class="PUNC">,</span><span class="NAME">c.y</span><span class="PUNC">,</span><span class="NAME">c.z</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">[</span><span class="NUMB">7</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">set</span><span class="PUNC">(</span><span class="NAME">b.x</span><span class="PUNC">,</span><span class="NAME">c.y</span><span class="PUNC">,</span><span class="NAME">c.z</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.geometry.computeBoundingSphere</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.geometry.verticesNeedUpdate</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">this.matrixAutoUpdate</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">this.matrixWorld</span><span class="PUNC">=</span><span class="NAME">a.matrixWorld</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.BoundingBoxHelper</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">||</span><span class="NUMB">8947848</span><span class="PUNC">;</span><span class="NAME">this.object</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">this.box</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Box3</span><span class="PUNC">;</span><span class="NAME">THREE.Mesh.call</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.CubeGeometry</span><span class="PUNC">(</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.MeshBasicMaterial</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">color</span><span class="PUNC">:</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">wireframe</span><span class="PUNC">:</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.BoundingBoxHelper.prototype</span><span class="PUNC">=</span><span class="NAME">Object.create</span><span class="PUNC">(</span><span class="NAME">THREE.Mesh.prototype</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">THREE.BoundingBoxHelper.prototype.update</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.box.setFromObject</span><span class="PUNC">(</span><span class="NAME">this.object</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.box.size</span><span class="PUNC">(</span><span class="NAME">this.scale</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.box.center</span><span class="PUNC">(</span><span class="NAME">this.position</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.CameraHelper</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">c</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">d.vertices.push</span><span class="PUNC">(</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">d.colors.push</span><span class="PUNC">(</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Color</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">===</span><span class="NAME">f</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">]</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">f</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">push</span><span class="PUNC">(</span><span class="NAME">d.vertices.length</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Geometry</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.LineBasicMaterial</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">color</span><span class="PUNC">:</span><span class="NUMB">16777215</span><span class="PUNC">,</span><span class="NAME">vertexColors</span><span class="PUNC">:</span><span class="NAME">THREE.FaceColors</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">(</span><span class="STRN">"n1"</span><span class="PUNC">,</span><span class="STRN">"n2"</span><span class="PUNC">,</span><span class="NUMB">16755200</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">(</span><span class="STRN">"n2"</span><span class="PUNC">,</span><span class="STRN">"n4"</span><span class="PUNC">,</span><span class="NUMB">16755200</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">(</span><span class="STRN">"n4"</span><span class="PUNC">,</span><span class="STRN">"n3"</span><span class="PUNC">,</span><span class="NUMB">16755200</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">(</span><span class="STRN">"n3"</span><span class="PUNC">,</span><span class="STRN">"n1"</span><span class="PUNC">,</span><span class="NUMB">16755200</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">(</span><span class="STRN">"f1"</span><span class="PUNC">,</span><span class="STRN">"f2"</span><span class="PUNC">,</span><span class="NUMB">16755200</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">(</span><span class="STRN">"f2"</span><span class="PUNC">,</span><span class="STRN">"f4"</span><span class="PUNC">,</span><span class="NUMB">16755200</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">(</span><span class="STRN">"f4"</span><span class="PUNC">,</span><span class="STRN">"f3"</span><span class="PUNC">,</span><span class="NUMB">16755200</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">(</span><span class="STRN">"f3"</span><span class="PUNC">,</span><span class="STRN">"f1"</span><span class="PUNC">,</span><span class="NUMB">16755200</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">(</span><span class="STRN">"n1"</span><span class="PUNC">,</span><span class="STRN">"f1"</span><span class="PUNC">,</span><span class="NUMB">16755200</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>666</span> </span><span class="NAME">b</span><span class="PUNC">(</span><span class="STRN">"n2"</span><span class="PUNC">,</span><span class="STRN">"f2"</span><span class="PUNC">,</span><span class="NUMB">16755200</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">(</span><span class="STRN">"n3"</span><span class="PUNC">,</span><span class="STRN">"f3"</span><span class="PUNC">,</span><span class="NUMB">16755200</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">(</span><span class="STRN">"n4"</span><span class="PUNC">,</span><span class="STRN">"f4"</span><span class="PUNC">,</span><span class="NUMB">16755200</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">(</span><span class="STRN">"p"</span><span class="PUNC">,</span><span class="STRN">"n1"</span><span class="PUNC">,</span><span class="NUMB">16711680</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">(</span><span class="STRN">"p"</span><span class="PUNC">,</span><span class="STRN">"n2"</span><span class="PUNC">,</span><span class="NUMB">16711680</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">(</span><span class="STRN">"p"</span><span class="PUNC">,</span><span class="STRN">"n3"</span><span class="PUNC">,</span><span class="NUMB">16711680</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">(</span><span class="STRN">"p"</span><span class="PUNC">,</span><span class="STRN">"n4"</span><span class="PUNC">,</span><span class="NUMB">16711680</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">(</span><span class="STRN">"u1"</span><span class="PUNC">,</span><span class="STRN">"u2"</span><span class="PUNC">,</span><span class="NUMB">43775</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">(</span><span class="STRN">"u2"</span><span class="PUNC">,</span><span class="STRN">"u3"</span><span class="PUNC">,</span><span class="NUMB">43775</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">(</span><span class="STRN">"u3"</span><span class="PUNC">,</span><span class="STRN">"u1"</span><span class="PUNC">,</span><span class="NUMB">43775</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">(</span><span class="STRN">"c"</span><span class="PUNC">,</span><span class="STRN">"t"</span><span class="PUNC">,</span><span class="NUMB">16777215</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">(</span><span class="STRN">"p"</span><span class="PUNC">,</span><span class="STRN">"c"</span><span class="PUNC">,</span><span class="NUMB">3355443</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">(</span><span class="STRN">"cn1"</span><span class="PUNC">,</span><span class="STRN">"cn2"</span><span class="PUNC">,</span><span class="NUMB">3355443</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">(</span><span class="STRN">"cn3"</span><span class="PUNC">,</span><span class="STRN">"cn4"</span><span class="PUNC">,</span><span class="NUMB">3355443</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">(</span><span class="STRN">"cf1"</span><span class="PUNC">,</span><span class="STRN">"cf2"</span><span class="PUNC">,</span><span class="NUMB">3355443</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">(</span><span class="STRN">"cf3"</span><span class="PUNC">,</span><span class="STRN">"cf4"</span><span class="PUNC">,</span><span class="NUMB">3355443</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">THREE.Line.call</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">THREE.LinePieces</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.camera</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">this.matrixWorld</span><span class="PUNC">=</span><span class="NAME">a.matrixWorld</span><span class="PUNC">;</span><span class="NAME">this.matrixAutoUpdate</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">this.pointMap</span><span class="PUNC">=</span><span class="NAME">f</span><span class="PUNC">;</span><span class="NAME">this.update</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>667</span> </span><span class="NAME">THREE.CameraHelper.prototype</span><span class="PUNC">=</span><span class="NAME">Object.create</span><span class="PUNC">(</span><span class="NAME">THREE.Line.prototype</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>668</span> </span><span class="NAME">THREE.CameraHelper.prototype.update</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Camera</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Projector</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">a.set</span><span class="PUNC">(</span><span class="NAME">h</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">c.unprojectVector</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">e.pointMap</span><span class="PUNC">[</span><span class="NAME">d</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">d.length</span><span class="PUNC">;</span><span class="NAME">h</span><span class="PUNC">&lt;</span><span class="NAME">g</span><span class="PUNC">;</span><span class="NAME">h</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">e.geometry.vertices</span><span class="PUNC">[</span><span class="NAME">d</span><span class="PUNC">[</span><span class="NAME">h</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">copy</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">e</span><span class="PUNC">=</span><span class="KEYW">this</span><span class="PUNC">;</span><span class="NAME">b.projectionMatrix.copy</span><span class="PUNC">(</span><span class="NAME">this.camera.projectionMatrix</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">(</span><span class="STRN">"c"</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">(</span><span class="STRN">"t"</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">(</span><span class="STRN">"n1"</span><span class="PUNC">,</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">(</span><span class="STRN">"n2"</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">(</span><span class="STRN">"n3"</span><span class="PUNC">,</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">(</span><span class="STRN">"n4"</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">(</span><span class="STRN">"f1"</span><span class="PUNC">,</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">(</span><span class="STRN">"f2"</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">(</span><span class="STRN">"f3"</span><span class="PUNC">,</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">(</span><span class="STRN">"f4"</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">(</span><span class="STRN">"u1"</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>669</span> </span><span class="NUMB">0.7</span><span class="PUNC">,</span><span class="NUMB">1.1</span><span class="PUNC">,</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">(</span><span class="STRN">"u2"</span><span class="PUNC">,</span><span class="PUNC">-</span><span class="NUMB">0.7</span><span class="PUNC">,</span><span class="NUMB">1.1</span><span class="PUNC">,</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">(</span><span class="STRN">"u3"</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">2</span><span class="PUNC">,</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">(</span><span class="STRN">"cf1"</span><span class="PUNC">,</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">(</span><span class="STRN">"cf2"</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">(</span><span class="STRN">"cf3"</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">(</span><span class="STRN">"cf4"</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">(</span><span class="STRN">"cn1"</span><span class="PUNC">,</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">(</span><span class="STRN">"cn2"</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">(</span><span class="STRN">"cn3"</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">(</span><span class="STRN">"cn4"</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.geometry.verticesNeedUpdate</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">THREE.DirectionalLightHelper</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">THREE.Object3D.call</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.light</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">this.light.updateMatrixWorld</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.matrixWorld</span><span class="PUNC">=</span><span class="NAME">a.matrixWorld</span><span class="PUNC">;</span><span class="NAME">this.matrixAutoUpdate</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.PlaneGeometry</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.MeshBasicMaterial</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">wireframe</span><span class="PUNC">:</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">fog</span><span class="PUNC">:</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">d.color.copy</span><span class="PUNC">(</span><span class="NAME">this.light.color</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">multiplyScalar</span><span class="PUNC">(</span><span class="NAME">this.light.intensity</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.lightPlane</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Mesh</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.add</span><span class="PUNC">(</span><span class="NAME">this.lightPlane</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Geometry</span><span class="PUNC">;</span><span class="NAME">c.vertices.push</span><span class="PUNC">(</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">c.vertices.push</span><span class="PUNC">(</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">c.computeLineDistances</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>670</span> </span><span class="NAME">d</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.LineBasicMaterial</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">fog</span><span class="PUNC">:</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">d.color.copy</span><span class="PUNC">(</span><span class="NAME">this.light.color</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">multiplyScalar</span><span class="PUNC">(</span><span class="NAME">this.light.intensity</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.targetLine</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Line</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.add</span><span class="PUNC">(</span><span class="NAME">this.targetLine</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.update</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.DirectionalLightHelper.prototype</span><span class="PUNC">=</span><span class="NAME">Object.create</span><span class="PUNC">(</span><span class="NAME">THREE.Object3D.prototype</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>671</span> </span><span class="NAME">THREE.DirectionalLightHelper.prototype.update</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">a.getPositionFromMatrix</span><span class="PUNC">(</span><span class="NAME">this.light.matrixWorld</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">negate</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.lightPlane.lookAt</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.lightPlane.material.color.copy</span><span class="PUNC">(</span><span class="NAME">this.light.color</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">multiplyScalar</span><span class="PUNC">(</span><span class="NAME">this.light.intensity</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.targetLine.geometry.vertices</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">copy</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.targetLine.geometry.verticesNeedUpdate</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">this.targetLine.material.color.copy</span><span class="PUNC">(</span><span class="NAME">this.lightPlane.material.color</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">THREE.FaceNormalsHelper</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.object</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">this.size</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">||</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">||</span><span class="NUMB">16776960</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">||</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Geometry</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">this.object.geometry.faces.length</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">&lt;</span><span class="NAME">e</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">b.vertices.push</span><span class="PUNC">(</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">b.vertices.push</span><span class="PUNC">(</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">THREE.Line.call</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.LineBasicMaterial</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">color</span><span class="PUNC">:</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">linewidth</span><span class="PUNC">:</span><span class="NAME">d</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">THREE.LinePieces</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.matrixAutoUpdate</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">this.normalMatrix</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Matrix3</span><span class="PUNC">;</span><span class="NAME">this.update</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.FaceNormalsHelper.prototype</span><span class="PUNC">=</span><span class="NAME">Object.create</span><span class="PUNC">(</span><span class="NAME">THREE.Line.prototype</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>672</span> </span><span class="NAME">THREE.FaceNormalsHelper.prototype.update</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.object.updateMatrixWorld</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.normalMatrix.getNormalMatrix</span><span class="PUNC">(</span><span class="NAME">this.object.matrixWorld</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.geometry.vertices</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.object.geometry.faces</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">this.object.matrixWorld</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">c.length</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">&lt;</span><span class="NAME">f</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NAME">e</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">a.copy</span><span class="PUNC">(</span><span class="NAME">h.normal</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">applyMatrix3</span><span class="PUNC">(</span><span class="NAME">this.normalMatrix</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">normalize</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">multiplyScalar</span><span class="PUNC">(</span><span class="NAME">this.size</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">g</span><span class="PUNC">=</span><span class="NUMB">2</span><span class="PUNC">*</span><span class="NAME">e</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NAME">g</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">copy</span><span class="PUNC">(</span><span class="NAME">h.centroid</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">applyMatrix4</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NAME">g</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">addVectors</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NAME">g</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="NAME">this.geometry.verticesNeedUpdate</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>673</span> </span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">THREE.GridHelper</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Geometry</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.LineBasicMaterial</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">vertexColors</span><span class="PUNC">:</span><span class="NAME">THREE.VertexColors</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.color1</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Color</span><span class="PUNC">(</span><span class="NUMB">4473924</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.color2</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Color</span><span class="PUNC">(</span><span class="NUMB">8947848</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">e</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">&lt;=</span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">c.vertices.push</span><span class="PUNC">(</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">(</span><span class="PUNC">-</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="PUNC">-</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">f</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">===</span><span class="NAME">e</span><span class="PUNC">?</span><span class="NAME">this.color1</span><span class="PUNC">:</span><span class="NAME">this.color2</span><span class="PUNC">;</span><span class="NAME">c.colors.push</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="NAME">THREE.Line.call</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">THREE.LinePieces</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.GridHelper.prototype</span><span class="PUNC">=</span><span class="NAME">Object.create</span><span class="PUNC">(</span><span class="NAME">THREE.Line.prototype</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>674</span> </span><span class="NAME">THREE.GridHelper.prototype.setColors</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.color1.set</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.color2.set</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.geometry.colorsNeedUpdate</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.HemisphereLightHelper</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">THREE.Object3D.call</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.light</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">this.light.updateMatrixWorld</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.matrixWorld</span><span class="PUNC">=</span><span class="NAME">a.matrixWorld</span><span class="PUNC">;</span><span class="NAME">this.matrixAutoUpdate</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">this.colors</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Color</span><span class="PUNC">,</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Color</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.SphereGeometry</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NUMB">4</span><span class="PUNC">,</span><span class="NUMB">2</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">c.applyMatrix</span><span class="PUNC">(</span><span class="PUNC">(</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Matrix4</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">makeRotationX</span><span class="PUNC">(</span><span class="PUNC">-</span><span class="NAME">Math.PI</span><span class="PUNC">/</span><span class="NUMB">2</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NUMB">8</span><span class="PUNC">></span><span class="NAME">d</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">c.faces</span><span class="PUNC">[</span><span class="NAME">d</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">color</span><span class="PUNC">=</span><span class="NAME">this.colors</span><span class="PUNC">[</span><span class="NUMB">4</span><span class="PUNC">></span><span class="NAME">d</span><span class="PUNC">?</span><span class="NUMB">0</span><span class="PUNC">:</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.MeshBasicMaterial</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">vertexColors</span><span class="PUNC">:</span><span class="NAME">THREE.FaceColors</span><span class="PUNC">,</span><span class="NAME">wireframe</span><span class="PUNC">:</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.lightSphere</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Mesh</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.add</span><span class="PUNC">(</span><span class="NAME">this.lightSphere</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>675</span> </span><span class="NAME">this.update</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.HemisphereLightHelper.prototype</span><span class="PUNC">=</span><span class="NAME">Object.create</span><span class="PUNC">(</span><span class="NAME">THREE.Object3D.prototype</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">THREE.HemisphereLightHelper.prototype.update</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.colors</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">copy</span><span class="PUNC">(</span><span class="NAME">this.light.color</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">multiplyScalar</span><span class="PUNC">(</span><span class="NAME">this.light.intensity</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.colors</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">copy</span><span class="PUNC">(</span><span class="NAME">this.light.groundColor</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">multiplyScalar</span><span class="PUNC">(</span><span class="NAME">this.light.intensity</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.lightSphere.lookAt</span><span class="PUNC">(</span><span class="NAME">a.getPositionFromMatrix</span><span class="PUNC">(</span><span class="NAME">this.light.matrixWorld</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">negate</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.lightSphere.geometry.colorsNeedUpdate</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">THREE.PointLightHelper</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.light</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">this.light.updateMatrixWorld</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.SphereGeometry</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NUMB">4</span><span class="PUNC">,</span><span class="NUMB">2</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.MeshBasicMaterial</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">wireframe</span><span class="PUNC">:</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">fog</span><span class="PUNC">:</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">d.color.copy</span><span class="PUNC">(</span><span class="NAME">this.light.color</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">multiplyScalar</span><span class="PUNC">(</span><span class="NAME">this.light.intensity</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">THREE.Mesh.call</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.matrixWorld</span><span class="PUNC">=</span><span class="NAME">this.light.matrixWorld</span><span class="PUNC">;</span><span class="NAME">this.matrixAutoUpdate</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.PointLightHelper.prototype</span><span class="PUNC">=</span><span class="NAME">Object.create</span><span class="PUNC">(</span><span class="NAME">THREE.Mesh.prototype</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">THREE.PointLightHelper.prototype.update</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.material.color.copy</span><span class="PUNC">(</span><span class="NAME">this.light.color</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">multiplyScalar</span><span class="PUNC">(</span><span class="NAME">this.light.intensity</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.SpotLightHelper</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">THREE.Object3D.call</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.light</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">this.light.updateMatrixWorld</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.matrixWorld</span><span class="PUNC">=</span><span class="NAME">a.matrixWorld</span><span class="PUNC">;</span><span class="NAME">this.matrixAutoUpdate</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.CylinderGeometry</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NUMB">8</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a.applyMatrix</span><span class="PUNC">(</span><span class="PUNC">(</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Matrix4</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">makeTranslation</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="PUNC">-</span><span class="NUMB">0.5</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a.applyMatrix</span><span class="PUNC">(</span><span class="PUNC">(</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Matrix4</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">makeRotationX</span><span class="PUNC">(</span><span class="PUNC">-</span><span class="NAME">Math.PI</span><span class="PUNC">/</span><span class="NUMB">2</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.MeshBasicMaterial</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">wireframe</span><span class="PUNC">:</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">fog</span><span class="PUNC">:</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.cone</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Mesh</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.add</span><span class="PUNC">(</span><span class="NAME">this.cone</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.update</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.SpotLightHelper.prototype</span><span class="PUNC">=</span><span class="NAME">Object.create</span><span class="PUNC">(</span><span class="NAME">THREE.Object3D.prototype</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>676</span> </span><span class="NAME">THREE.SpotLightHelper.prototype.update</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.light.distance</span><span class="PUNC">?</span><span class="NAME">this.light.distance</span><span class="PUNC">:</span><span class="NUMB">1</span><span class="NAME">E4</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">*</span><span class="NAME">Math.tan</span><span class="PUNC">(</span><span class="NAME">this.light.angle</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.cone.scale.set</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.cone.lookAt</span><span class="PUNC">(</span><span class="NAME">a.getPositionFromMatrix</span><span class="PUNC">(</span><span class="NAME">this.light.matrixWorld</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">negate</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.cone.material.color.copy</span><span class="PUNC">(</span><span class="NAME">this.light.color</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">multiplyScalar</span><span class="PUNC">(</span><span class="NAME">this.light.intensity</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">THREE.VertexNormalsHelper</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.object</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">this.size</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">||</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">||</span><span class="NUMB">16711680</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">||</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Geometry</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">a.geometry.faces</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">a.length</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">&lt;</span><span class="NAME">f</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">h</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NAME">e</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">vertexNormals.length</span><span class="PUNC">;</span><span class="NAME">h</span><span class="PUNC">&lt;</span><span class="NAME">g</span><span class="PUNC">;</span><span class="NAME">h</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">c.vertices.push</span><span class="PUNC">(</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">c.vertices.push</span><span class="PUNC">(</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">THREE.Line.call</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.LineBasicMaterial</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">color</span><span class="PUNC">:</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">linewidth</span><span class="PUNC">:</span><span class="NAME">d</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">THREE.LinePieces</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.matrixAutoUpdate</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">this.normalMatrix</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Matrix3</span><span class="PUNC">;</span><span class="NAME">this.update</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.VertexNormalsHelper.prototype</span><span class="PUNC">=</span><span class="NAME">Object.create</span><span class="PUNC">(</span><span class="NAME">THREE.Line.prototype</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>677</span> </span><span class="NAME">THREE.VertexNormalsHelper.prototype.update</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="STRN">"a"</span><span class="PUNC">,</span><span class="STRN">"b"</span><span class="PUNC">,</span><span class="STRN">"c"</span><span class="PUNC">,</span><span class="STRN">"d"</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">this.object.updateMatrixWorld</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.normalMatrix.getNormalMatrix</span><span class="PUNC">(</span><span class="NAME">this.object.matrixWorld</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.geometry.vertices</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">this.object.geometry.vertices</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">this.object.geometry.faces</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">this.object.matrixWorld</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">=</span><span class="NAME">e.length</span><span class="PUNC">;</span><span class="NAME">g</span><span class="PUNC">&lt;</span><span class="NAME">i</span><span class="PUNC">;</span><span class="NAME">g</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">j</span><span class="PUNC">=</span><span class="NAME">e</span><span class="PUNC">[</span><span class="NAME">g</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">l</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">m</span><span class="PUNC">=</span><span class="NAME">j.vertexNormals.length</span><span class="PUNC">;</span><span class="NAME">l</span><span class="PUNC">&lt;</span><span class="NAME">m</span><span class="PUNC">;</span><span class="NAME">l</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">n</span><span class="PUNC">=</span><span class="NAME">j.vertexNormals</span><span class="PUNC">[</span><span class="NAME">l</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NAME">h</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">copy</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">[</span><span class="NAME">j</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NAME">l</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">applyMatrix4</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a.copy</span><span class="PUNC">(</span><span class="NAME">n</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">applyMatrix3</span><span class="PUNC">(</span><span class="NAME">this.normalMatrix</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">normalize</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">multiplyScalar</span><span class="PUNC">(</span><span class="NAME">this.size</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>678</span> </span><span class="NAME">a.add</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NAME">h</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">h</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NAME">h</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">copy</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">h</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">}</span><span class="NAME">this.geometry.verticesNeedUpdate</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">THREE.VertexTangentsHelper</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.object</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">this.size</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">||</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">||</span><span class="NUMB">255</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">||</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Geometry</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">a.geometry.faces</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">a.length</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">&lt;</span><span class="NAME">f</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">h</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NAME">e</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">vertexTangents.length</span><span class="PUNC">;</span><span class="NAME">h</span><span class="PUNC">&lt;</span><span class="NAME">g</span><span class="PUNC">;</span><span class="NAME">h</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">c.vertices.push</span><span class="PUNC">(</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">c.vertices.push</span><span class="PUNC">(</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">THREE.Line.call</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.LineBasicMaterial</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">color</span><span class="PUNC">:</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">linewidth</span><span class="PUNC">:</span><span class="NAME">d</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">THREE.LinePieces</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.matrixAutoUpdate</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">this.update</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.VertexTangentsHelper.prototype</span><span class="PUNC">=</span><span class="NAME">Object.create</span><span class="PUNC">(</span><span class="NAME">THREE.Line.prototype</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>679</span> </span><span class="NAME">THREE.VertexTangentsHelper.prototype.update</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="STRN">"a"</span><span class="PUNC">,</span><span class="STRN">"b"</span><span class="PUNC">,</span><span class="STRN">"c"</span><span class="PUNC">,</span><span class="STRN">"d"</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">this.object.updateMatrixWorld</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.geometry.vertices</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">this.object.geometry.vertices</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">this.object.geometry.faces</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">this.object.matrixWorld</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">=</span><span class="NAME">e.length</span><span class="PUNC">;</span><span class="NAME">g</span><span class="PUNC">&lt;</span><span class="NAME">i</span><span class="PUNC">;</span><span class="NAME">g</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">j</span><span class="PUNC">=</span><span class="NAME">e</span><span class="PUNC">[</span><span class="NAME">g</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">l</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">m</span><span class="PUNC">=</span><span class="NAME">j.vertexTangents.length</span><span class="PUNC">;</span><span class="NAME">l</span><span class="PUNC">&lt;</span><span class="NAME">m</span><span class="PUNC">;</span><span class="NAME">l</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">n</span><span class="PUNC">=</span><span class="NAME">j.vertexTangents</span><span class="PUNC">[</span><span class="NAME">l</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NAME">h</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">copy</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">[</span><span class="NAME">j</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NAME">l</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">applyMatrix4</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a.copy</span><span class="PUNC">(</span><span class="NAME">n</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">transformDirection</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">multiplyScalar</span><span class="PUNC">(</span><span class="NAME">this.size</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a.add</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NAME">h</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">h</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NAME">h</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">copy</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>680</span> </span><span class="NAME">h</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">}</span><span class="NAME">this.geometry.verticesNeedUpdate</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">THREE.WireframeHelper</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">-</span><span class="NAME">b</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="STRN">"a"</span><span class="PUNC">,</span><span class="STRN">"b"</span><span class="PUNC">,</span><span class="STRN">"c"</span><span class="PUNC">,</span><span class="STRN">"d"</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Geometry</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">a.geometry.vertices</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">a.geometry.faces</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">j</span><span class="PUNC">=</span><span class="NAME">g.length</span><span class="PUNC">;</span><span class="NAME">i</span><span class="PUNC">&lt;</span><span class="NAME">j</span><span class="PUNC">;</span><span class="NAME">i</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">l</span><span class="PUNC">=</span><span class="NAME">g</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">m</span><span class="PUNC">=</span><span class="NAME">l</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">THREE.Face4</span><span class="PUNC">?</span><span class="NUMB">4</span><span class="PUNC">:</span><span class="NUMB">3</span><span class="PUNC">,</span><span class="NAME">n</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">n</span><span class="PUNC">&lt;</span><span class="NAME">m</span><span class="PUNC">;</span><span class="NAME">n</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">l</span><span class="PUNC">[</span><span class="NAME">e</span><span class="PUNC">[</span><span class="NAME">n</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">l</span><span class="PUNC">[</span><span class="NAME">e</span><span class="PUNC">[</span><span class="PUNC">(</span><span class="NAME">n</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">%</span><span class="NAME">m</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">b.sort</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">p</span><span class="PUNC">=</span><span class="NAME">b.toString</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">===</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NAME">p</span><span class="PUNC">]</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">f.vertices.push</span><span class="PUNC">(</span><span class="NAME">h</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">f.vertices.push</span><span class="PUNC">(</span><span class="NAME">h</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">[</span><span class="NAME">p</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="NAME">THREE.Line.call</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">,</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.LineBasicMaterial</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">color</span><span class="PUNC">:</span><span class="NUMB">16777215</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">THREE.LinePieces</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.matrixAutoUpdate</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">this.matrixWorld</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>681</span> </span><span class="NAME">a.matrixWorld</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.WireframeHelper.prototype</span><span class="PUNC">=</span><span class="NAME">Object.create</span><span class="PUNC">(</span><span class="NAME">THREE.Line.prototype</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">THREE.ImmediateRenderObject</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">THREE.Object3D.call</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.render</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.ImmediateRenderObject.prototype</span><span class="PUNC">=</span><span class="NAME">Object.create</span><span class="PUNC">(</span><span class="NAME">THREE.Object3D.prototype</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">THREE.LensFlare</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">THREE.Object3D.call</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.lensFlares</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">this.positionScreen</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">;</span><span class="NAME">this.customUpdateCallback</span><span class="PUNC">=</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">a</span><span class="PUNC">&&</span><span class="NAME">this.add</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.LensFlare.prototype</span><span class="PUNC">=</span><span class="NAME">Object.create</span><span class="PUNC">(</span><span class="NAME">THREE.Object3D.prototype</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>682</span> </span><span class="NAME">THREE.LensFlare.prototype.add</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">===</span><span class="NAME">b</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">===</span><span class="NAME">c</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">===</span><span class="NAME">f</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">===</span><span class="NAME">e</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Color</span><span class="PUNC">(</span><span class="NUMB">16777215</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">void</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">===</span><span class="NAME">d</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">THREE.NormalBlending</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">Math.min</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">Math.max</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.lensFlares.push</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">texture</span><span class="PUNC">:</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">size</span><span class="PUNC">:</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">distance</span><span class="PUNC">:</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">x</span><span class="PUNC">:</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">y</span><span class="PUNC">:</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">z</span><span class="PUNC">:</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">scale</span><span class="PUNC">:</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">rotation</span><span class="PUNC">:</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">opacity</span><span class="PUNC">:</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">color</span><span class="PUNC">:</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">blending</span><span class="PUNC">:</span><span class="NAME">d</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>683</span> </span><span class="NAME">THREE.LensFlare.prototype.updateLensFlares</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.lensFlares.length</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NUMB">2</span><span class="PUNC">*</span><span class="PUNC">-</span><span class="NAME">this.positionScreen.x</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NUMB">2</span><span class="PUNC">*</span><span class="PUNC">-</span><span class="NAME">this.positionScreen.y</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">&lt;</span><span class="NAME">b</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.lensFlares</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">c.x</span><span class="PUNC">=</span><span class="NAME">this.positionScreen.x</span><span class="PUNC">+</span><span class="NAME">d</span><span class="PUNC">*</span><span class="NAME">c.distance</span><span class="PUNC">,</span><span class="NAME">c.y</span><span class="PUNC">=</span><span class="NAME">this.positionScreen.y</span><span class="PUNC">+</span><span class="NAME">e</span><span class="PUNC">*</span><span class="NAME">c.distance</span><span class="PUNC">,</span><span class="NAME">c.wantedRotation</span><span class="PUNC">=</span><span class="NUMB">0.25</span><span class="PUNC">*</span><span class="NAME">c.x</span><span class="PUNC">*</span><span class="NAME">Math.PI</span><span class="PUNC">,</span><span class="NAME">c.rotation</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NUMB">0.25</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">c.wantedRotation</span><span class="PUNC">-</span><span class="NAME">c.rotation</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.MorphBlendMesh</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">THREE.Mesh.call</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.animationsMap</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">this.animationsList</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.geometry.morphTargets.length</span><span class="PUNC">;</span><span class="NAME">this.createAnimation</span><span class="PUNC">(</span><span class="STRN">"__default"</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">/</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.setAnimationWeight</span><span class="PUNC">(</span><span class="STRN">"__default"</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.MorphBlendMesh.prototype</span><span class="PUNC">=</span><span class="NAME">Object.create</span><span class="PUNC">(</span><span class="NAME">THREE.Mesh.prototype</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>684</span> </span><span class="NAME">THREE.MorphBlendMesh.prototype.createAnimation</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">b</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="NAME">startFrame</span><span class="PUNC">:</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">endFrame</span><span class="PUNC">:</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">length</span><span class="PUNC">:</span><span class="NAME">c</span><span class="PUNC">-</span><span class="NAME">b</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">fps</span><span class="PUNC">:</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">duration</span><span class="PUNC">:</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">-</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">/</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">lastFrame</span><span class="PUNC">:</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">currentFrame</span><span class="PUNC">:</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">active</span><span class="PUNC">:</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">time</span><span class="PUNC">:</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">direction</span><span class="PUNC">:</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">weight</span><span class="PUNC">:</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">directionBackwards</span><span class="PUNC">:</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">mirroredLoop</span><span class="PUNC">:</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">this.animationsMap</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">;</span><span class="NAME">this.animationsList.push</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>685</span> </span><span class="NAME">THREE.MorphBlendMesh.prototype.autoCreateAnimations</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="REGX">/([a-z]+)(\d+)/</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">this.geometry</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">e.morphTargets.length</span><span class="PUNC">;</span><span class="NAME">f</span><span class="PUNC">&lt;</span><span class="NAME">h</span><span class="PUNC">;</span><span class="NAME">f</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">e.morphTargets</span><span class="PUNC">[</span><span class="NAME">f</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">name.match</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">g</span><span class="PUNC">&&</span><span class="NUMB">1</span><span class="PUNC">&lt;</span><span class="NAME">g.length</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">=</span><span class="NAME">g</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">||</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="NAME">start</span><span class="PUNC">:</span><span class="NAME">Infinity</span><span class="PUNC">,</span><span class="NAME">end</span><span class="PUNC">:</span><span class="PUNC">-</span><span class="NAME">Infinity</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">f</span><span class="PUNC">&lt;</span><span class="NAME">g.start</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">g.start</span><span class="PUNC">=</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">f</span><span class="PUNC">></span><span class="NAME">g.end</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">g.end</span><span class="PUNC">=</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">||</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">i</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">i</span><span class="WHIT"> </span><span class="KEYW">in</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">)</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">d</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">this.createAnimation</span><span class="PUNC">(</span><span class="NAME">i</span><span class="PUNC">,</span><span class="NAME">g.start</span><span class="PUNC">,</span><span class="NAME">g.end</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.firstAnimation</span><span class="PUNC">=</span><span class="NAME">c</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>686</span> </span><span class="NAME">THREE.MorphBlendMesh.prototype.setAnimationDirectionForward</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">this.animationsMap</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="NAME">a.direction</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">a.directionBackwards</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.MorphBlendMesh.prototype.setAnimationDirectionBackward</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">this.animationsMap</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="NAME">a.direction</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">a.directionBackwards</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.MorphBlendMesh.prototype.setAnimationFPS</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.animationsMap</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">c.fps</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c.duration</span><span class="PUNC">=</span><span class="PUNC">(</span><span class="NAME">c.end</span><span class="PUNC">-</span><span class="NAME">c.start</span><span class="PUNC">)</span><span class="PUNC">/</span><span class="NAME">c.fps</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>687</span> </span><span class="NAME">THREE.MorphBlendMesh.prototype.setAnimationDuration</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.animationsMap</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">c.duration</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c.fps</span><span class="PUNC">=</span><span class="PUNC">(</span><span class="NAME">c.end</span><span class="PUNC">-</span><span class="NAME">c.start</span><span class="PUNC">)</span><span class="PUNC">/</span><span class="NAME">c.duration</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.MorphBlendMesh.prototype.setAnimationWeight</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.animationsMap</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">c.weight</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.MorphBlendMesh.prototype.setAnimationTime</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.animationsMap</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">c.time</span><span class="PUNC">=</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.MorphBlendMesh.prototype.getAnimationTime</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">this.animationsMap</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">a.time</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>688</span> </span><span class="NAME">THREE.MorphBlendMesh.prototype.getAnimationDuration</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">this.animationsMap</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">a.duration</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.MorphBlendMesh.prototype.playAnimation</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">this.animationsMap</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">?</span><span class="PUNC">(</span><span class="NAME">b.time</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">b.active</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">console.warn</span><span class="PUNC">(</span><span class="STRN">"animation["</span><span class="PUNC">+</span><span class="NAME">a</span><span class="PUNC">+</span><span class="STRN">"] undefined"</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.MorphBlendMesh.prototype.stopAnimation</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">this.animationsMap</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="NAME">a.active</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>689</span> </span><span class="NAME">THREE.MorphBlendMesh.prototype.update</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">this.animationsList.length</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">&lt;</span><span class="NAME">c</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">this.animationsList</span><span class="PUNC">[</span><span class="NAME">b</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">d.active</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">d.duration</span><span class="PUNC">/</span><span class="NAME">d.length</span><span class="PUNC">;</span><span class="NAME">d.time</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">d.direction</span><span class="PUNC">*</span><span class="NAME">a</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">d.mirroredLoop</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">d.time</span><span class="PUNC">></span><span class="NAME">d.duration</span><span class="PUNC">||</span><span class="NUMB">0</span><span class="PUNC">></span><span class="NAME">d.time</span><span class="PUNC">)</span><span class="NAME">d.direction</span><span class="PUNC">*</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">d.time</span><span class="PUNC">></span><span class="NAME">d.duration</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">d.time</span><span class="PUNC">=</span><span class="NAME">d.duration</span><span class="PUNC">,</span><span class="NAME">d.directionBackwards</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">></span><span class="NAME">d.time</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">d.time</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">d.directionBackwards</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="NAME">d.time</span><span class="PUNC">%</span><span class="PUNC">=</span><span class="NAME">d.duration</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">></span><span class="NAME">d.time</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">d.time</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NAME">d.duration</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">d.startFrame</span><span class="PUNC">+</span><span class="NAME">THREE.Math.clamp</span><span class="PUNC">(</span><span class="NAME">Math.floor</span><span class="PUNC">(</span><span class="NAME">d.time</span><span class="PUNC">/</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">d.length</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">d.weight</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>690</span> </span><span class="NAME">f</span><span class="PUNC">!==</span><span class="NAME">d.currentFrame</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">this.morphTargetInfluences</span><span class="PUNC">[</span><span class="NAME">d.lastFrame</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">this.morphTargetInfluences</span><span class="PUNC">[</span><span class="NAME">d.currentFrame</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">*</span><span class="NAME">h</span><span class="PUNC">,</span><span class="NAME">this.morphTargetInfluences</span><span class="PUNC">[</span><span class="NAME">f</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">d.lastFrame</span><span class="PUNC">=</span><span class="NAME">d.currentFrame</span><span class="PUNC">,</span><span class="NAME">d.currentFrame</span><span class="PUNC">=</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">d.time</span><span class="PUNC">%</span><span class="NAME">e</span><span class="PUNC">/</span><span class="NAME">e</span><span class="PUNC">;</span><span class="NAME">d.directionBackwards</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">-</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">this.morphTargetInfluences</span><span class="PUNC">[</span><span class="NAME">d.currentFrame</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">e</span><span class="PUNC">*</span><span class="NAME">h</span><span class="PUNC">;</span><span class="NAME">this.morphTargetInfluences</span><span class="PUNC">[</span><span class="NAME">d.lastFrame</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="PUNC">(</span><span class="NUMB">1</span><span class="PUNC">-</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">h</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.LensFlarePlugin</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">b.createProgram</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">b.createShader</span><span class="PUNC">(</span><span class="NAME">b.FRAGMENT_SHADER</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NAME">b.createShader</span><span class="PUNC">(</span><span class="NAME">b.VERTEX_SHADER</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">=</span><span class="STRN">"precision "</span><span class="PUNC">+</span><span class="NAME">c</span><span class="PUNC">+</span><span class="STRN">" float;\n"</span><span class="PUNC">;</span><span class="NAME">b.shaderSource</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">+</span><span class="NAME">a.fragmentShader</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b.shaderSource</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">+</span><span class="NAME">a.vertexShader</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b.compileShader</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b.compileShader</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b.attachShader</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b.attachShader</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b.linkProgram</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">d</span><span class="PUNC">}</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">,</span><span class="NAME">j</span><span class="PUNC">,</span><span class="NAME">l</span><span class="PUNC">,</span><span class="NAME">m</span><span class="PUNC">,</span><span class="NAME">n</span><span class="PUNC">,</span><span class="NAME">p</span><span class="PUNC">;</span><span class="NAME">this.init</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">t</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">t.context</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">t</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">t.getPrecision</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Float32Array</span><span class="PUNC">(</span><span class="NUMB">16</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">f</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Uint16Array</span><span class="PUNC">(</span><span class="NUMB">6</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">t</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">[</span><span class="NAME">t</span><span class="PUNC">++</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">[</span><span class="NAME">t</span><span class="PUNC">++</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>691</span> </span><span class="NAME">e</span><span class="PUNC">[</span><span class="NAME">t</span><span class="PUNC">++</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">[</span><span class="NAME">t</span><span class="PUNC">++</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">[</span><span class="NAME">t</span><span class="PUNC">++</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">[</span><span class="NAME">t</span><span class="PUNC">++</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">[</span><span class="NAME">t</span><span class="PUNC">++</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">[</span><span class="NAME">t</span><span class="PUNC">++</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">[</span><span class="NAME">t</span><span class="PUNC">++</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">[</span><span class="NAME">t</span><span class="PUNC">++</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">[</span><span class="NAME">t</span><span class="PUNC">++</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">[</span><span class="NAME">t</span><span class="PUNC">++</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">[</span><span class="NAME">t</span><span class="PUNC">++</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">[</span><span class="NAME">t</span><span class="PUNC">++</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">[</span><span class="NAME">t</span><span class="PUNC">++</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">[</span><span class="NAME">t</span><span class="PUNC">++</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">t</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">f</span><span class="PUNC">[</span><span class="NAME">t</span><span class="PUNC">++</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">f</span><span class="PUNC">[</span><span class="NAME">t</span><span class="PUNC">++</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">f</span><span class="PUNC">[</span><span class="NAME">t</span><span class="PUNC">++</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NUMB">2</span><span class="PUNC">;</span><span class="NAME">f</span><span class="PUNC">[</span><span class="NAME">t</span><span class="PUNC">++</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">f</span><span class="PUNC">[</span><span class="NAME">t</span><span class="PUNC">++</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NUMB">2</span><span class="PUNC">;</span><span class="NAME">f</span><span class="PUNC">[</span><span class="NAME">t</span><span class="PUNC">++</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NUMB">3</span><span class="PUNC">;</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">b.createBuffer</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">b.createBuffer</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b.bindBuffer</span><span class="PUNC">(</span><span class="NAME">b.ARRAY_BUFFER</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b.bufferData</span><span class="PUNC">(</span><span class="NAME">b.ARRAY_BUFFER</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">b.STATIC_DRAW</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b.bindBuffer</span><span class="PUNC">(</span><span class="NAME">b.ELEMENT_ARRAY_BUFFER</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b.bufferData</span><span class="PUNC">(</span><span class="NAME">b.ELEMENT_ARRAY_BUFFER</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">b.STATIC_DRAW</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">i</span><span class="PUNC">=</span><span class="NAME">b.createTexture</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">j</span><span class="PUNC">=</span><span class="NAME">b.createTexture</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b.bindTexture</span><span class="PUNC">(</span><span class="NAME">b.TEXTURE_2D</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b.texImage2D</span><span class="PUNC">(</span><span class="NAME">b.TEXTURE_2D</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">b.RGB</span><span class="PUNC">,</span><span class="NUMB">16</span><span class="PUNC">,</span><span class="NUMB">16</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>692</span> </span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">b.RGB</span><span class="PUNC">,</span><span class="NAME">b.UNSIGNED_BYTE</span><span class="PUNC">,</span><span class="KEYW">null</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b.texParameteri</span><span class="PUNC">(</span><span class="NAME">b.TEXTURE_2D</span><span class="PUNC">,</span><span class="NAME">b.TEXTURE_WRAP_S</span><span class="PUNC">,</span><span class="NAME">b.CLAMP_TO_EDGE</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b.texParameteri</span><span class="PUNC">(</span><span class="NAME">b.TEXTURE_2D</span><span class="PUNC">,</span><span class="NAME">b.TEXTURE_WRAP_T</span><span class="PUNC">,</span><span class="NAME">b.CLAMP_TO_EDGE</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b.texParameteri</span><span class="PUNC">(</span><span class="NAME">b.TEXTURE_2D</span><span class="PUNC">,</span><span class="NAME">b.TEXTURE_MAG_FILTER</span><span class="PUNC">,</span><span class="NAME">b.NEAREST</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b.texParameteri</span><span class="PUNC">(</span><span class="NAME">b.TEXTURE_2D</span><span class="PUNC">,</span><span class="NAME">b.TEXTURE_MIN_FILTER</span><span class="PUNC">,</span><span class="NAME">b.NEAREST</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b.bindTexture</span><span class="PUNC">(</span><span class="NAME">b.TEXTURE_2D</span><span class="PUNC">,</span><span class="NAME">j</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b.texImage2D</span><span class="PUNC">(</span><span class="NAME">b.TEXTURE_2D</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">b.RGBA</span><span class="PUNC">,</span><span class="NUMB">16</span><span class="PUNC">,</span><span class="NUMB">16</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">b.RGBA</span><span class="PUNC">,</span><span class="NAME">b.UNSIGNED_BYTE</span><span class="PUNC">,</span><span class="KEYW">null</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b.texParameteri</span><span class="PUNC">(</span><span class="NAME">b.TEXTURE_2D</span><span class="PUNC">,</span><span class="NAME">b.TEXTURE_WRAP_S</span><span class="PUNC">,</span><span class="NAME">b.CLAMP_TO_EDGE</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b.texParameteri</span><span class="PUNC">(</span><span class="NAME">b.TEXTURE_2D</span><span class="PUNC">,</span><span class="NAME">b.TEXTURE_WRAP_T</span><span class="PUNC">,</span><span class="NAME">b.CLAMP_TO_EDGE</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>693</span> </span><span class="NAME">b.texParameteri</span><span class="PUNC">(</span><span class="NAME">b.TEXTURE_2D</span><span class="PUNC">,</span><span class="NAME">b.TEXTURE_MAG_FILTER</span><span class="PUNC">,</span><span class="NAME">b.NEAREST</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b.texParameteri</span><span class="PUNC">(</span><span class="NAME">b.TEXTURE_2D</span><span class="PUNC">,</span><span class="NAME">b.TEXTURE_MIN_FILTER</span><span class="PUNC">,</span><span class="NAME">b.NEAREST</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NUMB">0</span><span class="PUNC">>=</span><span class="NAME">b.getParameter</span><span class="PUNC">(</span><span class="NAME">b.MAX_VERTEX_TEXTURE_IMAGE_UNITS</span><span class="PUNC">)</span><span class="PUNC">?</span><span class="PUNC">(</span><span class="NAME">l</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">m</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">(</span><span class="NAME">THREE.ShaderFlares.lensFlare</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="PUNC">(</span><span class="NAME">l</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">m</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">(</span><span class="NAME">THREE.ShaderFlares.lensFlareVertexTexture</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">n</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">p</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">n.vertex</span><span class="PUNC">=</span><span class="NAME">b.getAttribLocation</span><span class="PUNC">(</span><span class="NAME">m</span><span class="PUNC">,</span><span class="STRN">"position"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">n.uv</span><span class="PUNC">=</span><span class="NAME">b.getAttribLocation</span><span class="PUNC">(</span><span class="NAME">m</span><span class="PUNC">,</span><span class="STRN">"uv"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">p.renderType</span><span class="PUNC">=</span><span class="NAME">b.getUniformLocation</span><span class="PUNC">(</span><span class="NAME">m</span><span class="PUNC">,</span><span class="STRN">"renderType"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">p.map</span><span class="PUNC">=</span><span class="NAME">b.getUniformLocation</span><span class="PUNC">(</span><span class="NAME">m</span><span class="PUNC">,</span><span class="STRN">"map"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">p.occlusionMap</span><span class="PUNC">=</span><span class="NAME">b.getUniformLocation</span><span class="PUNC">(</span><span class="NAME">m</span><span class="PUNC">,</span><span class="STRN">"occlusionMap"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">p.opacity</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>694</span> </span><span class="NAME">b.getUniformLocation</span><span class="PUNC">(</span><span class="NAME">m</span><span class="PUNC">,</span><span class="STRN">"opacity"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">p.color</span><span class="PUNC">=</span><span class="NAME">b.getUniformLocation</span><span class="PUNC">(</span><span class="NAME">m</span><span class="PUNC">,</span><span class="STRN">"color"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">p.scale</span><span class="PUNC">=</span><span class="NAME">b.getUniformLocation</span><span class="PUNC">(</span><span class="NAME">m</span><span class="PUNC">,</span><span class="STRN">"scale"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">p.rotation</span><span class="PUNC">=</span><span class="NAME">b.getUniformLocation</span><span class="PUNC">(</span><span class="NAME">m</span><span class="PUNC">,</span><span class="STRN">"rotation"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">p.screenPosition</span><span class="PUNC">=</span><span class="NAME">b.getUniformLocation</span><span class="PUNC">(</span><span class="NAME">m</span><span class="PUNC">,</span><span class="STRN">"screenPosition"</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">this.render</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">a.__webglFlares</span><span class="PUNC">,</span><span class="NAME">v</span><span class="PUNC">=</span><span class="NAME">a.length</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">v</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">z</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">,</span><span class="NAME">C</span><span class="PUNC">=</span><span class="NAME">f</span><span class="PUNC">/</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">F</span><span class="PUNC">=</span><span class="NUMB">0.5</span><span class="PUNC">*</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">H</span><span class="PUNC">=</span><span class="NUMB">0.5</span><span class="PUNC">*</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">I</span><span class="PUNC">=</span><span class="NUMB">16</span><span class="PUNC">/</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">G</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector2</span><span class="PUNC">(</span><span class="NAME">I</span><span class="PUNC">*</span><span class="NAME">C</span><span class="PUNC">,</span><span class="NAME">I</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">A</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">(</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">K</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector2</span><span class="PUNC">(</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">B</span><span class="PUNC">=</span><span class="NAME">p</span><span class="PUNC">,</span><span class="NAME">I</span><span class="PUNC">=</span><span class="NAME">n</span><span class="PUNC">;</span><span class="NAME">b.useProgram</span><span class="PUNC">(</span><span class="NAME">m</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b.enableVertexAttribArray</span><span class="PUNC">(</span><span class="NAME">n.vertex</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b.enableVertexAttribArray</span><span class="PUNC">(</span><span class="NAME">n.uv</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>695</span> </span><span class="NAME">b.uniform1i</span><span class="PUNC">(</span><span class="NAME">B.occlusionMap</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b.uniform1i</span><span class="PUNC">(</span><span class="NAME">B.map</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b.bindBuffer</span><span class="PUNC">(</span><span class="NAME">b.ARRAY_BUFFER</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b.vertexAttribPointer</span><span class="PUNC">(</span><span class="NAME">I.vertex</span><span class="PUNC">,</span><span class="NUMB">2</span><span class="PUNC">,</span><span class="NAME">b.FLOAT</span><span class="PUNC">,</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NUMB">16</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b.vertexAttribPointer</span><span class="PUNC">(</span><span class="NAME">I.uv</span><span class="PUNC">,</span><span class="NUMB">2</span><span class="PUNC">,</span><span class="NAME">b.FLOAT</span><span class="PUNC">,</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NUMB">16</span><span class="PUNC">,</span><span class="NUMB">8</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b.bindBuffer</span><span class="PUNC">(</span><span class="NAME">b.ELEMENT_ARRAY_BUFFER</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b.disable</span><span class="PUNC">(</span><span class="NAME">b.CULL_FACE</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b.depthMask</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">J</span><span class="PUNC">,</span><span class="NAME">N</span><span class="PUNC">,</span><span class="NAME">y</span><span class="PUNC">,</span><span class="NAME">M</span><span class="PUNC">,</span><span class="NAME">w</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">J</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">J</span><span class="PUNC">&lt;</span><span class="NAME">v</span><span class="PUNC">;</span><span class="NAME">J</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">I</span><span class="PUNC">=</span><span class="NUMB">16</span><span class="PUNC">/</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">G.set</span><span class="PUNC">(</span><span class="NAME">I</span><span class="PUNC">*</span><span class="NAME">C</span><span class="PUNC">,</span><span class="NAME">I</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">M</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">[</span><span class="NAME">J</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">z.set</span><span class="PUNC">(</span><span class="NAME">M.matrixWorld.elements</span><span class="PUNC">[</span><span class="NUMB">12</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">M.matrixWorld.elements</span><span class="PUNC">[</span><span class="NUMB">13</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">M.matrixWorld.elements</span><span class="PUNC">[</span><span class="NUMB">14</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">z.applyMatrix4</span><span class="PUNC">(</span><span class="NAME">d.matrixWorldInverse</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">z.applyProjection</span><span class="PUNC">(</span><span class="NAME">d.projectionMatrix</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">A.copy</span><span class="PUNC">(</span><span class="NAME">z</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">K.x</span><span class="PUNC">=</span><span class="NAME">A.x</span><span class="PUNC">*</span><span class="NAME">F</span><span class="PUNC">+</span><span class="NAME">F</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>696</span> </span><span class="NAME">K.y</span><span class="PUNC">=</span><span class="NAME">A.y</span><span class="PUNC">*</span><span class="NAME">H</span><span class="PUNC">+</span><span class="NAME">H</span><span class="PUNC">,</span><span class="NAME">l</span><span class="PUNC">||</span><span class="NUMB">0</span><span class="PUNC">&lt;</span><span class="NAME">K.x</span><span class="PUNC">&&</span><span class="NAME">K.x</span><span class="PUNC">&lt;</span><span class="NAME">e</span><span class="PUNC">&&</span><span class="NUMB">0</span><span class="PUNC">&lt;</span><span class="NAME">K.y</span><span class="PUNC">&&</span><span class="NAME">K.y</span><span class="PUNC">&lt;</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">b.activeTexture</span><span class="PUNC">(</span><span class="NAME">b.TEXTURE1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b.bindTexture</span><span class="PUNC">(</span><span class="NAME">b.TEXTURE_2D</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b.copyTexImage2D</span><span class="PUNC">(</span><span class="NAME">b.TEXTURE_2D</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">b.RGB</span><span class="PUNC">,</span><span class="NAME">K.x</span><span class="PUNC">-</span><span class="NUMB">8</span><span class="PUNC">,</span><span class="NAME">K.y</span><span class="PUNC">-</span><span class="NUMB">8</span><span class="PUNC">,</span><span class="NUMB">16</span><span class="PUNC">,</span><span class="NUMB">16</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b.uniform1i</span><span class="PUNC">(</span><span class="NAME">B.renderType</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b.uniform2f</span><span class="PUNC">(</span><span class="NAME">B.scale</span><span class="PUNC">,</span><span class="NAME">G.x</span><span class="PUNC">,</span><span class="NAME">G.y</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b.uniform3f</span><span class="PUNC">(</span><span class="NAME">B.screenPosition</span><span class="PUNC">,</span><span class="NAME">A.x</span><span class="PUNC">,</span><span class="NAME">A.y</span><span class="PUNC">,</span><span class="NAME">A.z</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b.disable</span><span class="PUNC">(</span><span class="NAME">b.BLEND</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b.enable</span><span class="PUNC">(</span><span class="NAME">b.DEPTH_TEST</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b.drawElements</span><span class="PUNC">(</span><span class="NAME">b.TRIANGLES</span><span class="PUNC">,</span><span class="NUMB">6</span><span class="PUNC">,</span><span class="NAME">b.UNSIGNED_SHORT</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b.activeTexture</span><span class="PUNC">(</span><span class="NAME">b.TEXTURE0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b.bindTexture</span><span class="PUNC">(</span><span class="NAME">b.TEXTURE_2D</span><span class="PUNC">,</span><span class="NAME">j</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b.copyTexImage2D</span><span class="PUNC">(</span><span class="NAME">b.TEXTURE_2D</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">b.RGBA</span><span class="PUNC">,</span><span class="NAME">K.x</span><span class="PUNC">-</span><span class="NUMB">8</span><span class="PUNC">,</span><span class="NAME">K.y</span><span class="PUNC">-</span><span class="NUMB">8</span><span class="PUNC">,</span><span class="NUMB">16</span><span class="PUNC">,</span><span class="NUMB">16</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b.uniform1i</span><span class="PUNC">(</span><span class="NAME">B.renderType</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b.disable</span><span class="PUNC">(</span><span class="NAME">b.DEPTH_TEST</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>697</span> </span><span class="NAME">b.activeTexture</span><span class="PUNC">(</span><span class="NAME">b.TEXTURE1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b.bindTexture</span><span class="PUNC">(</span><span class="NAME">b.TEXTURE_2D</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b.drawElements</span><span class="PUNC">(</span><span class="NAME">b.TRIANGLES</span><span class="PUNC">,</span><span class="NUMB">6</span><span class="PUNC">,</span><span class="NAME">b.UNSIGNED_SHORT</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">M.positionScreen.copy</span><span class="PUNC">(</span><span class="NAME">A</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">M.customUpdateCallback</span><span class="PUNC">?</span><span class="NAME">M.customUpdateCallback</span><span class="PUNC">(</span><span class="NAME">M</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">M.updateLensFlares</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b.uniform1i</span><span class="PUNC">(</span><span class="NAME">B.renderType</span><span class="PUNC">,</span><span class="NUMB">2</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b.enable</span><span class="PUNC">(</span><span class="NAME">b.BLEND</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">N</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">y</span><span class="PUNC">=</span><span class="NAME">M.lensFlares.length</span><span class="PUNC">;</span><span class="NAME">N</span><span class="PUNC">&lt;</span><span class="NAME">y</span><span class="PUNC">;</span><span class="NAME">N</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">w</span><span class="PUNC">=</span><span class="NAME">M.lensFlares</span><span class="PUNC">[</span><span class="NAME">N</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NUMB">0.001</span><span class="PUNC">&lt;</span><span class="NAME">w.opacity</span><span class="PUNC">&&</span><span class="NUMB">0.001</span><span class="PUNC">&lt;</span><span class="NAME">w.scale</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">A.x</span><span class="PUNC">=</span><span class="NAME">w.x</span><span class="PUNC">,</span><span class="NAME">A.y</span><span class="PUNC">=</span><span class="NAME">w.y</span><span class="PUNC">,</span><span class="NAME">A.z</span><span class="PUNC">=</span><span class="NAME">w.z</span><span class="PUNC">,</span><span class="NAME">I</span><span class="PUNC">=</span><span class="NAME">w.size</span><span class="PUNC">*</span><span class="NAME">w.scale</span><span class="PUNC">/</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">G.x</span><span class="PUNC">=</span><span class="NAME">I</span><span class="PUNC">*</span><span class="NAME">C</span><span class="PUNC">,</span><span class="NAME">G.y</span><span class="PUNC">=</span><span class="NAME">I</span><span class="PUNC">,</span><span class="NAME">b.uniform3f</span><span class="PUNC">(</span><span class="NAME">B.screenPosition</span><span class="PUNC">,</span><span class="NAME">A.x</span><span class="PUNC">,</span><span class="NAME">A.y</span><span class="PUNC">,</span><span class="NAME">A.z</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">b.uniform2f</span><span class="PUNC">(</span><span class="NAME">B.scale</span><span class="PUNC">,</span><span class="NAME">G.x</span><span class="PUNC">,</span><span class="NAME">G.y</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">b.uniform1f</span><span class="PUNC">(</span><span class="NAME">B.rotation</span><span class="PUNC">,</span><span class="NAME">w.rotation</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">b.uniform1f</span><span class="PUNC">(</span><span class="NAME">B.opacity</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>698</span> </span><span class="NAME">w.opacity</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">b.uniform3f</span><span class="PUNC">(</span><span class="NAME">B.color</span><span class="PUNC">,</span><span class="NAME">w.color.r</span><span class="PUNC">,</span><span class="NAME">w.color.g</span><span class="PUNC">,</span><span class="NAME">w.color.b</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">c.setBlending</span><span class="PUNC">(</span><span class="NAME">w.blending</span><span class="PUNC">,</span><span class="NAME">w.blendEquation</span><span class="PUNC">,</span><span class="NAME">w.blendSrc</span><span class="PUNC">,</span><span class="NAME">w.blendDst</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">c.setTexture</span><span class="PUNC">(</span><span class="NAME">w.texture</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">b.drawElements</span><span class="PUNC">(</span><span class="NAME">b.TRIANGLES</span><span class="PUNC">,</span><span class="NUMB">6</span><span class="PUNC">,</span><span class="NAME">b.UNSIGNED_SHORT</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="NAME">b.enable</span><span class="PUNC">(</span><span class="NAME">b.CULL_FACE</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b.enable</span><span class="PUNC">(</span><span class="NAME">b.DEPTH_TEST</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b.depthMask</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.ShadowMapPlugin</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Frustum</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Matrix4</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">,</span><span class="NAME">j</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">,</span><span class="NAME">l</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">;</span><span class="NAME">this.init</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">g</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">g.context</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">g</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">THREE.ShaderLib.depthRGBA</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">THREE.UniformsUtils.clone</span><span class="PUNC">(</span><span class="NAME">g.uniforms</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.ShaderMaterial</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">fragmentShader</span><span class="PUNC">:</span><span class="NAME">g.fragmentShader</span><span class="PUNC">,</span><span class="NAME">vertexShader</span><span class="PUNC">:</span><span class="NAME">g.vertexShader</span><span class="PUNC">,</span><span class="NAME">uniforms</span><span class="PUNC">:</span><span class="NAME">h</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.ShaderMaterial</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">fragmentShader</span><span class="PUNC">:</span><span class="NAME">g.fragmentShader</span><span class="PUNC">,</span><span class="NAME">vertexShader</span><span class="PUNC">:</span><span class="NAME">g.vertexShader</span><span class="PUNC">,</span><span class="NAME">uniforms</span><span class="PUNC">:</span><span class="NAME">h</span><span class="PUNC">,</span><span class="NAME">morphTargets</span><span class="PUNC">:</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.ShaderMaterial</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">fragmentShader</span><span class="PUNC">:</span><span class="NAME">g.fragmentShader</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>699</span> </span><span class="NAME">vertexShader</span><span class="PUNC">:</span><span class="NAME">g.vertexShader</span><span class="PUNC">,</span><span class="NAME">uniforms</span><span class="PUNC">:</span><span class="NAME">h</span><span class="PUNC">,</span><span class="NAME">skinning</span><span class="PUNC">:</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">f</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.ShaderMaterial</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">fragmentShader</span><span class="PUNC">:</span><span class="NAME">g.fragmentShader</span><span class="PUNC">,</span><span class="NAME">vertexShader</span><span class="PUNC">:</span><span class="NAME">g.vertexShader</span><span class="PUNC">,</span><span class="NAME">uniforms</span><span class="PUNC">:</span><span class="NAME">h</span><span class="PUNC">,</span><span class="NAME">morphTargets</span><span class="PUNC">:</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">skinning</span><span class="PUNC">:</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">c._shadowPass</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">d._shadowPass</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">e._shadowPass</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">f._shadowPass</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">this.render</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">b.shadowMapEnabled</span><span class="PUNC">&&</span><span class="NAME">b.shadowMapAutoUpdate</span><span class="PUNC">&&</span><span class="NAME">this.update</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">this.update</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">m</span><span class="PUNC">,</span><span class="NAME">n</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">p</span><span class="PUNC">,</span><span class="NAME">t</span><span class="PUNC">,</span><span class="NAME">q</span><span class="PUNC">,</span><span class="NAME">r</span><span class="PUNC">,</span><span class="NAME">s</span><span class="PUNC">,</span><span class="NAME">v</span><span class="PUNC">,</span><span class="NAME">z</span><span class="PUNC">,</span><span class="NAME">C</span><span class="PUNC">,</span><span class="NAME">F</span><span class="PUNC">,</span><span class="NAME">H</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">r</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">a.clearColor</span><span class="PUNC">(</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a.disable</span><span class="PUNC">(</span><span class="NAME">a.BLEND</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a.enable</span><span class="PUNC">(</span><span class="NAME">a.CULL_FACE</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a.frontFace</span><span class="PUNC">(</span><span class="NAME">a.CCW</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b.shadowMapCullFace</span><span class="PUNC">===</span><span class="NAME">THREE.CullFaceFront</span><span class="PUNC">?</span><span class="WHIT">
<span class='line'>700</span> </span><span class="NAME">a.cullFace</span><span class="PUNC">(</span><span class="NAME">a.FRONT</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">a.cullFace</span><span class="PUNC">(</span><span class="NAME">a.BACK</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b.setDepthTest</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">p</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">t</span><span class="PUNC">=</span><span class="NAME">m.__lights.length</span><span class="PUNC">;</span><span class="NAME">p</span><span class="PUNC">&lt;</span><span class="NAME">t</span><span class="PUNC">;</span><span class="NAME">p</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">q</span><span class="PUNC">=</span><span class="NAME">m.__lights</span><span class="PUNC">[</span><span class="NAME">p</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">q.castShadow</span><span class="PUNC">)</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">q</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">THREE.DirectionalLight</span><span class="PUNC">&&</span><span class="NAME">q.shadowCascade</span><span class="PUNC">)</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">s</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">s</span><span class="PUNC">&lt;</span><span class="NAME">q.shadowCascadeCount</span><span class="PUNC">;</span><span class="NAME">s</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">I</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">q.shadowCascadeArray</span><span class="PUNC">[</span><span class="NAME">s</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="NAME">I</span><span class="PUNC">=</span><span class="NAME">q.shadowCascadeArray</span><span class="PUNC">[</span><span class="NAME">s</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="KEYW">else</span><span class="PUNC">{</span><span class="NAME">F</span><span class="PUNC">=</span><span class="NAME">q</span><span class="PUNC">;</span><span class="NAME">z</span><span class="PUNC">=</span><span class="NAME">s</span><span class="PUNC">;</span><span class="NAME">I</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.DirectionalLight</span><span class="PUNC">;</span><span class="NAME">I.isVirtual</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">I.onlyShadow</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">I.castShadow</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">I.shadowCameraNear</span><span class="PUNC">=</span><span class="NAME">F.shadowCameraNear</span><span class="PUNC">;</span><span class="NAME">I.shadowCameraFar</span><span class="PUNC">=</span><span class="NAME">F.shadowCameraFar</span><span class="PUNC">;</span><span class="NAME">I.shadowCameraLeft</span><span class="PUNC">=</span><span class="NAME">F.shadowCameraLeft</span><span class="PUNC">;</span><span class="NAME">I.shadowCameraRight</span><span class="PUNC">=</span><span class="NAME">F.shadowCameraRight</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>701</span> </span><span class="NAME">I.shadowCameraBottom</span><span class="PUNC">=</span><span class="NAME">F.shadowCameraBottom</span><span class="PUNC">;</span><span class="NAME">I.shadowCameraTop</span><span class="PUNC">=</span><span class="NAME">F.shadowCameraTop</span><span class="PUNC">;</span><span class="NAME">I.shadowCameraVisible</span><span class="PUNC">=</span><span class="NAME">F.shadowCameraVisible</span><span class="PUNC">;</span><span class="NAME">I.shadowDarkness</span><span class="PUNC">=</span><span class="NAME">F.shadowDarkness</span><span class="PUNC">;</span><span class="NAME">I.shadowBias</span><span class="PUNC">=</span><span class="NAME">F.shadowCascadeBias</span><span class="PUNC">[</span><span class="NAME">z</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">I.shadowMapWidth</span><span class="PUNC">=</span><span class="NAME">F.shadowCascadeWidth</span><span class="PUNC">[</span><span class="NAME">z</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">I.shadowMapHeight</span><span class="PUNC">=</span><span class="NAME">F.shadowCascadeHeight</span><span class="PUNC">[</span><span class="NAME">z</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">I.pointsWorld</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">I.pointsFrustum</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">C</span><span class="PUNC">=</span><span class="NAME">I.pointsWorld</span><span class="PUNC">;</span><span class="NAME">v</span><span class="PUNC">=</span><span class="NAME">I.pointsFrustum</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">G</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NUMB">8</span><span class="PUNC">></span><span class="NAME">G</span><span class="PUNC">;</span><span class="NAME">G</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">C</span><span class="PUNC">[</span><span class="NAME">G</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">,</span><span class="NAME">v</span><span class="PUNC">[</span><span class="NAME">G</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector3</span><span class="PUNC">;</span><span class="NAME">C</span><span class="PUNC">=</span><span class="NAME">F.shadowCascadeNearZ</span><span class="PUNC">[</span><span class="NAME">z</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">F</span><span class="PUNC">=</span><span class="NAME">F.shadowCascadeFarZ</span><span class="PUNC">[</span><span class="NAME">z</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">v</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">set</span><span class="PUNC">(</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">C</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">v</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">set</span><span class="PUNC">(</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">C</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">v</span><span class="PUNC">[</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">set</span><span class="PUNC">(</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>702</span> </span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">C</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">v</span><span class="PUNC">[</span><span class="NUMB">3</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">set</span><span class="PUNC">(</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">C</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">v</span><span class="PUNC">[</span><span class="NUMB">4</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">set</span><span class="PUNC">(</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">F</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">v</span><span class="PUNC">[</span><span class="NUMB">5</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">set</span><span class="PUNC">(</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">F</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">v</span><span class="PUNC">[</span><span class="NUMB">6</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">set</span><span class="PUNC">(</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">F</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">v</span><span class="PUNC">[</span><span class="NUMB">7</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">set</span><span class="PUNC">(</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">F</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">I.originalCamera</span><span class="PUNC">=</span><span class="NAME">n</span><span class="PUNC">;</span><span class="NAME">v</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Gyroscope</span><span class="PUNC">;</span><span class="NAME">v.position</span><span class="PUNC">=</span><span class="NAME">q.shadowCascadeOffset</span><span class="PUNC">;</span><span class="NAME">v.add</span><span class="PUNC">(</span><span class="NAME">I</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">v.add</span><span class="PUNC">(</span><span class="NAME">I.target</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">n.add</span><span class="PUNC">(</span><span class="NAME">v</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">q.shadowCascadeArray</span><span class="PUNC">[</span><span class="NAME">s</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">I</span><span class="PUNC">;</span><span class="NAME">console.log</span><span class="PUNC">(</span><span class="STRN">"Created virtualLight"</span><span class="PUNC">,</span><span class="NAME">I</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="NAME">z</span><span class="PUNC">=</span><span class="NAME">q</span><span class="PUNC">;</span><span class="NAME">C</span><span class="PUNC">=</span><span class="NAME">s</span><span class="PUNC">;</span><span class="NAME">F</span><span class="PUNC">=</span><span class="NAME">z.shadowCascadeArray</span><span class="PUNC">[</span><span class="NAME">C</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">F.position.copy</span><span class="PUNC">(</span><span class="NAME">z.position</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">F.target.position.copy</span><span class="PUNC">(</span><span class="NAME">z.target.position</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">F.lookAt</span><span class="PUNC">(</span><span class="NAME">F.target</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">F.shadowCameraVisible</span><span class="PUNC">=</span><span class="NAME">z.shadowCameraVisible</span><span class="PUNC">;</span><span class="NAME">F.shadowDarkness</span><span class="PUNC">=</span><span class="NAME">z.shadowDarkness</span><span class="PUNC">;</span><span class="NAME">F.shadowBias</span><span class="PUNC">=</span><span class="NAME">z.shadowCascadeBias</span><span class="PUNC">[</span><span class="NAME">C</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">v</span><span class="PUNC">=</span><span class="NAME">z.shadowCascadeNearZ</span><span class="PUNC">[</span><span class="NAME">C</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>703</span> </span><span class="NAME">z</span><span class="PUNC">=</span><span class="NAME">z.shadowCascadeFarZ</span><span class="PUNC">[</span><span class="NAME">C</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">F</span><span class="PUNC">=</span><span class="NAME">F.pointsFrustum</span><span class="PUNC">;</span><span class="NAME">F</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">z</span><span class="PUNC">=</span><span class="NAME">v</span><span class="PUNC">;</span><span class="NAME">F</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">z</span><span class="PUNC">=</span><span class="NAME">v</span><span class="PUNC">;</span><span class="NAME">F</span><span class="PUNC">[</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">z</span><span class="PUNC">=</span><span class="NAME">v</span><span class="PUNC">;</span><span class="NAME">F</span><span class="PUNC">[</span><span class="NUMB">3</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">z</span><span class="PUNC">=</span><span class="NAME">v</span><span class="PUNC">;</span><span class="NAME">F</span><span class="PUNC">[</span><span class="NUMB">4</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">z</span><span class="PUNC">=</span><span class="NAME">z</span><span class="PUNC">;</span><span class="NAME">F</span><span class="PUNC">[</span><span class="NUMB">5</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">z</span><span class="PUNC">=</span><span class="NAME">z</span><span class="PUNC">;</span><span class="NAME">F</span><span class="PUNC">[</span><span class="NUMB">6</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">z</span><span class="PUNC">=</span><span class="NAME">z</span><span class="PUNC">;</span><span class="NAME">F</span><span class="PUNC">[</span><span class="NUMB">7</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">z</span><span class="PUNC">=</span><span class="NAME">z</span><span class="PUNC">;</span><span class="NAME">H</span><span class="PUNC">[</span><span class="NAME">r</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">I</span><span class="PUNC">;</span><span class="NAME">r</span><span class="PUNC">++</span><span class="PUNC">}</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="NAME">H</span><span class="PUNC">[</span><span class="NAME">r</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">q</span><span class="PUNC">,</span><span class="NAME">r</span><span class="PUNC">++</span><span class="PUNC">;</span><span class="NAME">p</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">t</span><span class="PUNC">=</span><span class="NAME">H.length</span><span class="PUNC">;</span><span class="NAME">p</span><span class="PUNC">&lt;</span><span class="NAME">t</span><span class="PUNC">;</span><span class="NAME">p</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">q</span><span class="PUNC">=</span><span class="NAME">H</span><span class="PUNC">[</span><span class="NAME">p</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">q.shadowMap</span><span class="PUNC">||</span><span class="PUNC">(</span><span class="NAME">s</span><span class="PUNC">=</span><span class="NAME">THREE.LinearFilter</span><span class="PUNC">,</span><span class="NAME">b.shadowMapType</span><span class="PUNC">===</span><span class="NAME">THREE.PCFSoftShadowMap</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">s</span><span class="PUNC">=</span><span class="NAME">THREE.NearestFilter</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">q.shadowMap</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.WebGLRenderTarget</span><span class="PUNC">(</span><span class="NAME">q.shadowMapWidth</span><span class="PUNC">,</span><span class="NAME">q.shadowMapHeight</span><span class="PUNC">,</span><span class="PUNC">{</span><span class="NAME">minFilter</span><span class="PUNC">:</span><span class="NAME">s</span><span class="PUNC">,</span><span class="NAME">magFilter</span><span class="PUNC">:</span><span class="NAME">s</span><span class="PUNC">,</span><span class="NAME">format</span><span class="PUNC">:</span><span class="NAME">THREE.RGBAFormat</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">q.shadowMapSize</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Vector2</span><span class="PUNC">(</span><span class="NAME">q.shadowMapWidth</span><span class="PUNC">,</span><span class="NAME">q.shadowMapHeight</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">q.shadowMatrix</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Matrix4</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>704</span> </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">q.shadowCamera</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">q</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">THREE.SpotLight</span><span class="PUNC">)</span><span class="NAME">q.shadowCamera</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.PerspectiveCamera</span><span class="PUNC">(</span><span class="NAME">q.shadowCameraFov</span><span class="PUNC">,</span><span class="NAME">q.shadowMapWidth</span><span class="PUNC">/</span><span class="NAME">q.shadowMapHeight</span><span class="PUNC">,</span><span class="NAME">q.shadowCameraNear</span><span class="PUNC">,</span><span class="NAME">q.shadowCameraFar</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">q</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">THREE.DirectionalLight</span><span class="PUNC">)</span><span class="NAME">q.shadowCamera</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.OrthographicCamera</span><span class="PUNC">(</span><span class="NAME">q.shadowCameraLeft</span><span class="PUNC">,</span><span class="NAME">q.shadowCameraRight</span><span class="PUNC">,</span><span class="NAME">q.shadowCameraTop</span><span class="PUNC">,</span><span class="NAME">q.shadowCameraBottom</span><span class="PUNC">,</span><span class="NAME">q.shadowCameraNear</span><span class="PUNC">,</span><span class="NAME">q.shadowCameraFar</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">else</span><span class="PUNC">{</span><span class="NAME">console.error</span><span class="PUNC">(</span><span class="STRN">"Unsupported light type for shadow"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">continue</span><span class="PUNC">}</span><span class="NAME">m.add</span><span class="PUNC">(</span><span class="NAME">q.shadowCamera</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">===</span><span class="NAME">m.autoUpdate</span><span class="PUNC">&&</span><span class="NAME">m.updateMatrixWorld</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="NAME">q.shadowCameraVisible</span><span class="PUNC">&&</span><span class="WHIT">
<span class='line'>705</span> </span><span class="PUNC">!</span><span class="NAME">q.cameraHelper</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">q.cameraHelper</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.CameraHelper</span><span class="PUNC">(</span><span class="NAME">q.shadowCamera</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">q.shadowCamera.add</span><span class="PUNC">(</span><span class="NAME">q.cameraHelper</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">q.isVirtual</span><span class="PUNC">&&</span><span class="NAME">I.originalCamera</span><span class="PUNC">==</span><span class="NAME">n</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">s</span><span class="PUNC">=</span><span class="NAME">n</span><span class="PUNC">;</span><span class="NAME">r</span><span class="PUNC">=</span><span class="NAME">q.shadowCamera</span><span class="PUNC">;</span><span class="NAME">v</span><span class="PUNC">=</span><span class="NAME">q.pointsFrustum</span><span class="PUNC">;</span><span class="NAME">F</span><span class="PUNC">=</span><span class="NAME">q.pointsWorld</span><span class="PUNC">;</span><span class="NAME">i.set</span><span class="PUNC">(</span><span class="NAME">Infinity</span><span class="PUNC">,</span><span class="NAME">Infinity</span><span class="PUNC">,</span><span class="NAME">Infinity</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">j.set</span><span class="PUNC">(</span><span class="PUNC">-</span><span class="NAME">Infinity</span><span class="PUNC">,</span><span class="PUNC">-</span><span class="NAME">Infinity</span><span class="PUNC">,</span><span class="PUNC">-</span><span class="NAME">Infinity</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">z</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NUMB">8</span><span class="PUNC">></span><span class="NAME">z</span><span class="PUNC">;</span><span class="NAME">z</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">C</span><span class="PUNC">=</span><span class="NAME">F</span><span class="PUNC">[</span><span class="NAME">z</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">C.copy</span><span class="PUNC">(</span><span class="NAME">v</span><span class="PUNC">[</span><span class="NAME">z</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">THREE.ShadowMapPlugin.__projector.unprojectVector</span><span class="PUNC">(</span><span class="NAME">C</span><span class="PUNC">,</span><span class="NAME">s</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">C.applyMatrix4</span><span class="PUNC">(</span><span class="NAME">r.matrixWorldInverse</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">C.x</span><span class="PUNC">&lt;</span><span class="NAME">i.x</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">i.x</span><span class="PUNC">=</span><span class="NAME">C.x</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">C.x</span><span class="PUNC">></span><span class="NAME">j.x</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">j.x</span><span class="PUNC">=</span><span class="NAME">C.x</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">C.y</span><span class="PUNC">&lt;</span><span class="NAME">i.y</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">i.y</span><span class="PUNC">=</span><span class="NAME">C.y</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">C.y</span><span class="PUNC">></span><span class="NAME">j.y</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">j.y</span><span class="PUNC">=</span><span class="NAME">C.y</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">C.z</span><span class="PUNC">&lt;</span><span class="NAME">i.z</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">i.z</span><span class="PUNC">=</span><span class="NAME">C.z</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">C.z</span><span class="PUNC">></span><span class="NAME">j.z</span><span class="PUNC">&&</span><span class="WHIT">
<span class='line'>706</span> </span><span class="PUNC">(</span><span class="NAME">j.z</span><span class="PUNC">=</span><span class="NAME">C.z</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">r.left</span><span class="PUNC">=</span><span class="NAME">i.x</span><span class="PUNC">;</span><span class="NAME">r.right</span><span class="PUNC">=</span><span class="NAME">j.x</span><span class="PUNC">;</span><span class="NAME">r.top</span><span class="PUNC">=</span><span class="NAME">j.y</span><span class="PUNC">;</span><span class="NAME">r.bottom</span><span class="PUNC">=</span><span class="NAME">i.y</span><span class="PUNC">;</span><span class="NAME">r.updateProjectionMatrix</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="NAME">r</span><span class="PUNC">=</span><span class="NAME">q.shadowMap</span><span class="PUNC">;</span><span class="NAME">v</span><span class="PUNC">=</span><span class="NAME">q.shadowMatrix</span><span class="PUNC">;</span><span class="NAME">s</span><span class="PUNC">=</span><span class="NAME">q.shadowCamera</span><span class="PUNC">;</span><span class="NAME">s.position.getPositionFromMatrix</span><span class="PUNC">(</span><span class="NAME">q.matrixWorld</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">l.getPositionFromMatrix</span><span class="PUNC">(</span><span class="NAME">q.target.matrixWorld</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">s.lookAt</span><span class="PUNC">(</span><span class="NAME">l</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">s.updateMatrixWorld</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">s.matrixWorldInverse.getInverse</span><span class="PUNC">(</span><span class="NAME">s.matrixWorld</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">q.cameraHelper</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">q.cameraHelper.visible</span><span class="PUNC">=</span><span class="NAME">q.shadowCameraVisible</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">q.shadowCameraVisible</span><span class="PUNC">&&</span><span class="NAME">q.cameraHelper.update</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">v.set</span><span class="PUNC">(</span><span class="NUMB">0.5</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0.5</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0.5</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0.5</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0.5</span><span class="PUNC">,</span><span class="NUMB">0.5</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">v.multiply</span><span class="PUNC">(</span><span class="NAME">s.projectionMatrix</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">v.multiply</span><span class="PUNC">(</span><span class="NAME">s.matrixWorldInverse</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>707</span> </span><span class="NAME">g.multiplyMatrices</span><span class="PUNC">(</span><span class="NAME">s.projectionMatrix</span><span class="PUNC">,</span><span class="NAME">s.matrixWorldInverse</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">h.setFromMatrix</span><span class="PUNC">(</span><span class="NAME">g</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b.setRenderTarget</span><span class="PUNC">(</span><span class="NAME">r</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b.clear</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">F</span><span class="PUNC">=</span><span class="NAME">m.__webglObjects</span><span class="PUNC">;</span><span class="NAME">q</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">r</span><span class="PUNC">=</span><span class="NAME">F.length</span><span class="PUNC">;</span><span class="NAME">q</span><span class="PUNC">&lt;</span><span class="NAME">r</span><span class="PUNC">;</span><span class="NAME">q</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">z</span><span class="PUNC">=</span><span class="NAME">F</span><span class="PUNC">[</span><span class="NAME">q</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">v</span><span class="PUNC">=</span><span class="NAME">z.object</span><span class="PUNC">,</span><span class="NAME">z.render</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">v.visible</span><span class="PUNC">&&</span><span class="NAME">v.castShadow</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="PUNC">(</span><span class="NAME">v</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">THREE.Mesh</span><span class="PUNC">||</span><span class="NAME">v</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">THREE.ParticleSystem</span><span class="PUNC">)</span><span class="PUNC">||</span><span class="PUNC">!</span><span class="NAME">v.frustumCulled</span><span class="PUNC">||</span><span class="NAME">h.intersectsObject</span><span class="PUNC">(</span><span class="NAME">v</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="NAME">v._modelViewMatrix.multiplyMatrices</span><span class="PUNC">(</span><span class="NAME">s.matrixWorldInverse</span><span class="PUNC">,</span><span class="NAME">v.matrixWorld</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">z.render</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">q</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">r</span><span class="PUNC">=</span><span class="NAME">F.length</span><span class="PUNC">;</span><span class="NAME">q</span><span class="PUNC">&lt;</span><span class="NAME">r</span><span class="PUNC">;</span><span class="NAME">q</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">z</span><span class="PUNC">=</span><span class="NAME">F</span><span class="PUNC">[</span><span class="NAME">q</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">z.render</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">v</span><span class="PUNC">=</span><span class="NAME">z.object</span><span class="PUNC">,</span><span class="NAME">z</span><span class="PUNC">=</span><span class="NAME">z.buffer</span><span class="PUNC">,</span><span class="NAME">G</span><span class="PUNC">=</span><span class="NAME">v.material</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">THREE.MeshFaceMaterial</span><span class="PUNC">?</span><span class="WHIT">
<span class='line'>708</span> </span><span class="NAME">v.material.materials</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">:</span><span class="NAME">v.material</span><span class="PUNC">,</span><span class="NAME">C</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">&lt;</span><span class="NAME">v.geometry.morphTargets.length</span><span class="PUNC">&&</span><span class="NAME">G.morphTargets</span><span class="PUNC">,</span><span class="NAME">G</span><span class="PUNC">=</span><span class="NAME">v</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">THREE.SkinnedMesh</span><span class="PUNC">&&</span><span class="NAME">G.skinning</span><span class="PUNC">,</span><span class="NAME">C</span><span class="PUNC">=</span><span class="NAME">v.customDepthMaterial</span><span class="PUNC">?</span><span class="NAME">v.customDepthMaterial</span><span class="PUNC">:</span><span class="NAME">G</span><span class="PUNC">?</span><span class="NAME">C</span><span class="PUNC">?</span><span class="NAME">f</span><span class="PUNC">:</span><span class="NAME">e</span><span class="PUNC">:</span><span class="NAME">C</span><span class="PUNC">?</span><span class="NAME">d</span><span class="PUNC">:</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">z</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">THREE.BufferGeometry</span><span class="PUNC">?</span><span class="NAME">b.renderBufferDirect</span><span class="PUNC">(</span><span class="NAME">s</span><span class="PUNC">,</span><span class="NAME">m.__lights</span><span class="PUNC">,</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">C</span><span class="PUNC">,</span><span class="NAME">z</span><span class="PUNC">,</span><span class="NAME">v</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">b.renderBuffer</span><span class="PUNC">(</span><span class="NAME">s</span><span class="PUNC">,</span><span class="NAME">m.__lights</span><span class="PUNC">,</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">C</span><span class="PUNC">,</span><span class="NAME">z</span><span class="PUNC">,</span><span class="NAME">v</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">F</span><span class="PUNC">=</span><span class="NAME">m.__webglObjectsImmediate</span><span class="PUNC">;</span><span class="NAME">q</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">r</span><span class="PUNC">=</span><span class="NAME">F.length</span><span class="PUNC">;</span><span class="NAME">q</span><span class="PUNC">&lt;</span><span class="NAME">r</span><span class="PUNC">;</span><span class="NAME">q</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">z</span><span class="PUNC">=</span><span class="NAME">F</span><span class="PUNC">[</span><span class="NAME">q</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">v</span><span class="PUNC">=</span><span class="NAME">z.object</span><span class="PUNC">,</span><span class="NAME">v.visible</span><span class="PUNC">&&</span><span class="NAME">v.castShadow</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">v._modelViewMatrix.multiplyMatrices</span><span class="PUNC">(</span><span class="NAME">s.matrixWorldInverse</span><span class="PUNC">,</span><span class="NAME">v.matrixWorld</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">b.renderImmediateObject</span><span class="PUNC">(</span><span class="NAME">s</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>709</span> </span><span class="NAME">m.__lights</span><span class="PUNC">,</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">v</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="NAME">p</span><span class="PUNC">=</span><span class="NAME">b.getClearColor</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">t</span><span class="PUNC">=</span><span class="NAME">b.getClearAlpha</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a.clearColor</span><span class="PUNC">(</span><span class="NAME">p.r</span><span class="PUNC">,</span><span class="NAME">p.g</span><span class="PUNC">,</span><span class="NAME">p.b</span><span class="PUNC">,</span><span class="NAME">t</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a.enable</span><span class="PUNC">(</span><span class="NAME">a.BLEND</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b.shadowMapCullFace</span><span class="PUNC">===</span><span class="NAME">THREE.CullFaceFront</span><span class="PUNC">&&</span><span class="NAME">a.cullFace</span><span class="PUNC">(</span><span class="NAME">a.BACK</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.ShadowMapPlugin.__projector</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Projector</span><span class="PUNC">;</span><span class="NAME">THREE.SpritePlugin</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a.z</span><span class="PUNC">!==</span><span class="NAME">b.z</span><span class="PUNC">?</span><span class="NAME">b.z</span><span class="PUNC">-</span><span class="NAME">a.z</span><span class="PUNC">:</span><span class="NAME">b.id</span><span class="PUNC">-</span><span class="NAME">a.id</span><span class="PUNC">}</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">,</span><span class="NAME">j</span><span class="PUNC">,</span><span class="NAME">l</span><span class="PUNC">;</span><span class="NAME">this.init</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">a.context</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">=</span><span class="NAME">a</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">=</span><span class="NAME">a.getPrecision</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Float32Array</span><span class="PUNC">(</span><span class="NUMB">16</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">f</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Uint16Array</span><span class="PUNC">(</span><span class="NUMB">6</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">++</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">++</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">++</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">++</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">++</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">++</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">++</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">++</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">++</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">++</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">++</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">++</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">++</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">++</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">++</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">++</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">f</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">++</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">f</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">++</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">f</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">++</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NUMB">2</span><span class="PUNC">;</span><span class="NAME">f</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">++</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">f</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">++</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NUMB">2</span><span class="PUNC">;</span><span class="NAME">f</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">++</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NUMB">3</span><span class="PUNC">;</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">b.createBuffer</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">b.createBuffer</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b.bindBuffer</span><span class="PUNC">(</span><span class="NAME">b.ARRAY_BUFFER</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b.bufferData</span><span class="PUNC">(</span><span class="NAME">b.ARRAY_BUFFER</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>710</span> </span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">b.STATIC_DRAW</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b.bindBuffer</span><span class="PUNC">(</span><span class="NAME">b.ELEMENT_ARRAY_BUFFER</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b.bufferData</span><span class="PUNC">(</span><span class="NAME">b.ELEMENT_ARRAY_BUFFER</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">b.STATIC_DRAW</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">THREE.ShaderSprite.sprite</span><span class="PUNC">,</span><span class="NAME">n</span><span class="PUNC">=</span><span class="NAME">b.createProgram</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">p</span><span class="PUNC">=</span><span class="NAME">b.createShader</span><span class="PUNC">(</span><span class="NAME">b.FRAGMENT_SHADER</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">t</span><span class="PUNC">=</span><span class="NAME">b.createShader</span><span class="PUNC">(</span><span class="NAME">b.VERTEX_SHADER</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">q</span><span class="PUNC">=</span><span class="STRN">"precision "</span><span class="PUNC">+</span><span class="NAME">d</span><span class="PUNC">+</span><span class="STRN">" float;\n"</span><span class="PUNC">;</span><span class="NAME">b.shaderSource</span><span class="PUNC">(</span><span class="NAME">p</span><span class="PUNC">,</span><span class="NAME">q</span><span class="PUNC">+</span><span class="NAME">a.fragmentShader</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b.shaderSource</span><span class="PUNC">(</span><span class="NAME">t</span><span class="PUNC">,</span><span class="NAME">q</span><span class="PUNC">+</span><span class="NAME">a.vertexShader</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b.compileShader</span><span class="PUNC">(</span><span class="NAME">p</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b.compileShader</span><span class="PUNC">(</span><span class="NAME">t</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b.attachShader</span><span class="PUNC">(</span><span class="NAME">n</span><span class="PUNC">,</span><span class="NAME">p</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b.attachShader</span><span class="PUNC">(</span><span class="NAME">n</span><span class="PUNC">,</span><span class="NAME">t</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b.linkProgram</span><span class="PUNC">(</span><span class="NAME">n</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">i</span><span class="PUNC">=</span><span class="NAME">n</span><span class="PUNC">;</span><span class="NAME">j</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">l</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">j.position</span><span class="PUNC">=</span><span class="NAME">b.getAttribLocation</span><span class="PUNC">(</span><span class="NAME">i</span><span class="PUNC">,</span><span class="STRN">"position"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">j.uv</span><span class="PUNC">=</span><span class="NAME">b.getAttribLocation</span><span class="PUNC">(</span><span class="NAME">i</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>711</span> </span><span class="STRN">"uv"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">l.uvOffset</span><span class="PUNC">=</span><span class="NAME">b.getUniformLocation</span><span class="PUNC">(</span><span class="NAME">i</span><span class="PUNC">,</span><span class="STRN">"uvOffset"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">l.uvScale</span><span class="PUNC">=</span><span class="NAME">b.getUniformLocation</span><span class="PUNC">(</span><span class="NAME">i</span><span class="PUNC">,</span><span class="STRN">"uvScale"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">l.rotation</span><span class="PUNC">=</span><span class="NAME">b.getUniformLocation</span><span class="PUNC">(</span><span class="NAME">i</span><span class="PUNC">,</span><span class="STRN">"rotation"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">l.scale</span><span class="PUNC">=</span><span class="NAME">b.getUniformLocation</span><span class="PUNC">(</span><span class="NAME">i</span><span class="PUNC">,</span><span class="STRN">"scale"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">l.alignment</span><span class="PUNC">=</span><span class="NAME">b.getUniformLocation</span><span class="PUNC">(</span><span class="NAME">i</span><span class="PUNC">,</span><span class="STRN">"alignment"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">l.color</span><span class="PUNC">=</span><span class="NAME">b.getUniformLocation</span><span class="PUNC">(</span><span class="NAME">i</span><span class="PUNC">,</span><span class="STRN">"color"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">l.map</span><span class="PUNC">=</span><span class="NAME">b.getUniformLocation</span><span class="PUNC">(</span><span class="NAME">i</span><span class="PUNC">,</span><span class="STRN">"map"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">l.opacity</span><span class="PUNC">=</span><span class="NAME">b.getUniformLocation</span><span class="PUNC">(</span><span class="NAME">i</span><span class="PUNC">,</span><span class="STRN">"opacity"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">l.useScreenCoordinates</span><span class="PUNC">=</span><span class="NAME">b.getUniformLocation</span><span class="PUNC">(</span><span class="NAME">i</span><span class="PUNC">,</span><span class="STRN">"useScreenCoordinates"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">l.sizeAttenuation</span><span class="PUNC">=</span><span class="NAME">b.getUniformLocation</span><span class="PUNC">(</span><span class="NAME">i</span><span class="PUNC">,</span><span class="STRN">"sizeAttenuation"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">l.screenPosition</span><span class="PUNC">=</span><span class="NAME">b.getUniformLocation</span><span class="PUNC">(</span><span class="NAME">i</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>712</span> </span><span class="STRN">"screenPosition"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">l.modelViewMatrix</span><span class="PUNC">=</span><span class="NAME">b.getUniformLocation</span><span class="PUNC">(</span><span class="NAME">i</span><span class="PUNC">,</span><span class="STRN">"modelViewMatrix"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">l.projectionMatrix</span><span class="PUNC">=</span><span class="NAME">b.getUniformLocation</span><span class="PUNC">(</span><span class="NAME">i</span><span class="PUNC">,</span><span class="STRN">"projectionMatrix"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">l.fogType</span><span class="PUNC">=</span><span class="NAME">b.getUniformLocation</span><span class="PUNC">(</span><span class="NAME">i</span><span class="PUNC">,</span><span class="STRN">"fogType"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">l.fogDensity</span><span class="PUNC">=</span><span class="NAME">b.getUniformLocation</span><span class="PUNC">(</span><span class="NAME">i</span><span class="PUNC">,</span><span class="STRN">"fogDensity"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">l.fogNear</span><span class="PUNC">=</span><span class="NAME">b.getUniformLocation</span><span class="PUNC">(</span><span class="NAME">i</span><span class="PUNC">,</span><span class="STRN">"fogNear"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">l.fogFar</span><span class="PUNC">=</span><span class="NAME">b.getUniformLocation</span><span class="PUNC">(</span><span class="NAME">i</span><span class="PUNC">,</span><span class="STRN">"fogFar"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">l.fogColor</span><span class="PUNC">=</span><span class="NAME">b.getUniformLocation</span><span class="PUNC">(</span><span class="NAME">i</span><span class="PUNC">,</span><span class="STRN">"fogColor"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">l.alphaTest</span><span class="PUNC">=</span><span class="NAME">b.getUniformLocation</span><span class="PUNC">(</span><span class="NAME">i</span><span class="PUNC">,</span><span class="STRN">"alphaTest"</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">this.render</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">t</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">q</span><span class="PUNC">=</span><span class="NAME">d.__webglSprites</span><span class="PUNC">,</span><span class="NAME">r</span><span class="PUNC">=</span><span class="NAME">q.length</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">r</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">s</span><span class="PUNC">=</span><span class="NAME">j</span><span class="PUNC">,</span><span class="NAME">v</span><span class="PUNC">=</span><span class="NAME">l</span><span class="PUNC">,</span><span class="NAME">z</span><span class="PUNC">=</span><span class="NAME">t</span><span class="PUNC">/</span><span class="WHIT">
<span class='line'>713</span> </span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">=</span><span class="NUMB">0.5</span><span class="PUNC">*</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">C</span><span class="PUNC">=</span><span class="NUMB">0.5</span><span class="PUNC">*</span><span class="NAME">t</span><span class="PUNC">;</span><span class="NAME">b.useProgram</span><span class="PUNC">(</span><span class="NAME">i</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b.enableVertexAttribArray</span><span class="PUNC">(</span><span class="NAME">s.position</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b.enableVertexAttribArray</span><span class="PUNC">(</span><span class="NAME">s.uv</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b.disable</span><span class="PUNC">(</span><span class="NAME">b.CULL_FACE</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b.enable</span><span class="PUNC">(</span><span class="NAME">b.BLEND</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b.bindBuffer</span><span class="PUNC">(</span><span class="NAME">b.ARRAY_BUFFER</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b.vertexAttribPointer</span><span class="PUNC">(</span><span class="NAME">s.position</span><span class="PUNC">,</span><span class="NUMB">2</span><span class="PUNC">,</span><span class="NAME">b.FLOAT</span><span class="PUNC">,</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NUMB">16</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b.vertexAttribPointer</span><span class="PUNC">(</span><span class="NAME">s.uv</span><span class="PUNC">,</span><span class="NUMB">2</span><span class="PUNC">,</span><span class="NAME">b.FLOAT</span><span class="PUNC">,</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NUMB">16</span><span class="PUNC">,</span><span class="NUMB">8</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b.bindBuffer</span><span class="PUNC">(</span><span class="NAME">b.ELEMENT_ARRAY_BUFFER</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b.uniformMatrix4fv</span><span class="PUNC">(</span><span class="NAME">v.projectionMatrix</span><span class="PUNC">,</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">e.projectionMatrix.elements</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b.activeTexture</span><span class="PUNC">(</span><span class="NAME">b.TEXTURE0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b.uniform1i</span><span class="PUNC">(</span><span class="NAME">v.map</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">F</span><span class="PUNC">=</span><span class="NAME">s</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">H</span><span class="PUNC">=</span><span class="NAME">d.fog</span><span class="PUNC">;</span><span class="NAME">H</span><span class="PUNC">?</span><span class="PUNC">(</span><span class="NAME">b.uniform3f</span><span class="PUNC">(</span><span class="NAME">v.fogColor</span><span class="PUNC">,</span><span class="NAME">H.color.r</span><span class="PUNC">,</span><span class="NAME">H.color.g</span><span class="PUNC">,</span><span class="NAME">H.color.b</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>714</span> </span><span class="NAME">H</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">THREE.Fog</span><span class="PUNC">?</span><span class="PUNC">(</span><span class="NAME">b.uniform1f</span><span class="PUNC">(</span><span class="NAME">v.fogNear</span><span class="PUNC">,</span><span class="NAME">H.near</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">b.uniform1f</span><span class="PUNC">(</span><span class="NAME">v.fogFar</span><span class="PUNC">,</span><span class="NAME">H.far</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">b.uniform1i</span><span class="PUNC">(</span><span class="NAME">v.fogType</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">F</span><span class="PUNC">=</span><span class="NAME">s</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">H</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">THREE.FogExp2</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">b.uniform1f</span><span class="PUNC">(</span><span class="NAME">v.fogDensity</span><span class="PUNC">,</span><span class="NAME">H.density</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">b.uniform1i</span><span class="PUNC">(</span><span class="NAME">v.fogType</span><span class="PUNC">,</span><span class="NUMB">2</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">F</span><span class="PUNC">=</span><span class="NAME">s</span><span class="PUNC">=</span><span class="NUMB">2</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="PUNC">(</span><span class="NAME">b.uniform1i</span><span class="PUNC">(</span><span class="NAME">v.fogType</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">F</span><span class="PUNC">=</span><span class="NAME">s</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">I</span><span class="PUNC">,</span><span class="NAME">G</span><span class="PUNC">,</span><span class="NAME">A</span><span class="PUNC">=</span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">H</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">H</span><span class="PUNC">&lt;</span><span class="NAME">r</span><span class="PUNC">;</span><span class="NAME">H</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">I</span><span class="PUNC">=</span><span class="NAME">q</span><span class="PUNC">[</span><span class="NAME">H</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">G</span><span class="PUNC">=</span><span class="NAME">I.material</span><span class="PUNC">,</span><span class="NAME">I.visible</span><span class="PUNC">&&</span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">G.opacity</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">G.useScreenCoordinates</span><span class="PUNC">?</span><span class="NAME">I.z</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="NAME">I.position.z</span><span class="PUNC">:</span><span class="PUNC">(</span><span class="NAME">I._modelViewMatrix.multiplyMatrices</span><span class="PUNC">(</span><span class="NAME">e.matrixWorldInverse</span><span class="PUNC">,</span><span class="NAME">I.matrixWorld</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">I.z</span><span class="PUNC">=</span><span class="PUNC">-</span><span class="NAME">I._modelViewMatrix.elements</span><span class="PUNC">[</span><span class="NUMB">14</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">q.sort</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">H</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">H</span><span class="PUNC">&lt;</span><span class="NAME">r</span><span class="PUNC">;</span><span class="NAME">H</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">I</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>715</span> </span><span class="NAME">q</span><span class="PUNC">[</span><span class="NAME">H</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">G</span><span class="PUNC">=</span><span class="NAME">I.material</span><span class="PUNC">,</span><span class="NAME">I.visible</span><span class="PUNC">&&</span><span class="NUMB">0</span><span class="PUNC">!==</span><span class="NAME">G.opacity</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">G.map</span><span class="PUNC">&&</span><span class="NAME">G.map.image</span><span class="PUNC">&&</span><span class="NAME">G.map.image.width</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">b.uniform1f</span><span class="PUNC">(</span><span class="NAME">v.alphaTest</span><span class="PUNC">,</span><span class="NAME">G.alphaTest</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">===</span><span class="NAME">G.useScreenCoordinates</span><span class="PUNC">?</span><span class="PUNC">(</span><span class="NAME">b.uniform1i</span><span class="PUNC">(</span><span class="NAME">v.useScreenCoordinates</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">b.uniform3f</span><span class="PUNC">(</span><span class="NAME">v.screenPosition</span><span class="PUNC">,</span><span class="PUNC">(</span><span class="NAME">I.position.x</span><span class="PUNC">*</span><span class="NAME">c.devicePixelRatio</span><span class="PUNC">-</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">/</span><span class="NAME">f</span><span class="PUNC">,</span><span class="PUNC">(</span><span class="NAME">C</span><span class="PUNC">-</span><span class="NAME">I.position.y</span><span class="PUNC">*</span><span class="NAME">c.devicePixelRatio</span><span class="PUNC">)</span><span class="PUNC">/</span><span class="NAME">C</span><span class="PUNC">,</span><span class="NAME">Math.max</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">Math.min</span><span class="PUNC">(</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">I.position.z</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">A</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">c.devicePixelRatio</span><span class="PUNC">,</span><span class="NAME">A</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">c.devicePixelRatio</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="PUNC">(</span><span class="NAME">b.uniform1i</span><span class="PUNC">(</span><span class="NAME">v.useScreenCoordinates</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">b.uniform1i</span><span class="PUNC">(</span><span class="NAME">v.sizeAttenuation</span><span class="PUNC">,</span><span class="NAME">G.sizeAttenuation</span><span class="PUNC">?</span><span class="NUMB">1</span><span class="PUNC">:</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">b.uniformMatrix4fv</span><span class="PUNC">(</span><span class="NAME">v.modelViewMatrix</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>716</span> </span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">I._modelViewMatrix.elements</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">A</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">A</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NAME">d.fog</span><span class="PUNC">&&</span><span class="NAME">G.fog</span><span class="PUNC">?</span><span class="NAME">F</span><span class="PUNC">:</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">s</span><span class="PUNC">!==</span><span class="NAME">e</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">b.uniform1i</span><span class="PUNC">(</span><span class="NAME">v.fogType</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">s</span><span class="PUNC">=</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">=</span><span class="NUMB">1</span><span class="PUNC">/</span><span class="PUNC">(</span><span class="NAME">G.scaleByViewport</span><span class="PUNC">?</span><span class="NAME">t</span><span class="PUNC">:</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">A</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">*</span><span class="PUNC">=</span><span class="NAME">e</span><span class="PUNC">*</span><span class="NAME">z</span><span class="PUNC">*</span><span class="NAME">I.scale.x</span><span class="PUNC">,</span><span class="NAME">A</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">*</span><span class="PUNC">=</span><span class="NAME">e</span><span class="PUNC">*</span><span class="NAME">I.scale.y</span><span class="PUNC">,</span><span class="NAME">b.uniform2f</span><span class="PUNC">(</span><span class="NAME">v.uvScale</span><span class="PUNC">,</span><span class="NAME">G.uvScale.x</span><span class="PUNC">,</span><span class="NAME">G.uvScale.y</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">b.uniform2f</span><span class="PUNC">(</span><span class="NAME">v.uvOffset</span><span class="PUNC">,</span><span class="NAME">G.uvOffset.x</span><span class="PUNC">,</span><span class="NAME">G.uvOffset.y</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">b.uniform2f</span><span class="PUNC">(</span><span class="NAME">v.alignment</span><span class="PUNC">,</span><span class="NAME">G.alignment.x</span><span class="PUNC">,</span><span class="NAME">G.alignment.y</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">b.uniform1f</span><span class="PUNC">(</span><span class="NAME">v.opacity</span><span class="PUNC">,</span><span class="NAME">G.opacity</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">b.uniform3f</span><span class="PUNC">(</span><span class="NAME">v.color</span><span class="PUNC">,</span><span class="NAME">G.color.r</span><span class="PUNC">,</span><span class="NAME">G.color.g</span><span class="PUNC">,</span><span class="NAME">G.color.b</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">b.uniform1f</span><span class="PUNC">(</span><span class="NAME">v.rotation</span><span class="PUNC">,</span><span class="NAME">I.rotation</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">b.uniform2fv</span><span class="PUNC">(</span><span class="NAME">v.scale</span><span class="PUNC">,</span><span class="NAME">A</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">c.setBlending</span><span class="PUNC">(</span><span class="NAME">G.blending</span><span class="PUNC">,</span><span class="NAME">G.blendEquation</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>717</span> </span><span class="NAME">G.blendSrc</span><span class="PUNC">,</span><span class="NAME">G.blendDst</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">c.setDepthTest</span><span class="PUNC">(</span><span class="NAME">G.depthTest</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">c.setDepthWrite</span><span class="PUNC">(</span><span class="NAME">G.depthWrite</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">c.setTexture</span><span class="PUNC">(</span><span class="NAME">G.map</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">b.drawElements</span><span class="PUNC">(</span><span class="NAME">b.TRIANGLES</span><span class="PUNC">,</span><span class="NUMB">6</span><span class="PUNC">,</span><span class="NAME">b.UNSIGNED_SHORT</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b.enable</span><span class="PUNC">(</span><span class="NAME">b.CULL_FACE</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.DepthPassPlugin</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.enabled</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="NAME">this.renderTarget</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Frustum</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.Matrix4</span><span class="PUNC">;</span><span class="NAME">this.init</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">g</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">a</span><span class="PUNC">=</span><span class="NAME">g.context</span><span class="PUNC">;</span><span class="NAME">b</span><span class="PUNC">=</span><span class="NAME">g</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">g</span><span class="PUNC">=</span><span class="NAME">THREE.ShaderLib.depthRGBA</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">=</span><span class="NAME">THREE.UniformsUtils.clone</span><span class="PUNC">(</span><span class="NAME">g.uniforms</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">c</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.ShaderMaterial</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">fragmentShader</span><span class="PUNC">:</span><span class="NAME">g.fragmentShader</span><span class="PUNC">,</span><span class="NAME">vertexShader</span><span class="PUNC">:</span><span class="NAME">g.vertexShader</span><span class="PUNC">,</span><span class="NAME">uniforms</span><span class="PUNC">:</span><span class="NAME">h</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">d</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.ShaderMaterial</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">fragmentShader</span><span class="PUNC">:</span><span class="NAME">g.fragmentShader</span><span class="PUNC">,</span><span class="NAME">vertexShader</span><span class="PUNC">:</span><span class="NAME">g.vertexShader</span><span class="PUNC">,</span><span class="NAME">uniforms</span><span class="PUNC">:</span><span class="NAME">h</span><span class="PUNC">,</span><span class="NAME">morphTargets</span><span class="PUNC">:</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.ShaderMaterial</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">fragmentShader</span><span class="PUNC">:</span><span class="NAME">g.fragmentShader</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>718</span> </span><span class="NAME">vertexShader</span><span class="PUNC">:</span><span class="NAME">g.vertexShader</span><span class="PUNC">,</span><span class="NAME">uniforms</span><span class="PUNC">:</span><span class="NAME">h</span><span class="PUNC">,</span><span class="NAME">skinning</span><span class="PUNC">:</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">f</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">THREE.ShaderMaterial</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">fragmentShader</span><span class="PUNC">:</span><span class="NAME">g.fragmentShader</span><span class="PUNC">,</span><span class="NAME">vertexShader</span><span class="PUNC">:</span><span class="NAME">g.vertexShader</span><span class="PUNC">,</span><span class="NAME">uniforms</span><span class="PUNC">:</span><span class="NAME">h</span><span class="PUNC">,</span><span class="NAME">morphTargets</span><span class="PUNC">:</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">skinning</span><span class="PUNC">:</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">c._shadowPass</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">d._shadowPass</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">e._shadowPass</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">f._shadowPass</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">this.render</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">this.enabled</span><span class="PUNC">&&</span><span class="NAME">this.update</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">this.update</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">i</span><span class="PUNC">,</span><span class="NAME">j</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">l</span><span class="PUNC">,</span><span class="NAME">m</span><span class="PUNC">,</span><span class="NAME">n</span><span class="PUNC">,</span><span class="NAME">p</span><span class="PUNC">,</span><span class="NAME">t</span><span class="PUNC">,</span><span class="NAME">q</span><span class="PUNC">;</span><span class="NAME">a.clearColor</span><span class="PUNC">(</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a.disable</span><span class="PUNC">(</span><span class="NAME">a.BLEND</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b.setDepthTest</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">===</span><span class="NAME">i.autoUpdate</span><span class="PUNC">&&</span><span class="NAME">i.updateMatrixWorld</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">j.matrixWorldInverse.getInverse</span><span class="PUNC">(</span><span class="NAME">j.matrixWorld</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">g.multiplyMatrices</span><span class="PUNC">(</span><span class="NAME">j.projectionMatrix</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>719</span> </span><span class="NAME">j.matrixWorldInverse</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">h.setFromMatrix</span><span class="PUNC">(</span><span class="NAME">g</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b.setRenderTarget</span><span class="PUNC">(</span><span class="NAME">this.renderTarget</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">b.clear</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">q</span><span class="PUNC">=</span><span class="NAME">i.__webglObjects</span><span class="PUNC">;</span><span class="NAME">l</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">m</span><span class="PUNC">=</span><span class="NAME">q.length</span><span class="PUNC">;</span><span class="NAME">l</span><span class="PUNC">&lt;</span><span class="NAME">m</span><span class="PUNC">;</span><span class="NAME">l</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">n</span><span class="PUNC">=</span><span class="NAME">q</span><span class="PUNC">[</span><span class="NAME">l</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">t</span><span class="PUNC">=</span><span class="NAME">n.object</span><span class="PUNC">,</span><span class="NAME">n.render</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">t.visible</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="PUNC">!</span><span class="PUNC">(</span><span class="NAME">t</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">THREE.Mesh</span><span class="PUNC">||</span><span class="NAME">t</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">THREE.ParticleSystem</span><span class="PUNC">)</span><span class="PUNC">||</span><span class="PUNC">!</span><span class="NAME">t.frustumCulled</span><span class="PUNC">||</span><span class="NAME">h.intersectsObject</span><span class="PUNC">(</span><span class="NAME">t</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="NAME">t._modelViewMatrix.multiplyMatrices</span><span class="PUNC">(</span><span class="NAME">j.matrixWorldInverse</span><span class="PUNC">,</span><span class="NAME">t.matrixWorld</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">n.render</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">r</span><span class="PUNC">;</span><span class="NAME">l</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">m</span><span class="PUNC">=</span><span class="NAME">q.length</span><span class="PUNC">;</span><span class="NAME">l</span><span class="PUNC">&lt;</span><span class="NAME">m</span><span class="PUNC">;</span><span class="NAME">l</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">n</span><span class="PUNC">=</span><span class="NAME">q</span><span class="PUNC">[</span><span class="NAME">l</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">n.render</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">t</span><span class="PUNC">=</span><span class="NAME">n.object</span><span class="PUNC">,</span><span class="NAME">n</span><span class="PUNC">=</span><span class="NAME">n.buffer</span><span class="PUNC">,</span><span class="PUNC">!</span><span class="PUNC">(</span><span class="NAME">t</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">THREE.ParticleSystem</span><span class="PUNC">)</span><span class="PUNC">||</span><span class="NAME">t.customDepthMaterial</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">(</span><span class="NAME">r</span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>720</span> </span><span class="NAME">t.material</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">THREE.MeshFaceMaterial</span><span class="PUNC">?</span><span class="NAME">t.material.materials</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">:</span><span class="NAME">t.material</span><span class="PUNC">)</span><span class="PUNC">&&</span><span class="NAME">b.setMaterialFaces</span><span class="PUNC">(</span><span class="NAME">t.material</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">p</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">&lt;</span><span class="NAME">t.geometry.morphTargets.length</span><span class="PUNC">&&</span><span class="NAME">r.morphTargets</span><span class="PUNC">,</span><span class="NAME">r</span><span class="PUNC">=</span><span class="NAME">t</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">THREE.SkinnedMesh</span><span class="PUNC">&&</span><span class="NAME">r.skinning</span><span class="PUNC">,</span><span class="NAME">p</span><span class="PUNC">=</span><span class="NAME">t.customDepthMaterial</span><span class="PUNC">?</span><span class="NAME">t.customDepthMaterial</span><span class="PUNC">:</span><span class="NAME">r</span><span class="PUNC">?</span><span class="NAME">p</span><span class="PUNC">?</span><span class="NAME">f</span><span class="PUNC">:</span><span class="NAME">e</span><span class="PUNC">:</span><span class="NAME">p</span><span class="PUNC">?</span><span class="NAME">d</span><span class="PUNC">:</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">n</span><span class="WHIT"> </span><span class="KEYW">instanceof</span><span class="WHIT"> </span><span class="NAME">THREE.BufferGeometry</span><span class="PUNC">?</span><span class="NAME">b.renderBufferDirect</span><span class="PUNC">(</span><span class="NAME">j</span><span class="PUNC">,</span><span class="NAME">i.__lights</span><span class="PUNC">,</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">p</span><span class="PUNC">,</span><span class="NAME">n</span><span class="PUNC">,</span><span class="NAME">t</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">b.renderBuffer</span><span class="PUNC">(</span><span class="NAME">j</span><span class="PUNC">,</span><span class="NAME">i.__lights</span><span class="PUNC">,</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">p</span><span class="PUNC">,</span><span class="NAME">n</span><span class="PUNC">,</span><span class="NAME">t</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">q</span><span class="PUNC">=</span><span class="NAME">i.__webglObjectsImmediate</span><span class="PUNC">;</span><span class="NAME">l</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="NAME">m</span><span class="PUNC">=</span><span class="NAME">q.length</span><span class="PUNC">;</span><span class="NAME">l</span><span class="PUNC">&lt;</span><span class="NAME">m</span><span class="PUNC">;</span><span class="NAME">l</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">n</span><span class="PUNC">=</span><span class="NAME">q</span><span class="PUNC">[</span><span class="NAME">l</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">t</span><span class="PUNC">=</span><span class="NAME">n.object</span><span class="PUNC">,</span><span class="NAME">t.visible</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">t._modelViewMatrix.multiplyMatrices</span><span class="PUNC">(</span><span class="NAME">j.matrixWorldInverse</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>721</span> </span><span class="NAME">t.matrixWorld</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">b.renderImmediateObject</span><span class="PUNC">(</span><span class="NAME">j</span><span class="PUNC">,</span><span class="NAME">i.__lights</span><span class="PUNC">,</span><span class="KEYW">null</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">t</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">l</span><span class="PUNC">=</span><span class="NAME">b.getClearColor</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">m</span><span class="PUNC">=</span><span class="NAME">b.getClearAlpha</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a.clearColor</span><span class="PUNC">(</span><span class="NAME">l.r</span><span class="PUNC">,</span><span class="NAME">l.g</span><span class="PUNC">,</span><span class="NAME">l.b</span><span class="PUNC">,</span><span class="NAME">m</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">a.enable</span><span class="PUNC">(</span><span class="NAME">a.BLEND</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.ShaderFlares</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="NAME">lensFlareVertexTexture</span><span class="PUNC">:</span><span class="PUNC">{</span><span class="NAME">vertexShader</span><span class="PUNC">:</span><span class="STRN">"uniform lowp int renderType;\nuniform vec3 screenPosition;\nuniform vec2 scale;\nuniform float rotation;\nuniform sampler2D occlusionMap;\nattribute vec2 position;\nattribute vec2 uv;\nvarying vec2 vUV;\nvarying float vVisibility;\nvoid main() {\nvUV = uv;\nvec2 pos = position;\nif( renderType == 2 ) {\nvec4 visibility = texture2D( occlusionMap, vec2( 0.1, 0.1 ) );\nvisibility += texture2D( occlusionMap, vec2( 0.5, 0.1 ) );\nvisibility += texture2D( occlusionMap, vec2( 0.9, 0.1 ) );\nvisibility += texture2D( occlusionMap, vec2( 0.9, 0.5 ) );\nvisibility += texture2D( occlusionMap, vec2( 0.9, 0.9 ) );\nvisibility += texture2D( occlusionMap, vec2( 0.5, 0.9 ) );\nvisibility += texture2D( occlusionMap, vec2( 0.1, 0.9 ) );\nvisibility += texture2D( occlusionMap, vec2( 0.1, 0.5 ) );\nvisibility += texture2D( occlusionMap, vec2( 0.5, 0.5 ) );\nvVisibility =        visibility.r / 9.0;\nvVisibility *= 1.0 - visibility.g / 9.0;\nvVisibility *=       visibility.b / 9.0;\nvVisibility *= 1.0 - visibility.a / 9.0;\npos.x = cos( rotation ) * position.x - sin( rotation ) * position.y;\npos.y = sin( rotation ) * position.x + cos( rotation ) * position.y;\n}\ngl_Position = vec4( ( pos * scale + screenPosition.xy ).xy, screenPosition.z, 1.0 );\n}"</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>722</span> </span><span class="NAME">fragmentShader</span><span class="PUNC">:</span><span class="STRN">"uniform lowp int renderType;\nuniform sampler2D map;\nuniform float opacity;\nuniform vec3 color;\nvarying vec2 vUV;\nvarying float vVisibility;\nvoid main() {\nif( renderType == 0 ) {\ngl_FragColor = vec4( 1.0, 0.0, 1.0, 0.0 );\n} else if( renderType == 1 ) {\ngl_FragColor = texture2D( map, vUV );\n} else {\nvec4 texture = texture2D( map, vUV );\ntexture.a *= opacity * vVisibility;\ngl_FragColor = texture;\ngl_FragColor.rgb *= color;\n}\n}"</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">lensFlare</span><span class="PUNC">:</span><span class="PUNC">{</span><span class="NAME">vertexShader</span><span class="PUNC">:</span><span class="STRN">"uniform lowp int renderType;\nuniform vec3 screenPosition;\nuniform vec2 scale;\nuniform float rotation;\nattribute vec2 position;\nattribute vec2 uv;\nvarying vec2 vUV;\nvoid main() {\nvUV = uv;\nvec2 pos = position;\nif( renderType == 2 ) {\npos.x = cos( rotation ) * position.x - sin( rotation ) * position.y;\npos.y = sin( rotation ) * position.x + cos( rotation ) * position.y;\n}\ngl_Position = vec4( ( pos * scale + screenPosition.xy ).xy, screenPosition.z, 1.0 );\n}"</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>723</span> </span><span class="NAME">fragmentShader</span><span class="PUNC">:</span><span class="STRN">"precision mediump float;\nuniform lowp int renderType;\nuniform sampler2D map;\nuniform sampler2D occlusionMap;\nuniform float opacity;\nuniform vec3 color;\nvarying vec2 vUV;\nvoid main() {\nif( renderType == 0 ) {\ngl_FragColor = vec4( texture2D( map, vUV ).rgb, 0.0 );\n} else if( renderType == 1 ) {\ngl_FragColor = texture2D( map, vUV );\n} else {\nfloat visibility = texture2D( occlusionMap, vec2( 0.5, 0.1 ) ).a;\nvisibility += texture2D( occlusionMap, vec2( 0.9, 0.5 ) ).a;\nvisibility += texture2D( occlusionMap, vec2( 0.5, 0.9 ) ).a;\nvisibility += texture2D( occlusionMap, vec2( 0.1, 0.5 ) ).a;\nvisibility = ( 1.0 - visibility / 4.0 );\nvec4 texture = texture2D( map, vUV );\ntexture.a *= opacity * visibility;\ngl_FragColor = texture;\ngl_FragColor.rgb *= color;\n}\n}"</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="NAME">THREE.ShaderSprite</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="NAME">sprite</span><span class="PUNC">:</span><span class="PUNC">{</span><span class="NAME">vertexShader</span><span class="PUNC">:</span><span class="STRN">"uniform int useScreenCoordinates;\nuniform int sizeAttenuation;\nuniform vec3 screenPosition;\nuniform mat4 modelViewMatrix;\nuniform mat4 projectionMatrix;\nuniform float rotation;\nuniform vec2 scale;\nuniform vec2 alignment;\nuniform vec2 uvOffset;\nuniform vec2 uvScale;\nattribute vec2 position;\nattribute vec2 uv;\nvarying vec2 vUV;\nvoid main() {\nvUV = uvOffset + uv * uvScale;\nvec2 alignedPosition = position + alignment;\nvec2 rotatedPosition;\nrotatedPosition.x = ( cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y ) * scale.x;\nrotatedPosition.y = ( sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y ) * scale.y;\nvec4 finalPosition;\nif( useScreenCoordinates != 0 ) {\nfinalPosition = vec4( screenPosition.xy + rotatedPosition, screenPosition.z, 1.0 );\n} else {\nfinalPosition = projectionMatrix * modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\nfinalPosition.xy += rotatedPosition * ( sizeAttenuation == 1 ? 1.0 : finalPosition.z );\n}\ngl_Position = finalPosition;\n}"</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>724</span> </span><span class="NAME">fragmentShader</span><span class="PUNC">:</span><span class="STRN">"uniform vec3 color;\nuniform sampler2D map;\nuniform float opacity;\nuniform int fogType;\nuniform vec3 fogColor;\nuniform float fogDensity;\nuniform float fogNear;\nuniform float fogFar;\nuniform float alphaTest;\nvarying vec2 vUV;\nvoid main() {\nvec4 texture = texture2D( map, vUV );\nif ( texture.a &lt; alphaTest ) discard;\ngl_FragColor = vec4( color * texture.xyz, texture.a * opacity );\nif ( fogType > 0 ) {\nfloat depth = gl_FragCoord.z / gl_FragCoord.w;\nfloat fogFactor = 0.0;\nif ( fogType == 1 ) {\nfogFactor = smoothstep( fogNear, fogFar, depth );\n} else {\nconst float LOG2 = 1.442695;\nfloat fogFactor = exp2( - fogDensity * fogDensity * depth * depth * LOG2 );\nfogFactor = 1.0 - clamp( fogFactor, 0.0, 1.0 );\n}\ngl_FragColor = mix( gl_FragColor, vec4( fogColor, gl_FragColor.w ), fogFactor );\n}\n}"</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>725</span> </span></pre></body></html>